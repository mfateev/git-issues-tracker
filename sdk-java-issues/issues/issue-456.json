{
  "assignees": [],
  "author": {
    "id": "MDQ6VXNlcjU4MTc4NTk=",
    "is_bot": false,
    "login": "smax48",
    "name": "Maxim Chuvilyaev"
  },
  "body": "## Expected Behavior\r\nI start 2 workflows (one by one) with the same workflowId and `WorkflowIdReusePolicy.WORKFLOW_ID_REUSE_POLICY_REJECT_DUPLICATE` option.\r\nI use `execute` method to start exection.\r\n\r\nFirst workflow is still running when I start the second - so the second should just becomes a \"proxy\" for the first one and should return the same result without starting a new wf instance.\r\n\r\nThen I try to wait for CompletableFuture and get the result.\r\nPseudo-code for illustration:\r\n```\r\nf1 = WorkflowClient.execute(..., options)\r\nf2 = WorkflowClient.execute(..., options)\r\nresult1 = f1.get()\r\nresult2 = f2.get()\r\n```\r\n\r\nThe behaviour is very different when I use Test Environment and real docker containers for Temporal.\r\nWith \"real\" Temporal all works as expected.\r\nI expect that in the test environment it works the same way.\r\n\r\n## Actual Behaviour\r\n\r\nWith Test Environment the second f2.get() call hangs forever.\r\n\r\nIf the first workflow is fully completed before starting the second, all works OK.\r\n\r\n\r\n## Steps to Reproduce the Problem\r\n\r\nI have a test (implemented in Kotlin) that fully reproduces the described issue. See the attached file.\r\n[DuplicateWorkflowIdTest.kt.zip](https://github.com/temporalio/sdk-java/files/6395725/DuplicateWorkflowIdTest.kt.zip)\r\n\r\n## Specifications\r\n\r\n  - Version: Java SDK 1.0.7, Temporal 1.8.2\r\n  - Platform: Java SDK 1.0.7, Kotlin \r\n",
  "closedAt": null,
  "comments": [],
  "createdAt": "2021-04-29T01:06:50Z",
  "labels": [
    {
      "id": "MDU6TGFiZWwxNjIyNzE5ODQx",
      "name": "bug",
      "description": "Something isn't working",
      "color": "d73a4a"
    },
    {
      "id": "LA_kwDODN12PM8AAAABzzHCJQ",
      "name": "test server",
      "description": "Related to the test server",
      "color": "A71076"
    }
  ],
  "milestone": null,
  "number": 456,
  "reactionGroups": [],
  "state": "OPEN",
  "title": "Duplicate concurrent workflow - hangs on completion",
  "updatedAt": "2024-11-19T19:12:14Z",
  "url": "https://github.com/temporalio/sdk-java/issues/456"
}
