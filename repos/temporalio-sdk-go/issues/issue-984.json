{"assignees":[],"author":{"id":"MDQ6VXNlcjc5MjM0NjA=","is_bot":false,"login":"chunming-c","name":"chunming, chen"},"body":"## Expected Behavior\r\n\r\nHi forks, thank you for the great work. I faced a difficulty which might not be a bug but I couldn't find relative solution anywhere. In our case I would like to know how should we detect workflow has timeout or how should we catch the timeout error when `WorkflowRunTimeout` is reached. For example, the following set the `WorkflowRunTimeout` to 1 second which should enter workflow `defer` function once timeout is reached. \r\n\r\n**main.go**\r\n```go\r\nfunc main() {\r\n\t...\r\n\tworkflowOptions := client.StartWorkflowOptions{\r\n\t\tID:        workflowID,\r\n\t\tTaskQueue: \"\",\r\n                 // Set workflow timeout to one second.\r\n\t\tWorkflowRunTimeout: 1 * time.Second,\r\n\t}\r\n\r\n\twe, err := c.ExecuteWorkflow(context.Background(), workflowOptions, YourWorkflow)\r\n}\r\n```\r\n\r\n\r\n**workflow.go**\r\n```go\r\nfunc YourWorkflow(ctx workflow.Context) error {\r\n\tdefer func() {\r\n                 // Ideally the defer function should be called once one second passed. The fact is the temporal will terminate \r\n                 // the workflow without entering the the defer function.\r\n\t\tif !errors.Is(ctx.Err(), workflow.ErrCanceled) {\r\n\t\t\treturn\r\n\t\t}\r\n\t}()\r\n\r\n        time.Sleep(5 * time.Second)\r\n\r\n\treturn nil\r\n}\r\n\r\n```\r\n\r\n## Actual Behavior\r\n\r\nThe fact is the temporal will terminate the workflow without entering the the `defer` function.\r\n\r\n\r\n## Specifications\r\n\r\n  - Version: `v1.18.4`\r\n  - Platform: OSX\r\n","closedAt":"2022-12-22T05:40:46Z","comments":[{"id":"IC_kwDODN1w685RM1T5","author":{"login":"Quinn-With-Two-Ns"},"authorAssociation":"MEMBER","body":"Hi @chunming-c , I believe this is the intended behaviour. Per our documentation on [WorkflowRunTimeout](https://docs.temporal.io/concepts/what-is-a-workflow-run-timeout) it will terminate the workflow execution so no other workflow tasks should be run. \r\n\r\nWe don't recommend putting any business logic on workflow timeouts. Why exactly are you setting `WorkflowRunTimeout ` ","createdAt":"2022-12-22T02:32:34Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/984#issuecomment-1362318585","viewerDidAuthor":false},{"id":"IC_kwDODN1w685RNDoU","author":{"login":"chunming-c"},"authorAssociation":"NONE","body":"`WorkflowRunTimeout` is the minimum hard deadline because we don't want workflow would run forever\r\n\r\nOur workflow is long-running process which contains couples of activities might last one or two hours. It's a big deal for us if one of them is delayed and make the entire workflow not able to finish on time, especially the last few activities. Therefore, once the workflow exceed the timeout, an alert will be sent. It would be ideal if we could get a either event or error when the workflow timeouts","createdAt":"2022-12-22T03:45:50Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/984#issuecomment-1362377236","viewerDidAuthor":false},{"id":"IC_kwDODN1w685RNKIg","author":{"login":"Quinn-With-Two-Ns"},"authorAssociation":"MEMBER","body":"As I said we don't recommend using workflow timeout for any business logic. If you did really want to go with that approach then you could have a parent workflow that's job is to supervise the child workflow and wait for the child workflow to complete/fail and react accordingly. Another approach would be to create a timer at the start of your workflow and if that timer expires cancel the workflow and do any cleanup\r\n\r\n [Child workflow example](https://github.com/temporalio/samples-go/tree/main/child-workflow)\r\n \r\n [timer example](https://github.com/temporalio/samples-go/blob/main/timer/workflow.go)","createdAt":"2022-12-22T04:39:27Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/984#issuecomment-1362403872","viewerDidAuthor":false},{"id":"IC_kwDODN1w685RNTXI","author":{"login":"chunming-c"},"authorAssociation":"NONE","body":"okay, thank you for your advices. Will figure out an alternative to fit our own logic. Thanks!","createdAt":"2022-12-22T05:40:46Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/984#issuecomment-1362441672","viewerDidAuthor":false}],"createdAt":"2022-12-22T01:32:04Z","labels":[{"id":"MDU6TGFiZWwyMDUzODEzNTY0","name":"potential-bug","description":"","color":"90c109"}],"milestone":null,"number":984,"reactionGroups":[],"state":"CLOSED","title":"No error will be thrown if WorkflowRunTimeout is reached","updatedAt":"2022-12-22T05:40:46Z","url":"https://github.com/temporalio/sdk-go/issues/984"}
