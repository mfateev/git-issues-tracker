{"assignees":[],"author":{"id":"MDQ6VXNlcjYzNjE1MjQ5","is_bot":false,"login":"kevinzhu-sa","name":""},"body":"Getting issues since upgrading to 1.13.1. No issues in 1.13.0\r\n\r\n\r\n## Expected Behavior\r\n\r\nCancel activity should not panic the workflow \r\n\r\n## Actual Behavior\r\n\r\n```\r\nPanicError: lookup failed for scheduledEventID to activityID: scheduleEventID: 197, activityID: 196\r\n```\r\n\r\n\r\n## Steps to Reproduce the Problem\r\n\r\nomitted details but main structure as below\r\n\r\n```go\r\nfunc workflow() error {\r\n\tvar runningActivities ActivityResults\r\n\r\n\tactivityCtx, cancelActivity := workflow.WithCancel(ctx)\r\n\r\n\ts.AddReceive(signalChan, func(c workflow.ReceiveChannel, more bool) {\r\n\t\t...\r\n\t\tif shouldCancel {\r\n\t\t\tcancelActivity()\r\n\r\n\t\t\tif len(runningActivities) > 0 {\r\n\t\t\t\t// get results of all the running activities to ensure they are cancelled\r\n\t\t\t\trunningActivities = ActivityResults{}\r\n\t\t\t}\r\n\t\t\t_ = workflow.Sleep(ctx, 15*time.Second)\r\n\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\r\n\t\t// Do not block workflow thread.\r\n\t\tworkflow.Go(activityCtx, func(activityCtx workflow.Context) {\r\n\t\t\t// run activities with `activityCtx`\r\n\t\t\t// update runningActivities array\r\n\t\t})\r\n\t})\r\n}\r\n\r\n```\r\n\r\n\r\n\r\n## Specifications\r\n\r\n  - Version: 1.13.1\r\n  - Platform: kubernetes\r\n","closedAt":"2022-03-28T15:38:06Z","comments":[{"id":"IC_kwDODN1w684_PEQy","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"We have noticed a similar issue here and fixed it with https://github.com/temporalio/sdk-go/pull/741 and are about to release it. Can you try with `master` and see if you can still replicate?","createdAt":"2022-03-07T17:03:48Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/747#issuecomment-1060914226","viewerDidAuthor":false},{"id":"IC_kwDODN1w684_PH40","author":{"login":"kevinzhu-sa"},"authorAssociation":"NONE","body":"> \r\n\r\nThanks! Will give it a try","createdAt":"2022-03-07T17:17:47Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/747#issuecomment-1060929076","viewerDidAuthor":false},{"id":"IC_kwDODN1w685Aa9Td","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"Closing. Reopen if this issue persists.","createdAt":"2022-03-28T15:38:06Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/747#issuecomment-1080808669","viewerDidAuthor":false},{"id":"IC_kwDODN1w685GPRm9","author":{"login":"choo-stripe"},"authorAssociation":"NONE","body":"We hit this cancelling a workflow on 1.14.1. Let me know what details I can provide to help.","createdAt":"2022-07-08T00:44:03Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/747#issuecomment-1178409405","viewerDidAuthor":false},{"id":"IC_kwDODN1w685GRYND","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"This is often caused by non-determinism. See https://community.temporal.io/t/go-sdk-troubleshooting/4440#workflow-non-determinism-5.","createdAt":"2022-07-08T12:58:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/747#issuecomment-1178960707","viewerDidAuthor":false}],"createdAt":"2022-03-07T17:02:24Z","labels":[{"id":"MDU6TGFiZWwyMDUzODEzNTY0","name":"potential-bug","description":"","color":"90c109"}],"milestone":null,"number":747,"reactionGroups":[],"state":"CLOSED","title":"lookup failed for scheduledEventID to activityID since 1.13.1","updatedAt":"2022-07-08T12:58:20Z","url":"https://github.com/temporalio/sdk-go/issues/747"}
