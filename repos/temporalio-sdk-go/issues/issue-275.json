{"assignees":[],"author":{"id":"MDQ6VXNlcjE1NDc4OTA=","is_bot":false,"login":"umran","name":"Umran Hussain"},"body":"## Expected Behavior\r\nI expect the workflow to not be retried if the type of the error that is returned from the workflow (although originating from an activity) matches one of the non-retryable types specified in the workflow's retry policy.\r\n\r\n## Actual Behavior\r\nThe workflow keeps getting retried despite the error being a non-retryable type.\r\n\r\n## Steps to Reproduce the Problem\r\n\r\n1. Define an activity that results in a non-retryable error:\r\n\r\n```go\r\nfunc MyActivity(ctx context.Context) (string, error) {\r\n\treturn \"\", temporal.NewApplicationError(\"this is a rejection\", \"Rejection\")\r\n}\r\n```\r\n\r\n2. Define a workflow that returns the error as is from the activity:\r\n\r\n```go\r\nfunc MyWorkflow(ctx workflow.Context) (string, error) {\r\n\tctx = workflow.WithActivityOptions(ctx, workflow.ActivityOptions{\r\n\t\tScheduleToCloseTimeout: time.Second * 60,\r\n\t\tRetryPolicy: &temporal.RetryPolicy{\r\n\t\t\tInitialInterval:        time.Second * 1,\r\n\t\t\tNonRetryableErrorTypes: []string{\"Rejection\"},\r\n\t\t},\r\n\t})\r\n\r\n\tvar result string\r\n\terr := workflow.ExecuteActivity(ctx, MyActivity).Get(ctx, &result)\r\n\tif err != nil {\r\n\t\treturn \"\", err\r\n\t}\r\n\r\n\treturn result, nil\r\n}\r\n```\r\n\r\n3. Call the workflow with a retry policy:\r\n\r\n```go\r\nfunc main() {\r\n\tc, err := client.NewClient(client.Options{})\r\n\tif err != nil {\r\n\t\tlog.Fatalln(\"unable to create Temporal client\", err)\r\n\t}\r\n\r\n\tworkflowOptions := client.StartWorkflowOptions{\r\n\t\tTaskQueue: \"someTaskQueue\",\r\n\t\tRetryPolicy: &temporal.RetryPolicy{\r\n\t\t\tInitialInterval:        time.Second * 1,\r\n\t\t\tMaximumAttempts:        30,\r\n\t\t\tNonRetryableErrorTypes: []string{\"Rejection\"},\r\n\t\t},\r\n\t}\r\n\r\n\tvar result string\r\n\terr = c.ExecuteWorkflow(context.Background(), workflowOptions, MyWorkflow).Get(context.Background(), &result)\r\n\tif err != nil {\r\n\t\tlog.Fatalln(err)\r\n\t}\r\n\r\n\tfmt.Println(result)\r\n}\r\n```\r\n\r\nI would expect the workflow to quit on the first attempt, but it keeps getting retried until MaxAttempts is reached.\r\n\r\nNote that if I omit the retry policy from workflow options, I get back the error and am able to cast it as temporal.ApplicationError (as expected) and if I call its Type() method, it returns \"Rejection\".\r\n\r\n## Specifications\r\n\r\n  - Version: v1.1.0\r\n  - Platform: mac","closedAt":"2020-10-26T02:32:22Z","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDcxNjI2ODg3NQ==","author":{"login":"umran"},"authorAssociation":"NONE","body":"Closing as I think the thread [here](https://community.temporal.io/t/application-error-handling/708) sufficiently clears up the issue","createdAt":"2020-10-26T02:32:22Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/275#issuecomment-716268875","viewerDidAuthor":false}],"createdAt":"2020-10-22T22:45:20Z","labels":[{"id":"MDU6TGFiZWwyMDUzODEzNTY0","name":"potential-bug","description":"","color":"90c109"}],"milestone":null,"number":275,"reactionGroups":[],"state":"CLOSED","title":"If a retryable workflow returns a non-retryable error that was originally returned by an activity, the workflow still gets retried","updatedAt":"2020-10-26T08:22:45Z","url":"https://github.com/temporalio/sdk-go/issues/275"}
