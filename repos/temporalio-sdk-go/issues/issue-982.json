{"assignees":[],"author":{"id":"MDQ6VXNlcjIwNjM5Ng==","is_bot":false,"login":"cretz","name":"Chad Retz"},"body":"## Expected Behavior\r\n\r\nShould be able to call `OnActivity(\"string-name\"` without having registered it first\r\n\r\n## Actual Behavior\r\n\r\nWe check whether it was registered first. There are activities defined in different languages that do not have a Go function to have been registered.\r\n\r\nStop requiring activities to be registered before mocking them.","closedAt":null,"comments":[{"id":"IC_kwDODN1w685Wi_Y4","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"We may have to require registration first, but we should at least document that we require registration first.","createdAt":"2023-03-02T15:00:24Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/982#issuecomment-1452013112","viewerDidAuthor":false},{"id":"IC_kwDODN1w686Y3ukd","author":{"login":"Turao"},"authorAssociation":"NONE","body":"I also bumped into this issue while learning how to use the SDK.\r\n\r\nI don't understand why registration is even required in the first place, since `OnActivity` aims to override the function's behavior - the original function is completely ignored: https://github.com/temporalio/sdk-go/blob/master/internal/workflow_testsuite.go#L413\r\n\r\nTo make matters worse, it looks like we cannot even register the activities before calling `OnActivity`, since:\r\n- `RegisterActivity` expects a function (or struct?)\r\n- `RegisterActivityWithOptions` expects an internal struct (and we cannot use internal packages, else we get \"use of internal package go.temporal.io/sdk/internal not allowed\")\r\n\r\nExample: https://github.com/Turao/temporal-study/blob/main/src/temporal/workflows/start-new-project/workflow_test.go\r\n\r\nCould this assertion be dropped? It feels quite unnecessary.","createdAt":"2024-12-29T14:41:15Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/982#issuecomment-2564745501","viewerDidAuthor":false},{"id":"IC_kwDODN1w686ZYpBS","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"> RegisterActivity expects a function (or struct?)\r\n\r\nA dummy function works fine\r\n\r\n> RegisterActivityWithOptions expects an internal struct (and we cannot use internal packages, else we get \"use of internal package go.temporal.io/sdk/internal not allowed\")\r\n\r\nUse `go.temporal.io/sdk/activity.RegisterOptions` which is an alias to that internal type\r\n\r\n> Could this assertion be dropped? It feels quite unnecessary.\r\n\r\nI think the issue is that local activities expect to validate the argument types before dispatching to the actual activity, which the mock can provide. It may be possible for us to relax this requirement since it is local activity only, which is the reason we created this issue. In the meantime, just register a dummy function that has the proper argument types.","createdAt":"2025-01-06T15:42:05Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-go/issues/982#issuecomment-2573373522","viewerDidAuthor":false},{"id":"IC_kwDODN1w686aHuTd","author":{"login":"Turao"},"authorAssociation":"NONE","body":"> In the meantime, just register a dummy function that has the proper argument types.\r\n\r\nThat works! Thanks for the explanation :)","createdAt":"2025-01-12T12:32:05Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/982#issuecomment-2585715933","viewerDidAuthor":false}],"createdAt":"2022-12-13T15:07:46Z","labels":[{"id":"MDU6TGFiZWwyMDUzODEzNTY0","name":"potential-bug","description":"","color":"90c109"}],"milestone":null,"number":982,"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"state":"OPEN","title":"Cannot register mock activity with string name on test workflow environment","updatedAt":"2025-01-12T12:32:11Z","url":"https://github.com/temporalio/sdk-go/issues/982"}
