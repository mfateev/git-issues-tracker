{"assignees":[],"author":{"id":"MDQ6VXNlcjU1NTIzODE=","is_bot":false,"login":"mastermanu","name":""},"body":"Health check code:\r\n\r\n```\r\nfunc checkHealth(connection grpc.ClientConnInterface, options ConnectionOptions) error {\r\n\tif options.DisableHealthCheck {\r\n\t\treturn nil\r\n\t}\r\n\thealthClient := healthpb.NewHealthClient(connection)\r\n\trequest := &healthpb.HealthCheckRequest{\r\n\t\tService: healthCheckServiceName,\r\n\t}\r\n\thealthCheckTimeout := options.HealthCheckTimeout\r\n\tif healthCheckTimeout == 0 {\r\n\t\thealthCheckTimeout = defaultHealthCheckTimeout\r\n\t}\r\n\tctx, cancel := context.WithTimeout(context.Background(), healthCheckTimeout)\r\n\tdefer cancel()\r\n\tresp, err := healthClient.Check(ctx, request)\r\n\tif err != nil {\r\n\t\treturn fmt.Errorf(\"health check error: %w\", err)\r\n\t}\r\n\tif resp.Status != healthpb.HealthCheckResponse_SERVING {\r\n\t\treturn fmt.Errorf(\"health check returned unhealthy status: %v\", resp.Status)\r\n\t}\r\n\treturn nil\r\n}\r\n```\r\n\r\nUser's only option is to disable the health check or add retries on their application layer. For checkHealth calls on create client, we may want more sophisticated logic, or at least the ability to configure something via ConnectionOptions","closedAt":"2021-05-28T03:16:03Z","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDg0OTQxMzk1Ng==","author":{"login":"vitarb"},"authorAssociation":"CONTRIBUTOR","body":"@mastermanu what do you think about #453?","createdAt":"2021-05-27T07:43:59Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/438#issuecomment-849413956","viewerDidAuthor":false}],"createdAt":"2021-05-10T21:46:03Z","labels":[{"id":"MDU6TGFiZWwxNjIyNzA3NDky","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":438,"reactionGroups":[],"state":"CLOSED","title":"Client creation doesn't have any retries if health check intermittently fails","updatedAt":"2021-05-28T03:16:03Z","url":"https://github.com/temporalio/sdk-go/issues/438"}
