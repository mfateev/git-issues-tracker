{"assignees":[],"author":{"id":"MDQ6VXNlcjExMjc1","is_bot":false,"login":"mnichols","name":"Mike Nichols"},"body":"## Expected Behavior\n\nI should be able to just provide a callback for `OnComplete` in the `testsuite.TestUpdateCallbacks`. \nEither that, or I should get an error that tells me what is really wrong (not nil pointer).\n\n## Actual Behavior\n\nThis doesn't seem to check that each callback is provided so will panic when invoked downstream. These `nil pointer` exceptions are super hard to understand coming out of this test suite and make testing brittle with UpdateWorkflow. \n\nI recommend we either:\n1. catch the error and provided a more meaningful error\n2. (better) provide no-op stubs when a particular callback is not provided (eg `OnAccept: func() {}`)\n\nSomewhere in here probably:\nhttps://github.com/temporalio/sdk-go/blob/master/internal/internal_workflow_testsuite.go#L2986\n\n## Steps to Reproduce the Problem\n\nThis will fail because I don't have `OnAccept` provided as a noop.\nIMO this should be an opt-in facility.\n\n```\npackage myworkflow\n\nimport (\n\t\"fmt\"\n\t\"github.com/google/uuid\"\n\t\"github.com/stretchr/testify/assert\"\n\t\"github.com/stretchr/testify/require\"\n\t\"go.temporal.io/sdk/testsuite\"\n\t\"go.temporal.io/sdk/workflow\"\n\t\"testing\"\n)\n\nfunc MyWorkflow(ctx workflow.Context) error {\n\n\tif err := workflow.SetUpdateHandler(\n\t\tctx,\n\t\t\"add\",\n\t\tfunc(ctx workflow.Context) (int, error) {\n\t\t\tfmt.Printf(\"UpdateHandler called\")\n\t\t\treturn 42, nil\n\t\t}); err != nil {\n\n\t\treturn fmt.Errorf(\"could not set update: %w\", err)\n\t}\n\treturn nil\n}\n\nfunc TestUpdateReturnsAppropriateResponse(t *testing.T) {\n\tA := assert.New(t)\n\tR := require.New(t)\n\n\ts := &testsuite.WorkflowTestSuite{}\n\n\tenv := s.NewTestWorkflowEnvironment()\n\n\tenv.RegisterWorkflow(StandaloneScreening)\n\tenv.RegisterDelayedCallback(func() {\n\t\tenv.UpdateWorkflow(\"add\", uuid.New().String(), &testsuite.TestUpdateCallback{\n\t\t\t//  uncomment this callback to let it pass\n                         // OnAccept: func() {},\n\t\t\tOnReject: func(err error) {\n\t\t\t\tR.NoError(err)\n\t\t\t},\n\t\t\tOnComplete: func(i interface{}, err error) {\n\t\t\t\tfmt.Printf(\"OnComplete: %v\\n\", i)\n\t\t\t},\n\t\t})\n\t}, 0)\n\tenv.ExecuteWorkflow(MyWorkflow)\n\terr := env.GetWorkflowError()\n\tR.NoError(err)\n\tA.True(env.IsWorkflowCompleted())\n\tA.NoError(env.GetWorkflowError())\n}\n\n```\n\n\n## Specifications\n\n  - Version:\n  - Platform:\n","closedAt":"2025-04-14T21:29:21Z","comments":[],"createdAt":"2025-03-10T00:11:29Z","labels":[{"id":"MDU6TGFiZWwxNjIyNzA3NDg2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":1860,"reactionGroups":[],"state":"CLOSED","title":"testsuite.TestUpdateCallback method should be given no-ops when not provided","updatedAt":"2025-04-14T21:29:21Z","url":"https://github.com/temporalio/sdk-go/issues/1860"}
