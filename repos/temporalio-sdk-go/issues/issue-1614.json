{"assignees":[],"author":{"id":"MDQ6VXNlcjIwNjM5Ng==","is_bot":false,"login":"cretz","name":"Chad Retz"},"body":"**Describe the solution you'd like**\r\n\r\nWe set the parent on the context before making a visit call but then don't set it back when done causing it to leak to other calls. We need to set it back.\r\n\r\nAlso for clarity we need to change the doc from:\r\n\r\n> Context is the same for every call of a visit, callers should not store it.\r\n\r\nto\r\n\r\n> Context is the same for every call of a visit and is mutated between calls, callers should not store it or reference it beyond the call. Also, context should be considered by mutated by users.\r\n\r\nAnd perhaps put this doc on the `VisitPayloadsContext` itself. This is on this repo instead of https://github.com/temporalio/api-go because that has no \"issues\" section.","closedAt":"2024-09-04T19:07:45Z","comments":[{"id":"IC_kwDODN1w686KXRla","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"```go\r\n\t\t\tctx.Parent = o\r\n\t\t\tif err := visitPayloads(\r\n\t\t\t\tctx,\r\n\t\t\t\toptions,\r\n\t\t\t\to.GetHeader(),\r\n\t\t\t\to.GetInput(),\r\n\t\t\t\to.GetMemo(),\r\n\t\t\t\to.GetSearchAttributes(),\r\n```\r\nshould probably be more like\r\n```go\r\n\t\t\tif err := visitPayloads(\r\n\t\t\t\tctx,\r\n\t\t\t\toptions,\r\n\t\t\t\to,\r\n\t\t\t\to.GetHeader(),\r\n\t\t\t\to.GetInput(),\r\n\t\t\t\to.GetMemo(),\r\n\t\t\t\to.GetSearchAttributes(),\r\n```\r\ni.e. pass in the parent as a param and set the parent before the type switch. But up to implementer.","createdAt":"2024-08-30T14:01:05Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/1614#issuecomment-2321357146","viewerDidAuthor":false},{"id":"IC_kwDODN1w686K3bHm","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"(note this is not yet tagged/released in the API repo)","createdAt":"2024-09-04T19:08:28Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/1614#issuecomment-2329784806","viewerDidAuthor":false}],"createdAt":"2024-08-30T12:12:10Z","labels":[{"id":"MDU6TGFiZWwxNjIyNzA3NDg2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":1614,"reactionGroups":[],"state":"CLOSED","title":"For `go.temporal.io/api/proxy.VisitPayloadsOptions.Visitor`, parent not properly reset (and clarify docs)","updatedAt":"2024-09-04T19:08:30Z","url":"https://github.com/temporalio/sdk-go/issues/1614"}
