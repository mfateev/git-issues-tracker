{"assignees":[],"author":{"id":"MDQ6VXNlcjEwODkyODU=","is_bot":false,"login":"saumitrabhave","name":"Saumitra Bhave"},"body":"## Expected Behavior\r\nThe prject should build fine\r\n\r\n## Actual Behavior\r\nError is produced is bazel build like\r\n\r\n/external/com_github_grpc_ecosystem_grpc_gateway/runtime/BUILD.bazel:5:11: no such package '@go_googleapis//google/api': The repository '@go_googleapis' could not be resolved: Repository '@go_googleapis' is not defined and referenced by '@com_github_grpc_ecosystem_grpc_gateway//runtime:go_default_library'\r\n\r\n\r\n## Steps to Reproduce the Problem\r\n\r\n  1. go get go.temporal.io/sdk  [ this gets v1.25.1  which also adds github.com/grpc-ecosystem/grpc-gateway v1.16.0  as dependency]\r\n  2. bazel run //:gazelle-update-repos\r\n  3. bazel build the project\r\n\r\n## Specifications\r\n\r\nErrors:\r\n  - io_bazel_rules_go: 0.42\r\n  - bazel_gazelle: 0.33\r\n\r\nWorks Fine with \r\n  - io_bazel_rules_go: 0.40\r\n  - bazel_gazelle: 0.31.1\r\n\r\n## Additional Details\r\n\r\nI am a noob in bazel and go build tool chains in general but with whatever I could see there might be multiple issues at play. even to build with older versions(as mentioned above) I had to add `build_naming_convention = \"go_default_library\",  #keep` to the `com_github_grpc_ecosystem_grpc_gateway` dependency.\r\n\r\nEven after adding this, if I increase the bazelle_gazelle version, it still errors out with error above. I think it has something to do with the fact that bazelle_gazelle stopped resolving go and proto imports to @go_googleapis since 0.32 as per https://github.com/bazelbuild/bazel-gazelle/releases. and that is where the injection point is for the error I am facing.","closedAt":"2024-03-13T15:26:05Z","comments":[{"id":"IC_kwDODN1w685vq5oy","author":{"login":"Quinn-With-Two-Ns"},"authorAssociation":"MEMBER","body":"I am not super familiar with bazel, but is the problem really with `github.com/grpc-ecosystem/grpc-gateway`  does the same issue exist with `github.com/grpc-ecosystem/grpc-gateway/v2`? Since that is what the head of the repo uses.","createdAt":"2024-01-01T23:06:09Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/1331#issuecomment-1873517106","viewerDidAuthor":false},{"id":"IC_kwDODN1w685xpGZY","author":{"login":"SpencerC"},"authorAssociation":"NONE","body":"Slightly different problem with Bzlmod, but also traces back to `grpc-gateway`:\r\n```\r\nERROR: /private/var/tmp/_bazel_spencerconnaughton/9b09d78e8f2190e9af61aa37bcab571e/external/gazelle~0.35.0~go_deps~io_temporal_go_api/internal/temporalgateway/BUILD.bazel:3:11: no such target '@gazelle~0.35.0~go_deps~com_github_grpc_ecosystem_grpc_gateway//runtime:runtime': target 'runtime' not declared in package 'runtime' defined by /private/var/tmp/_bazel_spencerconnaughton/9b09d78e8f2190e9af61aa37bcab571e/external/gazelle~0.35.0~go_deps~com_github_grpc_ecosystem_grpc_gateway/runtime/BUILD.bazel (Tip: use `query \"@@gazelle~0.35.0~go_deps~com_github_grpc_ecosystem_grpc_gateway//runtime:*\"` to see all the targets in that package) and referenced by '@gazelle~0.35.0~go_deps~io_temporal_go_api//internal/temporalgateway:temporalgateway'\r\n```\r\nHopefully will be fixed by #1365","createdAt":"2024-01-23T17:45:53Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/1331#issuecomment-1906599512","viewerDidAuthor":false},{"id":"IC_kwDODN1w685xpJmk","author":{"login":"Quinn-With-Two-Ns"},"authorAssociation":"MEMBER","body":"@SpencerC I am not sure how your PR is related to this issue.\r\n\r\nNote: `grpc-gateway` is already updated to v2 on the head of the repo","createdAt":"2024-01-23T17:54:28Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/1331#issuecomment-1906612644","viewerDidAuthor":false},{"id":"IC_kwDODN1w685xpPEK","author":{"login":"SpencerC"},"authorAssociation":"NONE","body":"@Quinn-With-Two-Ns oops, got my gRPC packages mixed up! It works on HEAD. @saumitrabhave try `go get go.temporal.io/sdk@94a5f5f81f98b9351a0df0dd6833582e83052a0e`.\r\n","createdAt":"2024-01-23T18:08:02Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/1331#issuecomment-1906635018","viewerDidAuthor":false},{"id":"IC_kwDODN1w685xqG80","author":{"login":"saumitrabhave"},"authorAssociation":"NONE","body":"Thanks @Quinn-With-Two-Ns and @SpencerC ... let me check and get back","createdAt":"2024-01-23T20:26:11Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/1331#issuecomment-1906863924","viewerDidAuthor":false},{"id":"IC_kwDODN1w68525B0n","author":{"login":"Quinn-With-Two-Ns"},"authorAssociation":"MEMBER","body":"Closing since the Go SDK now uses `grpc-gateway v2`","createdAt":"2024-03-13T15:26:05Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/1331#issuecomment-1994661159","viewerDidAuthor":false}],"createdAt":"2023-12-23T05:58:08Z","labels":[{"id":"MDU6TGFiZWwyMDUzODEzNTY0","name":"potential-bug","description":"","color":"90c109"}],"milestone":null,"number":1331,"reactionGroups":[],"state":"CLOSED","title":"Temporal Go SDK can not be used with bazel_gazelle 0.32+","updatedAt":"2024-03-13T15:26:11Z","url":"https://github.com/temporalio/sdk-go/issues/1331"}
