{"assignees":[],"author":{"id":"MDQ6VXNlcjM2MDk4Mw==","is_bot":false,"login":"jackielii","name":"Jackie Li"},"body":"**Is your feature request related to a problem? Please describe.**\r\nI have a workflow that relies on child workflow to run many times. And I need to test the behaviour of this behaviour.\r\n\r\nE.g. in the [child-workflow-continue-as-new](https://github.com/temporalio/samples-go/tree/main/child-workflow-continue-as-new) example, we want to test the the child workflow is executed exactly _5_ times.\r\n\r\n**Describe the solution you'd like**\r\nIn order to keep compatibility, I propose adding an method in `TestWorkflowEnvironment` called `EnableRunContinueAsNew`. \r\n\r\nIf this option is enabled, the `ContinueAsNewError` won't be returned, but workflow will be executed instead.\r\n\r\n**Describe alternatives you've considered**\r\nThere is no easy alternatives. The only one I can think of is an integration testing with full temporal + workflow worker setup.\r\n\r\n","closedAt":"2022-05-16T15:40:37Z","comments":[{"id":"IC_kwDODN1w685DOGpW","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"The workflow unit test represents a single run, not multiple (be it by retry, continue as new, cron, etc). Are you trying to test that the continue as new error is as you expect, or that the Temporal server reacts to continue as new as expected? The former is best as a unit test, the latter as an integration test, but I am afraid using the unit test suite for multi-workflow-run integration testing is a bit out of scope.","createdAt":"2022-05-16T14:47:56Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/805#issuecomment-1127770710","viewerDidAuthor":false},{"id":"IC_kwDODN1w685DOVVQ","author":{"login":"jackielii"},"authorAssociation":"NONE","body":"Good point, I tend to agree with you. Also I found that I should probably mock the child workflow using `env.OnWorkflow`.\r\n\r\nClosing...","createdAt":"2022-05-16T15:40:37Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-go/issues/805#issuecomment-1127830864","viewerDidAuthor":false},{"id":"IC_kwDODN1w685DOV5q","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"By the way, for integration testing, have a look at this package: https://pkg.go.dev/github.com/DataDog/temporalite/temporaltest","createdAt":"2022-05-16T15:42:09Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/805#issuecomment-1127833194","viewerDidAuthor":false},{"id":"IC_kwDODN1w685DOWww","author":{"login":"jackielii"},"authorAssociation":"NONE","body":"> By the way, for integration testing, have a look at this package: https://pkg.go.dev/github.com/DataDog/temporalite/temporaltest\r\n\r\nNice! I'm using temporalite for local dev, didn't realise it has a testserver impl as well. Will be using this one.\r\n\r\nFWIW, my workflow is a recursive one, so `OnWorkflow` probably won't work in this case, but the integration test feels the right way to go.\r\n\r\nThanks again.","createdAt":"2022-05-16T15:45:30Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/805#issuecomment-1127836720","viewerDidAuthor":false}],"createdAt":"2022-05-13T16:03:53Z","labels":[{"id":"MDU6TGFiZWwxNjIyNzA3NDky","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":805,"reactionGroups":[],"state":"CLOSED","title":"testsuite support restarting workflow if returned `NewContinueAsNewError`","updatedAt":"2022-05-16T15:45:30Z","url":"https://github.com/temporalio/sdk-go/issues/805"}
