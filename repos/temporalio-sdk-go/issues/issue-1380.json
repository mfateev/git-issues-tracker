{"assignees":[],"author":{"id":"MDQ6VXNlcjYyOTg2Njg=","is_bot":false,"login":"sosnovski","name":"Anatoliy Sosnovsky"},"body":"## Expected Behavior\r\nI expect the workflow to fail after 1 minute\r\n<img width=\"758\" alt=\"Снимок экрана 2024-02-07 в 22 38 37\" src=\"https://github.com/temporalio/sdk-go/assets/6298668/e26242fe-c8ea-4b80-9dfc-31e291c143a5\">\r\n\r\n## Actual Behavior\r\nWorkflow completes exactly twice as fast, in about 30 seconds.\r\n<img width=\"1866\" alt=\"Снимок экрана 2024-02-07 в 22 39 37\" src=\"https://github.com/temporalio/sdk-go/assets/6298668/2312cb65-f409-4e31-a3f8-9674c4c82056\">\r\n\r\n\r\nI noticed that the timeout is triggered twice as early as set in the ScheduleToCloseTimeout timeout. \r\nI tried to specify 10 minutes and the timeout worked after 5.\r\n\r\n## Steps to Reproduce the Problem\r\n\r\nRun this workflow without any timeouts:\r\n```golang\r\nfunc SampleWorkflow(ctx workflow.Context) error {\r\n\tao := workflow.ActivityOptions{\r\n\t\tScheduleToCloseTimeout: time.Minute,\r\n\t}\r\n\tctx = workflow.WithActivityOptions(ctx, ao)\r\n\r\n\terr := workflow.ExecuteActivity(ctx, SampleActivity).Get(ctx, nil)\r\n\tif err != nil {\r\n\t\treturn err\r\n\t}\r\n\r\n\treturn nil\r\n}\r\n\r\nfunc SampleActivity() error {\r\n\treturn errors.New(\"some error\")\r\n}\r\n```\r\n\r\n## Specifications\r\n\r\n  - Version: v1.25.1\r\n  - Platform: Mac OS 14.2 ARM \r\n","closedAt":"2024-02-08T09:10:03Z","comments":[{"id":"IC_kwDODN1w685zNK8A","author":{"login":"Quinn-With-Two-Ns"},"authorAssociation":"MEMBER","body":"Could you share the history of this workflow?","createdAt":"2024-02-07T20:40:44Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/1380#issuecomment-1932832512","viewerDidAuthor":false},{"id":"IC_kwDODN1w685zOJP0","author":{"login":"sosnovski"},"authorAssociation":"NONE","body":"@Quinn-With-Two-Ns In what form should you provide the data?","createdAt":"2024-02-07T23:13:06Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/1380#issuecomment-1933087732","viewerDidAuthor":false},{"id":"IC_kwDODN1w685zOp4m","author":{"login":"Quinn-With-Two-Ns"},"authorAssociation":"MEMBER","body":"@sosnovski On further research this is expected, Since your activity always fails the backoff time will grow exponentially from 1s doubling every retry until the next attempt time is after the activity timeout. If the next schedule time is after the `schedule_to_close` time, we skip the attempt and fail the activity. ","createdAt":"2024-02-08T01:27:05Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-go/issues/1380#issuecomment-1933221414","viewerDidAuthor":false},{"id":"IC_kwDODN1w685zQQS6","author":{"login":"sosnovski"},"authorAssociation":"NONE","body":"@Quinn-With-Two-Ns Now everything is clear, thank you!","createdAt":"2024-02-08T09:09:54Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/1380#issuecomment-1933640890","viewerDidAuthor":false}],"createdAt":"2024-02-07T19:37:41Z","labels":[{"id":"MDU6TGFiZWwxNjIyNzA3NTAy","name":"question","description":"Further information is requested","color":"d876e3"},{"id":"MDU6TGFiZWwyMDUzODEzNTY0","name":"potential-bug","description":"","color":"90c109"}],"milestone":null,"number":1380,"reactionGroups":[],"state":"CLOSED","title":"The timeout is triggered twice earlier than ScheduleToCloseTimeout is set","updatedAt":"2024-02-08T09:10:03Z","url":"https://github.com/temporalio/sdk-go/issues/1380"}
