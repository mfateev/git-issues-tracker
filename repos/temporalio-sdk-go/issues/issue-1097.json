{"assignees":[],"author":{"id":"MDQ6VXNlcjIwNjM5Ng==","is_bot":false,"login":"cretz","name":"Chad Retz"},"body":"## Expected Behavior\r\n\r\nDev server should stop on Windows, but we foolishly used signals. We should make  a `util_nonwindows.go` file with:\r\n\r\n```go\r\n//go:build !windows\r\n\r\npackage main\r\n\r\nimport (\r\n\t\"os\"\r\n\t\"syscall\"\r\n)\r\n\r\nfunc sendInterrupt(process *os.Process) error {\r\n\treturn process.Signal(syscall.SIGINT)\r\n}\r\n```\r\n\r\nAnd a `util_windows.go` file with:\r\n\r\n```go\r\npackage main\r\n\r\nimport (\r\n\t\"os\"\r\n\t\"syscall\"\r\n\r\n\t\"golang.org/x/sys/windows\"\r\n)\r\n\r\nfunc sendInterrupt(process *os.Process) error {\r\n\tdll, err := windows.LoadDLL(\"kernel32.dll\")\r\n\tif err != nil {\r\n\t\treturn err\r\n\t}\r\n\tdefer dll.Release()\r\n\tf, err := dll.FindProc(\"AttachConsole\")\r\n\tif err != nil {\r\n\t\treturn err\r\n\t}\r\n\tr1, _, err := f.Call(uintptr(process.Pid))\r\n\tif r1 == 0 && err != syscall.ERROR_ACCESS_DENIED {\r\n\t\treturn err\r\n\t}\r\n\r\n\tf, err = dll.FindProc(\"SetConsoleCtrlHandler\")\r\n\tif err != nil {\r\n\t\treturn err\r\n\t}\r\n\tr1, _, err = f.Call(0, 1)\r\n\tif r1 == 0 {\r\n\t\treturn err\r\n\t}\r\n\tf, err = dll.FindProc(\"GenerateConsoleCtrlEvent\")\r\n\tif err != nil {\r\n\t\treturn err\r\n\t}\r\n\tr1, _, err = f.Call(windows.CTRL_BREAK_EVENT, uintptr(process.Pid))\r\n\tif r1 == 0 {\r\n\t\treturn err\r\n\t}\r\n\treturn nil\r\n}\r\n```\r\n\r\nAnd then just call `sendInterrupt` to close the server.","closedAt":"2025-02-04T18:16:02Z","comments":[{"id":"IC_kwDODN1w686dCrnB","author":{"login":"Quinn-With-Two-Ns"},"authorAssociation":"MEMBER","body":"https://github.com/temporalio/sdk-go/pull/1129","createdAt":"2025-02-04T18:16:02Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/1097#issuecomment-2634725825","viewerDidAuthor":false}],"createdAt":"2023-05-02T12:50:59Z","labels":[{"id":"MDU6TGFiZWwyMDUzODEzNTY0","name":"potential-bug","description":"","color":"90c109"}],"milestone":null,"number":1097,"reactionGroups":[],"state":"CLOSED","title":"Stopping dev server not supported on Windows","updatedAt":"2025-02-04T18:16:04Z","url":"https://github.com/temporalio/sdk-go/issues/1097"}
