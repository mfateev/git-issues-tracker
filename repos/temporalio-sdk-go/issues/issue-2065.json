{"assignees":[],"author":{"id":"MDQ6VXNlcjMyMjIxMw==","is_bot":false,"login":"kylelemons","name":"Kyle Lemons"},"body":"## Example code:\n\n```go\n\tsuite := testsuite.WorkflowTestSuite{}\n\n\tact := suite.NewTestActivityEnvironment()\n\n\t// This used to work:\n\tvar reg worker.ActivityRegistry = act\n\t// Now it gets:\n\t//\t Cannot use act (type *TestActivityEnvironment) as the type worker.ActivityRegistry\n\t//\t Type does not implement worker.ActivityRegistry as some methods are missing:\n\t//\t   RegisterDynamicActivity(a interface{}, options activity.DynamicRegisterOptions)\n\n\tvar myActivity any\n\treg.RegisterActivity(myActivity)\n\n\tres, err := act.ExecuteActivity(myActivity, \"input\")\n\tif err != nil {\n\t\tt.Fatalf(\"ExecuteActivity: %s\", err)\n\t}\n\n\tvar output any\n\tif err := res.Get(&output); err != nil {\n\t\tt.Fatalf(\"Getting result %T: %s\", output, err)\n\t}\n```\n\n## Expected Behavior\n\nThis code should compile and execute.  Obviously nobody would write the code above, but we have our own abstractions that make use of the `worker.ActivityRegistry` interface, and the `NewTestActivityEnvironment` no longer implements it.  `NewTestWorkflowEnvironment` does, but that doesn't have the `ExecuteActivity` functionality.\n\n## Actual Behavior\n\nThis works with `go.temporal.io/sdk v1.34.0` but breaks with `v1.35.0` and `v1.36.0`.  This was a breaking change to the `ActivityRegistry` interface (and I suspect to the `WorkerRegistry` interface as well).\n\n## Steps to Reproduce the Problem\n\n  1. Add the code above to a unit test\n  1. `go get go.temporal.io/sdk@v1.34.0` and observe that it compiles\n  1. `go get go.temporal.io/sdk@v1.35.0` (or later) and observe that it fails to compile\n\n## Specifications\n\n  - Version: `go.temporal.io/sdk@v1.36.0`\n  - Platform: Mac OS, Linux\n","closedAt":null,"comments":[{"id":"IC_kwDODN1w687IeWl_","author":{"login":"yuandrew"},"authorAssociation":"MEMBER","body":"Thanks for the GH issue! Like you mentioned, this is similar to #2006. A compile check can be added to keep this relationship. Marking this as an enhancement, since I don't think we originally intended on having `NewTestActivityEnvironment` implement the `ActivityRegistry` interface, but might as well keep it now that it does.","createdAt":"2025-10-02T22:16:10Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/2065#issuecomment-3363400063","viewerDidAuthor":false},{"id":"IC_kwDODN1w687It4k6","author":{"login":"kylelemons"},"authorAssociation":"NONE","body":"Something similar came up in\n* https://github.com/temporalio/sdk-go/issues/1610\n\nI think the root cause of all three issues is [returning interfaces, not concrete types](https://google.github.io/styleguide/go/decisions#interfaces), since it is [considered a breaking change](https://go.dev/blog/module-compatibility#working-with-interfaces) to add a method to a public interface.  If you are ever planning a v2 of this module (or if it's better to make \"just one more\" breaking change to prevent accidentally making many more), I think switching to concrete types would help avoid this class of problems.\n\nMore generally, I think I would recommend classing \"breaking changes\" as bugs, since they (can) manifest downstream as compile errors.\n\nThere is a tool that you can use in CI to detect incompatible changes:\n\n<details>\n<summary>gorelease output</summary>\n\n```\n‚ùØ go run golang.org/x/exp/cmd/gorelease@latest -base=v1.34.0\n# go.temporal.io/sdk/activity\n## compatible changes\nDynamicRegisterOptions: added\nErrActivityReset: added\n\n# go.temporal.io/sdk/client\n## incompatible changes\nClient.DescribeWorkflow: added\n## compatible changes\nAutoUpgradeVersioningOverride: added\nPinnedVersioningOverride: added\nVersioningOverrideChange: added\nWorkflowExecutionDescription: added\nWorkflowExecutionMetadata: added\n\n# go.temporal.io/sdk/interceptor\n## compatible changes\nClientDescribeWorkflowInput: added\nClientDescribeWorkflowOutput: added\n\n# go.temporal.io/sdk/mocks\n## compatible changes\n(*Client).DescribeWorkflow: added\n\n# go.temporal.io/sdk/temporal\n## incompatible changes\nSDKVersion: value changed from \"1.34.0\" to \"1.36.0\"\n## compatible changes\nApplicationErrorCategory: added\nApplicationErrorCategoryBenign: added\nApplicationErrorCategoryUnspecified: added\n\n# go.temporal.io/sdk/temporalnexus\n## incompatible changes\nNewSyncOperation: removed\n## compatible changes\nGetOperationInfo: added\nIsNexusOperation: added\nOperationInfo: added\n\n# go.temporal.io/sdk/testsuite\n## compatible changes\nDevServerOptions.SearchAttributes: added\n\n# go.temporal.io/sdk/worker\n## incompatible changes\nActivityRegistry.RegisterDynamicActivity: added\nWorkflowRegistry.RegisterDynamicWorkflow: added\nWorkflowReplayer.RegisterDynamicWorkflow: added\n## compatible changes\nNewPollerBehaviorAutoscaling: added\nNewPollerBehaviorSimpleMaximum: added\nPollerBehavior: added\nPollerBehaviorAutoscalingOptions: added\nPollerBehaviorSimpleMaximumOptions: added\nWorkerDeploymentVersion: added\n\n# go.temporal.io/sdk/workflow\n## compatible changes\nDynamicRegisterOptions: added\nDynamicRuntimeOptions: added\nLoadDynamicRuntimeOptionsDetails: added\nNexusOperationCancellationType: added\nNexusOperationCancellationTypeAbandon: added\nNexusOperationCancellationTypeTryCancel: added\nNexusOperationCancellationTypeUnspecified: added\nNexusOperationCancellationTypeWaitCompleted: added\nNexusOperationCancellationTypeWaitRequested: added\n\n# summary\nCannot suggest a release version.\nIncompatible changes were detected.\n\nexit status 1\n```\n\n</details>","createdAt":"2025-10-03T22:59:41Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/2065#issuecomment-3367471418","viewerDidAuthor":false}],"createdAt":"2025-10-02T21:31:26Z","labels":[{"id":"MDU6TGFiZWwxNjIyNzA3NDky","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":2065,"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"state":"OPEN","title":"NewTestActivityEnvironment no longer implements worker.ActivityRegistry","updatedAt":"2025-10-03T23:16:41Z","url":"https://github.com/temporalio/sdk-go/issues/2065"}
