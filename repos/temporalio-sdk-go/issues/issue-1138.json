{"assignees":[],"author":{"id":"MDQ6VXNlcjI2NTg0NDc4","is_bot":false,"login":"albertteoh","name":"Albert"},"body":"**Is your feature request related to a problem? Please describe.**\r\nGenerically instrument Activities. That is, avoid the need to manually instrument each activity as illustrated in [this example](https://github.com/temporalio/samples-go/blob/main/metrics/workflow.go#L32), because we have a lot of Activities defined and would be tedious to instrument.\r\n\r\n**Describe the solution you'd like**\r\nHave Activities automatically instrumented, if enabled via configuration/options. Propose to wrap instrumentation before and after [`ExecuteActivity`](https://github.com/temporalio/sdk-go/blob/master/internal/workflow.go#L555), following a similar approach to [the existing Go metrics instrumentation example](https://github.com/temporalio/samples-go/blob/main/metrics/workflow.go#L32)\r\n\r\n**Describe alternatives you've considered**\r\n- Manually instrument each Activity: works but tedious\r\n- [Cluster metrics setup](https://docs.temporal.io/kb/prometheus-grafana-setup#cluster-metrics-setup): does not contain Activity-specific metrics.\r\n\r\n**Additional context**\r\nHappy to put together a PR as an upstream contribution, if the community is happy with this proposal.\r\n","closedAt":"2023-06-14T13:29:13Z","comments":[{"id":"IC_kwDODN1w685e1yHP","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"What metric are you looking for? We already have [`temporal_activity_execution_latency`](https://docs.temporal.io/references/sdk-metrics#activity_execution_latency). That sample in your link is just for demonstrating how to make custom metric with your own name, but a metric for activity execution already exists.","createdAt":"2023-06-14T12:57:31Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/1138#issuecomment-1591157199","viewerDidAuthor":false},{"id":"IC_kwDODN1w685e18Jo","author":{"login":"albertteoh"},"authorAssociation":"NONE","body":"> What metric are you looking for?\r\n\r\nAt the very least, success/failure counts from activity executions grouped by activity name; latency is a bonus.\r\n\r\n> We already have [temporal_activity_execution_latency](https://docs.temporal.io/references/sdk-metrics#activity_execution_latency).\r\n\r\nIs this metric surfaced after enabling cluster level metrics as described [here](https://docs.temporal.io/kb/prometheus-grafana-setup#cluster-metrics-setup)?\r\n\r\nIf so, I gave that a go, and eyeballed some metrics but couldn't find labels that contained the Activity name. But if that particular metric does have it, then it meets our requirements.","createdAt":"2023-06-14T13:20:36Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/1138#issuecomment-1591198312","viewerDidAuthor":false},{"id":"IC_kwDODN1w685e186S","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"> At the very least, success/failure counts from activity executions grouped by activity name; latency is a bonus.\r\n\r\nYou won't get all success/failure counts technically because a server-side could timeout. But yes there is a failure counter (`temporal_activity_execution_failed`) and others.\r\n\r\n> Is this metric surfaced after enabling cluster level metrics as described [here](https://docs.temporal.io/kb/prometheus-grafana-setup#cluster-metrics-setup)?\r\n\r\nThis is a worker-side metric not a server-side one. Enable metrics as shown in the previously-linked sample.\r\n\r\n(also feel free to join us on forums and `#go-sdk` on Slack)","createdAt":"2023-06-14T13:22:18Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/1138#issuecomment-1591201426","viewerDidAuthor":false},{"id":"IC_kwDODN1w685e1_2e","author":{"login":"albertteoh"},"authorAssociation":"NONE","body":"> This is a worker-side metric not a server-side one. Enable metrics as shown in the previously-linked sample.\r\n\r\nOh yes, I should have checked the title of the page. üòÖ \r\n\r\n> (also feel free to join us on forums and #go-sdk on Slack)\r\n\r\nThank you, will do! And also thank you for the amazingly fast and helpful responses. üëçüèº \r\n","createdAt":"2023-06-14T13:29:13Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-go/issues/1138#issuecomment-1591213470","viewerDidAuthor":false}],"createdAt":"2023-06-14T01:38:30Z","labels":[{"id":"MDU6TGFiZWwxNjIyNzA3NDky","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":1138,"reactionGroups":[],"state":"CLOSED","title":"Auto instrument Activities if enabled","updatedAt":"2023-06-14T16:11:01Z","url":"https://github.com/temporalio/sdk-go/issues/1138"}
