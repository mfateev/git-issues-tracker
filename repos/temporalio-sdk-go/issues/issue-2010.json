{"assignees":[],"author":{"id":"U_kgDOBiREwQ","is_bot":false,"login":"OfirEnglard","name":""},"body":"## Expected Behavior\n\nenv.OnActivity(MyActivity,...).Never() should panic when MyActivity is called, and fail our test.\nIt should panic and fail even if we're not checking or using the returned err from workflow.ExecuteActivity.\n\n\n## Actual Behavior\nTests that call activities that were set to never() are passing.\n\n## Steps to Reproduce the Problem\n\n  1. Create a workflow that executes an activity and doesn't fail the workflow when the activity fails\n  2. Create a test which sets the activity to never be run \n  3. env.ExecuteWorkflow(my_workflow)\n  4. require.NoError(t, env.GetWorkflowError())\n\n```code\nfunc TestMyWorkflow(t *testing.T) {\n\tt.Parallel()\n\ts := &testsuite.WorkflowTestSuite{}\n\tenv := s.NewTestWorkflowEnvironment()\n\n\tenv.OnActivity(MyActivity, mock.Anything, mock.Anything).Return(\"output\", nil).Never()\n\n\tenv.ExecuteWorkflow(MyWorkflow, \"input\")\n\trequire.True(t, env.IsWorkflowCompleted())\n\trequire.NoError(t, env.GetWorkflowError())\n\n\tenv.AssertExpectations(t)\n\n}\n\nfunc MyWorkflow(ctx workflow.Context, input string) (string, error) {\n\tvar result string\n\tactivityOptions := workflow.ActivityOptions{\n\t\tStartToCloseTimeout: common.ActivityStartToCloseTimeout,\n\t}\n\tctx = workflow.WithActivityOptions(ctx, activityOptions)\n\terr := workflow.ExecuteActivity(ctx, MyActivity, input).Get(ctx, &result)\n\tif err != nil {\n\t\tslog.Error(\"Failed to execute activity\", slog.String(\"input\", input), slog.Any(\"error\", err))\n\t}\n\treturn result, nil\n}\n\nfunc MyActivity(ctx context.Context, input string) (string, error) {\n\treturn \"output\", nil\n}\n ```\n\nWe believe it's happening due to the recover in internal/internal_task_handlers which handles the execution of both regular and mock activities\n## Specifications\n\n  - Version: 1.35.0\n  - Platform:\n","closedAt":"2025-08-03T17:40:54Z","comments":[{"id":"IC_kwDODN1w6867q8KB","author":{"login":"Quinn-With-Two-Ns"},"authorAssociation":"MEMBER","body":"Yes you should be checking test result of your activity, it is not recommend to ignore the result of an activity. A workaround would be to fail the test if the activity is called since testify[ does not consider these mock failures as failing the test](https://github.com/stretchr/testify/issues/608), but the recommend approach is to always check activity results in workflows.","createdAt":"2025-08-03T17:43:11Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_DOWN","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-go/issues/2010#issuecomment-3148595841","viewerDidAuthor":false}],"createdAt":"2025-08-03T16:26:11Z","labels":[{"id":"MDU6TGFiZWwxNjIyNzA3NDg2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":2010,"reactionGroups":[],"state":"CLOSED","title":"Setting a mock activity to Never isn't always enforced","updatedAt":"2025-08-03T18:01:07Z","url":"https://github.com/temporalio/sdk-go/issues/2010"}
