{"assignees":[],"author":{"id":"MDQ6VXNlcjQ1MjM5NTU=","is_bot":false,"login":"longquanzheng","name":"Quanzheng Long"},"body":"**Is your feature request related to a problem? Please describe.**\r\nThis is one example of the current NDE:\r\n```\r\n2024-10-22T20:38:57.8502536Z 2024/10/22 20:38:57 ERROR Workflow panic Namespace default TaskQueue Interpreter_DEFAULT WorkerID 11283@fv-az1498-207@ WorkflowType Interpreter WorkflowID locking1729629466434353139 RunID 96cc0bce-c727-45ab-8c58-32a9928ec882 Attempt 1 Error [TMPRL1100] lookup failed for scheduledEventID to activityID: scheduleEventID: 60, activityID: 60 StackTrace process event for Interpreter_DEFAULT [panic]:\r\n2024-10-22T20:38:57.8505930Z go.temporal.io/sdk/internal.panicIllegalState(...)\r\n2024-10-22T20:38:57.8507126Z \t/home/runner/go/pkg/mod/go.temporal.io/sdk@v1.29.1/internal/internal_command_state_machine.go:518\r\n2024-10-22T20:38:57.8508780Z go.temporal.io/sdk/internal.(*commandsHelper).handleActivityTaskScheduled(0xc000b779a0, {0xc000a3d88c, 0x2}, 0x3c)\r\n2024-10-22T20:38:57.8510591Z \t/home/runner/go/pkg/mod/go.temporal.io/sdk@v1.29.1/internal/internal_command_state_machine.go:1150 +0xf8\r\n2024-10-22T20:38:57.8512440Z go.temporal.io/sdk/internal.(*workflowExecutionEventHandlerImpl).ProcessEvent(0xc000e13ea8, 0xc0012bdef0, 0x4?, 0x0)\r\n2024-10-22T20:38:57.8514059Z \t/home/runner/go/pkg/mod/go.temporal.io/sdk@v1.29.1/internal/internal_event_handlers.go:1217 +0x275\r\n2024-10-22T20:38:57.8515606Z go.temporal.io/sdk/internal.(*workflowExecutionContextImpl).ProcessWorkflowTask(0xc001184c80, 0xc00150da40)\r\n2024-10-22T20:38:57.8517165Z \t/home/runner/go/pkg/mod/go.temporal.io/sdk@v1.29.1/internal/internal_task_handlers.go:1152 +0x199c\r\n2024-10-22T20:38:57.8518726Z go.temporal.io/sdk/internal.(*workflowTaskHandlerImpl).ProcessWorkflowTask(0xc0011a6750, 0xc00150da40, 0xc001184c80, 0xc00111fc50)\r\n2024-10-22T20:38:57.8520250Z \t/home/runner/go/pkg/mod/go.temporal.io/sdk@v1.29.1/internal/internal_task_handlers.go:917 +0x3bf\r\n2024-10-22T20:38:57.8521674Z go.temporal.io/sdk/internal.(*workflowTaskPoller).processWorkflowTask(0xc000a0e120, 0xc00150da40)\r\n2024-10-22T20:38:57.8522716Z \t/home/runner/go/pkg/mod/go.temporal.io/sdk@v1.29.1/internal/internal_task_pollers.go:363 +0x3a3\r\n2024-10-22T20:38:57.8523572Z go.temporal.io/sdk/internal.(*workflowTaskPoller).ProcessTask(0xc000a0e120, {0x14d1660, 0xc00150da40})\r\n2024-10-22T20:38:57.8524404Z \t/home/runner/go/pkg/mod/go.temporal.io/sdk@v1.29.1/internal/internal_task_pollers.go:325 +0x78\r\n2024-10-22T20:38:57.8525101Z go.temporal.io/sdk/internal.(*baseWorker).processTaskAsync.func1()\r\n2024-10-22T20:38:57.8525809Z \t/home/runner/go/pkg/mod/go.temporal.io/sdk@v1.29.1/internal/internal_worker_base.go:444 +0x12f\r\n2024-10-22T20:38:57.8526802Z created by go.temporal.io/sdk/internal.(*baseWorker).processTaskAsync in goroutine 5428\r\n2024-10-22T20:38:57.8527590Z \t/home/runner/go/pkg/mod/go.temporal.io/sdk@v1.29.1/internal/internal_worker_base.go:423 +0x90\r\n```\r\nIn this example, my workflow removed a \"UpsertSearchAttribute\" API by mistake. \r\nBut this info is really hard to figure out why it runs into NDE. I would expect the error to say it more clearly: `Workflow code tried to scheduled an activity but based on the history events to replay, it should upsert a search attribute instead`. That way, we can clearly know that is something wrong with our code with the upsert search attribute (by looking at the event details of UpsertSearchAttribute in the history). \r\n\r\n\r\n**Describe the solution you'd like**\r\nAs above said.\r\n\r\n**Describe alternatives you've considered**\r\nNA\r\n\r\n**Additional context**\r\nNA\r\n","closedAt":null,"comments":[],"createdAt":"2024-10-28T19:13:38Z","labels":[{"id":"MDU6TGFiZWwxNjIyNzA3NDky","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":1693,"reactionGroups":[],"state":"OPEN","title":"Provide details and actionable info about Non Deterministic Errors","updatedAt":"2024-10-28T19:13:51Z","url":"https://github.com/temporalio/sdk-go/issues/1693"}
