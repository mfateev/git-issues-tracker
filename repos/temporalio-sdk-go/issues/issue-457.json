{"assignees":[{"id":"MDQ6VXNlcjEzMTE2OTQ=","login":"vitarb","name":"Vitali","databaseId":0}],"author":{"id":"MDQ6VXNlcjQ1OTUwNDM0","is_bot":false,"login":"sjmtan","name":"Shannon Tan"},"body":"## Expected Behavior\r\n\r\nWhen activities return an error - even if it is retryable - they should be logged against this metric.\r\n\r\n## Actual Behavior\r\n\r\nActivity errors don't result in any change for this metric. (Or perhaps another metric is appropriate instead).\r\n\r\nI believe this is caused by: https://github.com/temporalio/sdk-go/blob/master/internal/internal_task_handlers.go#L1838. This returns nil for the error, but that means the code here never logs it. \r\n\r\n```\r\n\t// Process the activity task.\r\n\trequest, err := atp.taskHandler.Execute(atp.taskQueueName, activityTask.task)\r\n\tif err != nil {\r\n\t\tactivityMetricsScope.Counter(metrics.ActivityExecutionFailedCounter).Inc(1)\r\n\t\treturn err\r\n\t}\r\n```\r\n\r\n## Steps to Reproduce the Problem\r\n\r\n  1. Have an activity return a retryable error\r\n  2. See that nothing is logged against this metric\r\n\r\n## Specifications\r\n\r\n  - Version: 1.6.0\r\n","closedAt":"2021-06-24T17:17:56Z","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDg2NzI3ODQ5MA==","author":{"login":"vitarb"},"authorAssociation":"CONTRIBUTOR","body":"Above PR should address the problem, meanwhile if you need it urgently, you should be able to use RPC metric (`temporal_request` with `operation=RespondActivityTaskFailed`). It won't have activity/workflow types and will not account for internal errors (but they are captured in `temporal_activity_execution_failed` so you can combine the two).","createdAt":"2021-06-24T02:11:48Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/457#issuecomment-867278490","viewerDidAuthor":false}],"createdAt":"2021-06-08T18:12:41Z","labels":[{"id":"MDU6TGFiZWwyMDUzODEzNTY0","name":"potential-bug","description":"","color":"90c109"}],"milestone":null,"number":457,"reactionGroups":[],"state":"CLOSED","title":"temporal_activity_execution_failure Metric Doesn't Seem to Work","updatedAt":"2021-06-24T17:17:56Z","url":"https://github.com/temporalio/sdk-go/issues/457"}
