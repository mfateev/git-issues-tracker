{"assignees":[],"author":{"id":"MDQ6VXNlcjIyMjAyNw==","is_bot":false,"login":"justenwalker","name":"Justen Walker"},"body":"**Is your feature request related to a problem? Please describe.**\r\n\r\nIt is currently not possible to test a workflow that runs forever.\r\n\r\nSomething like:\r\n```go\r\nfunc MyWorkflow(ctx workflow.Context, params Params) error {\r\n  for {\r\n    if workflow.GetInfo(ctx).GetCurrentHistoryLength() > maxHistoryLength { // This will never evaluate to true in tests\r\n      return workflow.NewContinueAsNewError(ctx, MyWorkflow, params)\r\n    }\r\n    // doSomething\r\n    if err := workflow.Sleep(ctx, time.Hour); err != nil { return err }\r\n  }\r\n}\r\n```\r\n\r\nWill never stop running since the history length is always 0 during tests.\r\n\r\n**Describe the solution you'd like**\r\n\r\nThere should be some way to set the current history length as returned by `workflow.GetInfo(ctx).GetCurrentHistoryLength()` to trigger the `continue-as-new` branch.\r\n\r\n**Describe alternatives you've considered**\r\n\r\nOne could possible expose a global variable that you could set in testing to bypass the history check and make it always run the ContinueAsNew line; but adding additional code to workflow solely for testing seems like a poor practice.\r\n\r\n","closedAt":"2023-10-29T22:26:49Z","comments":[{"id":"IC_kwDODN1w685qWXQK","author":{"login":"justenwalker"},"authorAssociation":"NONE","body":"Seems this exists: nevermind!\r\nhttps://github.com/temporalio/sdk-go/blob/3cccbdd5f47d640fffe6651e4f49c236a4803a47/internal/workflow_testsuite.go#L309","createdAt":"2023-10-29T22:26:49Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/1284#issuecomment-1784247306","viewerDidAuthor":false}],"createdAt":"2023-10-29T22:23:10Z","labels":[{"id":"MDU6TGFiZWwxNjIyNzA3NDky","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":1284,"reactionGroups":[],"state":"CLOSED","title":"[feature]: Allow GetCurrentHistoryLength() to return > 0 during tests","updatedAt":"2023-10-29T22:26:49Z","url":"https://github.com/temporalio/sdk-go/issues/1284"}
