{"assignees":[],"author":{"id":"MDQ6VXNlcjI1NjY5NTM4","is_bot":false,"login":"shojaeix","name":"Amin Shojaei"},"body":"I'm initiating a Temporal test server in the tests. \r\nBefore each test, I create a server, and after each test, I close that server. \r\nSo the server is in its and closes a few times. \r\n\r\n## Expected Behavior\r\nSuccess or a standard error!\r\n\r\n## Actual Behavior\r\nFailing due to concurrent read/write from the map\r\n\r\n## Log trace \r\n```\r\n\r\ngoroutine 723 [running]:\r\ngithub.com/temporalio/tchannel-go/json.Register.func1({0x339d218, 0xc0007ee030}, 0xc00037e600)\r\n\t/home/runner/go/pkg/mod/github.com/temporalio/tchannel-go@v1.22.1-0.20220818200552-1be8d8cffa5b/json/handler.go:100 +0x4e\r\ngithub.com/temporalio/tchannel-go.HandlerFunc.Handle(0xc00026d0e0?, {0x339d218?, 0xc0007ee030?}, 0x2143900?)\r\n\t/home/runner/go/pkg/mod/github.com/temporalio/tchannel-go@v1.22.1-0.20220818200552-1be8d8cffa5b/handlers.go:49 +0x2f\r\ngithub.com/temporalio/tchannel-go.(*handlerMap).Handle(0x444f31?, {0x339d218, 0xc0007ee030}, 0xc00037e600)\r\n\t/home/runner/go/pkg/mod/github.com/temporalio/tchannel-go@v1.22.1-0.20220818200552-1be8d8cffa5b/handlers.go:123 +0x21c\r\ngithub.com/temporalio/tchannel-go.channelHandler.Handle({0x22b0a80?}, {0x339d218, 0xc0007ee030}, 0xc00037e600)\r\n\t/home/runner/go/pkg/mod/github.com/temporalio/tchannel-go@v1.22.1-0.20220818200552-1be8d8cffa5b/handlers.go:131 +0x5a\r\ngithub.com/temporalio/tchannel-go.(*Connection).dispatchInbound(0xc00074a580, 0x0?, 0x0?, 0xc00037e600, 0xc000402940?)\r\n\t/home/runner/go/pkg/mod/github.com/temporalio/tchannel-go@v1.22.1-0.20220818200552-1be8d8cffa5b/inbound.go:203 +0x454\r\ncreated by github.com/temporalio/tchannel-go.(*Connection).handleCallReq\r\n\t/home/runner/go/pkg/mod/github.com/temporalio/tchannel-go@v1.22.1-0.20220818200552-1be8d8cffa5b/inbound.go:125 +0xe2a\r\n```\r\n## Steps to Reproduce the Problem\r\n\r\n  1.\r\n  1.\r\n  1.\r\n\r\n## Specifications\r\n\r\n  - Version: `v1.22.1` (check the log trace)\r\n  - Platform: \r\n","closedAt":"2023-07-29T17:03:39Z","comments":[{"id":"IC_kwDODN1w685fSjrA","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"This looks like the same `tchannel-go` concurrent map write issue as https://github.com/temporalio/temporal/issues/4000. This is a server-side issue I am afraid.","createdAt":"2023-06-20T12:43:13Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-go/issues/1145#issuecomment-1598700224","viewerDidAuthor":false},{"id":"IC_kwDODN1w685iwJ2S","author":{"login":"Quinn-With-Two-Ns"},"authorAssociation":"MEMBER","body":"Closing as duplicate  of https://github.com/temporalio/temporal/issues/4000","createdAt":"2023-07-29T17:03:39Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/1145#issuecomment-1656790418","viewerDidAuthor":false}],"createdAt":"2023-06-20T08:59:17Z","labels":[{"id":"MDU6TGFiZWwyMDUzODEzNTY0","name":"potential-bug","description":"","color":"90c109"}],"milestone":null,"number":1145,"reactionGroups":[],"state":"CLOSED","title":"Err on setup: concurrent map read and map write","updatedAt":"2023-07-29T17:03:40Z","url":"https://github.com/temporalio/sdk-go/issues/1145"}
