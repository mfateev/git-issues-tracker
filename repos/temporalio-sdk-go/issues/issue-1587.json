{"assignees":[],"author":{"id":"MDQ6VXNlcjUxNDkzMg==","is_bot":false,"login":"antmendoza","name":"Antonio Mendoza PÃ©rez"},"body":"Using [this code](https://github.com/temporalio/samples-go/tree/main/encryption) as example, I have set the Failure converter with EncodeCommonAttributes to encrypt failures \r\n\r\n```\r\nc, err := client.Dial(client.Options{\r\n...\r\n...\r\nFailureConverter: temporal.NewDefaultFailureConverter(temporal.DefaultFailureConverterOptions{\r\n\tEncodeCommonAttributes: true,\r\n\tDataConverter:          dataConverter,\r\n}),\r\n```\r\n\r\nworkflow and activity payload are encrypted with the [key set to the context propagator](https://github.com/temporalio/samples-go/blob/main/encryption/starter/main.go#L55-L57) but not failures. \r\n\r\n\r\n## Expected Behavior\r\n\r\nFailure attributes should be encrypted\r\n\r\n\r\n## Actual Behavior\r\n\r\nFailure attributes are not encrypted (or are encrypted with a different key) \r\n\r\n\r\n## Steps to Reproduce the Problem\r\n\r\nThere is a repro [here](https://github.com/antmendoza/my-temporal-pocs/tree/main/go/_6715/src) and \r\nthe workflow history that it produces where [encryption-key-id is empty](https://github.com/antmendoza/my-temporal-pocs/blob/main/go/_6715/src/6a8e27d0-2d12-4c24-b960-de993137c587_events.json#L175-L177) \r\n\r\n\r\n\r\n\r\n\r\n","closedAt":"2024-08-27T14:43:05Z","comments":[{"id":"IC_kwDODN1w686J2gIs","author":{"login":"Quinn-With-Two-Ns"},"authorAssociation":"MEMBER","body":"As discussed offline this is not excepted to work because failure converters cannot be context aware. I opened up an issue to add support to failure converters https://github.com/temporalio/sdk-go/issues/1609","createdAt":"2024-08-27T14:43:05Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-go/issues/1587#issuecomment-2312765996","viewerDidAuthor":false}],"createdAt":"2024-08-13T13:01:49Z","labels":[{"id":"MDU6TGFiZWwyMDUzODEzNTY0","name":"potential-bug","description":"","color":"90c109"}],"milestone":null,"number":1587,"reactionGroups":[],"state":"CLOSED","title":"Activity failure is not encrypted with the key set to the context propagator, used to encrypt workflow and activity payload","updatedAt":"2024-08-27T14:43:12Z","url":"https://github.com/temporalio/sdk-go/issues/1587"}
