{"assignees":[],"author":{"id":"MDQ6VXNlcjE1NzkzODQ=","is_bot":false,"login":"mbark","name":"Martin Wohlfart"},"body":"## Expected Behavior\n\nIf a child workflow is started and terminates during the test no go routine should be left once the test completes.\n\n## Actual Behavior\n\nA go routine is left running from `executeChildWorkflowWithDelay` which doesn't seem to terminate.\n\n## Steps to Reproduce the Problem\n\n  1. Create a test that runs a Workflow that starts a ChildWorkflow.\n  2. Use `defer goleak.VerifyNone(s.T())`\n\nI've added a [repo](https://github.com/mbark/temporal-childwf-reproduction) to illustrate how to reproduce the issue, see the file `do_test.go`:\n\n```go\ntype TestSuite struct {\n\tsuite.Suite\n\ttestsuite.WorkflowTestSuite\n}\n\nfunc Test(t *testing.T) {\n\tsuite.Run(t, new(TestSuite))\n}\n\nfunc ChildWorkflow(ctx workflow.Context) error {\n\treturn workflow.Sleep(ctx, 24*time.Hour)\n}\n\nfunc ParentWorkflow(ctx workflow.Context) error {\n\treturn workflow.ExecuteChildWorkflow(ctx, \"ChildWorkflow\", nil).Get(ctx, nil)\n}\n\nfunc (s *TestSuite) TestChildWorkflow() {\n\tdefer goleak.VerifyNone(s.T())\n\tenv := s.NewTestWorkflowEnvironment()\n\tenv.RegisterWorkflow(ChildWorkflow)\n\tenv.RegisterWorkflow(ParentWorkflow)\n\n\tenv.ExecuteWorkflow(ParentWorkflow)\n\terr := env.GetWorkflowError()\n\ts.Require().NoError(err)\n\n\tenv.AssertExpectations(s.T())\n}\n```\n\n## Specifications\n\n  - Version: `v1.37.0`\n  - Platform: -\n","closedAt":null,"comments":[],"createdAt":"2025-10-24T07:17:10Z","labels":[{"id":"MDU6TGFiZWwxNjIyNzA3NDg2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":2090,"reactionGroups":[],"state":"OPEN","title":"Starting a child workflow in tests leaks goroutines","updatedAt":"2025-10-24T07:18:17Z","url":"https://github.com/temporalio/sdk-go/issues/2090"}
