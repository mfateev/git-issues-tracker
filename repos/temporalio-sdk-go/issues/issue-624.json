{"assignees":[{"id":"MDQ6VXNlcjIwNjM5Ng==","login":"cretz","name":"Chad Retz","databaseId":0}],"author":{"id":"MDQ6VXNlcjg0NDExMDE0","is_bot":false,"login":"yiminc","name":"Yimin Chen"},"body":"Panic from workflow code, including any code running in corotine created by any workflow.Go() should be handled by sdk.\r\nUser reported this panic stack trace suggest that we might have panic coming from [here](https://github.com/temporalio/sdk-go/blob/384e906eaace5e8914a6c0890419c23eba3b033c/internal/internal_workflow.go#L863)\r\npanic: manual inject panic from go routine [recovered]\r\n\tpanic: runtime error: slice bounds out of range [9:8]\r\n\r\ngoroutine 52489 [running]:\r\ngo.temporal.io/sdk/internal.getStackTraceRaw({0xc000e7c180, 0x14}, 0x9, 0x4)\r\n\texternal/io_temporal_go_sdk/internal/internal_workflow.go:863 +0x1bd\r\ngo.temporal.io/sdk/internal.getStackTrace({0x52ba998, 0x7f069a39aa68}, {0x30317d5, 0x5}, 0x4)\r\n\texternal/io_temporal_go_sdk/internal/internal_workflow.go:853 +0xab\r\ngo.temporal.io/sdk/internal.(*dispatcherImpl).NewCoroutine.func1.1()\r\n\texternal/io_temporal_go_sdk/internal/internal_workflow.go:936 +0x73\r\npanic({0x2995340, 0x346e360})\r\n\tGOROOT/src/runtime/panic.go:1038 +0x215\r\nxxxxxxx/xxxx/xxxxxxxx.(*Workflow).startBlocks.func1({0xc001857950, 0x1})\r\n\txxxxx/xxxxxxxx/workflow.go:432 +0x27\r\ngo.temporal.io/sdk/internal.(*dispatcherImpl).NewCoroutine.func1(0xc0008ee120)\r\n\texternal/io_temporal_go_sdk/internal/internal_workflow.go:941 +0xde\r\ncreated by go.temporal.io/sdk/internal.(*dispatcherImpl).NewCoroutine\r\n\texternal/io_temporal_go_sdk/internal/internal_workflow.go:932 +0x365\r\npanic: manual inject panic from go routine [recovered]\r\n\tpanic: runtime error: slice bounds out of range [9:8]\r\n\r\ngoroutine 52382 [running]:\r\ngo.temporal.io/sdk/internal.getStackTraceRaw({0xc001e65698, 0x14}, 0x9, 0x4)\r\n\texternal/io_temporal_go_sdk/internal/internal_workflow.go:863 +0x1bd\r\ngo.temporal.io/sdk/internal.getStackTrace({0x52ba998, 0x34ed810}, {0x30317d5, 0x5}, 0x4)\r\n\texternal/io_temporal_go_sdk/internal/internal_workflow.go:853 +0xab\r\ngo.temporal.io/sdk/internal.(*dispatcherImpl).NewCoroutine.func1.1()\r\n\texternal/io_temporal_go_sdk/internal/internal_workflow.go:936 +0x73\r\npanic({0x2995340, 0x346e360})\r\n\tGOROOT/src/runtime/panic.go:1038 +0x215\r\nxxxxxxx/xxxxxxx/xxxxxxxxxx.(*Workflow).startBlocks.func1({0xc001c8fe50, 0x1})\r\n\txxxxxxx/xxxxxxxxxx/workflow.go:432 +0x27\r\ngo.temporal.io/sdk/internal.(*dispatcherImpl).NewCoroutine.func1(0xc0024b1030)\r\n\texternal/io_temporal_go_sdk/internal/internal_workflow.go:941 +0xde\r\ncreated by go.temporal.io/sdk/internal.(*dispatcherImpl).NewCoroutine\r\n\texternal/io_temporal_go_sdk/internal/internal_workflow.go:932 +0x365","closedAt":"2021-11-10T20:17:55Z","comments":[{"id":"IC_kwDODN1w6845i2Ve","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"I am struggling to replicate this. I cannot panic from `workflow.Go` in a way that gets the stack small enough to replicate this. I can of course fix bounds size issue, but I would like a way to test. Can simple code to replicate be provided?","createdAt":"2021-11-10T15:43:56Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/624#issuecomment-965436766","viewerDidAuthor":false},{"id":"IC_kwDODN1w6845jo7p","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"Despite being unable to replicate, I am adding bounds checks to the stack trace line filter.","createdAt":"2021-11-10T18:56:00Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-go/issues/624#issuecomment-965644009","viewerDidAuthor":false}],"createdAt":"2021-11-10T01:56:40Z","labels":[{"id":"MDU6TGFiZWwxNjIyNzA3NDg2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":624,"reactionGroups":[],"state":"CLOSED","title":"unhandled panic from workflow code","updatedAt":"2021-11-10T20:17:55Z","url":"https://github.com/temporalio/sdk-go/issues/624"}
