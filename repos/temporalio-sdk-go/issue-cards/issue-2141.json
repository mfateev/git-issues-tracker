{
  "summary": "Anonymous functions used in activity registration cause alias collisions in the test environment, where multiple packages register activities with the same short function name (e.g., 'func1'), resulting in local activities being incorrectly routed to unrelated registered activity mocks and causing panics.",
  "category": "bug",
  "subcategory": "test-framework",
  "apis": [
    "ExecuteLocalActivity",
    "RegisterActivityWithOptions"
  ],
  "components": [
    "test-workflow-environment",
    "activity-registry",
    "activity-alias-map",
    "mock-wrapper"
  ],
  "concepts": [
    "activity-aliasing",
    "function-naming",
    "anonymous-functions",
    "collision-detection",
    "test-mocking",
    "function-resolution"
  ],
  "severity": "high",
  "userImpact": "Tests using anonymous functions for activities fail with panics or incorrect mock invocations when multiple activities with the same short function name are registered.",
  "rootCause": "The activity alias registry uses short function names (e.g., 'func1') as keys instead of full function names, causing collisions when multiple packages define anonymous functions with identical short names.",
  "proposedFix": "Option 1: Use full function names as alias keys instead of short names. Option 2: Skip alias lookup for anonymous functions in test environment by detecting them via runtime inspection.",
  "workaround": "Use named functions instead of anonymous functions when registering activities in tests, as named functions have unique full names that won't collide.",
  "resolution": null,
  "resolutionDetails": null,
  "related": [
    1341
  ],
  "keyQuote": "We strongly discourage usage of anonymous functions for local activities... their name is generated by the Go runtime and is not deterministic.",
  "number": 2141,
  "repo": "temporalio-sdk-go",
  "generatedAt": "2026-01-11T03:29:07.792Z"
}