{"assignees":[{"id":"MDQ6VXNlcjQwOTIyNg==","login":"tdeebswihart","name":"Tim Deeb-Swihart","databaseId":0}],"author":{"id":"MDQ6VXNlcjIwNjM5Ng==","is_bot":false,"login":"cretz","name":"Chad Retz"},"body":"### Describe the bug\r\n\r\nIf the payload is something like `{\"greeting\":{}}`, it marshals to `{\"greeting\":}`. If you take [api-go as of this time](https://github.com/temporalio/api-go/tree/406a5810b501f1b75ee1ebe46c119174cc35e69f) and apply the following test patch you can see the error:\r\n\r\n```diff\r\n--- a/internal/temporalcommonv1/payload_json_test.go\r\n+++ b/internal/temporalcommonv1/payload_json_test.go\r\n@@ -82,6 +82,16 @@ var tests = []struct {\r\n \t\t\t},\r\n \t\t},\r\n \t},\r\n+}, {\r\n+\tname:          \"json/plain with empty object\",\r\n+\tlongformJSON:  `{\"metadata\":{\"encoding\":\"anNvbi9wcm90b2J1Zg==\"},\"data\":\"eyJncmVldGluZyI6IHt9fQ==\"}`,\r\n+\tshorthandJSON: `{\"greeting\": {}}`,\r\n+\tpb: &common.Payload{\r\n+\t\tMetadata: map[string][]byte{\r\n+\t\t\t\"encoding\": []byte(\"json/plain\"),\r\n+\t\t},\r\n+\t\tData: []byte(`{\"greeting\":{}}`),\r\n+\t},\r\n }}\r\n \r\n func TestMaybeMarshal_ShorthandEnabled(t *testing.T) {\r\n```\r\n\r\n(sorry for opening in `api` repo, the `api-go` repo has issues disabled for good reason)","closedAt":"2024-01-23T19:43:01Z","comments":[],"createdAt":"2024-01-23T15:05:58Z","labels":[{"id":"MDU6TGFiZWwxNjQzNjQ3OTQy","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":349,"reactionGroups":[],"state":"CLOSED","title":"[Bug] api-go failing to properly handle nested empty objects for shorthand payloads","updatedAt":"2024-01-23T19:43:01Z","url":"https://github.com/temporalio/api/issues/349"}
