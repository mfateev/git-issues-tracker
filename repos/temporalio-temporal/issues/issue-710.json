{"assignees":[],"author":{"id":"MDQ6VXNlcjE3NjY1MTU=","is_bot":false,"login":"samarabbas","name":"Samar Abbas"},"body":"I had to delete unit test `TestDecodeMsgAndSubmit_History_Success` as part of removal of 2dc specific code path:\r\n\r\n```\r\nfunc (s *replicationTaskProcessorSuite) TestDecodeMsgAndSubmit_History_Success() {\r\n\treplicationAttr := &replicationspb.HistoryTaskAttributes{\r\n\t\tTargetClusters:  []string{cluster.TestCurrentClusterName, cluster.TestAlternativeClusterName},\r\n\t\tNamespaceId:     \"some random namespace ID\",\r\n\t\tWorkflowId:      \"some random workflow ID\",\r\n\t\tRunId:           \"some random run ID\",\r\n\t\tVersion:         1394,\r\n\t\tFirstEventId:    728,\r\n\t\tNextEventId:     1015,\r\n\t\tReplicationInfo: map[string]*replicationspb.ReplicationInfo{},\r\n\t\tHistory: &historypb.History{\r\n\t\t\tEvents: []*historypb.HistoryEvent{{EventId: 1}},\r\n\t\t},\r\n\t\tNewRunHistory: nil,\r\n\t\tResetWorkflow: true,\r\n\t}\r\n\treplicationTask := &replicationspb.ReplicationTask{\r\n\t\tTaskType:   enumsspb.REPLICATION_TASK_TYPE_HISTORY_TASK,\r\n\t\tAttributes: &replicationspb.ReplicationTask_HistoryTaskAttributes{HistoryTaskAttributes: replicationAttr},\r\n\t}\r\n\treplicationTaskBinary, err := replicationTask.Marshal()\r\n\ts.Nil(err)\r\n\ts.mockMsg.On(\"Value\").Return(replicationTaskBinary)\r\n\ts.mockSequentialTaskProcessor.EXPECT().Submit(gomock.Any()).Return(nil).Times(1)\r\n\r\n\ts.processor.decodeMsgAndSubmit(s.mockMsg)\r\n}\r\n```\r\n\r\nRemoved in PR #692 ","closedAt":"2021-01-28T00:39:29Z","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDY4NTk4NTkyMg==","author":{"login":"samarabbas"},"authorAssociation":"MEMBER","body":"Another one of the unit test removed:\r\n\r\n```\r\nfunc (s *replicationTaskProcessorSuite) TestDecodeMsgAndSubmit_History_FailedThenSuccess() {\r\n\treplicationAttr := &replicationspb.HistoryTaskAttributes{\r\n\t\tTargetClusters:  []string{cluster.TestCurrentClusterName, cluster.TestAlternativeClusterName},\r\n\t\tNamespaceId:     \"some random namespace ID\",\r\n\t\tWorkflowId:      \"some random workflow ID\",\r\n\t\tRunId:           \"some random run ID\",\r\n\t\tVersion:         1394,\r\n\t\tFirstEventId:    728,\r\n\t\tNextEventId:     1015,\r\n\t\tReplicationInfo: map[string]*replicationspb.ReplicationInfo{},\r\n\t\tHistory: &historypb.History{\r\n\t\t\tEvents: []*historypb.HistoryEvent{{EventId: 1}},\r\n\t\t},\r\n\t\tNewRunHistory: nil,\r\n\t\tResetWorkflow: true,\r\n\t}\r\n\treplicationTask := &replicationspb.ReplicationTask{\r\n\t\tTaskType:   enumsspb.REPLICATION_TASK_TYPE_HISTORY_TASK,\r\n\t\tAttributes: &replicationspb.ReplicationTask_HistoryTaskAttributes{HistoryTaskAttributes: replicationAttr},\r\n\t}\r\n\treplicationTaskBinary, err := replicationTask.Marshal()\r\n\ts.Nil(err)\r\n\ts.mockMsg.On(\"Value\").Return(replicationTaskBinary)\r\n\ts.mockSequentialTaskProcessor.EXPECT().Submit(gomock.Any()).Return(errors.New(\"some random error\")).Times(1)\r\n\ts.mockSequentialTaskProcessor.EXPECT().Submit(gomock.Any()).Return(nil).Times(1)\r\n\r\n\ts.processor.decodeMsgAndSubmit(s.mockMsg)\r\n}\r\n```\r\n","createdAt":"2020-09-02T20:40:30Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/710#issuecomment-685985922","viewerDidAuthor":false}],"createdAt":"2020-09-02T20:38:27Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"},{"id":"MDU6TGFiZWwyMDE5ODQ3NDEz","name":"testing","description":"","color":"949fdd"}],"milestone":null,"number":710,"reactionGroups":[],"state":"CLOSED","title":"Add unit testing for decoding REPLICATION_TASK_TYPE_HISTORY_V2_TASK","updatedAt":"2021-01-28T00:39:29Z","url":"https://github.com/temporalio/temporal/issues/710"}
