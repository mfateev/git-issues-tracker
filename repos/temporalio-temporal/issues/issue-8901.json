{"assignees":[],"author":{"id":"MDQ6VXNlcjc5MzkwODcx","is_bot":false,"login":"Tomlord1122","name":"Hsiu-Chi Liu (Tomlord)"},"body":"**Is your feature request related to a problem? Please describe.**\n\nYes. When a Workflow fails after some Activities have completed successfully, and we want to retry the entire Workflow via Workflow-level Retry policy, Temporal re-executes all Activities from the beginning, including those that already succeeded.\n\n  This is problematic for systems with non-reversible side effects:\n\n1. Our Use Case: We have a workflow where: \n\n   - `CreateCaseActivity` successfully creates a case record in an external database \n\n   - `xxxActivity` fails 3 times (Activity-level retry exhausted)\n\n   - Workflow fails and triggers Workflow-level Retry\n\n   - Problem: Workflow Retry attempts to create the same case again â†’ duplicate/conflict errors\n\n2. Why We Can't Simply Delete and Retry:\n\n   - The external case record is not reversible (once created, it shouldn't be deleted)\n\n   - Other teams' systems query and depend on these records\n\n   - Deleting records to enable retry is unreliable and error-prone\n\n3. Current Workaround (unsatisfactory):\n\n   - Manually detect failed Workflows\n\n   - Delete case records from external storage \n\n   - Wait for Workflow Retry - This is dangerous, especially when other teams are actively using the same data\n\n**Describe the solution you'd like**\n\n\nSupport an option in Workflow execution to replay Event History during Workflow Retry, similar to how Temporal handles Worker failover recovery:\n\n```go\n  options := client.StartWorkflowOptions{\n      ID:        \"aifp-case-001\",\n      TaskQueue: \"aifp_queue\",\n      RetryPolicy: &temporal.RetryPolicy{\n          MaximumAttempts: 10,\n          InitialInterval: 10 * time.Second,\n          // New feature: Skip completed activities on retry\n          ReplayOnRetry: true,  // ðŸ‘ˆ Proposed flag\n      },\n  }\n```\n\n  Behavior when ReplayOnRetry: true:\n\n- Workflow Retry uses the existing Event History\n\n- Already-completed Activities are skipped (using their historical results)\n\n- Execution resumes from the point of last failure\n\n- This prevents duplicate side effects in external systems\n\n\n\n**Describe alternatives you've considered**\n\n1. Manual Reset via SDK (`client.ResetWorkflowExecution()`)\n\n   - Requires external monitoring and manual API calls\n\n   - Adds operational complexity\n\n   - Not suitable for automatic recovery scenarios\n\n2. Delete and Retry Pattern\n\n   - Currently, we must delete case records from external storage before retry \n\n   - Risk: Other teams' queries may fail during deletion window\n\n   - Unreliable and dangerous in production\n\n3. `ContinueAsNew` with State Persistence\n\n   - Could save completion checkpoints and call `ContinueAsNew` on failure\n\n   - Adds significant complexity to Workflow code\n\n   - Doubles the size of Event History\n\n4. Manual Idempotency + Retry\n\n   - Make every Activity check if it's already been done before re-executin\n\n   - Requires external state tracking (defeats the purpose of Temporal)\n\n   - Adds unnecessary retry latency\n\n5. Saga Pattern with Compensation \n\n   - We already use Saga for cleanup on failure. However, Saga compensation (deleting records) is not always safe or desired. For our use case, we'd rather skip re-execution than compensate\n\n***Additional Context***\n\nIâ€™m new to Temporal and may be misinterpreting some aspects. Thank you for your patience. If thereâ€™s a recommended approach for this use case, Iâ€™d truly appreciate your guidance so I can handle it the right way.","closedAt":null,"comments":[{"id":"IC_kwDODNqesM7dAWdi","author":{"login":"ziidu"},"authorAssociation":"NONE","body":"When will it be resolved?","createdAt":"2026-01-04T08:18:38Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/8901#issuecomment-3707856738","viewerDidAuthor":false}],"createdAt":"2025-12-24T09:43:00Z","labels":[{"id":"MDU6TGFiZWwxNjIxMDMwNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":8901,"reactionGroups":[],"state":"OPEN","title":"Skip Re-executing Completed Activities on Workflow Retry (Replay-on-Retry Option)","updatedAt":"2026-01-04T08:18:38Z","url":"https://github.com/temporalio/temporal/issues/8901"}
