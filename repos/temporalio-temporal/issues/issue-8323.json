{"assignees":[{"id":"MDQ6VXNlcjQxODA1MjAx","login":"fretz12","name":"Fred Tzeng","databaseId":0}],"author":{"id":"MDQ6VXNlcjM0Mjk2NzQx","is_bot":false,"login":"Zzzz1111","name":""},"body":"## Expected Behavior\nSuccessful run \n\n## Actual Behavior\nrun failed with error\n{\"level\":\"error\",\"ts\":\"2025-09-13T14:38:49.570Z\",\"msg\":\"error returned\",\"component\":\"fx\",\"name\":\"go.temporal.io/server/temporal.ApplyClusterMetadataConfigProvider()\",\"kind\": \"provide\",\"module\":\"\",\"\"error\":\"received non-nil error from function \\'go.tem\nporal.io/server/temporal\\'.ApplyClusterMetadataConfigProvider(/Users/bytedance/dev/eps/docker-builds/temporal/temporal/fx)go:571): SaveClusterMetadata operation failed. Error Error 10565 (HY000): Cannot execute statement: impossible to write tobina\nry log since BINLOG_FORMAT = STATEMENT and at least onetable uses a storage engine limited to row-based loggingg. InnoDB is limited to row-logging when transaction isolation level is READ COMMITTED or READ UNCOMMITTED.\",\"errorverbose\":\"received non\nnil error from function \\'go.temporal.io/server/temporall\\\".ApplyClusterMetadataConfigProvider\\n\\t/Users/bytedance/dev/eps/docker-builds/temporal/temporal/fx.go:57l:\\nSSaveClusterMetadata operation failed. Error Error 1665 (HY000): Cannot execute stat\nement: impossible to write to binary log since BINLOG_FORMAT = STATEMENT and at least one table usesa storage engine limited to row-based logging. InnnoDB is limited to row-logging when transaction isplation level is READ COMMITTED or READ UNCOMMITT\nED.\", \"logging-call-at\":\"/Users/bytedance/dev/eps/docker--builds/temporal/temporal/fx.go:1095\",\"stacktrace\":\"go.temporal.io/server/common/log.(*zapLogger).Error\\n\\t/Users/bytedance/dev/eps/docker-builds/temporal/common/log/zaap_logger.go:132\\ngo.tempor\nal.io/server/temporal.(*fxLogAdapter).LogEvent\\n\\t/Userss/bytedance/dev/eps/docker-builds/temporal/temporal/fx.g0:1095\\ngo.uber.org/fx.(*module).provide.funcl\\n\\t/Users/bytedance/go/pkg/mod/go.uber.org/fx@vl.23.0/module.go:1199\\ngo.uber.org/dig.(*cons\ntructorNode).Call.funcl\\n\\t/Üsers/bytedance/go/pkg/mod/ggo.uber.org/dig@v1.18.0/constructor.go:167\\ngo.uber.org/dig.(*constructorNode).Call\\n\\t/Users/bytedance/go/pkg/mod/go.uber.org/dig@vl.18.0/constructor.go:189\\ngo.uber.org/dig.paramSingle.Build\\n\n\\t/Users/bytedance/go/pkg/mod/go.uber.org/dig@vl.18.0/param.go:288 /ngo.uber.org/dig.paramObjectField.Build\\n\\t/Users/bytedance/go/pkg/mod/go.uber.org/dig@v1.18.0/param.go:485\\ngo.uber.org/dig.paramObject.Build\\n\\t/Users/bytedance/go/pkg/mod/go.uber.\norg/dig@vl.18.0/param.go:413\\ngo.uber.org/dig.paramList.BuildList\\n\\t/Users/bytedance/go/pkg/mod/go.uber.org/dig@vl.18.0/param.go:151\\ngo.uber.org/dig.(*constructorNode).Call\\n\\t/Users/bytedance/go/pkg/mod/go.uber.org/dig@v1.18.0/constrัuctor.go:155\\\nngo.uber.org/dig.paramGroupedSlice.callGroupProviders\\n\\t/Users/bytedance/go/pkg/mod/go.uber.org/dig@v1.18.0/param.go:610\\ngo.uber.org/dig.paramGroupedSlice.Build\\n\\t/Users/bytedance/go/pkg/mod/go.ubef.org/dig@vl.18.0/param.go:640\\ngo.uber.org/dig.p\naramObjectField.Build\\n\\t/Users/bytedance/go/pkg/mod/go.uber.org/dig@vl.18.0/param.go:485\\ngo.uber.org/dig.parammObject.Build\\n\\t/Users/bytedance/go/pkg/mod/go.uber.org/dig@v1.18.0/param.go:413\\ngo.uber.org/dig.paramList.BuilldList\\n\\t/Users/bytedance\n/go/pkg/mod/go.uber.org/dig@vl.18.0/param.go:151\\ngo.ubeer.org/dig.(*constructorNode).Call\\n\\'t/Users/bytedance/go/pkg/mod/go.uber.org/dig@vl.18.0/constructor.go:155\\ngo.uber.org/dig.paramŠingle.Build\\n\\t/Users/bytedance/go/pkg/mod/go.uber.org/dig@vl.\n18.0/param.go:288\\ngo.uber.org/dig.paramList.BuildList\\n\\t/Users/bytedance/go/pkg/mod/go.uber.org/dig@v1.18.0/param.go:151\\ngo.uber.org/dig.(*Scope).Invoke\\n\\t/Users/bytedance/go/pkg/mod/go.uber.org/dig@vl.18.0/invoke.go:123\\'ngo.uber.org/dig.(*Čonta\niner).Invoke\\n\\t/Users/bytedance/go/pkg/mod/go.uber.org/dig@vl.18.0/invoke.go:83\\ngo.uber.org/fx.runInvoke\\n\\t/Users/bytedance/go/pkg/mod/go.uber.org/fx@vl.23.0/invoke.go:109\\ngo.uber.org/fx.(*module).executeInvoke\\n\\t/Userrs/bytedance/go/pkg/mod/go.\nuber.org/fx@v1.23.0/module.go:322\\ngo.uber.org/fx.(*module).executeInvokes\\n\\t/Users/bytedance/go/pkg/mod/go.uber.org/fx@v1.23.0/module.go:308\\ngo.uber.org/fx.New\\n\\t/Users/bytedance/go/pkg/mod/go.uber.org/fx@vl.23.0/app.go:517\\ngo.temporal.io/serve\nr/temporal.NewServerFx\\n\\t/Üsers/bytedance/dev/eps/docker-builds/temporal/temporal/fx.go:148\\ngo.temporal.io/server/temporal.NewServer\\n\\t/Users/bytedance/dev/eps/docker-builds/temporal/temporal/server.go:45\\nmain.buildCLİ.func4\\n\\t/Users/bytedance/\ndev/eps/docker-builds/temporal/cmd/server/main.go:214\\nggithub.com/urfave/cli/v2.(*Command).Run\\n\\t/Users/bytedance/go/pkg/mod/github.com/urfave/cli/v2@v2.27.5/command.go:276\\ngithub.com/urfave/cli/v2.(*Command).Run\\n\\t/Userrs/bytedance/go/pkg/mod/git\nhub.com/urfave/cli/v2@v2.27.5/command.go:269\\ngithub.com/urfave/cli/v2.(*App).RunContext\\n\\t/Users/bytedance/go/pkg/mod/github.com/urfave/cli/v2@v2.27.5/app.go:333\\ngithub.com/urfave/cli/v2.(*App).Run\\n\\t/Users/bytedance/go/pkg/mod/github.com/unfave\n/cli/v2@v2.27.5/app.go:307\\nmain\\n\\n\\t/Users/bytedance/dev/eps/docker-builds/temporal/cmd/serveer/main.go:36\\nruntime.main\\n\\t/usr/local/go/src/runtime/proc.go:283\"}\n\n\n## Steps to Reproduce the Problem\n\n  1. set mysql  binlog_format to STATEMENT\n  2.run temporal\n\n\n## Specifications\n\n  - Version:\n  - Platform: all \n\nI Find temporal default mysql session transaction_isolation is  'READ-COMMITTED' , when the mysql binlog_format is STATEMENT , there will be a conflict. so , i think temporal can set default binlog_format . \neg:\n<img width=\"1326\" height=\"400\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/8b617f3d-a377-4b46-8313-0d1530daa7cb\" />","closedAt":"2025-09-22T22:56:37Z","comments":[{"id":"IC_kwDODNqesM7FSdzN","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"Thanks, we will take a look.","createdAt":"2025-09-18T23:00:36Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/8323#issuecomment-3309952205","viewerDidAuthor":false},{"id":"IC_kwDODNqesM7F34iq","author":{"login":"fretz12"},"authorAssociation":"MEMBER","body":"Hey @Zzzz1111 -\nUsing binlog_format=STATEMENT would require the isolation to be REPEATABLE-READ (or more conservative) else it breaks transactional guarantees. Our default session isolation is READ-COMMITTED, and therefore you see that error. \nYou can override the session isolation via static config to the server:\n\n```\npersistence:\n  defaultStore: mysql-default\n  ...\n  datastores:\n    mysql-default:\n      sql:\n      \t...\n        connectAttributes:\n          transaction_isolation: \"'REPEATABLE-READ'\"\n```\n\nAnd same for visibility if using mysql:\n\n```\npersistence:\n  visibilityStore: mysql-visibility\n  datastores:\n    mysql-visibility:\n      sql:\n      \t...\n        connectAttributes:\n          transaction_isolation: \"'REPEATABLE-READ'\"\n```\n\n\n> [!WARNING]\n> Please Note: STATEMENT binlog is experimental in Temporal. Use at your own risk. I highly recommend sticking with ROW binlog + READ-COMMITTED.","createdAt":"2025-09-22T15:32:07Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HEART","users":{"totalCount":1}}],"url":"https://github.com/temporalio/temporal/issues/8323#issuecomment-3319761066","viewerDidAuthor":false},{"id":"IC_kwDODNqesM7F_mEk","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"Closing as there is a proposed solution to the issue.","createdAt":"2025-09-22T22:56:37Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/8323#issuecomment-3321782564","viewerDidAuthor":false}],"createdAt":"2025-09-15T09:13:32Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"}],"milestone":null,"number":8323,"reactionGroups":[],"state":"CLOSED","title":"Run temporal failed in MYSQL binlog STATEMENT","updatedAt":"2025-09-22T22:56:37Z","url":"https://github.com/temporalio/temporal/issues/8323"}
