{"assignees":[{"id":"MDQ6VXNlcjIwNjgxMjQ=","login":"rodrigozhou","name":"Rodrigo Zhou","databaseId":0}],"author":{"id":"MDQ6VXNlcjc3NTQxMjA=","is_bot":false,"login":"yycptt","name":"Yichao Yang"},"body":"**Is your feature request related to a problem? Please describe.**\r\n- Currently to know the activityType, we need to read workflow history and find the type in the activity scheduled events.\r\n- For DescribeWorkflowExecution, we need to load activity scheduled event for each pending activity which can be quite expensive as there can be at most 2k pending activities.\r\n\r\n**Describe the solution you'd like**\r\n- Add ActivityType to MutableState's ActivityInfo\r\n- https://github.com/temporalio/temporal/blob/master/service/history/api/describeworkflow/api.go#L145\r\n- Do not read history event if activityType is available in activityInfo\r\n\r\n**Describe alternatives you've considered**\r\nA clear and concise description of any alternative solutions or features you've considered.\r\n\r\n**Additional context**\r\n\r\n","closedAt":"2023-08-03T20:55:27Z","comments":[{"id":"IC_kwDODNqesM5gLTax","author":{"login":"paulnpdev"},"authorAssociation":"MEMBER","body":"is this semantically \"mostRecentActivityType\"?","createdAt":"2023-06-29T17:34:01Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/4537#issuecomment-1613575857","viewerDidAuthor":false},{"id":"IC_kwDODNqesM5i6OkR","author":{"login":"yycptt"},"authorAssociation":"MEMBER","body":"Not sure if I follow the question. But I don't think activity type can change once scheduled.","createdAt":"2023-08-01T01:32:12Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/4537#issuecomment-1659431185","viewerDidAuthor":false},{"id":"IC_kwDODNqesM5jAggT","author":{"login":"paulnpdev"},"authorAssociation":"MEMBER","body":"I think he's asking if we could add a field \"mostRecentActivityType\" to the MS (and populate it every time we process a completed activity) so that we don't have to go load history to find out what it was when processing the next UpdateWorkflow.  I believe there are cases where you need to know what the previous ActivityType was.  \r\n\r\nthis is all a guess :)","createdAt":"2023-08-01T20:53:37Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/4537#issuecomment-1661077523","viewerDidAuthor":false},{"id":"IC_kwDODNqesM5jOFg8","author":{"login":"rodrigozhou"},"authorAssociation":"MEMBER","body":"@paulnpdev The mutable state contains a list of pending activities. The task here is to add the activity type to each pending activity object in mutable state.","createdAt":"2023-08-03T20:55:24Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/4537#issuecomment-1664636988","viewerDidAuthor":false}],"createdAt":"2023-06-23T21:44:39Z","labels":[{"id":"MDU6TGFiZWwxNjIxMDMwNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":4537,"reactionGroups":[],"state":"CLOSED","title":"Add ActivityType to MutableState","updatedAt":"2023-08-03T20:55:28Z","url":"https://github.com/temporalio/temporal/issues/4537"}
