{"assignees":[{"id":"MDQ6VXNlcjU4MzkxOQ==","login":"underrun","name":"J Derek Wilson","databaseId":0},{"id":"MDQ6VXNlcjQ0MjA2NzQ=","login":"mcbryde","name":"Mike McBryde","databaseId":0}],"author":{"id":"MDQ6VXNlcjE0NjQxODY=","is_bot":false,"login":"sivasamyk","name":"Siva Kaliappan"},"body":"## Expected Behavior\r\n\r\nRun temporal cluster in kubernetes environment as non-root user. \r\n\r\nSome enterprises have restrictions in k8s environment to block running containers as root user. Kubernetes also recommends running containers as non-root user - https://kubernetes.io/blog/2018/07/18/11-ways-not-to-get-hacked/#8-run-containers-as-a-non-root-user\r\n\r\nhttps://community.temporal.io/t/cannot-run-temporal-services-as-non-root-user-in-kubernetes/1441\r\n\r\n## Actual Behavior\r\n\r\nStarting temporal containers (using the helm chart from temporal helm chart repo) as non-root user throws the below permission error:\r\n\r\n```\r\ndockerize -template /etc/temporal/config/config_template.yaml:/etc/temporal/config/docker.yaml\r\n2021/02/04 14:28:48 unable to create open /etc/temporal/config/docker.yaml: permission denied\r\n```\r\n\r\n## Steps to Reproduce the Problem\r\n\r\n  1. Create Pod Security Policy (PSP) in kubernetes cluster to block running containers as root user\r\n  2. Adjust Temporal helm charts to include PSP spec with `runAsUser: 1000`\r\n  3. Temporal services fail to start with above error\r\n\r\n## Specifications\r\n\r\n  - Version: 1.6.2\r\n  - Platform: Kubernetes\r\n","closedAt":"2021-09-01T18:22:07Z","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDg1OTk3MzIxNA==","author":{"login":"loopingrage"},"authorAssociation":"NONE","body":"This is blocking us as well. Any update?","createdAt":"2021-06-12T00:57:32Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1263#issuecomment-859973214","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg3MzY1NjUwOA==","author":{"login":"samarabbas"},"authorAssociation":"MEMBER","body":"@mcbryde can you drive this request?  I think we need to start scoping out work needed to run Temporal as non-root user.","createdAt":"2021-07-04T20:28:19Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1263#issuecomment-873656508","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg3OTk5NDMzOA==","author":{"login":"sagardeo2105"},"authorAssociation":"CONTRIBUTOR","body":"This is blocker for us as well. It would be really helpful if we can get this pushed. :)","createdAt":"2021-07-14T15:33:32Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1263#issuecomment-879994338","viewerDidAuthor":false}],"createdAt":"2021-02-05T00:38:28Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"},{"id":"MDU6TGFiZWwyMTU4ODQ2NzIw","name":"security","description":"","color":"f72e32"}],"milestone":null,"number":1263,"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"state":"CLOSED","title":"Cannot run temporal services as non-root user in kubernetes","updatedAt":"2021-09-01T18:22:07Z","url":"https://github.com/temporalio/temporal/issues/1263"}
