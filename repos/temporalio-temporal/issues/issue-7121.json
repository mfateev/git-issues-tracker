{"assignees":[],"author":{"id":"U_kgDOBqUSig","is_bot":false,"login":"thle40","name":""},"body":"**Actual Behavior**\n\nThere are a lot of CVEs found from the latest Temporal image:\ntemporalio/admin-tools:1.26.2-tctl-1.18.1-cli-1.2.0\nSteps to Reproduce the Problem\n\nPull the latest image temporalio/admin-tools:1.26.2-tctl-1.18.1-cli-1.2.0from Dockerhub\nScan the image with any vulnerability scanner\n```\nScan results for: image temporalio/admin-tools:1.26.2-tctl-1.18.1-cli-1.2.0 sha256:5cd1ded2a877d8deca13059770544d291f97b81e5552ab37bd1e0f68362bb30d\nVulnerabilities\n```\n```\n+------------------+----------+------+-----------------------+---------------------------------------+---------------------------------+------------+------------+----------------------------------------------------+\n|       CVE        | SEVERITY | CVSS |        PACKAGE        |                VERSION                |             STATUS              | PUBLISHED  | DISCOVERED |                    DESCRIPTION                     |\n+------------------+----------+------+-----------------------+---------------------------------------+---------------------------------+------------+------------+----------------------------------------------------+\n| CVE-2024-6345    | high     | 8.80 | setuptools            | 65.5.0                                | fixed in 70.0.0                 | > 6 months | < 1 hour   | A vulnerability in the package_index module of     |\n|                  |          |      |                       |                                       | > 6 months ago                  |            |            | pypa/setuptools versions up to 69.1.1 allows for   |\n|                  |          |      |                       |                                       |                                 |            |            | remote code execution via its download functions.  |\n|                  |          |      |                       |                                       |                                 |            |            | Thes...                                            |\n+------------------+----------+------+-----------------------+---------------------------------------+---------------------------------+------------+------------+----------------------------------------------------+\n| PRISMA-2022-0168 | high     | 7.80 | pip                   | 24.0                                  | open                            | > 2 years  | < 1 hour   | An issue was discovered in pip (all versions)      |\n|                  |          |      |                       |                                       |                                 |            |            | because it installs the version with the highest   |\n|                  |          |      |                       |                                       |                                 |            |            | version number, even if the user had intended to   |\n|                  |          |      |                       |                                       |                                 |            |            | obtain...                                          |\n+------------------+----------+------+-----------------------+---------------------------------------+---------------------------------+------------+------------+----------------------------------------------------+\n| CVE-2024-7348    | high     | 7.50 | postgresql16          | 16.3-r0                               | fixed in 16.4-r0                | > 5 months | < 1 hour   | Time-of-check Time-of-use (TOCTOU) race condition  |\n|                  |          |      |                       |                                       | 77 days ago                     |            |            | in pg_dump in PostgreSQL allows an object creator  |\n|                  |          |      |                       |                                       |                                 |            |            | to execute arbitrary SQL functions as the user     |\n|                  |          |      |                       |                                       |                                 |            |            | run...                                             |\n+------------------+----------+------+-----------------------+---------------------------------------+---------------------------------+------------+------------+----------------------------------------------------+\n| CVE-2024-45338   | high     | 0.00 | golang.org/x/net/html | v0.24.0                               | fixed in 0.33.0                 | 29 days    | < 1 hour   | An attacker can craft an input to the Parse        |\n|                  |          |      |                       |                                       | 29 days ago                     |            |            | functions that would be processed non-linearly     |\n|                  |          |      |                       |                                       |                                 |            |            | with respect to its length, resulting in extremely |\n|                  |          |      |                       |                                       |                                 |            |            | slow par...                                        |\n+------------------+----------+------+-----------------------+---------------------------------------+---------------------------------+------------+------------+----------------------------------------------------+\n| CVE-2024-9681    | medium   | 6.50 | curl                  | 8.9.1-r2                              | fixed in 8.11.0-r0              | 71 days    | < 1 hour   | When curl is asked to use HSTS, the expiry time    |\n|                  |          |      |                       |                                       | 71 days ago                     |            |            | for a subdomain might overwrite a parent domain\\'s |\n|                  |          |      |                       |                                       |                                 |            |            | cache entry, making it end sooner or later than    |\n|                  |          |      |                       |                                       |                                 |            |            | oth...                                             |\n+------------------+----------+------+-----------------------+---------------------------------------+---------------------------------+------------+------------+----------------------------------------------------+\n| CVE-2022-40897   | medium   | 5.90 | setuptools            | 65.5.0                                | fixed in 65.5.1                 | > 2 years  | < 1 hour   | Python Packaging Authority (PyPA) setuptools       |\n|                  |          |      |                       |                                       | > 2 years ago                   |            |            | before 65.5.1 allows remote attackers to cause a   |\n|                  |          |      |                       |                                       |                                 |            |            | denial of service via HTML in a crafted package or |\n|                  |          |      |                       |                                       |                                 |            |            | custo...                                           |\n+------------------+----------+------+-----------------------+---------------------------------------+---------------------------------+------------+------------+----------------------------------------------------+\n| CVE-2024-2689    | medium   | 0.00 | go.temporal.io/server | v1.18.1-0.20230217005328-b313b7f58641 | fixed in 1.20.5, 1.21.6, 1.22.7 | > 7 months | < 1 hour   | Denial of Service in Temporal Server prior to      |\n|                  |          |      |                       |                                       | > 7 months ago                  |            |            | version 1.20.5, 1.21.6, and 1.22.7 allows an       |\n|                  |          |      |                       |                                       |                                 |            |            | authenticated user who has permissions to interact |\n|                  |          |      |                       |                                       |                                 |            |            | with wor...                                        |\n+------------------+----------+------+-----------------------+---------------------------------------+---------------------------------+------------+------------+----------------------------------------------------+\n| CVE-2023-3485    | low      | 3.60 | go.temporal.io/server | v1.18.1-0.20230217005328-b313b7f58641 | fixed in 1.20.0                 | > 4 months | < 1 hour   | Insecure defaults in open-source Temporal Server   |\n|                  |          |      |                       |                                       | > 1 years ago                   |            |            | before version 1.20 on all platforms allows an     |\n|                  |          |      |                       |                                       |                                 |            |            | attacker to craft a task token with access to a    |\n|                  |          |      |                       |                                       |                                 |            |            | namesp...                                          |\n+------------------+----------+------+-----------------------+---------------------------------------+---------------------------------+------------+------------+----------------------------------------------------+\n| CVE-2024-9287    | low      | 0.00 | python3               | 3.12.6-r0                             | fixed in 3.12.8-r0              | 86 days    | < 1 hour   | A vulnerability has been found in the CPython      |\n|                  |          |      |                       |                                       | 41 days ago                     |            |            | `venv` module and CLI where path names provided    |\n|                  |          |      |                       |                                       |                                 |            |            | when creating a virtual environment were not       |\n|                  |          |      |                       |                                       |                                 |            |            | quoted prop...                                     |\n+------------------+----------+------+-----------------------+---------------------------------------+---------------------------------+------------+------------+----------------------------------------------------+\n| CVE-2024-9143    | low      | 0.00 | openssl               | 3.3.2-r0                              | fixed in 3.3.2-r1               | > 3 months | < 1 hour   | Issue summary: Use of the low-level GF(2^m)        |\n|                  |          |      |                       |                                       | 88 days ago                     |            |            | elliptic curve APIs with untrusted explicit values |\n|                  |          |      |                       |                                       |                                 |            |            | for the field polynomial can lead to out-of-bounds |\n|                  |          |      |                       |                                       |                                 |            |            | memo...                                            |\n+------------------+----------+------+-----------------------+---------------------------------------+---------------------------------+------------+------------+----------------------------------------------------+\n| CVE-2024-8096    | low      | 0.00 | curl                  | 8.9.1-r2                              | fixed in 8.10.0-r0              | > 4 months | < 1 hour   | When curl is told to use the Certificate Status    |\n|                  |          |      |                       |                                       | > 4 months ago                  |            |            | Request TLS extension, often referred to as OCSP   |\n|                  |          |      |                       |                                       |                                 |            |            | stapling, to verify that the server certificate is |\n|                  |          |      |                       |                                       |                                 |            |            | va...                                              |\n+------------------+----------+------+-----------------------+---------------------------------------+---------------------------------+------------+------------+----------------------------------------------------+\n| CVE-2024-50602   | low      | 0.00 | expat                 | 2.6.3-r0                              | fixed in 2.6.4-r0               | 81 days    | < 1 hour   | An issue was discovered in libexpat before 2.6.4.  |\n|                  |          |      |                       |                                       | 69 days ago                     |            |            | There is a crash within the XML_ResumeParser       |\n|                  |          |      |                       |                                       |                                 |            |            | function because XML_StopParser can stop/suspend   |\n|                  |          |      |                       |                                       |                                 |            |            | an uns...                                          |\n+------------------+----------+------+-----------------------+---------------------------------------+---------------------------------+------------+------------+----------------------------------------------------+\n| CVE-2024-12254   | low      | 0.00 | python3               | 3.12.6-r0                             | fixed in 3.12.8-r1              | 41 days    | < 1 hour   | Starting in Python 3.12.0, the                     |\n|                  |          |      |                       |                                       | 40 days ago                     |            |            | asyncio._SelectorSocketTransport.writelines()      |\n|                  |          |      |                       |                                       |                                 |            |            | method would not \"pause\" writing and signal to the |\n|                  |          |      |                       |                                       |                                 |            |            | Protocol to drain  th...                           |\n+------------------+----------+------+-----------------------+---------------------------------------+---------------------------------+------------+------------+----------------------------------------------------+\n| CVE-2024-11053   | low      | 0.00 | curl                  | 8.9.1-r2                              | fixed in 8.11.1-r0              | 36 days    | < 1 hour   | When asked to both use a `.netrc` file for         |\n|                  |          |      |                       |                                       | 35 days ago                     |            |            | credentials and to follow HTTP redirects, curl     |\n|                  |          |      |                       |                                       |                                 |            |            | could leak the password used for the first host to |\n|                  |          |      |                       |                                       |                                 |            |            | the follo...                                       |\n+------------------+----------+------+-----------------------+---------------------------------------+---------------------------------+------------+------------+----------------------------------------------------+\n| CVE-2024-10979   | low      | 0.00 | postgresql16          | 16.3-r0                               | fixed in 16.5-r0                | 63 days    | < 1 hour   | Incorrect control of environment variables in      |\n|                  |          |      |                       |                                       | 61 days ago                     |            |            | PostgreSQL PL/Perl allows an unprivileged database |\n|                  |          |      |                       |                                       |                                 |            |            | user to change sensitive process environment       |\n|                  |          |      |                       |                                       |                                 |            |            | variable...                                        |\n+------------------+----------+------+-----------------------+---------------------------------------+---------------------------------+------------+------------+----------------------------------------------------+\n| CVE-2024-10978   | low      | 0.00 | postgresql16          | 16.3-r0                               | fixed in 16.5-r0                | 63 days    | < 1 hour   | Incorrect privilege assignment in PostgreSQL       |\n|                  |          |      |                       |                                       | 61 days ago                     |            |            | allows a less-privileged application user to view  |\n|                  |          |      |                       |                                       |                                 |            |            | or change different rows from those intended.  An  |\n|                  |          |      |                       |                                       |                                 |            |            | attac...                                           |\n+------------------+----------+------+-----------------------+---------------------------------------+---------------------------------+------------+------------+----------------------------------------------------+\n| CVE-2024-10977   | low      | 0.00 | postgresql16          | 16.3-r0                               | fixed in 16.5-r0                | 63 days    | < 1 hour   | Client use of server error message in PostgreSQL   |\n|                  |          |      |                       |                                       | 61 days ago                     |            |            | allows a server not trusted under current SSL or   |\n|                  |          |      |                       |                                       |                                 |            |            | GSS settings to furnish arbitrary non-NUL bytes to |\n|                  |          |      |                       |                                       |                                 |            |            | t...                                               |\n+------------------+----------+------+-----------------------+---------------------------------------+---------------------------------+------------+------------+----------------------------------------------------+\n| CVE-2024-10976   | low      | 0.00 | postgresql16          | 16.3-r0                               | fixed in 16.5-r0                | 63 days    | < 1 hour   | Incomplete tracking in PostgreSQL of tables        |\n|                  |          |      |                       |                                       | 61 days ago                     |            |            | with row security allows a reused query to view    |\n|                  |          |      |                       |                                       |                                 |            |            | or change different rows from those intended.      |\n|                  |          |      |                       |                                       |                                 |            |            | CVE-2023-24...                                     |\n+------------------+----------+------+-----------------------+---------------------------------------+---------------------------------+------------+------------+----------------------------------------------------+\n```\n\nVulnerabilities found for image temporalio/admin-tools:1.26.2-tctl-1.18.1-cli-1.2.0: total - 18, critical - 0, high - 4, medium - 3, low - 11\nVulnerability threshold check results: PASS\n\nCompliance Issues\n```\n+----------+------------------------------+\n| SEVERITY |         DESCRIPTION          |\n+----------+------------------------------+\n| high     | Private keys stored in image |\n+----------+------------------------------+\n```\n","closedAt":"2025-03-18T08:23:44Z","comments":[{"id":"IC_kwDODNqesM6i2FMt","author":{"login":"thle40"},"authorAssociation":"NONE","body":"Multiple CVEs are resolved in latest version v1.27.1","createdAt":"2025-03-18T08:23:41Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/7121#issuecomment-2732086061","viewerDidAuthor":false}],"createdAt":"2025-01-20T07:17:14Z","labels":[],"milestone":null,"number":7121,"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"state":"CLOSED","title":"Addressing a lot of security vulnerabilities in the Temporalio/admin-tools release temporalio/admin-tools:1.26.2-tctl-1.18.1-cli-1.2.0","updatedAt":"2025-03-18T08:23:44Z","url":"https://github.com/temporalio/temporal/issues/7121"}
