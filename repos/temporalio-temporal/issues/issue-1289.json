{"assignees":[],"author":{"id":"MDQ6VXNlcjE0NjM2MjI=","is_bot":false,"login":"mfateev","name":"Maxim Fateev"},"body":"**Is your feature request related to a problem? Please describe.**\r\nIf a signal is received during a workflow task processing that created continue-as-new command the task is failed. This is to allow the workflow to process the newly received signal.  The workflow handles such a signal by rolling back its state through replay from the beginning. This creates a problem if signals are constantly sent to the workflow. It keeps replaying without ever finishing. In reality, it reaches the hard limit of signals per workflow and then continue-as-new is executed.\r\n\r\n**Describe the solution you'd like**\r\nBy default pass signal to the next run of the workflow. This way the continue-as-new is never blocked and the signal is not lost.\r\nThis behavior should be configurable through options as in some use cases signal shouldn't be transferred. \r\n\r\nThe diagram that illustrates the current handling of the signal received during a workflow task execution that completes a workflow run:\r\n![CompleteSignalRaceCondition](https://user-images.githubusercontent.com/1463622/107866440-cf8e8000-6e25-11eb-8298-c3ceb422d27f.png)\r\n","closedAt":null,"comments":[{"id":"IC_kwDODNqesM5QMVPb","author":{"login":"XingLiu0923"},"authorAssociation":"NONE","body":"I found this issue from `samples-java`. It is a interesting issue, making me realize that signal will also affect the replay effect. I'm curious whether this issue has a solution now?","createdAt":"2022-12-10T23:43:51Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1289#issuecomment-1345410011","viewerDidAuthor":false},{"id":"IC_kwDODNqesM5ZHFY1","author":{"login":"longquanzheng"},"authorAssociation":"CONTRIBUTOR","body":"> In reality, it reaches the hard limit of signals per workflow and then continue-as-new is executed\r\n\r\nJust a feedback on this. In reality, it could reach the workflow history size/length first and get hard terminated by server. \r\nOr because of too many signals received, continueAsNew is too challenging(near impossible to most users) to implement correctly -- they need to carry over hundreds of signals to next run (unless next run use a query handler to fetch the signals from previous run using pagination )\r\n\r\nI want to call it out how bad that would be so that you may prioritize this ðŸ˜‚ \r\n\r\nAlso, I just realize that Temporal doesn't have a default signalsPerExecution limit -- the default is 0, should we change that? \r\n\r\nhttps://github.com/temporalio/temporal/blob/6f1f02280f72bc92212c98a87c8a21122724490b/service/history/configs/config.go#L417\r\n\r\n(In Cadence it's now 10000 )","createdAt":"2023-04-03T21:48:53Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}},{"content":"EYES","users":{"totalCount":1}}],"url":"https://github.com/temporalio/temporal/issues/1289#issuecomment-1495029301","viewerDidAuthor":false}],"createdAt":"2021-02-14T02:04:40Z","labels":[{"id":"MDU6TGFiZWwxNjIxMDMwNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTM4ODI4MTE3","name":"up-for-grabs","description":"Issues to consider for external contribution","color":"69CD90"}],"milestone":null,"number":1289,"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":5}},{"content":"EYES","users":{"totalCount":2}}],"state":"OPEN","title":"Do not fail continue as new on a new signal","updatedAt":"2023-04-03T21:49:23Z","url":"https://github.com/temporalio/temporal/issues/1289"}
