{"assignees":[{"id":"MDQ6VXNlcjQwOTIyNg==","login":"tdeebswihart","name":"Tim Deeb-Swihart","databaseId":0}],"author":{"id":"MDQ6VXNlcjIyNzg5ODUx","is_bot":false,"login":"ndtretyak","name":"Nikolay Tretyak"},"body":"**Is your feature request related to a problem? Please describe.**\r\nCurrently, there are three `ResourceExhausted` errors with the `RESOURCE_EXHAUSTED_CAUSE_BUSY_WORKFLOW` reason.\r\n\r\n1. `ErrWorkflowClosing`, in my opinion, does not necessarily mean exhaustion.\r\nhttps://github.com/temporalio/temporal/blob/aec2c100b6fae91a53f0f4ea3befe8ea683f0d9c/service/history/consts/const.go#L71-L72\r\n\r\n2. `ErrConsistentQueryBufferExceeded` indicates that there are too many queries but `BUSY_WORKFLOW` might be too ambiguous in this case. \r\nhttps://github.com/temporalio/temporal/blob/aec2c100b6fae91a53f0f4ea3befe8ea683f0d9c/service/history/consts/const.go#L77-L78\r\n\r\n3. `ErrResourceExhaustedBusyWorkflow` explicitly includes \"busy workflow\" in its name. So, this error looks fine :) However, the comment indicate that this error `should not be retried`, but resource exhaustion usually means \"retry later, please\".\r\nhttps://github.com/temporalio/temporal/blob/aec2c100b6fae91a53f0f4ea3befe8ea683f0d9c/service/history/consts/const.go#L101-L102\r\n\r\nThese errors are indistinguishable in metrics, so I cannot exclude `ErrWorkflowClosing` (which is valid in my workload) from alerts.\r\n\r\n**Describe the solution you'd like**\r\nMore granular reasons for `service_errors_resource_exhausted`.\r\n\r\n\r\n","closedAt":null,"comments":[],"createdAt":"2024-01-25T12:52:22Z","labels":[{"id":"MDU6TGFiZWwxNjIxMDMwNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":5352,"reactionGroups":[],"state":"OPEN","title":"Refinement of ResourceExhausted reasons","updatedAt":"2024-01-26T22:39:33Z","url":"https://github.com/temporalio/temporal/issues/5352"}
