{"assignees":[],"author":{"id":"MDQ6VXNlcjI1MjE3MDE=","is_bot":false,"login":"nordiste","name":"marc druelle"},"body":"hello, \r\nwe have a problem with a cron workflow :\r\nwhen our worker do a runtime error: \"invalid memory address or nil pointer dereference\" followed by a timeout,\r\nthe next executions all go into error : 5, 2022-03-22T10:25:02Z, WorkflowExecutionFailed, {Failure:{Message:[client: ] \"bad request - unable to fetch tasks: bad request - too many (2) workflows found\", Source:GoSDK, FailureInfo:{ApplicationFailureInfo:{Type:SDKError, NonRetryable:false}}}\r\n\r\nat each execution, the number was incremented.\r\n\r\n\r\n## Steps to Reproduce the Problem\r\n\r\n  1. do a cron workflow with invalid memory address error\r\n  2. 1st run : \"invalid memory address or nil pointer dereference\"\r\n  3. next run : \"bad request - unable to fetch tasks: bad request - too many (XXXX) workflows found\"\r\n\r\n## Specifications\r\n\r\n  - Version: 1.15.0\r\n  - Platform: k8s\r\n\r\n\r\nlogs : \r\n\r\n1st run : \r\n  1, 2022-03-22T10:22:41Z, WorkflowExecutionStarted, {WorkflowType:{Name:blockedIp/banOnArmor}, ParentInitiatedEventId:0, TaskQueue:{Name:blockedIp/banOnXxx, Kind:Normal}, WorkflowExecutionTimeout:0s, WorkflowRunTimeout:1m0s, WorkflowTaskTimeout:1m0s, Initiator:CronSchedule, OriginalExecutionRunId:2d8643ab-acf1-400f-90ed-ac74e273e19b, Identity:tctl@temporal-tools-5bfb6f89b4-5zfst, FirstExecutionRunId:2d8643ab-acf1-400f-90ed-ac74e273e19b, Attempt:1, CronSchedule:* * * * *, FirstWorkflowTaskBackoff:19s}\r\n  2, 2022-03-22T10:23:00Z, WorkflowTaskScheduled, {TaskQueue:{Name:blockedIp/banOnXxx, Kind:Normal}, StartToCloseTimeout:1m0s, Attempt:1}\r\n  3, 2022-03-22T10:23:00Z, WorkflowTaskStarted, {ScheduledEventId:2, Identity:1@is-ipban-worker-8444896885-tpsbl@, RequestId:a4f19b0a-dcf0-4bab-96fb-713646d3ea64}\r\n  4, 2022-03-22T10:23:01Z, WorkflowTaskFailed, {ScheduledEventId:2, StartedEventId:3, Cause:WorkflowWorkerUnhandledFailure, Failure:{Message:runtime error: invalid memory address or nil pointer dereference, Source:GoSDK, StackTrace:coroutine 2 [panic]: ...\r\n  5, 2022-03-22T10:24:00Z, WorkflowExecutionTimedOut, {RetryState:RetryPolicyNotSet, NewExecutionRunId:240bb40c-7abe-444e-9b0b-699913dfc\r\n\r\n\r\n\r\n2nd (and next) run : \r\n  1, 2022-03-22T10:36:00Z, WorkflowExecutionStarted, {WorkflowType:{Name:blockedIp/banOnArmor}, ParentInitiatedEventId:0, TaskQueue:{Name:blockedIp/banOnXxx, Kind:Normal}, WorkflowExecutionTimeout:0s, WorkflowRunTimeout:1m0s, WorkflowTaskTimeout:1m0s, ContinuedExecutionRunId:552d2731-96bf-44c9-972e-252dd444ffe7, Initiator:CronSchedule, ContinuedFailure:{Message:[client: ] \"bad request - unable to fetch tasks: bad request - too many (13) workflows found\", Source:GoSDK, FailureInfo:{ApplicationFailureInfo:{Type:SDKError, NonRetryable:false}}}, OriginalExecutionRunId:e3c07e5d-b832-4937-ab65-5fd13cd34004, FirstExecutionRunId:2d8643ab-acf1-400f-90ed-ac74e273e19b, Attempt:1, CronSchedule:* * * * *, FirstWorkflowTaskBackoff:1m0s, PrevAutoResetPoints:{Points:[{BinaryChecksum:d2d85548744dd64be46fe9758fd897e9, RunId:240bb40c-7abe-444e-9b0b-699913dfce4e, FirstWorkflowTaskCompletedId:4, CreateTime:2022-03-22 10:25:02.135517052 +0000 UTC, ExpireTime:2022-04-21 10:25:02.135752529 +0000 UTC, Resettable:true}]}}\r\n  2, 2022-03-22T10:37:00Z, WorkflowTaskScheduled, {TaskQueue:{Name:blockedIp/banOnXxx, Kind:Normal}, StartToCloseTimeout:1m0s, Attempt:1}\r\n  3, 2022-03-22T10:37:00Z, WorkflowTaskStarted, {ScheduledEventId:2, Identity:1@is-ipban-worker-8444896885-tpsbl@, RequestId:ec08ba8a-17d5-4c3b-b124-89ea6c38efab}\r\n  4, 2022-03-22T10:37:01Z, WorkflowTaskCompleted, {ScheduledEventId:2, StartedEventId:3, Identity:1@is-ipban-worker-8444896885-tpsbl@, BinaryChecksum:d2d85548744dd64be46fe9758fd897e9}\r\n  5, 2022-03-22T10:37:01Z, WorkflowExecutionFailed, {Failure:{Message:[client: ] \"bad request - unable to fetch tasks: bad request - too many (14) workflows found\", Source:GoSDK, FailureInfo:{ApplicationFailureInfo:{Type:SDKError, NonRetryable:false}}}, RetryState:RetryPolicyNotSet, WorkflowTaskCompletedEventId:4, NewExecutionRunId:f480131c-4a61-4b31-a251-a7011737d449}\r\n  \r\n  \r\n  \r\n  Thanks, \r\n  marc\r\n","closedAt":"2022-03-22T11:03:00Z","comments":[{"id":"IC_kwDODNqesM5AE6ni","author":{"login":"nordiste"},"authorAssociation":"NONE","body":"error from our side, sorry.","createdAt":"2022-03-22T11:03:14Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/2631#issuecomment-1075030498","viewerDidAuthor":false}],"createdAt":"2022-03-22T10:44:30Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"}],"milestone":null,"number":2631,"reactionGroups":[],"state":"CLOSED","title":"\"unable to fech tasks\" after a worker crash on cron style workflow","updatedAt":"2022-03-22T11:03:14Z","url":"https://github.com/temporalio/temporal/issues/2631"}
