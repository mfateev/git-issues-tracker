{"assignees":[],"author":{"id":"MDQ6VXNlcjU3OTY2OTI=","is_bot":false,"login":"bschoening","name":"Brad Schoening"},"body":"The Cassandra schema uses LevelTieredCompaction (LCS) but likely should use default SizeTieredCompactionStrategy (STCS) instead.  All of the tables seem to be configured with LCS but this is not a good general purpose configuration.\r\n\r\nLevel compaction (LCS) can involve significant write magnification, where data is re-written multiple times. In performance testing, reports show up to 13-fold write amplification with LCS.  This blog article by ScyllaDB - a Cassandra compatible database -discusses the many downsides to using LCS:\r\n\r\n- https://www.scylladb.com/2018/01/31/compaction-series-leveled-compaction/\r\n\r\nThe default STCS is preferred and works well for most workloads.","closedAt":null,"comments":[{"id":"IC_kwDODNqesM5O4bI5","author":{"login":"jaffarsadikk"},"authorAssociation":"NONE","body":"Hi Brad,\r\nIt  looks Temporal by default creating table using SizeTieredCompactionStrategy (STCS) ie., schema_version & schema_update_history tables, rest of them manually specifing compaction strategy is LevelTieredCompaction (LCS).\r\n\r\nhttps://github.com/temporalio/temporal/blob/master/schema/cassandra/temporal/schema.cql#L53","createdAt":"2022-11-22T10:09:01Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/3633#issuecomment-1323414073","viewerDidAuthor":false},{"id":"IC_kwDODNqesM53KGX8","author":{"login":"vikingUnet"},"authorAssociation":"NONE","body":"Hello again! Thanks for answer, but why rest of tables indeed have old LevelTieredCompaction (LCS) instead more common and robust compaction type SizeTieredCompactionStrategy (STCS) ? Is this a secret meaning in that, or we can change compaction type of all tables on Size Tired compaction type by ourselfs?\r\n","createdAt":"2024-03-15T08:12:27Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/3633#issuecomment-1999136252","viewerDidAuthor":false}],"createdAt":"2022-11-21T18:13:24Z","labels":[{"id":"MDU6TGFiZWwxNjIxMDMwNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":3633,"reactionGroups":[],"state":"OPEN","title":"Cassandra schema should use default SizeTieredCompactionStrategy ","updatedAt":"2024-03-15T08:12:28Z","url":"https://github.com/temporalio/temporal/issues/3633"}
