{"assignees":[{"id":"MDQ6VXNlcjg3NjI4OTM=","login":"wxing1292","name":"Wenquan Xing","databaseId":0}],"author":{"id":"MDQ6VXNlcjg3NjI4OTM=","is_bot":false,"login":"wxing1292","name":"Wenquan Xing"},"body":"Try not to use cassandra timestamp, due to loss of precision.\r\n\r\nFYI:\r\nhttps://github.com/temporalio/temporal/blob/master/schema/cassandra/temporal/schema.cql#L71","closedAt":null,"comments":[{"id":"MDEyOklzc3VlQ29tbWVudDY1ODMzODQxNw==","author":{"login":"alexshtin"},"authorAssociation":"CONTRIBUTOR","body":"Most of them are gone besides these 3:\r\n```\r\nCREATE TABLE executions (\r\n  visibility_ts                  timestamp, -- unique identifier for timer tasks for an execution\r\n\r\nCREATE TABLE cluster_membership\r\n(\r\n    session_start        timestamp,\r\n    last_heartbeat       timestamp,\r\n","createdAt":"2020-07-14T18:24:37Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/245#issuecomment-658338417","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDY1ODM1NzM2MA==","author":{"login":"wxing1292"},"authorAssociation":"CONTRIBUTOR","body":"not sure about the cluster membership, maybe ok?\r\n\r\nfor execution table, plz change the `timestamp` to bigint or any data type which will not lose precision.\r\n","createdAt":"2020-07-14T19:03:31Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/245#issuecomment-658357360","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDY2NzI3OTQ2Mw==","author":{"login":"samarabbas"},"authorAssociation":"MEMBER","body":"We may not do this for Temporal.  Millisecond precision should be ok.","createdAt":"2020-07-31T18:18:42Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/245#issuecomment-667279463","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDY2OTc1OTM5Ng==","author":{"login":"wxing1292"},"authorAssociation":"CONTRIBUTOR","body":"this is not about ok or not ok\r\nthis is about persist a record into db, and db modifies it without consent.\r\n\r\nconsider in the future, using mutable state to calculate the timer to be deleted, say once a workflow is finished, delete all user timer in the future which have not fired yet.","createdAt":"2020-08-06T07:30:39Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/245#issuecomment-669759396","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDY3MzkwNjk2MA==","author":{"login":"samarabbas"},"authorAssociation":"MEMBER","body":"I'm not sure I fully understand the comment.  Originally the issue was filed to not use Cassandra timestamp due to precision issue.  We decided to not do this for Temporal as we feel timer granularity beyond millisecond is probably not needed at the moment.  I think we have a rounding issue where a timer could be fired earlier than expected due to rounding error.\r\nAs for your other comment we have filed an issue to delete unnecessary timers through a DB scan.  #574  ","createdAt":"2020-08-14T06:14:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/245#issuecomment-673906960","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDY3NDE1MDE4Nw==","author":{"login":"wxing1292"},"authorAssociation":"CONTRIBUTOR","body":"> I'm not sure I fully understand the comment. Originally the issue was filed to not use Cassandra timestamp due to precision issue. We decided to not do this for Temporal as we feel timer granularity beyond millisecond is probably not needed at the moment. I think we have a rounding issue where a timer could be fired earlier than expected due to rounding error.\r\n> As for your other comment we have filed an issue to delete unnecessary timers through a DB scan. #574\r\n\r\nshort answer: the precision issue will open a can of worms\r\nthe main idea here is to have a contract with DB layer: I get the same data that I stored.\r\n\r\nIf this issue is not addressed, later (now?) the business logic will do all kinds of hacks trying to compensate the missing precision.","createdAt":"2020-08-14T16:14:28Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/245#issuecomment-674150187","viewerDidAuthor":false}],"createdAt":"2020-03-23T07:35:49Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"},{"id":"MDU6TGFiZWwzMTM4ODUyODY2","name":"needs-investigation","description":"","color":"0052cc"}],"milestone":{"number":1,"title":"Initial Temporal Release","description":"","dueOn":null},"number":245,"reactionGroups":[],"state":"OPEN","title":"Cassandra timestamp type","updatedAt":"2023-03-03T20:23:30Z","url":"https://github.com/temporalio/temporal/issues/245"}
