{"assignees":[],"author":{"id":"MDQ6VXNlcjE4NTIxNzI=","is_bot":false,"login":"gshively11","name":"Grant Shively"},"body":"## Expected Behavior\r\n\r\nI'm running temporal locally using autosetup, and I'm scheduling two activities in parallel in a single workflow using the Ruby SDK, e.g.\r\n\r\n```ruby\r\nfuture_a = ActivityA.execute()\r\nfuture_b = ActivityB.execute()\r\n\r\nresult_a = future_a.get\r\nresult_b = future_b.get\r\n```\r\nI expect both actions to run in parallel.\r\n\r\n## Actual Behavior\r\n\r\nBoth actions do run in parallel and finish successfully, but (edit: almost) every time I'm seeing an error logged on the temporal server:\r\n\r\n```json\r\n{\r\n  \"level\": \"error\",\r\n  \"ts\": \"2022-02-24T22:01:53.035Z\",\r\n  \"msg\": \"matching client encountered error\",\r\n  \"service\": \"matching\",\r\n  \"error\": \"remote sync match failed\",\r\n  \"service-error-type\": \"serviceerror.Canceled\",\r\n  \"logging-call-at\": \"metricClient.go:259\",\r\n  \"stacktrace\": \"go.temporal.io/server/common/log.(*zapLogger).Error\\n\\t/temporal/common/log/zap_logger.go:142\\ngo.temporal.io/server/common/log.(*throttledLogger).Error.func1\\n\\t/temporal/common/log/throttle_logger.go:79\\ngo.temporal.io/server/common/log.(*throttledLogger).rateLimit\\n\\t/temporal/common/log/throttle_logger.go:100\\ngo.temporal.io/server/common/log.(*throttledLogger).Error\\n\\t/temporal/common/log/throttle_logger.go:78\\ngo.temporal.io/server/client/matching.(*metricClient).finishMetricsRecording\\n\\t/temporal/client/matching/metricClient.go:259\\ngo.temporal.io/server/client/matching.(*metricClient).AddActivityTask.func1\\n\\t/temporal/client/matching/metricClient.go:72\\ngo.temporal.io/server/client/matching.(*metricClient).AddActivityTask\\n\\t/temporal/client/matching/metricClient.go:81\\ngo.temporal.io/server/service/matching.(*Forwarder).ForwardTask\\n\\t/temporal/service/matching/forwarder.go:160\\ngo.temporal.io/server/service/matching.(*TaskMatcher).Offer\\n\\t/temporal/service/matching/matcher.go:150\\ngo.temporal.io/server/service/matching.(*taskQueueManagerImpl).trySyncMatch\\n\\t/temporal/service/matching/taskQueueManager.go:523\\ngo.temporal.io/server/service/matching.(*taskQueueManagerImpl).AddTask.func1\\n\\t/temporal/service/matching/taskQueueManager.go:291\\ngo.temporal.io/server/common/backoff.Retry.func1\\n\\t/temporal/common/backoff/retry.go:104\\ngo.temporal.io/server/common/backoff.RetryContext\\n\\t/temporal/common/backoff/retry.go:125\\ngo.temporal.io/server/common/backoff.Retry\\n\\t/temporal/common/backoff/retry.go:105\\ngo.temporal.io/server/service/matching.executeWithRetry\\n\\t/temporal/service/matching/taskQueueManager.go:501\\ngo.temporal.io/server/service/matching.(*taskQueueManagerImpl).AddTask\\n\\t/temporal/service/matching/taskQueueManager.go:281\\ngo.temporal.io/server/service/matching.(*matchingEngineImpl).AddActivityTask\\n\\t/temporal/service/matching/matchingEngine.go:332\\ngo.temporal.io/server/service/matching.(*Handler).AddActivityTask\\n\\t/temporal/service/matching/handler.go:172\\ngo.temporal.io/server/api/matchingservice/v1._MatchingService_AddActivityTask_Handler.func1\\n\\t/temporal/api/matchingservice/v1/service.pb.go:357\\ngo.temporal.io/server/common/rpc/interceptor.(*RateLimitInterceptor).Intercept\\n\\t/temporal/common/rpc/interceptor/rate_limit.go:84\\ngoogle.golang.org/grpc.chainUnaryInterceptors.func1.1\\n\\t/go/pkg/mod/google.golang.org/grpc@v1.44.0/server.go:1116\\ngo.temporal.io/server/common/rpc/interceptor.(*TelemetryInterceptor).Intercept\\n\\t/temporal/common/rpc/interceptor/telemetry.go:108\\ngoogle.golang.org/grpc.chainUnaryInterceptors.func1.1\\n\\t/go/pkg/mod/google.golang.org/grpc@v1.44.0/server.go:1119\\ngo.temporal.io/server/common/metrics.NewServerMetricsTrailerPropagatorInterceptor.func1\\n\\t/temporal/common/metrics/grpc.go:113\\ngoogle.golang.org/grpc.chainUnaryInterceptors.func1.1\\n\\t/go/pkg/mod/google.golang.org/grpc@v1.44.0/server.go:1119\\ngo.temporal.io/server/common/metrics.NewServerMetricsContextInjectorInterceptor.func1\\n\\t/temporal/common/metrics/grpc.go:66\\ngoogle.golang.org/grpc.chainUnaryInterceptors.func1.1\\n\\t/go/pkg/mod/google.golang.org/grpc@v1.44.0/server.go:1119\\ngo.temporal.io/server/common/rpc.ServiceErrorInterceptor\\n\\t/temporal/common/rpc/grpc.go:131\\ngoogle.golang.org/grpc.chainUnaryInterceptors.func1.1\\n\\t/go/pkg/mod/google.golang.org/grpc@v1.44.0/server.go:1119\\ngoogle.golang.org/grpc.chainUnaryInterceptors.func1\\n\\t/go/pkg/mod/google.golang.org/grpc@v1.44.0/server.go:1121\\ngo.temporal.io/server/api/matchingservice/v1._MatchingService_AddActivityTask_Handler\\n\\t/temporal/api/matchingservice/v1/service.pb.go:359\\ngoogle.golang.org/grpc.(*Server).processUnaryRPC\\n\\t/go/pkg/mod/google.golang.org/grpc@v1.44.0/server.go:1282\\ngoogle.golang.org/grpc.(*Server).handleStream\\n\\t/go/pkg/mod/google.golang.org/grpc@v1.44.0/server.go:1616\\ngoogle.golang.org/grpc.(*Server).serveStreams.func1.2\\n\\t/go/pkg/mod/google.golang.org/grpc@v1.44.0/server.go:921\"\r\n}\r\n```\r\n\r\n## Specifications\r\n\r\n  - Version: 1.15.0\r\n  - Platform: osx, docker, auto-setup\r\n","closedAt":"2022-02-25T22:33:43Z","comments":[{"id":"IC_kwDODNqesM4-qfMe","author":{"login":"yiminc"},"authorAssociation":"MEMBER","body":"https://github.com/temporalio/temporal/pull/2549","createdAt":"2022-02-25T22:33:43Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/2543#issuecomment-1051325214","viewerDidAuthor":false}],"createdAt":"2022-02-24T22:08:18Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"}],"milestone":null,"number":2543,"reactionGroups":[],"state":"CLOSED","title":"\"remote sync match failed\" error in matching service","updatedAt":"2022-02-25T22:33:43Z","url":"https://github.com/temporalio/temporal/issues/2543"}
