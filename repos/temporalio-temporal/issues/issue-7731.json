{"assignees":[],"author":{"id":"MDQ6VXNlcjE4ODMzOA==","is_bot":false,"login":"adamf","name":"Adam Fletcher"},"body":"Describe the bug\nWhile running:\n\ntemporal server start-dev --dynamic-config-value frontend.enableUpdateWorkflowExecution=true\n\nI cannot access remote Postgres servers; for example, servers run by Neon. Requests to those machines time out.\n\nIf I kill temporal, database access works fine.\n\nThis is on OS X latest, bash, clean environment variables. Failures appear with psql (versions 14 through 17 tested).\n\nTo Reproduce\nSteps to reproduce the behavior:\n\nStart temporal server start-dev --dynamic-config-value frontend.enableUpdateWorkflowExecution=true\nRun psql <neon URL> (or try to connect with psycopg2/asyncpg in Python)\nWait for timeout.\nKill temporal\nRun psql again, it works,.\nExpected behavior\nDatabase connections still work.,\n\nScreenshots\nIf applicable, add screenshots to help explain your problem.\n\nDesktop (please complete the following information):\n\nOS: [e.g. iOS] OS X latest\nBrowser [e.g. chrome, safari] N/A\nVersion [e.g. 22]\nAdditional context\nDo you setup an overlay network of some kind? One oddity is that if I run drizzle studio (a node app), that can connect to database even with temporal running.\n","closedAt":"2025-05-14T18:29:15Z","comments":[{"id":"IC_kwDODNqesM6reQL5","author":{"login":"anthonywong555"},"authorAssociation":"NONE","body":"Hi Adam, \n\nThe Temporal CLI uses a SQLite as persistence.  You want to take a look at the following [docker compose file](https://github.com/temporalio/docker-compose/blob/main/docker-compose-postgres.yml#L24C9-L24C23).\n\nSet the `POSTGRES_SEEDS` to the IpAddress to your Postgres DB.","createdAt":"2025-05-13T14:48:26Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/7731#issuecomment-2876834553","viewerDidAuthor":false},{"id":"IC_kwDODNqesM6rfBO6","author":{"login":"adamf"},"authorAssociation":"NONE","body":"Hi @anthonywong555 - that's not the issue, I perhaps did a poor job of describing the bug. The issue is that when the temporal dev server is running, access to remote postgres databases stops working from my machine. Temporal is fine using sqlite, but the code I'm running (including the workflows I'm trying to execute with temporal) cannot access the remote neon database when the temporal server is running. When the temporal server is stopped, the code can access the databases with no issue. ","createdAt":"2025-05-13T15:46:15Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/7731#issuecomment-2877035450","viewerDidAuthor":false},{"id":"IC_kwDODNqesM6rg1nT","author":{"login":"anthonywong555"},"authorAssociation":"NONE","body":"Hey @adamf, thanks for the clarification. Here is an [example](https://github.com/temporalio/samples-python/blob/main/hello/hello_activity_method.py#L35) of how an activity make DB to your Neon Instance.","createdAt":"2025-05-13T18:11:06Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/7731#issuecomment-2877512147","viewerDidAuthor":false},{"id":"IC_kwDODNqesM6ruvEa","author":{"login":"adamf"},"authorAssociation":"NONE","body":"@anthonywong555 thanks for following up here - for future reference, the issue was around shared database management code that was being shared across activities and breaking everything. I'm not how the symptoms I observed came from that, but it's better now after a refactor.","createdAt":"2025-05-14T18:29:15Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/7731#issuecomment-2881155354","viewerDidAuthor":false}],"createdAt":"2025-05-08T04:33:21Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"}],"milestone":null,"number":7731,"reactionGroups":[],"state":"CLOSED","title":"While temporal dev server is running, cannot access remote Postgres database","updatedAt":"2025-05-14T18:29:16Z","url":"https://github.com/temporalio/temporal/issues/7731"}
