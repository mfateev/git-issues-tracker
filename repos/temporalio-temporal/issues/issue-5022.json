{"assignees":[],"author":{"id":"MDQ6VXNlcjg0MDIxNjgz","is_bot":false,"login":"Aoao54","name":"Obu Yao"},"body":"I put this also on Slack : https://temporalio.slack.com/archives/CTRCR8RBP/p1697683052222109\r\n## Expected Behavior\r\nDisplay archived workflows which have past the retention from archived file store S3.\r\n\r\n## Actual Behavior\r\nCan't display it both in web-ui or tctl \r\n\r\n![image](https://github.com/temporalio/temporal/assets/84021683/bc01d620-1964-493a-8b96-6ed13e9c70b1)\r\n\r\n`âžœ  ~ tctl wf desc -w    hello_world_workflowID -r d07eaf4b-83d4-4bf6-b387-a3ae1caf584c                                    \r\nError: Describe workflow execution failed\r\nError Details: rpc error: code = NotFound desc = Workflow executionsRow not found.  WorkflowId: hello_world_workflowID, RunId: d07eaf4b-83d4-4bf6-b387-a3ae1caf584c\r\nStack trace:\r\ngoroutine 1 [running]:\r\nruntime/debug.Stack()\r\n\truntime/debug/stack.go:24 +0x64\r\nruntime/debug.PrintStack()\r\n\truntime/debug/stack.go:16 +0x1c\r\ngithub.com/temporalio/tctl/cli_curr.printError({0x101f76e2c, 0x22}, {0x1026cd0e0, 0x140001262c0})\r\n\tgithub.com/temporalio/tctl/cli_curr/util.go:393 +0x1c0\r\ngithub.com/temporalio/tctl/cli_curr.ErrorAndExit({0x101f76e2c?, 0x1026dd3a8?}, {0x1026cd0e0?, 0x140001262c0?})\r\n\tgithub.com/temporalio/tctl/cli_curr/util.go:404 +0x28\r\ngithub.com/temporalio/tctl/cli_curr.describeWorkflowHelper(0x140000c0c60, {0x16efa77e8, 0x16}, {0x16efa7802, 0x24})\r\n\tgithub.com/temporalio/tctl/cli_curr/workflowCommands.go:905 +0x1f4\r\ngithub.com/temporalio/tctl/cli_curr.DescribeWorkflow(0x140000c0c60)\r\n\tgithub.com/temporalio/tctl/cli_curr/workflowCommands.go:870 +0x68\r\ngithub.com/temporalio/tctl/cli_curr.newWorkflowCommands.func15(0x140000a6640?)\r\n\tgithub.com/temporalio/tctl/cli_curr/workflow.go:237 +0x1c\r\ngithub.com/urfave/cli.HandleAction({0x10241d620?, 0x1026c2060?}, 0x8?)\r\n\tgithub.com/urfave/cli@v1.22.10/app.go:526 +0x94\r\ngithub.com/urfave/cli.Command.Run({{0x101f38abc, 0x8}, {0x0, 0x0}, {0x1400018b150, 0x1, 0x1}, {0x101f8357d, 0x26}, {0x0, ...}, ...}, ...)\r\n\tgithub.com/urfave/cli@v1.22.10/command.go:173 +0x504\r\ngithub.com/urfave/cli.(*App).RunAsSubcommand(0x1400055d340, 0x140000c09a0)\r\n\tgithub.com/urfave/cli@v1.22.10/app.go:405 +0xa68\r\ngithub.com/urfave/cli.Command.startApp({{0x101f395cc, 0x8}, {0x0, 0x0}, {0x1400018b720, 0x1, 0x1}, {0x101f5f7be, 0x19}, {0x0, ...}, ...}, ...)\r\n\tgithub.com/urfave/cli@v1.22.10/command.go:378 +0x9c4\r\ngithub.com/urfave/cli.Command.Run({{0x101f395cc, 0x8}, {0x0, 0x0}, {0x1400018b720, 0x1, 0x1}, {0x101f5f7be, 0x19}, {0x0, ...}, ...}, ...)\r\n\tgithub.com/urfave/cli@v1.22.10/command.go:102 +0x650\r\ngithub.com/urfave/cli.(*App).Run(0x1400055cfc0, {0x140001a6000, 0x7, 0x7})\r\n\tgithub.com/urfave/cli@v1.22.10/app.go:277 +0x7e4\r\nmain.main()\r\n\t./main.go:47 +0xc0`\r\n## Steps to Reproduce the Problem\r\n\r\n  1. Set up a local S3-server and local temporal-server with this archival config \r\n \r\n\r\n> archival:\r\n>   history:\r\n>     state: \"enabled\"\r\n>     enableRead: true\r\n>     provider:\r\n>       s3store:\r\n>         region: \"us-east-1\"\r\n>         endpoint: \"http://127.0.0.1:4566/\"\r\n>         s3ForcePathStyle: true\r\n>   visibility:\r\n>     state: \"enabled\"\r\n>     enableRead: true\r\n>     provider:\r\n>       s3store:\r\n>         region: \"us-east-1\"\r\n>         endpoint: \"http://127.0.0.1:4566/\"\r\n>         s3ForcePathStyle: true\r\n> \r\n> namespaceDefaults:\r\n>   archival:\r\n>     history:\r\n>       state: \"enabled\"\r\n>       URI: \"s3://temporal-development\"\r\n>     visibility:\r\n>       state: \"enabled\"\r\n>       URI: \"s3://temporal-development\"\r\n\r\n  2. set a default namespace which the retention-period is 1h\r\n> temporal operator namespace create --retention=1h default\r\n  3. run some easy sample-go workflows. When the archived workflows past the retention, you can't open it from web-ui or describe it use tclt cmd.\r\n> tctl wf desc -w    hello_world_workflowID -r d07eaf4b-83d4-4bf6-b387-a3ae1caf584c       \r\n\r\n## Specifications\r\n\r\n  - Version: \r\n    temporal-server: 1.22\r\n    ui-server:  2.19.0\r\n  - Platform: S3, MAC\r\n","closedAt":null,"comments":[{"id":"IC_kwDODNqesM5pxW8_","author":{"login":"yycptt"},"authorAssociation":"MEMBER","body":"Describe workflow execution does not support archived workflows.\r\n\r\nHistory for archived workflows can be retrieved from archival storage and returned via the GetWorkflowExecutionHistory API or `tctl wf show` when runID is specified.","createdAt":"2023-10-23T06:58:19Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/5022#issuecomment-1774546751","viewerDidAuthor":false},{"id":"IC_kwDODNqesM5pxawv","author":{"login":"Aoao54"},"authorAssociation":"NONE","body":"Thanks! Succeeded in getting history of archived workflow with **tctl wf show** . But still can't open it from web-ui. So this is supposed to be a UI bug. \r\n<img width=\"1528\" alt=\"image\" src=\"https://github.com/temporalio/temporal/assets/84021683/85488a43-5f32-4aa9-b562-67a643793a19\">\r\n","createdAt":"2023-10-23T07:11:02Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/5022#issuecomment-1774562351","viewerDidAuthor":false},{"id":"IC_kwDODNqesM5_IWle","author":{"login":"Marwan-Dalaty"},"authorAssociation":"NONE","body":"HI I have similar issue to the above , from the UI it keeps loading and then give me no workflows found while using tctl I can find the archived workflows . It was working before normally\r\n\r\n![Screenshot from 2024-05-27 12-07-27](https://github.com/temporalio/temporal/assets/109135194/e5d114b3-e720-4ae6-bacf-abe4edbb30d0)\r\n`{\"level\":\"error\",\"ts\":\"2024-05-27T07:40:44.567Z\",\"msg\":\"service failures\",\"operation\":\"ListArchivedWorkflowExecutions\",\"wf-namespace\":\"default\",\"error\":\"RequestCanceled: request context canceled\\ncaused by: context canceled\",\"logging-call-at\":\"telemetry.go:341\",\"stacktrace\":\"go.temporal.io/server/common/log.(*zapLogger).Error\\n\\t/home/builder/temporal/common/log/zap_logger.go:156\\ngo.temporal.io/server/common/rpc/interceptor.(*TelemetryInterceptor).handleError\\n\\t/home/builder/temporal/common/rpc/interceptor/telemetry.go:341\\ngo.temporal.io/server/common/rpc/interceptor.(*TelemetryInterceptor).UnaryIntercept\\n\\t/home/builder/temporal/common/rpc/interceptor/telemetry.go:174\\ngoogle.golang.org/grpc.getChainUnaryHandler.func1\\n\\t/go/pkg/mod/google.golang.org/grpc@v1.58.2/server.go:1195\\ngo.temporal.io/server/service/frontend.(*RedirectionInterceptor).handleRedirectAPIInvocation.func2\\n\\t/home/builder/temporal/service/frontend/redirection_interceptor.go:238\\ngo.temporal.io/server/service/frontend.(*NoopRedirectionPolicy).WithNamespaceRedirect\\n\\t/home/builder/temporal/service/frontend/dc_redirection_policy.go:125\\ngo.temporal.io/server/service/frontend.(*RedirectionInterceptor).handleRedirectAPIInvocation\\n\\t/home/builder/temporal/service/frontend/redirection_interceptor.go:235\\ngo.temporal.io/server/service/frontend.(*RedirectionInterceptor).Intercept\\n\\t/home/builder/temporal/service/frontend/redirection_interceptor.go:195\\ngoogle.golang.org/grpc.getChainUnaryHandler.func1\\n\\t/go/pkg/mod/google.golang.org/grpc@v1.58.2/server.go:1195\\ngo.temporal.io/server/common/authorization.(*interceptor).Interceptor\\n\\t/home/builder/temporal/common/authorization/interceptor.go:158\\ngoogle.golang.org/grpc.getChainUnaryHandler.func1\\n\\t/go/pkg/mod/google.golang.org/grpc@v1.58.2/server.go:1195\\ngo.temporal.io/server/common/metrics.NewServerMetricsContextInjectorInterceptor.func1\\n\\t/home/builder/temporal/common/metrics/grpc.go:66\\ngoogle.golang.org/grpc.getChainUnaryHandler.func1\\n\\t/go/pkg/mod/google.golang.org/grpc@v1.58.2/server.go:1195\\ngo.opentelemetry.io/contrib/instrumentation/google.golang.org/grpc/otelgrpc.UnaryServerInterceptor.func1\\n\\t/go/pkg/mod/go.opentelemetry.io/contrib/instrumentation/google.golang.org/grpc/otelgrpc@v0.42.0/interceptor.go:344\\ngoogle.golang.org/grpc.getChainUnaryHandler.func1\\n\\t/go/pkg/mod/google.golang.org/grpc@v1.58.2/server.go:1195\\ngo.temporal.io/server/common/rpc/interceptor.(*NamespaceLogInterceptor).Intercept\\n\\t/home/builder/temporal/common/rpc/interceptor/namespace_logger.go:84\\ngoogle.golang.org/grpc.getChainUnaryHandler.func1\\n\\t/go/pkg/mod/google.golang.org/grpc@v1.58.2/server.go:1195\\ngo.temporal.io/server/common/rpc/interceptor.(*NamespaceValidatorInterceptor).NamespaceValidateIntercept\\n\\t/home/builder/temporal/common/rpc/interceptor/namespace_validator.go:111\\ngoogle.golang.org/grpc.getChainUnaryHandler.func1\\n\\t/go/pkg/mod/google.golang.org/grpc@v1.58.2/server.go:1195\\ngo.temporal.io/server/common/rpc.ServiceErrorInterceptor\\n\\t/home/builder/temporal/common/rpc/grpc.go:145\\ngoogle.golang.org/grpc.chainUnaryInterceptors.func1\\n\\t/go/pkg/mod/google.golang.org/grpc@v1.58.2/server.go:1186\\ngo.temporal.io/api/workflowservice/v1._WorkflowService_ListArchivedWorkflowExecutions_Handler\\n\\t/go/pkg/mod/go.temporal.io/api@v1.24.1-0.20231003165936-bb03061759c8/workflowservice/v1/service.pb.go:2059\\ngoogle.golang.org/grpc.(*Server).processUnaryRPC\\n\\t/go/pkg/mod/google.golang.org/grpc@v1.58.2/server.go:1376\\ngoogle.golang.org/grpc.(*Server).handleStream\\n\\t/go/pkg/mod/google.golang.org/grpc@v1.58.2/server.go:1753\\ngoogle.golang.org/grpc.(*Server).serveStreams.func1.1\\n\\t/go/pkg/mod/google.golang.org/grpc@v1.58.2/server.go:998\"}`\r\n\r\n","createdAt":"2024-05-27T08:08:01Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/5022#issuecomment-2132896094","viewerDidAuthor":false},{"id":"IC_kwDODNqesM6t13dG","author":{"login":"kkcmadhu-IBM"},"authorAssociation":"NONE","body":"i face the same issue.","createdAt":"2025-05-28T14:33:00Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/5022#issuecomment-2916579142","viewerDidAuthor":false},{"id":"IC_kwDODNqesM7EJjs9","author":{"login":"fabioyy"},"authorAssociation":"NONE","body":"same here. I can get the workflow by using cli, but cannot get in the web ( passing workflow and run_id ) on the url.\nstrange that it was ok in the past. I redeployed my k8 cluster and reinstall the helm. ( a little older version ).","createdAt":"2025-09-15T07:32:35Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/5022#issuecomment-3290839869","viewerDidAuthor":false}],"createdAt":"2023-10-23T06:04:17Z","labels":[],"milestone":null,"number":5022,"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"state":"OPEN","title":"Can't display archived workflows which have past the retention","updatedAt":"2025-09-15T07:32:35Z","url":"https://github.com/temporalio/temporal/issues/5022"}
