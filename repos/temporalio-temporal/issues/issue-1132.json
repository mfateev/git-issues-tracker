{"assignees":[],"author":{"id":"MDQ6VXNlcjUyMjI1MTI=","is_bot":false,"login":"hazcod","name":"Niels Hofmans"},"body":"## Expected Behavior\r\ntemporal works as usual.\r\n\r\n## Actual Behavior\r\n```json\r\n{\r\n  \"level\": \"error\",\r\n  \"ts\": \"2020-12-28T07:32:03.854Z\",\r\n  \"msg\": \"Operation failed with internal error.\",\r\n  \"service\": \"history\",\r\n  \"error\": \"UpdateWorkflowExecution operation failed. Failed to commit transaction. Error: pq: restart transaction: TransactionRetryWithProtoRefreshError: TransactionRetryError: retry txn (RETRY_SERIALIZABLE): \\\"sql txn\\\" meta={id=173d0576 key=/Table/60/1/3/\\\"$\\\\xa5\\\\x83\\\\x85\\f]K\\\\xf9\\\\x80Ù‚J\\\\x0fIW\\\"/\\\"InvestigateDomainWorkflow-1-619545624771854337\\\" pri=0.00374513 epo=0 ts=1609140723.658313472,1 min=1609140723.653018652,0 seq=9} lock=true stat=PENDING rts=1609140723.653018652,0 wto=false max=1609140723.653018652,0\",\r\n  \"metric-scope\": 5,\r\n  \"shard-id\": 3,\r\n  \"logging-call-at\": \"persistenceMetricClients.go:690\",\r\n  \"stacktrace\": \"go.temporal.io/server/common/log/loggerimpl.(*loggerImpl).Error\\n /temporal/common/log/loggerimpl/logger.go:138\\ngo.temporal.io/server/common/persistence.(*workflowExecutionPersistenceClient).updateErrorMetric\\n /temporal/common/persistence/persistenceMetricClients.go:690\\ngo.temporal.io/server/common/persistence.(*workflowExecutionPersistenceClient).UpdateWorkflowExecution\\n /temporal/common/persistence/persistenceMetricClients.go:279\\ngo.temporal.io/server/service/history/shard.(*ContextImpl).UpdateWorkflowExecution\\n /temporal/service/history/shard/context_impl.go:532\\ngo.temporal.io/server/service/history.(*workflowExecutionContextImpl).updateWorkflowExecutionWithRetry.func1\\n /temporal/service/history/workflowExecutionContext.go:1044\\ngo.temporal.io/server/common/backoff.Retry\\n /temporal/common/backoff/retry.go:103\\ngo.temporal.io/server/service/history.(*workflowExecutionContextImpl).updateWorkflowExecutionWithRetry\\n /temporal/service/history/workflowExecutionContext.go:1048\\ngo.temporal.io/server/service/history.(*workflowExecutionContextImpl).updateWorkflowExecutionWithNew\\n /temporal/service/history/workflowExecutionContext.go:754\\ngo.temporal.io/server/service/history.(*workflowExecutionContextImpl).updateWorkflowExecutionAsActive\\n /temporal/service/history/workflowExecutionContext.go:605\\ngo.temporal.io/server/service/history.(*historyEngineImpl).updateWorkflowHelper\\n /temporal/service/history/historyEngine.go:2423\\ngo.temporal.io/server/service/history.(*historyEngineImpl).updateWorkflowExecutionWithAction\\n /temporal/service/history/historyEngine.go:2377\\ngo.temporal.io/server/service/history.(*historyEngineImpl).updateWorkflowExecution\\n /temporal/service/history/historyEngine.go:2447\\ngo.temporal.io/server/service/history.(*historyEngineImpl).RespondActivityTaskCompleted\\n /temporal/service/history/historyEngine.go:1421\\ngo.temporal.io/server/service/history.(*Handler).RespondActivityTaskCompleted\\n /temporal/service/history/handler.go:441\\ngo.temporal.io/server/api/historyservice/v1._HistoryService_RespondActivityTaskCompleted_Handler.func1\\n /temporal/api/historyservice/v1/service.pb.go:1019\\ngo.temporal.io/server/common/rpc.ServiceErrorInterceptor\\n /temporal/common/rpc/grpc.go:100\\ngo.temporal.io/server/api/historyservice/v1._HistoryService_RespondActivityTaskCompleted_Handler\\n /temporal/api/historyservice/v1/service.pb.go:1021\\ngoogle.golang.org/grpc.(*Server).processUnaryRPC\\n /go/pkg/mod/google.golang.org/grpc@v1.34.0/server.go:1210\\ngoogle.golang.org/grpc.(*Server).handleStream\\n /go/pkg/mod/google.golang.org/grpc@v1.34.0/server.go:1533\\ngoogle.golang.org/grpc.(*Server).serveStreams.func1.2\\n /go/pkg/mod/google.golang.org/grpc@v1.34.0/server.go:871\"\r\n}\r\n```\r\n\r\n## Steps to Reproduce the Problem\r\n\r\n  1. Run temporal (?)\r\n\r\n## Specifications\r\n\r\n  - Version: temporalio/auto-setup:1.5.0 , cockroachdb/cockroach:v20.1.9 , go.temporal.io/sdk v1.2.0\r\n  - Platform: Go + Docker\r\n","closedAt":"2021-02-11T06:51:32Z","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDc3NzE0NzI3Mw==","author":{"login":"wxing1292"},"authorAssociation":"CONTRIBUTOR","body":"@hazcod are you still seeing the above using latest release (v1.6.3)?","createdAt":"2021-02-11T01:15:01Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1132#issuecomment-777147273","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDc3NzIzNzUyNw==","author":{"login":"hazcod"},"authorAssociation":"CONTRIBUTOR","body":"It's been a while, so no.","createdAt":"2021-02-11T06:51:32Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1132#issuecomment-777237527","viewerDidAuthor":false}],"createdAt":"2020-12-28T07:36:18Z","labels":[],"milestone":null,"number":1132,"reactionGroups":[],"state":"CLOSED","title":"server logs error Operation failed with internal error","updatedAt":"2021-02-11T06:51:33Z","url":"https://github.com/temporalio/temporal/issues/1132"}
