{"assignees":[],"author":{"id":"MDQ6VXNlcjEwNzIzNTMw","is_bot":false,"login":"Strunevskiy","name":""},"body":"## Expected Behavior\r\ntemporal is up and running\r\n\r\n## Actual Behavior\r\nthe error is shown that PostgreSQL is not up\r\n\r\nWaiting for PostgreSQL to startup.\r\ntemporal                | + echo 'Waiting for PostgreSQL to startup.'\r\ntemporal                | + sleep 1\r\ntemporal                | + nc -z postgresql 5432\r\ntemporal                | nc: bad address 'postgresql'\r\ntemporal                | + echo 'Waiting for PostgreSQL to startup.'\r\ntemporal                | + sleep 1\r\n\r\n## Steps to Reproduce the Problem\r\ngit clone https://github.com/temporalio/docker-compose.git\r\ncd  docker-compose\r\ndocker-compose up or docker-compose -f docker-compose-postgres.yml up\r\n\r\n\r\n## Specifications\r\n\r\ndocker info\r\nServer Version: 17.06.0-ce\r\nKernel Version: 3.10.0-1127.el7.x86_64\r\nOperating System: Oracle Linux Server 7.8\r\nOSType: linux\r\nArchitecture: x86_64\r\nCPUs: 4\r\nTotal Memory: 7.522GiB\r\nRegistry: https://index.docker.io/v1/\r\n\r\n\r\nNotes: everything works if I run temporal with MySQL.\r\n\r\n","closedAt":"2022-01-27T03:18:53Z","comments":[{"id":"IC_kwDODNqesM47xyX_","author":{"login":"suparnaj3"},"authorAssociation":"NONE","body":"@Strunevskiy, I have also come across this issue.\r\n\r\nIn my case, it was due to an existing temporal-postgresql container in the exited state.\r\nWhen I removed that, it worked perfectly.","createdAt":"2021-12-30T07:34:13Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":3}}],"url":"https://github.com/temporalio/temporal/issues/2322#issuecomment-1002907135","viewerDidAuthor":false},{"id":"IC_kwDODNqesM47y2Dj","author":{"login":"Strunevskiy"},"authorAssociation":"NONE","body":"@suparnaj3  thanks. Let me try it.","createdAt":"2021-12-30T21:18:42Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/temporal/issues/2322#issuecomment-1003184355","viewerDidAuthor":false},{"id":"IC_kwDODNqesM48EWj-","author":{"login":"yiminc"},"authorAssociation":"MEMBER","body":"@Strunevskiy , could you confirm if your problem is fixed?","createdAt":"2022-01-07T22:06:13Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/2322#issuecomment-1007773950","viewerDidAuthor":false},{"id":"IC_kwDODNqesM48bO4Q","author":{"login":"Strunevskiy"},"authorAssociation":"NONE","body":"@yiminc  the issue is not fixed. Also, I did not notice any container in the exited state as mentioned.","createdAt":"2022-01-15T23:39:26Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/2322#issuecomment-1013771792","viewerDidAuthor":false},{"id":"IC_kwDODNqesM48byga","author":{"login":"aureeaubert"},"authorAssociation":"NONE","body":"@Strunevskiy I had the same issue but I fixed it by adding the links property in the temporal container definition to allow the containers to communicate with postrgresql, \r\n```\r\nlinks:\r\n  - postgresql\r\n```\r\nLet me know if it fixes your issue","createdAt":"2022-01-16T17:27:22Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HEART","users":{"totalCount":3}}],"url":"https://github.com/temporalio/temporal/issues/2322#issuecomment-1013917722","viewerDidAuthor":false},{"id":"IC_kwDODNqesM48wzpZ","author":{"login":"Strunevskiy"},"authorAssociation":"NONE","body":"@aureeaubert  thanks, let me try and see.","createdAt":"2022-01-23T06:58:23Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/2322#issuecomment-1019427417","viewerDidAuthor":false},{"id":"IC_kwDODNqesM48x_-N","author":{"login":"basharkhatib"},"authorAssociation":"NONE","body":"I had the same issue. @suparnaj3 solution worked for me. Thanks.\r\n\r\n","createdAt":"2022-01-24T05:40:58Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/2322#issuecomment-1019740045","viewerDidAuthor":false},{"id":"IC_kwDODNqesM6Gjw-n","author":{"login":"apmcodes"},"authorAssociation":"NONE","body":"Was getting the same error, as **temporal is trying to connect to default postgresql port 5432**, which had a different postgresql running, while temportal-postgresql was configured to run on a non-default port of 5433. \r\n\r\n**error**\r\n```\r\ntemporal | 'Waiting for PostgreSQL to startup.'\r\n```\r\n\r\n**docker-compose.yaml**\r\n```\r\n  postgresql:\r\n    container_name: temporal-postgresql\r\n    ports:\r\n      - ${POSTGRES_DEFAULT_PORT}:5432\r\n  ...\r\n  temporal:\r\n    container_name: temporal\r\n    depends_on:\r\n      - postgresql\r\n    environment:\r\n      - DB=postgres12\r\n      - DB_PORT=${POSTGRES_DEFAULT_PORT}\r\n```\r\n\r\n**.env**\r\n```\r\nPOSTGRES_DEFAULT_PORT=5433\r\n```","createdAt":"2024-07-30T05:55:03Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/2322#issuecomment-2257522599","viewerDidAuthor":false}],"createdAt":"2021-12-27T07:44:51Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"}],"milestone":null,"number":2322,"reactionGroups":[],"state":"CLOSED","title":"docker-compose.yml does not start PostgreSQL","updatedAt":"2024-07-30T05:56:35Z","url":"https://github.com/temporalio/temporal/issues/2322"}
