{"assignees":[{"id":"MDQ6VXNlcjIwNjM5Ng==","login":"cretz","name":"Chad Retz","databaseId":0}],"author":{"id":"MDQ6VXNlcjIwNjM5Ng==","is_bot":false,"login":"cretz","name":"Chad Retz"},"body":"After internal discussion, an API like the following should be implemented on the workflow service (comments inline are not the actual documentation that will be used of course):\r\n\r\n```proto\r\nsyntax = \"proto3\";\r\n\r\nmessage GetServerInfoRequest {\r\n  // Research has said that every call should be namespaced.\r\n  string namespace = 1;\r\n}\r\n\r\nmessage GetServerInfoResponse {\r\n  // Same as GetClusterInfoResponse.server_version.\r\n  string server_version = 1;\r\n\r\n  // Same as GetClusterInfoResponse.version_info.\r\n  temporal.api.version.v1.VersionInfo version_info = 2;\r\n\r\n  // General purpose user metadata. While we may not support it at first, we\r\n  // should allow general YAML (or whatever) configured metadata that we then\r\n  // expose here. This is a great help to ops teams deploying and managing\r\n  // server details. Currently not namespace specific, but may get there.\r\n  // \r\n  // This is modeled off of metadata in Envoy (see \"metadata\" at\r\n  // https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/core/v3/base.proto#envoy-v3-api-msg-config-core-v3-node).\r\n  google.protobuf.Struct metadata = 3;\r\n\r\n  // All capabilities the server supports. It is clearer and more forward\r\n  // compatible as a message than a repeated enum or other form. A message also\r\n  // supports more advanced details than a simple enumerate.\r\n  Capabilities capabilities = 4;\r\n\r\n  // Server capability details.\r\n  message Capabilities {\r\n    // True if signal and query headers are supported.\r\n    bool signal_and_query_header = 1;\r\n\r\n    // True if internal errors are differentiated from other types of errors for\r\n    // purposes of retrying non-internal errors.\r\n    //\r\n    // When unset/false, clients retry all failures. When true, clients should\r\n    // only retry non-internal errors.\r\n    bool internal_error_differentiation = 2;\r\n  }\r\n}\r\n\r\nservice WorkflowService {\r\n  // ...\r\n\r\n  rpc GetServerInfo(GetServerInfo) returns (GetServerInfoResponse) {}\r\n}\r\n```\r\n","closedAt":"2021-12-20T17:32:56Z","comments":[{"id":"IC_kwDODNqesM458DzN","author":{"login":"Sushisource"},"authorAssociation":"MEMBER","body":"@cretz My only worry with the Capabilities message is we have to update the API defs every time we add one. Maybe that's actually a feature, though? \r\n\r\nReally like this.","createdAt":"2021-11-17T21:18:40Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/2190#issuecomment-972045517","viewerDidAuthor":false},{"id":"IC_kwDODNqesM45897K","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"@Sushisource - It is a feature. Missing proto fields are backwards compatible _and_ strongly typed which is much better than some dynamic structure. People need to just make sure the empty/zero value of the field they add is a reasonable representation of feature unsupported. Booleans that default to false work well here.","createdAt":"2021-11-17T23:36:18Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/2190#issuecomment-972283594","viewerDidAuthor":false},{"id":"IC_kwDODNqesM458_jv","author":{"login":"Sushisource"},"authorAssociation":"MEMBER","body":"Right, I was talking purely from a convenience / ease-of-adding feature standpoint, but I agree this makes sense.","createdAt":"2021-11-17T23:40:56Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/2190#issuecomment-972290287","viewerDidAuthor":false}],"createdAt":"2021-11-17T21:03:33Z","labels":[{"id":"MDU6TGFiZWwxNjIxMDMwNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":2190,"reactionGroups":[],"state":"CLOSED","title":"Server capabilities/metadata RPC","updatedAt":"2021-12-20T17:32:56Z","url":"https://github.com/temporalio/temporal/issues/2190"}
