{"assignees":[],"author":{"id":"MDQ6VXNlcjIwNjM5Ng==","is_bot":false,"login":"cretz","name":"Chad Retz"},"body":"**Is your feature request related to a problem? Please describe.**\r\n\r\n`temporal.api.history.v1.WorkflowExecutionStartedEventAttributes.identity` is populated with the client identity when started from a client, but not populated with a value when it's a child workflow.\r\n\r\n**Describe the solution you'd like**\r\n\r\nUse `temporal.api.workflowservice.v1.RespondWorkflowTaskCompletedRequest.identity` for the child workflow identity. SDKs set this as the same identity they set on `temporal.api.workflowservice.v1.StartWorkflowExecutionRequest.identity`. So a top-level workflow and a child-workflow started from the same SDK client will have the same value.","closedAt":null,"comments":[{"id":"IC_kwDODNqesM5AnQX6","author":{"login":"sumit-maurya-maersk"},"authorAssociation":"NONE","body":"Below is the child workflow history. You can clearly  see that `identity=\"\"` for `event id=1` and for other  events is showing `identity=\"MyIdentity\"` that is correct. The issue is only with `event id=1`.\r\n\r\n```json\r\n[\r\n  {\r\n    \"eventId\": \"1\",\r\n    \"eventTime\": \"2022-03-30T05:31:30.480372Z\",\r\n    \"eventType\": \"WorkflowExecutionStarted\",\r\n    \"version\": \"0\",\r\n    \"taskId\": \"1048593\",\r\n    \"workflowExecutionStartedEventAttributes\": {\r\n      \"workflowType\": {\r\n        \"name\": \"SampleChildWorkflow\"\r\n      },\r\n      \"parentWorkflowNamespace\": \"default\",\r\n      \"parentWorkflowExecution\": {\r\n        \"workflowId\": \"parent-workflow_7ec4cd96-0b6f-44a2-b084-e266ccd5f81d\",\r\n        \"runId\": \"09e80459-93ca-4022-8d6b-aa546c71bb94\"\r\n      },\r\n      \"parentInitiatedEventId\": \"5\",\r\n      \"taskQueue\": {\r\n        \"name\": \"child-workflow-continue-as-new\",\r\n        \"kind\": \"Normal\"\r\n      },\r\n      \"input\": {\r\n        \"payloads\": [\r\n          0,\r\n          5\r\n        ]\r\n      },\r\n      \"workflowExecutionTimeout\": \"0s\",\r\n      \"workflowRunTimeout\": \"0s\",\r\n      \"workflowTaskTimeout\": \"10s\",\r\n      \"continuedExecutionRunId\": \"\",\r\n      \"initiator\": \"Unspecified\",\r\n      \"continuedFailure\": null,\r\n      \"lastCompletionResult\": null,\r\n      \"originalExecutionRunId\": \"d48ff871-9016-4d5f-bf12-cf79a72d3a91\",\r\n      \"identity\": \"\",\r\n      \"firstExecutionRunId\": \"d48ff871-9016-4d5f-bf12-cf79a72d3a91\",\r\n      \"retryPolicy\": null,\r\n      \"attempt\": 1,\r\n      \"workflowExecutionExpirationTime\": null,\r\n      \"cronSchedule\": \"\",\r\n      \"firstWorkflowTaskBackoff\": \"0s\",\r\n      \"memo\": null,\r\n      \"searchAttributes\": null,\r\n      \"prevAutoResetPoints\": null,\r\n      \"header\": {\r\n        \"fields\": {}\r\n      }\r\n    },\r\n    \"id\": \"1\",\r\n    \"attributes\": {\r\n      \"type\": \"workflowExecutionStartedEventAttributes\",\r\n      \"workflowType\": {\r\n        \"name\": \"SampleChildWorkflow\"\r\n      },\r\n      \"parentWorkflowNamespace\": \"default\",\r\n      \"parentWorkflowExecution\": {\r\n        \"workflowId\": \"parent-workflow_7ec4cd96-0b6f-44a2-b084-e266ccd5f81d\",\r\n        \"runId\": \"09e80459-93ca-4022-8d6b-aa546c71bb94\"\r\n      },\r\n      \"parentInitiatedEventId\": \"5\",\r\n      \"taskQueue\": {\r\n        \"name\": \"child-workflow-continue-as-new\",\r\n        \"kind\": \"Normal\"\r\n      },\r\n      \"input\": {\r\n        \"payloads\": [\r\n          0,\r\n          5\r\n        ]\r\n      },\r\n      \"workflowExecutionTimeout\": \"0s\",\r\n      \"workflowRunTimeout\": \"0s\",\r\n      \"workflowTaskTimeout\": \"10s\",\r\n      \"continuedExecutionRunId\": \"\",\r\n      \"initiator\": \"Unspecified\",\r\n      \"continuedFailure\": null,\r\n      \"lastCompletionResult\": null,\r\n      \"originalExecutionRunId\": \"d48ff871-9016-4d5f-bf12-cf79a72d3a91\",\r\n      \"identity\": \"\",\r\n      \"firstExecutionRunId\": \"d48ff871-9016-4d5f-bf12-cf79a72d3a91\",\r\n      \"retryPolicy\": null,\r\n      \"attempt\": 1,\r\n      \"workflowExecutionExpirationTime\": null,\r\n      \"cronSchedule\": \"\",\r\n      \"firstWorkflowTaskBackoff\": \"0s\",\r\n      \"memo\": null,\r\n      \"searchAttributes\": null,\r\n      \"prevAutoResetPoints\": null,\r\n      \"header\": {\r\n        \"fields\": {}\r\n      }\r\n    }\r\n  },\r\n  {\r\n    \"eventId\": \"2\",\r\n    \"eventTime\": \"2022-03-30T05:31:30.482071Z\",\r\n    \"eventType\": \"WorkflowTaskScheduled\",\r\n    \"version\": \"0\",\r\n    \"taskId\": \"1048601\",\r\n    \"workflowTaskScheduledEventAttributes\": {\r\n      \"taskQueue\": {\r\n        \"name\": \"child-workflow-continue-as-new\",\r\n        \"kind\": \"Normal\"\r\n      },\r\n      \"startToCloseTimeout\": \"10s\",\r\n      \"attempt\": 1\r\n    },\r\n    \"id\": \"2\",\r\n    \"attributes\": {\r\n      \"type\": \"workflowTaskScheduledEventAttributes\",\r\n      \"taskQueue\": {\r\n        \"name\": \"child-workflow-continue-as-new\",\r\n        \"kind\": \"Normal\"\r\n      },\r\n      \"startToCloseTimeout\": \"10s\",\r\n      \"attempt\": 1\r\n    }\r\n  },\r\n  {\r\n    \"eventId\": \"3\",\r\n    \"eventTime\": \"2022-03-30T05:31:30.483875Z\",\r\n    \"eventType\": \"WorkflowTaskStarted\",\r\n    \"version\": \"0\",\r\n    \"taskId\": \"1048607\",\r\n    \"workflowTaskStartedEventAttributes\": {\r\n      \"scheduledEventId\": \"2\",\r\n      \"identity\": \"MyIdentity\",\r\n      \"requestId\": \"1ef00e16-4310-4eee-bdb3-0b261b93c72a\"\r\n    },\r\n    \"id\": \"3\",\r\n    \"attributes\": {\r\n      \"type\": \"workflowTaskStartedEventAttributes\",\r\n      \"scheduledEventId\": \"2\",\r\n      \"identity\": \"MyIdentity\",\r\n      \"requestId\": \"1ef00e16-4310-4eee-bdb3-0b261b93c72a\"\r\n    }\r\n  },\r\n  {\r\n    \"eventId\": \"4\",\r\n    \"eventTime\": \"2022-03-30T05:31:30.486503Z\",\r\n    \"eventType\": \"WorkflowTaskCompleted\",\r\n    \"version\": \"0\",\r\n    \"taskId\": \"1048612\",\r\n    \"workflowTaskCompletedEventAttributes\": {\r\n      \"scheduledEventId\": \"2\",\r\n      \"startedEventId\": \"3\",\r\n      \"identity\": \"MyIdentity\",\r\n      \"binaryChecksum\": \"ae42ab60b0d4526ee63b5719d3a2d805\"\r\n    },\r\n    \"id\": \"4\",\r\n    \"attributes\": {\r\n      \"type\": \"workflowTaskCompletedEventAttributes\",\r\n      \"scheduledEventId\": \"2\",\r\n      \"startedEventId\": \"3\",\r\n      \"identity\": \"MyIdentity\",\r\n      \"binaryChecksum\": \"ae42ab60b0d4526ee63b5719d3a2d805\"\r\n    }\r\n  },\r\n  {\r\n    \"eventId\": \"5\",\r\n    \"eventTime\": \"2022-03-30T05:31:30.486628Z\",\r\n    \"eventType\": \"WorkflowExecutionContinuedAsNew\",\r\n    \"version\": \"0\",\r\n    \"taskId\": \"1048613\",\r\n    \"workflowExecutionContinuedAsNewEventAttributes\": {\r\n      \"newExecutionRunId\": \"034a7ff8-49dd-421d-961d-62e497c39b88\",\r\n      \"workflowType\": {\r\n        \"name\": \"SampleChildWorkflow\"\r\n      },\r\n      \"taskQueue\": {\r\n        \"name\": \"child-workflow-continue-as-new\",\r\n        \"kind\": \"Normal\"\r\n      },\r\n      \"input\": {\r\n        \"payloads\": [\r\n          1,\r\n          4\r\n        ]\r\n      },\r\n      \"workflowRunTimeout\": \"0s\",\r\n      \"workflowTaskTimeout\": \"10s\",\r\n      \"workflowTaskCompletedEventId\": \"4\",\r\n      \"backoffStartInterval\": null,\r\n      \"initiator\": \"Unspecified\",\r\n      \"failure\": null,\r\n      \"lastCompletionResult\": null,\r\n      \"header\": {\r\n        \"fields\": {}\r\n      },\r\n      \"memo\": null,\r\n      \"searchAttributes\": null\r\n    },\r\n    \"id\": \"5\",\r\n    \"attributes\": {\r\n      \"type\": \"workflowExecutionContinuedAsNewEventAttributes\",\r\n      \"newExecutionRunId\": \"034a7ff8-49dd-421d-961d-62e497c39b88\",\r\n      \"workflowType\": {\r\n        \"name\": \"SampleChildWorkflow\"\r\n      },\r\n      \"taskQueue\": {\r\n        \"name\": \"child-workflow-continue-as-new\",\r\n        \"kind\": \"Normal\"\r\n      },\r\n      \"input\": {\r\n        \"payloads\": [\r\n          1,\r\n          4\r\n        ]\r\n      },\r\n      \"workflowRunTimeout\": \"0s\",\r\n      \"workflowTaskTimeout\": \"10s\",\r\n      \"workflowTaskCompletedEventId\": \"4\",\r\n      \"backoffStartInterval\": null,\r\n      \"initiator\": \"Unspecified\",\r\n      \"failure\": null,\r\n      \"lastCompletionResult\": null,\r\n      \"header\": {\r\n        \"fields\": {}\r\n      },\r\n      \"memo\": null,\r\n      \"searchAttributes\": null\r\n    }\r\n  }\r\n]\r\n```","createdAt":"2022-03-31T03:24:21Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/2687#issuecomment-1084032506","viewerDidAuthor":false}],"createdAt":"2022-03-30T21:28:41Z","labels":[{"id":"MDU6TGFiZWwxNjIxMDMwNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyNTc2NTM1ODQ2","name":"difficulty: easy","description":"","color":"68d662"},{"id":"MDU6TGFiZWwzMTM4ODI4MTE3","name":"up-for-grabs","description":"Issues to consider for external contribution","color":"69CD90"}],"milestone":null,"number":2687,"reactionGroups":[],"state":"OPEN","title":"Populate identity for child workflows","updatedAt":"2023-03-03T20:20:03Z","url":"https://github.com/temporalio/temporal/issues/2687"}
