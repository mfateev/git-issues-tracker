{"assignees":[],"author":{"id":"MDQ6VXNlcjYzMTkzNzU=","is_bot":false,"login":"munir131","name":"Munir Khakhi"},"body":"## Expected Behavior\r\nWorkflowTaskTimeout error should respect the retry policy.\r\n\r\n## Actual Behavior\r\nWe set MaximumAttempts to 1 and when WorkflowTaskTimeout error occurred it keep retrying that workflow for infinite time.\r\n\r\n## Steps to Reproduce the Problem\r\n\r\n  1. Create one workflow with default WorkflowTaskTimeout\r\n  2. Create 100s of child workflow from that workflow.  \r\n\r\n## Specifications\r\n\r\n  - Version: 1.7.0\r\n  - Platform: Docker Alpine\r\n","closedAt":"2021-09-29T11:43:58Z","comments":[{"id":"IC_kwDODNqesM417rPG","author":{"login":"yiminc"},"authorAssociation":"MEMBER","body":"@munir131 , which retry policy are you referring to? Is it activity retry policy or workflow retry policy?\r\nIs it the parent workflow that keeps seeing the workflow task timeout? \r\nCould you share the history events of the failed workflow?\r\nWe don't expect WorkflowTask to fail or timeout. Any failure or timeout in workflow task indicate some kind of bug that should be fixed.\r\nAnd so, it is by design always retied for workflow tasks.\r\nWhat is the use case that you want to stop retrying your workflow task? \r\n","createdAt":"2021-08-24T17:27:10Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1848#issuecomment-904836038","viewerDidAuthor":false},{"id":"IC_kwDODNqesM419IgT","author":{"login":"munir131"},"authorAssociation":"NONE","body":"@yiminc It is workflow retry policy. \r\nYes. Parent workflow keeps seeing workflow task timeout.\r\n\r\n[output.txt](https://github.com/temporalio/temporal/files/7044086/output.txt)\r\n\r\n`What is the use case that you want to stop retrying your workflow task?`\r\nUse case is just to avoid infinite retry. So, it will not block other workflows or will not eat resources. \r\nIf workflow fails then it will be inspect later when we need. Infinite retry creates overloads. \r\n\r\n`We don't expect WorkflowTask to fail or timeout. Any failure or timeout in workflow task indicate some kind of bug that should be fixed.\r\nAnd so, it is by design always retied for workflow tasks.`\r\nDoes that mean that WorkflowTaskTimeout is not respecting workflow retry policy is by design? if it is by design then I will redesign my workflow. If it is a bug then we can continue on this issue.","createdAt":"2021-08-25T06:20:32Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1848#issuecomment-905218067","viewerDidAuthor":false},{"id":"IC_kwDODNqesM41_4PH","author":{"login":"yiminc"},"authorAssociation":"MEMBER","body":"The workflow task is by design always retried. Temporal does not expect workflow task to fail or timeout. Any failure or timeout on workflow task is a strong indication of bug in workflow code. \r\nIf you want to fail the workflow and inspect at a later time and avoid it been retried indefinitely, you can set a shorter workflow run timeout, that way, workflow will be timed out and retry would stop once it is timed out. \r\n\r\nAlso, the retry policy that you set to the workflow apply on workflow level, meaning it is only evaluated when workflow is failed/timed out. If you have retry policy of MaximumAttempts = 1 on workflow, then it won't be retried when workflow failed or timed out. Each retry on workflow would have a new RunID.\r\n\r\nThe workflow task, however, is within a workflow. Workflow task failure does not mean the workflow run is failed. Temporal keeps retrying the workflow task until it succeed or until workflow run timed out.","createdAt":"2021-08-25T23:15:18Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1848#issuecomment-905937863","viewerDidAuthor":false},{"id":"IC_kwDODNqesM43cC9x","author":{"login":"munir131"},"authorAssociation":"NONE","body":"@yiminc Looks like `If you have retry policy of MaximumAttempts = 1 on workflow, then it won't be retried when workflow failed or timed out.` is not true in case of timeout. It keeps the workflow in `Running` state. But, Now I will change my workflow. So, closing this issue.","createdAt":"2021-09-29T11:43:58Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"EYES","users":{"totalCount":1}}],"url":"https://github.com/temporalio/temporal/issues/1848#issuecomment-930099057","viewerDidAuthor":false}],"createdAt":"2021-08-24T10:52:35Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"},{"id":"MDU6TGFiZWwyNzcwMzY2NzYw","name":"close-after-30-days","description":"","color":"1d76db"}],"milestone":null,"number":1848,"reactionGroups":[],"state":"CLOSED","title":"WorkflowTaskTimeout ignores RetryPolicy","updatedAt":"2021-09-29T11:43:58Z","url":"https://github.com/temporalio/temporal/issues/1848"}
