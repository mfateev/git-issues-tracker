{"assignees":[{"id":"MDQ6VXNlcjg0NDExMDE0","login":"yiminc","name":"Yimin Chen","databaseId":0}],"author":{"id":"MDQ6VXNlcjYyMTQ3Mzg2","is_bot":false,"login":"vaclavbroz","name":""},"body":"## Expected Behavior\r\n\r\nTemporal bootstraps Cassandra schema.\r\n\r\n## Actual Behavior\r\n\r\nThe initial schema is created but then the first migration at:\r\nhttps://github.com/temporalio/temporal/blob/30c89b9f91dafc13d2d75fda266d81ce8bc72f3e/schema/cassandra/temporal/versioned/v1.0/schema.cql\r\nfails probably because of syntax: \r\n\r\n```\r\nCREATE TYPE serialized_event_batch (\r\n  encoding_type text,\r\n  version       int,\r\n  data          blob,\r\n);\r\n```\r\nhas one comma at the end while the syntax should be:\r\nhttps://docs.datastax.com/en/cql-oss/3.3/cql/cql_reference/cqlCreateType.html\r\n\r\n## Steps to Reproduce the Problem\r\n\r\n  1. Clone the docker-compose repo version 1.13\r\n  1. Select the Cassandra version in config\r\n  1. Bring it up\r\n\r\n## Specifications\r\n\r\n  - Version: 1.13 docker-compose repo\r\n","closedAt":"2022-02-26T23:59:34Z","comments":[{"id":"IC_kwDODNqesM4-qeeD","author":{"login":"vaclavbroz"},"authorAssociation":"CONTRIBUTOR","body":"```\r\ntemporal                | 2022-02-25T22:16:44.483Z      INFO    Processing schema file: /etc/temporal/schema/cassandra/temporal/versioned/v1.6/cluster_metadata_info.cql   {\"logging-call-at\": \"updatetask.go:232\"}\r\ntemporal                | 2022-02-25T22:16:44.483Z      DEBUG   ---- Executing updates for version 1.0 ----     {\"logging-call-at\": \"updatetask.go:150\"}\r\ntemporal                | 2022-02-25T22:16:44.483Z      DEBUG   CREATE TYPE serialized_event_batch (encoding_type text,version int,data blob,);    {\"logging-call-at\": \"updatetask.go:152\"}\r\ntemporal                | 2022-02-25T22:16:44.552Z      ERROR   Unable to update CQL schema.    {\"error\": \"error executing statement:line 1:92 no viable alternative at input ') (... (encoding_type text,version       int,data          blob,)...)\", \"logging-call-at\": \"handler.go:82\"}\r\nt\r\n```","createdAt":"2022-02-25T22:30:53Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/2551#issuecomment-1051322243","viewerDidAuthor":false},{"id":"IC_kwDODNqesM4-qhZ2","author":{"login":"yiminc"},"authorAssociation":"MEMBER","body":"I have never encounter this issue. What version of Cassandra are you using?","createdAt":"2022-02-25T22:49:44Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/2551#issuecomment-1051334262","viewerDidAuthor":false},{"id":"IC_kwDODNqesM4-qhxf","author":{"login":"vaclavbroz"},"authorAssociation":"CONTRIBUTOR","body":"Azure CosmoDB Cassandra API. But it's inline with the specs see above, there should not be any trailing comma in the list of fields.","createdAt":"2022-02-25T22:52:29Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/2551#issuecomment-1051335775","viewerDidAuthor":false}],"createdAt":"2022-02-25T22:30:12Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"}],"milestone":null,"number":2551,"reactionGroups":[],"state":"CLOSED","title":"Cassandra schema bootstrap fails when applying the migration 1.0 to the intial schema","updatedAt":"2022-02-26T23:59:34Z","url":"https://github.com/temporalio/temporal/issues/2551"}
