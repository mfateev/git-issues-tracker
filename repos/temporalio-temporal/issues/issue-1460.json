{"assignees":[],"author":{"id":"MDQ6VXNlcjE0NjM2MjI=","is_bot":false,"login":"mfateev","name":"Maxim Fateev"},"body":"**Is your feature request related to a problem? Please describe.**\r\nCurrently, there is no way to query a specific worker for information as queries are always related to workflow execution. For example it is not possible to query a worker for activity types it supports.\r\n\r\n**Describe the solution you'd like**\r\nAdd `task queue` query concept. Such a query specifies a task queue name to send the query to. Then a worker picks it up and replies using a new API like `RespondTaskQueueQueryCompleted`.\r\n\r\n**Additional context**\r\nThis would support the ability to query for registered activity and workflow types, worker configuration options as well as execute activities synchronously. \r\n\r\nhttps://community.temporal.io/t/list-registered-activities/1927\r\n","closedAt":null,"comments":[{"id":"MDEyOklzc3VlQ29tbWVudDgyOTQ0MjE0MQ==","author":{"login":"ilmn-aeolus"},"authorAssociation":"NONE","body":"We are exploring a design where third parties would provide activity workers by running our activity daemon that communicates to a pre-configured, party-specific namespace. This feature would allow our central service to monitor whether third-parties have active workers. ","createdAt":"2021-04-29T17:14:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1460#issuecomment-829442141","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDgyOTQ0MzA5MA==","author":{"login":"ilmn-aeolus"},"authorAssociation":"NONE","body":"Also, does this ticket service https://community.temporal.io/t/ability-to-inspect-task-queues/1765 ?","createdAt":"2021-04-29T17:15:42Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1460#issuecomment-829443090","viewerDidAuthor":false},{"id":"IC_kwDODNqesM426nym","author":{"login":"swyxio"},"authorAssociation":"CONTRIBUTOR","body":"discussing with Samar an alternative name for this is \"worker queries\" \r\n\r\n- \"interceptor for starting a workflow\" for input validation before starting a workflow \r\n- we think we can implement worker queries first, THEN synchronous start https://github.com/temporalio/temporal/issues/804","createdAt":"2021-09-16T23:45:48Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1460#issuecomment-921336998","viewerDidAuthor":false},{"id":"IC_kwDODNqesM47bp5k","author":{"login":"jlegrone"},"authorAssociation":"CONTRIBUTOR","body":"> This would support the ability to query for registered activity and workflow types\r\n\r\nWe do something like this internally, inspired by the [GRPC server reflection protocol](https://github.com/grpc/grpc/blob/master/doc/server-reflection.md). Our \"reflection\" service is just a Temporal workflow type that each of our workers exposes. The reflection workflow is automatically registered and implemented via our worker package, but if this were moved upstream each language SDK could probably do the same.\r\n\r\nInternally we also use protobuf to define workflow/activity/signal/query interfaces, so we expose the message descriptors for those payloads as well. This is the full reflection interface:\r\n\r\n```proto\r\nmessage MessageDescriptor {\r\n    // Serialized message descriptor. We avoid taking a dependency on\r\n    // descriptor.proto, which uses proto2 only features, by making this opaque\r\n    // bytes instead.\r\n    //\r\n    // Source: https://github.com/protocolbuffers/protobuf/blob/c57ee04cf32274681f45a0c0acb35e8605fff9e7/src/google/protobuf/descriptor.proto#L93-L126\r\n    bytes message_descriptor_proto = 1;\r\n}\r\n\r\nmessage SignalType {\r\n    string name = 1;\r\n    // A description of the signal.\r\n    string doc = 2;\r\n    MessageDescriptor payload_type = 3;\r\n}\r\n\r\nmessage QueryType {\r\n    string name = 1;\r\n    // A description of the query.\r\n    string doc = 2;\r\n    MessageDescriptor request_type = 3;\r\n    MessageDescriptor response_type = 4;\r\n}\r\n\r\nmessage WorkflowType {\r\n    string name = 1;\r\n    // A description of the workflow.\r\n    string doc = 2;\r\n    temporal.StartWorkflowOptions default_options = 3;\r\n    MessageDescriptor request_type = 4;\r\n    MessageDescriptor response_type = 5;\r\n    repeated SignalType signals = 6;\r\n    repeated QueryType queries = 7;\r\n}\r\n\r\nmessage ActivityType {\r\n    string name = 1;\r\n    // A description of the activity.\r\n    string doc = 2;\r\n    temporal.ActivityOptions default_options = 3;\r\n    MessageDescriptor request_type = 4;\r\n    MessageDescriptor response_type = 5;\r\n}\r\n\r\nmessage ReflectResponse {\r\n    repeated WorkflowType workflows = 1;\r\n    repeated ActivityType activities = 2;\r\n}\r\n\r\n// The `Reflection` interface is exposed by every worker on its own task queue.\r\n// This allows external systems to query the list of workflows, activities,\r\n// signals, and queries supported on any task queue.\r\n//\r\n// To use the Reflection service, the client should send a request to execute\r\n// the Reflect workflow on the target task queue. If the worker listening on\r\n// the task queue has enabled Reflection, it will respond with a list of\r\n// available workflows and activities.\r\nservice Reflection {\r\n    // Reflect returns a list of workflows and activities registered on the current task queue.\r\n    rpc Reflect(google.protobuf.Empty) returns (ReflectResponse) {\r\n        option (temporal.workflow).config = {};\r\n    };\r\n}\r\n```\r\n\r\n","createdAt":"2021-12-18T00:24:17Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1460#issuecomment-997105252","viewerDidAuthor":false},{"id":"IC_kwDODNqesM47bqZs","author":{"login":"jlegrone"},"authorAssociation":"CONTRIBUTOR","body":"> Add `task queue` query concept. Such a query specifies a task queue name to send the query to. Then a worker picks it up and replies using a new API like `RespondTaskQueueQueryCompleted`.\r\n\r\nWhat does a new API provide vs. a pre-defined workflow type?","createdAt":"2021-12-18T00:33:42Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1460#issuecomment-997107308","viewerDidAuthor":false},{"id":"IC_kwDODNqesM48O-AB","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"We should consider supporting querying each worker separately so we can compare that they're all the same version and contain the same set of workflows and activities.","createdAt":"2022-01-12T02:05:09Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1460#issuecomment-1010556929","viewerDidAuthor":false},{"id":"IC_kwDODNqesM5inaXn","author":{"login":"mdross95"},"authorAssociation":"NONE","body":"Any update with this?","createdAt":"2023-07-27T20:14:27Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1460#issuecomment-1654498791","viewerDidAuthor":false},{"id":"IC_kwDODNqesM5-Hcia","author":{"login":"JacobJae"},"authorAssociation":"NONE","body":"Any update on this?","createdAt":"2024-05-16T18:02:31Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1460#issuecomment-2115881114","viewerDidAuthor":false},{"id":"IC_kwDODNqesM6CDaID","author":{"login":"skyf0cker"},"authorAssociation":"NONE","body":"Any update on this? ","createdAt":"2024-06-21T03:24:58Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1460#issuecomment-2181931523","viewerDidAuthor":false},{"id":"IC_kwDODNqesM6Nm3lE","author":{"login":"alexseedkou"},"authorAssociation":"CONTRIBUTOR","body":"I was wondering if anyone has taken this. If not, Iâ€™m happy to work on it.","createdAt":"2024-09-26T03:23:42Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":5}}],"url":"https://github.com/temporalio/temporal/issues/1460#issuecomment-2375776580","viewerDidAuthor":false},{"id":"IC_kwDODNqesM7CG-aE","author":{"login":"mfateev"},"authorAssociation":"MEMBER","body":"This is being solved differently by running a per-process Nexus service endpoint. ","createdAt":"2025-09-05T00:33:31Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"url":"https://github.com/temporalio/temporal/issues/1460#issuecomment-3256608388","viewerDidAuthor":true}],"createdAt":"2021-04-14T17:42:05Z","labels":[{"id":"MDU6TGFiZWwxNjIxMDMwNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMDE5OTIzNjU1","name":"devexp","description":"","color":"9350b7"},{"id":"MDU6TGFiZWwyNTc2NTM3NTI4","name":"difficulty: medium","description":"","color":"ffaf11"},{"id":"MDU6TGFiZWwyODE3MDk3ODQ0","name":"planning","description":"","color":"006b75"},{"id":"MDU6TGFiZWwzMTM4ODI4MTE3","name":"up-for-grabs","description":"Issues to consider for external contribution","color":"69CD90"}],"milestone":null,"number":1460,"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":16}},{"content":"EYES","users":{"totalCount":2}}],"state":"OPEN","title":"Add task queue query","updatedAt":"2025-09-05T00:33:32Z","url":"https://github.com/temporalio/temporal/issues/1460"}
