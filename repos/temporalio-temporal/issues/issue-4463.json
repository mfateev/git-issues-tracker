{"assignees":[],"author":{"id":"MDQ6VXNlcjc2OTc0ODQ=","is_bot":false,"login":"taonic","name":"Tao Guo"},"body":"**Is your feature request related to a problem? Please describe.**\r\nCurrently, if a query task is delivered to a worker through a normal queue, the [event history](https://github.com/temporalio/api/blob/cfa1a15b960920a47de8ec272873a4ee4db574c4/temporal/api/workflowservice/v1/request_response.proto#L269) is discarded after handling the query task since [RespondQueryTaskCompletedRequest](https://github.com/temporalio/api/blob/master/temporal/api/workflowservice/v1/request_response.proto#L794-L801) does not carry any [sticky attributes](https://github.com/temporalio/api/blob/master/temporal/api/workflowservice/v1/request_response.proto#L301).\r\n\r\nFor query heavy workflows with large history, especially when codec is involved, discarding the payload seems to be wasteful, and paying latency penalty unnecessarily.\r\n\r\n**Describe the solution you'd like**\r\nI'd like to see sticky attributes to be added to RespondQueryTaskCompletedRequest or in any other ways to cache the event history on worker in order to handle subsequent queries more efficiently.","closedAt":null,"comments":[{"id":"IC_kwDODNqesM5ghTEB","author":{"login":"taonic"},"authorAssociation":"MEMBER","body":"Just realized one workaround of the issue is to set a repeating Workflow timer with a short enough interval for reviving the workflow, which in turn rehydrates the cache and re-establishes the sticky queue.","createdAt":"2023-07-04T01:45:39Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/4463#issuecomment-1619341569","viewerDidAuthor":false}],"createdAt":"2023-06-09T01:47:23Z","labels":[{"id":"MDU6TGFiZWwxNjIxMDMwNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":4463,"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"state":"OPEN","title":"Cache event history from query tasks","updatedAt":"2023-07-04T01:45:40Z","url":"https://github.com/temporalio/temporal/issues/4463"}
