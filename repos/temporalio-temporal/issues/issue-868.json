{"assignees":[{"id":"MDQ6VXNlcjg3NjI4OTM=","login":"wxing1292","name":"Wenquan Xing","databaseId":0}],"author":{"id":"MDQ6VXNlcjYyNjgxNA==","is_bot":false,"login":"serhii-samoilenko","name":"Serhii Samoilenko"},"body":"I tried to perform a db scan with tctl on the Cassandra:\r\n`tctl adm db scan --db_address temporal-cassandra.temporal --db_port 9042`\r\n\r\n## Expected Behavior\r\nSuccessful completion of the scan\r\n\r\n## Actual Behavior\r\nGot message:\r\n```\r\nscan results located under:  ./scan_1602836287\r\n{\r\n        \"NumberOfShardsFinished\": 1,\r\n        \"TotalExecutionsCount\": 0,\r\n        \"CorruptedExecutionsCount\": 0,\r\n        \"ExecutionCheckFailureCount\": 0,\r\n        \"NumberOfShardScanFailures\": 0,\r\n        \"PercentageCorrupted\": 0,\r\n        \"PercentageCheckFailure\": 0,\r\n        \"Rates\": {\r\n                \"TimeRunning\": \"7.684172ms\",\r\n                \"DatabaseRPS\": 130,\r\n                \"TotalDBRequests\": 1,\r\n                \"ShardsPerHour\": 468406,\r\n                \"ExecutionsPerHour\": 0\r\n        },\r\n        \"CorruptionTypeBreakdown\": {\r\n                \"TotalHistoryMissing\": 0,\r\n                \"TotalInvalidFirstEvent\": 0,\r\n                \"TotalOpenExecutionInvalidCurrentExecution\": 0,\r\n                \"PercentageHistoryMissing\": 0,\r\n                \"PercentageInvalidStartEvent\": 0,\r\n                \"PercentageOpenExecutionInvalidCurrentExecution\": 0\r\n        },\r\n        \"ShardExecutionCountsDistribution\": {\r\n                \"MinExecutions\": null,\r\n                \"MaxExecutions\": null,\r\n                \"AverageExecutions\": 0\r\n        }\r\n}\r\npanic: runtime error: invalid memory address or nil pointer dereference\r\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x30 pc=0x133dbde]\r\ngoroutine 752 [running]:\r\ngo.temporal.io/server/common/persistence/cassandra.(*cassandraPersistence).ListConcreteExecutions(0xc00093a090, 0xc000914da0, 0xc0000483a0, 0x0, 0x0)\r\n        /temporal/common/persistence/cassandra/cassandraPersistence.go:1881 +0x24e\r\ngo.temporal.io/server/tools/cli.scanShard(0xc00067c380, 0x1, 0xc00082f380, 0xc000643f40, 0x1f4, 0x211b780, 0x2f8a208, 0x2110560, 0xc0005cb540, 0xc0008426e0, ...)\r\n        /temporal/tools/cli/adminDBScanCommand.go:316 +0x78c\r\ngo.temporal.io/server/tools/cli.AdminDBScan.func1(0x0, 0x4000, 0xc0003ec3d8, 0xc000889a40, 0xc00067c380, 0xc00082f380, 0xc000643f40, 0x1f4, 0x211b780, 0x2f8a208, ...)\r\n        /temporal/tools/cli/adminDBScanCommand.go:246 +0xfb\r\ncreated by go.temporal.io/server/tools/cli.AdminDBScan\r\n        /temporal/tools/cli/adminDBScanCommand.go:243 +0x53f\r\n```\r\n\r\n## Steps to Reproduce the Problem\r\n\r\n  1. Run the `tctl adm db scan` command\r\n\r\n## Specifications\r\n\r\n  - Version: 1.0.0, 0.29.0\r\n  - Platform: k8s\r\n","closedAt":"2020-10-16T19:23:09Z","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDcxMDQ2OTczNw==","author":{"login":"wxing1292"},"authorAssociation":"CONTRIBUTOR","body":"fix merged, will be part of the next release","createdAt":"2020-10-16T19:23:09Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/868#issuecomment-710469737","viewerDidAuthor":false}],"createdAt":"2020-10-16T08:46:55Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"}],"milestone":null,"number":868,"reactionGroups":[],"state":"CLOSED","title":"tctl admin db scan fails with panic / segmentation violation","updatedAt":"2020-10-16T19:23:09Z","url":"https://github.com/temporalio/temporal/issues/868"}
