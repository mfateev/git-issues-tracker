{"assignees":[],"author":{"id":"MDQ6VXNlcjUzMjEwOA==","is_bot":false,"login":"Spikhalskiy","name":"Dmitry Spikhalsky"},"body":"## Expected Behavior\r\n\r\nFrom the API doc:\r\n```\r\n// RequestCancelWorkflowExecution is called by workers when they want to request the cancellation of\r\n// a workflow execution.\r\n//\r\n// This result in a new `WORKFLOW_EXECUTION_CANCEL_REQUESTED` event being written to the\r\n// workflow history and a new workflow task created for the workflow. Fails with `NotFound` if\r\n// the workflow is already completed or doesn't exist.\r\nrpc RequestCancelWorkflowExecution (RequestCancelWorkflowExecutionRequest) returns (RequestCancelWorkflowExecutionResponse) {\r\n}\r\n```\r\n\r\nAlso, JavaSDK docstring on `#cancel` states:\r\n\r\n```\r\n@throws WorkflowNotFoundException if the workflow execution doesn't exist or is already completed\r\n```\r\n\r\nI would expect a cancel request for a workflow that is already finished with any status.\r\n\r\n*I personally prefer a cancel request to workflows with CANCELLED status to be successful. But this is not aligned with the doc and it is also not aligned with `terminate` behavior. Terminate request to a terminated workflow currently fails.*\r\n\r\n## Actual Behavior\r\n\r\n`RequestCancelWorkflowExecution` call for a successfully completed workflow returns OK no matter what, not following the documentation of the method.\r\n\r\n## Specifications\r\n\r\n  - Version: master@ 7d4265457a27a630d8f4400c85188b185ca91d7d\r\n","closedAt":"2022-05-28T17:20:26Z","comments":[{"id":"IC_kwDODNqesM5Dkhsf","author":{"login":"yiminc"},"authorAssociation":"MEMBER","body":"This is expected behavior. There is major difference between terminate and cancel. For terminate, it is a forceful operation, but for cancel it is a request thus the name RequestCancelWorkflowExecution. \r\nWe need to update the doc.","createdAt":"2022-05-21T15:03:02Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/2860#issuecomment-1133648671","viewerDidAuthor":false},{"id":"IC_kwDODNqesM5DkmsH","author":{"login":"Spikhalskiy"},"authorAssociation":"CONTRIBUTOR","body":"@yiminc It depends on how you look at it. Yes, it's a Request. But if a workflow is already in a state that doesn't allow a cancellation (like completed), it's more expressive to return an error. A user/SDK can always ignore/swallow this error, but it gives more information. \r\nOn the contrary, not throwing simplifies the contract and highlights that cancellation is very much \"best-effort\".\r\nI will update JavaSDK docs after the server does if it's the route we want to approach it.","createdAt":"2022-05-21T16:58:12Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/2860#issuecomment-1133669127","viewerDidAuthor":false},{"id":"IC_kwDODNqesM5D95tN","author":{"login":"yiminc"},"authorAssociation":"MEMBER","body":"The behavior is correct, the issue with with incorrect doc. Both API doc and method comments are updated to reflect the actual behavior.","createdAt":"2022-05-28T17:20:26Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/2860#issuecomment-1140300621","viewerDidAuthor":false}],"createdAt":"2022-05-17T21:20:09Z","labels":[{"id":"MDU6TGFiZWwxNjIxMDMwNzg0","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":2860,"reactionGroups":[],"state":"CLOSED","title":"An attempt to cancel a workflow that is completed returns without an error","updatedAt":"2022-05-28T17:20:26Z","url":"https://github.com/temporalio/temporal/issues/2860"}
