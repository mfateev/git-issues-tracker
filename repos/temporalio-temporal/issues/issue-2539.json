{"assignees":[{"id":"MDQ6VXNlcjYzNTAzMDE=","login":"jbreiding","name":"Jeremy","databaseId":0}],"author":{"id":"MDQ6VXNlcjY3NjQ5NTc=","is_bot":false,"login":"swyxio","name":"swyx.io"},"body":"## Expected Behavior\r\n\r\nWhen I [run `docker-compose up` in Gitpod](https://gitpod.io/#https://github.com/temporalio/samples-typescript/) with Temporal v1.13, Temporal (with auto-setup) starts up properly. I rely on this behavior for teaching Temporal.\r\n\r\n## Actual Behavior\r\n\r\nWhen I do the same thing with Temporal v1.14 and 1.15, Temporal fails to auto-setup properly, because running `tctl cluster health` now returns this error\r\n\r\n```\r\nError: Unable to get \"temporal.api.workflowservice.v1.WorkflowService\" health check status.\r\nError Details: rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp: lookup temporal on 127.0.0.11:53: no such host\"\r\n```\r\n\r\nThis error doesn't happen when I run `docker-compose up` on my local desktop, which leads me to suspect that this is a networking dependency that was changed between v1.13 and 1.14\r\n\r\n\r\n## Steps to Reproduce the Problem\r\n\r\n  1. Run https://gitpod.io/#https://github.com/temporalio/samples-typescript/ with Temporal v1.14 or v1.15 (you need to edit it locally since i'll pin it to v1.13 for now) and observe that Temporal Server does not start properly.","closedAt":"2022-03-02T08:11:53Z","comments":[{"id":"IC_kwDODNqesM4-lvZ3","author":{"login":"swyxio"},"authorAssociation":"CONTRIBUTOR","body":"Quick video bug report to elaborate the above: https://www.loom.com/share/a3126a935c3c4039b8696121e41f9fd5","createdAt":"2022-02-24T17:20:46Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/2539#issuecomment-1050080887","viewerDidAuthor":false},{"id":"IC_kwDODNqesM4-qmoA","author":{"login":"jbreiding"},"authorAssociation":"CONTRIBUTOR","body":"@sw-yx \r\nport 53 is dns, this is likely something with gitpod not temporal.\r\n\r\n```\r\nError: Unable to get \"temporal.api.workflowservice.v1.WorkflowService\" health check status.\r\nError Details: rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing dial tcp: lookup temporal on 127.0.0.11:53: no such host\"\r\n```","createdAt":"2022-02-25T23:21:23Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/2539#issuecomment-1051355648","viewerDidAuthor":false},{"id":"IC_kwDODNqesM4-3UYO","author":{"login":"swyxio"},"authorAssociation":"CONTRIBUTOR","body":"my thinking is that the change between v1.13 and v1.14 (which i can consistently replicate) is behavior that is being broken somehow and if it affects gitpod it probably affects other networking setup - still have to figure out what it is.","createdAt":"2022-02-28T21:37:06Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/2539#issuecomment-1054688782","viewerDidAuthor":false},{"id":"IC_kwDODNqesM4-3yUB","author":{"login":"jbreiding"},"authorAssociation":"CONTRIBUTOR","body":"The error message is around failing to lookup the host `temporal` and the local dns service responding with no host.\r\nIt's entirely possible the containers are not connected to the same network that would allow for that dns resolution to happen.\r\n\r\nI suppose its possible the docker-compose file that is being used changed between those versions.","createdAt":"2022-02-28T23:26:31Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/2539#issuecomment-1054811393","viewerDidAuthor":false},{"id":"IC_kwDODNqesM4--VaW","author":{"login":"swyxio"},"authorAssociation":"CONTRIBUTOR","body":"i am taking a [working docker-compose](https://github.com/temporalio/samples-typescript/blob/main/docker-compose.yml) file and only thing i am doing is changing the temporal version number up to 1.14 or 1.15 and that breaks it. i dont know what else to do but at this point happy to just stop at 1.13 indefinitely until this becomes a real problem. appreciate the time.","createdAt":"2022-03-02T08:11:53Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/2539#issuecomment-1056528022","viewerDidAuthor":false},{"id":"IC_kwDODNqesM4_AiqM","author":{"login":"jbreiding"},"authorAssociation":"CONTRIBUTOR","body":"I am not familiar with gitpod enough to help deeper.\r\nBut to dive further into this I would suggest trying to resolve the name temporal from a `shell` from the auto-setup container on gitpod.\r\n\r\nyou can ping, openssl connect, dig, or nslookup if it's available.\r\n\r\nwith local docker you can inspect the attached network of the containers to see the connected ips and the names the can be resolved with.","createdAt":"2022-03-02T16:15:10Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HEART","users":{"totalCount":1}}],"url":"https://github.com/temporalio/temporal/issues/2539#issuecomment-1057106572","viewerDidAuthor":false}],"createdAt":"2022-02-24T17:17:05Z","labels":[],"milestone":null,"number":2539,"reactionGroups":[],"state":"CLOSED","title":"Regression in/undocumented networking changes between Temporal v1.13 and 1.14","updatedAt":"2022-03-02T16:15:29Z","url":"https://github.com/temporalio/temporal/issues/2539"}
