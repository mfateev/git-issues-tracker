{"assignees":[{"id":"MDQ6VXNlcjM4MjU3MTY=","login":"mindaugasrukas","name":"Mind.R.","databaseId":0}],"author":{"id":"MDQ6VXNlcjYwMDQ5MjU3","is_bot":false,"login":"Soneca-ii","name":""},"body":"Hi,\r\n\r\nI'm trying to move from a manual setup of my chart with a dependency to Temporal.io to a more automatic procedure.\r\n\r\nUsing manual helm installation I manage to install it ok ( takes some time ) but using terraform and the same config it fails:\r\n\r\n```\r\nNAME                                       READY   STATUS     RESTARTS   AGE\r\ninf-temporal-web-54d76548d6-wf672          1/1     Running    0          60m\r\ninf-temporal-admintools-584c7c48bb-bc698   1/1     Running    0          60m\r\ninf-cassandra-0                            1/1     Running    0          60m\r\ninf-temporal-history-7d5b8998d6-zwc9l      0/1     Init:2/4   0          60m\r\ninf-temporal-frontend-79694ff665-lgrfz     0/1     Init:2/4   0          60m\r\ninf-temporal-worker-59f68f8cdf-bg7hh       0/1     Init:2/4   0          60m\r\ninf-temporal-matching-7f64fdb5db-gbjhx     0/1     Init:2/4   0          60m\r\n```\r\n\r\nI'm not sure if this is the correct place since I cannot find an official repo for the chart ( if there i would welcome some help ).\r\nI know it fails to try to evaluate the schema in Cassandra but I cannot find any log that can help evaluate the situation\r\n\r\nThe terraform config:\r\n\r\n```\r\nprovider \"kubernetes\" {\r\n config_path = \"~/.kube/config\"\r\n}\r\n\r\nprovider \"helm\" {\r\n  kubernetes {\r\n    config_path = \"~/.kube/config\"\r\n  }\r\n  debug = true\r\n}\r\n\r\n\r\nresource \"kubernetes_namespace\" \"create-namespace\" {\r\n  metadata {\r\n   name = \"inf\"\r\n  }\r\n}\r\n\r\nresource \"helm_release\" \"inf\" {\r\n  name       = \"inf\"\r\n  repository = \"https://armory.jfrog.io/artifactory/charts/\"\r\n  chart      = \"temporal\"\r\n  namespace  = \"inf\"\r\n  values = [\r\n    file(\"file.yaml\")\r\n  ]\r\n\r\n}\r\n```\r\n\r\nThe additional file:\r\n\r\n```\r\n  server:\r\n    replicaCount: 1\r\n  cassandra:\r\n    config:\r\n      cluster_size: 1\r\n  prometheus:\r\n    enabled: false\r\n  grafana:\r\n    enabled: false\r\n  elasticsearch:\r\n    enabled: false\r\n```","closedAt":"2022-11-21T17:18:33Z","comments":[{"id":"IC_kwDODNqesM5OR62L","author":{"login":"Soneca-ii"},"authorAssociation":"NONE","body":"Is there some sort of workaround that can be used at the moment?","createdAt":"2022-11-14T09:00:11Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/3550#issuecomment-1313320331","viewerDidAuthor":false},{"id":"IC_kwDODNqesM5OqRqS","author":{"login":"Soneca-ii"},"authorAssociation":"NONE","body":"update with a workaround:\r\n\r\nuse \"wait = false\" in the helm_release resource to avoid blocking and failing temporal instalation\r\n","createdAt":"2022-11-18T08:43:45Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/3550#issuecomment-1319705234","viewerDidAuthor":false},{"id":"IC_kwDODNqesM5Ot9lf","author":{"login":"mindaugasrukas"},"authorAssociation":"CONTRIBUTOR","body":"Official Temporal Helm Charts repository: https://github.com/temporalio/helm-charts\r\n\r\nCould you provide more details about what you mean by `using terraform it fails`? Does it fail the terraform command, or does it fail to launch Helm chart?\r\n\r\nIf Terraform command is failing, I suggest configuring these flags:\r\n```\r\nresource \"helm_release\" \"inf\" {\r\n    wait_for_jobs = true\r\n    timeout = 300\r\n    ...\r\n}\r\n```\r\n\r\nAs an alternative, you can skip waiting for jobs, as mentioned in the workaround solution.","createdAt":"2022-11-18T23:57:19Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/temporal/issues/3550#issuecomment-1320671583","viewerDidAuthor":false},{"id":"IC_kwDODNqesM5OyDOC","author":{"login":"Soneca-ii"},"authorAssociation":"NONE","body":"The validations to start temporal pod fails. Using the configuration on the initial submission requires 4 initial validations to enable the pod to start. It fails after the second one is validated and remains stuck ( without the flag ) .\r\n\r\nWhat is observed is the information in the first post:\r\n\r\n\r\ninf-temporal-history-7d5b8998d6-zwc9l      0/1     Init:2/4   0          60m\r\ninf-temporal-frontend-79694ff665-lgrfz     0/1     Init:2/4   0          60m\r\ninf-temporal-worker-59f68f8cdf-bg7hh       0/1     Init:2/4   0          60m\r\ninf-temporal-matching-7f64fdb5db-gbjhx     0/1     Init:2/4   0          60m\r\n\r\n\r\nAfter this no matter the time spent it will never advance nor give meaningful logs if the pod initialization logs are evaluated.\r\n\r\nThis request can be closed since the workaround works well and I'm able to configure automatically temporal.","createdAt":"2022-11-21T09:18:45Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/3550#issuecomment-1321743234","viewerDidAuthor":false},{"id":"IC_kwDODNqesM5O0j0e","author":{"login":"mindaugasrukas"},"authorAssociation":"CONTRIBUTOR","body":"Thank you for the context. We are closing this issue.","createdAt":"2022-11-21T17:18:33Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/3550#issuecomment-1322401054","viewerDidAuthor":false}],"createdAt":"2022-11-02T09:59:48Z","labels":[{"id":"LA_kwDODNqesM8AAAABGnQ9aA","name":"P1","description":"","color":"B60205"}],"milestone":null,"number":3550,"reactionGroups":[],"state":"CLOSED","title":"failing to install temporal chart using terraform","updatedAt":"2022-11-21T17:18:33Z","url":"https://github.com/temporalio/temporal/issues/3550"}
