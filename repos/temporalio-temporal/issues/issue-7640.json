{"assignees":[],"author":{"id":"MDQ6VXNlcjMzNzMxODE2","is_bot":false,"login":"SakshiMehta","name":""},"body":"## Expected Behavior\nWe are setting up multi-cluster replication in Temporal, which involves configuring clusterMetadata and setting the rpcAddress for each remote cluster. In our setup, we want to explicitly specify the passthrough:/// prefix in the rpcAddress, so the gRPC client uses the passthrough resolver behavior intentionally.\n\nThis is a valid gRPC URI format supported by grpc-go, and we expect Temporal to handle addresses with the passthrough:/// prefix in clusterInformation.rpcAddress without issue.\n\n## Actual Behavior\nWhen the rpcAddress is set to a value like passthrough:///host:port, operations that use this value — such as temporal operator cluster upsert — it still goes to default dns resolver\n\nWe think this is happening because the implementation of CreateRemoteFrontendGRPCConnection uses net.SplitHostPort to extract the hostname from the rpcAddress.\nWe observed that using the same prefix was working for temporal health command because it was not splitting the URI\nRelevant code snippet from Temporal:\n\n```\nhostname, _, err2 := net.SplitHostPort(rpcAddress)\nif err2 != nil {\n    d.logger.Fatal(\"Invalid rpcAddress for remote cluster\", tag.Error(err2))\n}\n```\nThe net.SplitHostPort function expects a basic host:port format and fails when the address includes a URI-style scheme like passthrough:///.\n\n## Steps to Reproduce the Problem\nRun `temporal operator cluster upsert` to connect to the remote cluster using address as `passthrough:///host:port`\n\nThe operation still resolves to default dns","closedAt":null,"comments":[{"id":"IC_kwDODNqesM6podWv","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"FTR the code is located here:\n\nhttps://github.com/temporalio/temporal/blob/bb507313febe5a2cb509f5aa46918d9587b086f4/common/rpc/rpc.go#L218.\n\nI'm not sure what other locations in the code would need to change to accept `passthrough:///` URLs.\nWe won't prioritize this work in the immediate future but would be happy to accept a contribution.","createdAt":"2025-05-01T23:02:27Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/7640#issuecomment-2845955503","viewerDidAuthor":false},{"id":"IC_kwDODNqesM6q1Gnj","author":{"login":"SakshiMehta"},"authorAssociation":"NONE","body":"Created a [PR](https://github.com/temporalio/temporal/pull/7744), please review","createdAt":"2025-05-09T10:35:09Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/7640#issuecomment-2866047459","viewerDidAuthor":false},{"id":"IC_kwDODNqesM6rfjlA","author":{"login":"SakshiMehta"},"authorAssociation":"NONE","body":"@bergundy please review the changes for supporting url with prefix ","createdAt":"2025-05-13T16:21:13Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/7640#issuecomment-2877176128","viewerDidAuthor":false}],"createdAt":"2025-04-22T06:22:16Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"}],"milestone":null,"number":7640,"reactionGroups":[],"state":"OPEN","title":"Unable to use passthrough:/// prefix in temporal operator command","updatedAt":"2025-05-13T16:21:14Z","url":"https://github.com/temporalio/temporal/issues/7640"}
