{"assignees":[],"author":{"id":"MDQ6VXNlcjQ2MjY1NDc4","is_bot":false,"login":"kennedyjustin","name":"Justin Kennedy"},"body":"## Expected Behavior\r\n\r\nWorkflowIds should be orthogonal to TaskQueues\r\n\r\n## Actual Behavior\r\n\r\nI couldn't get pollers to pick up a workflow or activity task unless I prefixed my WorkflowId with the task queue.\r\n\r\nMy apologies if this is in the docs somewhere.\r\n\r\n## Steps to Reproduce the Problem\r\n\r\nI created a workflow with a Singleton WorkflowId:\r\n\r\n```\r\nworkflowOptions := client.StartWorkflowOptions{\r\n\tID:           \"custodian\", // Idempotent\r\n\tTaskQueue:    \"aura\",\r\n}\r\n```\r\n\r\nAnd the task never got picked up by workers on the \"aura\" task queue.\r\n\r\nSimilarly with `tctl`:\r\n\r\n```\r\ntctl wf run --tq aura --wt CustodianWorkflow -w custodian\r\nRunning execution:\r\n  Workflow Id : custodian                             \r\n  Run Id      : 5aa70a40-2bd1-40ec-a2a2-c76f523676bc  \r\n  Type        : CustodianWorkflow                     \r\n  Namespace   : default                               \r\n  Task Queue  : aura                                  \r\n  Args        : []                                    \r\nProgress:\r\n  1, 2022-05-23T23:45:06Z, WorkflowExecutionStarted\r\n  2, 2022-05-23T23:46:00Z, WorkflowTaskScheduled\r\n\r\nTime elapse: 12s\r\n```\r\n^ It never gets picked up\r\n\r\nProof I had workers registered:\r\n```\r\ntctl tq desc --tq aura\r\nWORKFLOW POLLER IDENTITY |   LAST ACCESS TIME    \r\n1@aebc5c1b01d1@          | 2022-05-25T18:35:39Z  \r\n```\r\n\r\nWhats interesting is this never actually makes it to the wf list:\r\n```\r\ntctl wf listall\r\nWORKFLOW TYPE | WORKFLOW ID | RUN ID | TASK QUEUE | START TIME | EXECUTION TIME | END TIME  \r\n```\r\n\r\nThe second I prefix my WorkflowId with the TaskQueue, everything works as expected:\r\n\r\n```\r\njustin@MacBook-Pro-3 aura % tctl wf run --tq aura --wt CustodianWorkflow -w aura:custodian\r\nRunning execution:\r\n  Workflow Id : aura:custodian                        \r\n  Run Id      : 9de9cfd2-47b5-409a-b5d8-db804c57bf97  \r\n  Type        : CustodianWorkflow                     \r\n  Namespace   : default                               \r\n  Task Queue  : aura                                  \r\n  Args        : []                                    \r\nProgress:\r\n  1, 2022-05-25T18:51:17Z, WorkflowExecutionStarted\r\n  2, 2022-05-25T18:51:17Z, WorkflowTaskScheduled\r\n  3, 2022-05-25T18:51:17Z, WorkflowTaskStarted\r\n  4, 2022-05-25T18:51:17Z, WorkflowTaskCompleted\r\n  5, 2022-05-25T18:51:17Z, ActivityTaskScheduled\r\n  6, 2022-05-25T18:51:17Z, ActivityTaskStarted\r\n  7, 2022-05-25T18:51:17Z, ActivityTaskCompleted\r\n  8, 2022-05-25T18:51:17Z, WorkflowTaskScheduled\r\n  9, 2022-05-25T18:51:17Z, WorkflowTaskStarted\r\n  10, 2022-05-25T18:51:17Z, WorkflowTaskCompleted\r\n  11, 2022-05-25T18:51:17Z, WorkflowExecutionCompleted\r\n\r\nResult:\r\n  Run Time: 1 seconds\r\n  Status: COMPLETED\r\n  Output: \r\n```\r\n\r\n## Specifications\r\n\r\n  - Version: temporaliotest/auto-setup:sha-04e9ef0\r\n  - Platform: Go/tctl\r\n","closedAt":"2022-05-26T14:11:12Z","comments":[{"id":"IC_kwDODNqesM5D10qZ","author":{"login":"yiminc"},"authorAssociation":"MEMBER","body":"This is definitely not expected. @kennedyjustin are you able to reliably repro this? Or is this just happen once to you?\r\nI'm not able to repro this issue. ","createdAt":"2022-05-26T05:56:54Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/2902#issuecomment-1138182809","viewerDidAuthor":false},{"id":"IC_kwDODNqesM5D3fmS","author":{"login":"kennedyjustin"},"authorAssociation":"NONE","body":"I apologize I found out my issue (not a bug, will close the issue).\r\n\r\nI had originally started a workflow with my ID as a cron:\r\n```\r\n{\r\n  \"executionConfig\": {\r\n    \"taskQueue\": {\r\n      \"name\": \"cron\",\r\n      \"kind\": \"Normal\"\r\n    },\r\n    \"workflowExecutionTimeout\": \"0s\",\r\n    \"workflowRunTimeout\": \"0s\",\r\n    \"defaultWorkflowTaskTimeout\": \"10s\"\r\n  },\r\n  \"workflowExecutionInfo\": {\r\n    \"execution\": {\r\n      \"workflowId\": \"custodian\",\r\n      \"runId\": \"5aa70a40-2bd1-40ec-a2a2-c76f523676bc\"\r\n    },\r\n    \"type\": {\r\n      \"name\": \"CustodianWorkflow\"\r\n    },\r\n    \"startTime\": \"2022-05-23T23:45:06.374170400Z\",\r\n    \"status\": \"Running\",\r\n    \"historyLength\": \"2\",\r\n    \"memo\": {\r\n\r\n    },\r\n    \"autoResetPoints\": {\r\n\r\n    },\r\n    \"stateTransitionCount\": \"2\"\r\n  },\r\n  \"pendingWorkflowTask\": {\r\n    \"state\": \"Scheduled\",\r\n    \"scheduledTime\": \"2022-05-23T23:46:00.381320700Z\",\r\n    \"originalScheduledTime\": \"2022-05-23T23:46:00.381291100Z\",\r\n    \"attempt\": 1\r\n  }\r\n}\r\n```\r\n\r\nOn a different queue, and thought that I would be able to create a new `custodian` (id) workflow on the `aura` queue with no interference.\r\n\r\nOnce I terminated this old workflow, everything worked.","createdAt":"2022-05-26T14:11:12Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/2902#issuecomment-1138620818","viewerDidAuthor":false}],"createdAt":"2022-05-25T19:02:02Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"}],"milestone":null,"number":2902,"reactionGroups":[],"state":"CLOSED","title":"WorkflowIDs must have TaskQueue as a prefix","updatedAt":"2022-05-26T14:11:13Z","url":"https://github.com/temporalio/temporal/issues/2902"}
