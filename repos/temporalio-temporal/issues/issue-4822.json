{"assignees":[],"author":{"id":"MDQ6VXNlcjEwNDMxNzcz","is_bot":false,"login":"clcy1243","name":"Will"},"body":"## Expected Behavior\r\nStart Success\r\n\r\n## Actual Behavior\r\n```\r\n2023-08-31T17:46:43.067380+0800 error   /Users/admin/go/pkg/mod/go.temporal.io/server@v1.21.5/common/persistence/persistenceMetricClients.go:1281       Operation failed with internal error.   {\"error\": \"UpsertClusterMembership operation failed. Error: Error 1264 (22003): Out of range value for column 'rpc_port' at row 1\", \"operation\": \"UpsertClusterMembership\", \"logging-call-at\": \"persistenceMetricClients.go:1281\"}\r\n```\r\n\r\n## Steps to Reproduce the Problem\r\n\r\n  1. Start Temporal use config file ` development-mysql8.yaml` on Linux machine\r\n  2. Then Server exit and print error\r\n\r\n## Specifications\r\n\r\n  - Version: 1.21.5\r\n  - Platform: Linux machine\r\n","closedAt":"2023-08-31T12:51:45Z","comments":[{"id":"IC_kwDODNqesM5lX6qS","author":{"login":"clcy1243"},"authorAssociation":"NONE","body":"I debug server, found code at [factory](https://github.com/temporalio/temporal/blob/fab96500836c64ed95f54ec224765e0c6039aa3d/common/membership/ringpop/factory.go#L168)\r\n```\r\nfunc (factory *factory) getTCPChannel(ringpopHostAddress string, ringpopServiceName string) *tchannel.Channel {\r\n\tlistener, err := net.Listen(\"tcp\", ringpopHostAddress)\r\n\tif err != nil {\r\n\t\tfactory.Logger.Fatal(\"Failed to start ringpop listener\", tag.Error(err), tag.Address(ringpopHostAddress))\r\n\t}\r\n\r\n\ttChannel, err := tchannel.NewChannel(ringpopServiceName, &tchannel.ChannelOptions{})\r\n\tif err != nil {\r\n\t\tfactory.Logger.Fatal(\"Failed to create ringpop TChannel\", tag.Error(err))\r\n\t}\r\n\r\n\tif err := tChannel.Serve(listener); err != nil {\r\n\t\tfactory.Logger.Fatal(\"Failed to serve ringpop listener\", tag.Error(err), tag.Address(ringpopHostAddress))\r\n\t}\r\n\treturn tChannel\r\n}\r\n```\r\nparam `ringpopHostAddress` is `127.0.0.1:0`.\r\n\r\nafter `tChannel.Serve(listener)`, could get peerInfo, like `127.0.0.1:52336`.\r\n\r\nthen save 52336 to temporal.cluster_membership, column rpc_port, but it's type is `smallint`, just allowed (-32768ã€œ32767).\r\n\r\nMay be it should be `smallint unsigned`?","createdAt":"2023-08-31T10:20:17Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/4822#issuecomment-1700768402","viewerDidAuthor":false},{"id":"IC_kwDODNqesM5lYu6W","author":{"login":"clcy1243"},"authorAssociation":"NONE","body":"my fault, I edited config file, and deleted membershipPort","createdAt":"2023-08-31T12:51:46Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/4822#issuecomment-1700982422","viewerDidAuthor":false}],"createdAt":"2023-08-31T10:04:17Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"}],"milestone":null,"number":4822,"reactionGroups":[],"state":"CLOSED","title":"Mysql ERROR :  Out of range value for column 'rpc_port'","updatedAt":"2023-08-31T12:51:46Z","url":"https://github.com/temporalio/temporal/issues/4822"}
