{"assignees":[],"author":{"id":"MDQ6VXNlcjg3NjI4OTM=","is_bot":false,"login":"wxing1292","name":"Wenquan Xing"},"body":"Sticky workflow tasks usually have short timeout, in terms of seconds.\r\n\r\nWhen a sticky workflow task cannot be sync-matched, matching service right now will persist the task into DB and wait for SDK with local cache to pick up that task.\r\n\r\nIf sticky workflow task cannot be sync-matched, it (sometimes? usually?) means SDK is unavailable and history service will timeout the task few seconds later.\r\nIf above case happen, DB IOPS are wasted. (matching service persist the task, & maybe read it back)\r\n\r\nMatching service should not persist sticky workflow task, by\r\n1. either when unable to sync match, return error and let history service retry for few times before give up\r\n2. or using longer sync match timeout, if unable to sync match, give up immediately\r\n3. change history service to dispatch task, preferable to the SDK queue (SDK which has local cache) default to normal queue; when sync match timeout for SDK queue, put the task to normal queue\r\n\r\nNOTE: history service will timeout the sticky workflow task & create a normal workflow task, workflow will NOT be stuck","closedAt":null,"comments":[],"createdAt":"2022-07-29T23:57:55Z","labels":[{"id":"MDU6TGFiZWwxNjIxMDMwNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":3168,"reactionGroups":[],"state":"OPEN","title":"Matching service optimization - Do not persist sticky workflow task","updatedAt":"2023-03-03T20:18:37Z","url":"https://github.com/temporalio/temporal/issues/3168"}
