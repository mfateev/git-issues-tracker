{"assignees":[],"author":{"id":"MDQ6VXNlcjUxNDkzMg==","is_bot":false,"login":"antmendoza","name":"Antonio Mendoza PÃ©rez"},"body":"When a worker starts and sets `MaxActivityTasksPerSecond` to x, the activity dispatch rate is applied correctly.\n\nHowever, if the worker restarts without setting `MaxActivityTasksPerSecond`, the [max_tasks_per_second](https://github.com/temporalio/api/blob/d96bd55e87799e9f6a33a1c40a56cfa932566bdf/temporal/api/taskqueue/v1/message.proto#L33) field in PollActivityTaskQueueRequest is not present. \nIn this case, the server does not reset the dispatch rate to its default value, it retains the previous value instead.\n\n- I believe here https://github.com/temporalio/temporal/blob/61679595fff5a3ceab087e13ee45109a35c2f546/service/matching/task_queue_partition_manager.go#L389\n\n## Expected behavior:\nI would expect the server to reset the dispatch rate to its default value\n\n## Steps to Reproduce the Problem\n\n  1. Start a worker setting MaxActivityTasksPerSecond to some number (e.g 50)\n  2. Start workflows that schedule activities.\n  3. Restart the worker with default settings (do not set MaxActivityTasksPerSecond)\n\nDispatch rate for the taskqueue remains 50\n\n## Specifications\n\n  - Version:\n  - Platform:\n","closedAt":"2025-09-04T22:19:48Z","comments":[{"id":"IC_kwDODNqesM7CEqli","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"To unset the limit use the UpdateTaskQueueConfig request as mentioned here: https://github.com/temporalio/api/blob/21b27ff1010e33f30801dd60a074f89eac439cb4/temporal/api/workflowservice/v1/request_response.proto#L2489\n\nAsking internally on the stability of this newer API and the future of the poll request API.","createdAt":"2025-09-04T22:19:48Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/8137#issuecomment-3256002914","viewerDidAuthor":false}],"createdAt":"2025-08-01T16:33:41Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"}],"milestone":null,"number":8137,"reactionGroups":[],"state":"CLOSED","title":"The MaxActivityTasksPerSecond value is not reset to its default if the worker does not send max_tasks_per_second","updatedAt":"2025-09-04T22:19:48Z","url":"https://github.com/temporalio/temporal/issues/8137"}
