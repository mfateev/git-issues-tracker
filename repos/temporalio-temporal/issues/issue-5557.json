{"assignees":[{"id":"MDQ6VXNlcjIwNjgxMjQ=","login":"rodrigozhou","name":"Rodrigo Zhou","databaseId":0}],"author":{"id":"MDQ6VXNlcjE2NTA2NDA4","is_bot":false,"login":"enakshipriya","name":""},"body":"I have a self hosted Temporal server setup which uses auroradb and elasticsearch for visibility. I created a custom search attribute named \"abc-test\". While creation there was no error. I tried using this custom search attribute in one of my workflows which also got created without any error and I was able to see the newly created search attribute in the workflow history. However on trying to query the workflows through UI, I am getting error: \r\n```\r\nThere is an error with filtering Workflows.\r\ninvalid query: unable to convert filter expression: unable to convert left side of \"abc - test = 'xyz'\": invalid expression: must be a column name but was *sqlparser.BinaryExpr\r\n```\r\n\r\n## Expected Behavior\r\nIt should not return any error. \r\n\r\n## Actual Behavior\r\nIt seems that although there is no restriction on using hyphen it is somewhat acting as a delimeter and inserting spaces while filtering. If we are not using hyphen in the name then it works as expected.\r\n\r\n## Steps to Reproduce the Problem\r\n\r\n  1. On a self hosted server, create a custom search attribute \"abc-test\".\r\n  2. Use the newly created search attribute in any workflow execution\r\n  3. On UI, while querying, try to query the workflow using the search attribute as a filter.\r\n\r\n## Specifications\r\n\r\n  - Version: [1.22.6]\r\n  - Platform: All\r\n\r\nSlack link: https://temporalio.slack.com/archives/CTRCR8RBP/p1710752031783399\r\n","closedAt":"2025-02-25T14:14:52Z","comments":[{"id":"IC_kwDODNqesM567HRd","author":{"login":"alexseedkou"},"authorAssociation":"CONTRIBUTOR","body":"This issue comes from the sqlparser as hyphen `-` is reserved to SQL. \r\n\r\nCurrently, a workaround here is to use your custom filter directly in the search bar with the delimiter backtick (`` \"`\" ``).\r\nFor example `` `abc-test`=\"something\" ``.\r\n\r\nTo fix the issue when using the filter option in the UI, a way is to add the backtick to the customer search attribute when sending the query request to the backend server from UI or frontend .","createdAt":"2024-04-17T20:58:25Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/5557#issuecomment-2062316637","viewerDidAuthor":false},{"id":"IC_kwDODNqesM57O5j5","author":{"login":"diervo"},"authorAssociation":"NONE","body":"I run into the same issue without the hyphen:\r\n\r\n```\r\ninvalid query: unable to convert filter expression: unable to convert left side of \"OrgId = 'foo'\": filter by 'OrgId' not supported for standard visibility\r\n```\r\n\r\nI just upgraded (self hosted) to the latest version (1.22.7 , ui 2.26.1) and latest schema versions so not sure if it could be a regression?","createdAt":"2024-04-20T01:35:29Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/5557#issuecomment-2067503353","viewerDidAuthor":false},{"id":"IC_kwDODNqesM57O8Wm","author":{"login":"alexseedkou"},"authorAssociation":"CONTRIBUTOR","body":"> I run into the same issue without the hyphen:\r\n> \r\n> ```\r\n> invalid query: unable to convert filter expression: unable to convert left side of \"OrgId = 'foo'\": filter by 'OrgId' not supported for standard visibility\r\n> ```\r\n> \r\n> I just upgraded (self hosted) to the latest version (1.22.7 , ui 2.26.1) and latest schema versions so not sure if it could be a regression?\r\n\r\nDid you try the search directly to use the filter?","createdAt":"2024-04-20T02:12:06Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/5557#issuecomment-2067514790","viewerDidAuthor":false},{"id":"IC_kwDODNqesM57b8CV","author":{"login":"rodrigozhou"},"authorAssociation":"MEMBER","body":"It looks like you're using standard visibility, which does not support custom search attributes. Please refer to [v1.20.0 release notes](https://github.com/temporalio/temporal/releases/tag/v1.20.0) for upgrade instructions.","createdAt":"2024-04-22T20:44:38Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/5557#issuecomment-2070921365","viewerDidAuthor":false},{"id":"IC_kwDODNqesM57cdci","author":{"login":"alexseedkou"},"authorAssociation":"CONTRIBUTOR","body":"The issue should be fixed with the hyphen after the merge of this [PR](https://github.com/temporalio/ui/pull/2015)\r\n\r\n\r\n","createdAt":"2024-04-22T22:30:00Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/temporal/issues/5557#issuecomment-2071058210","viewerDidAuthor":false},{"id":"IC_kwDODNqesM6f3ddY","author":{"login":"enakshipriya"},"authorAssociation":"NONE","body":"I am not able to reproduce the issue in the new version\nServer version: 1.26.2\nUI version: 2.28.0\nWe are good to close this issue. Thanks for the quick turnaround @alexseedkou @tdeebswihart @rodrigozhou @ychebotarev.","createdAt":"2025-02-25T14:14:52Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/5557#issuecomment-2682115928","viewerDidAuthor":false}],"createdAt":"2024-03-19T05:41:48Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"}],"milestone":null,"number":5557,"reactionGroups":[],"state":"CLOSED","title":"Custom search attributes having hyphen(\"-\") in the name is returning error while filtering Workflows","updatedAt":"2025-02-25T14:14:55Z","url":"https://github.com/temporalio/temporal/issues/5557"}
