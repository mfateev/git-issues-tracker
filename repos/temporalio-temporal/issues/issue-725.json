{"assignees":[],"author":{"id":"MDQ6VXNlcjE0NjM2MjI=","is_bot":false,"login":"mfateev","name":"Maxim Fateev"},"body":"## Expected Behavior\r\nWhen a child is open resetting it should not be visible to its parent. So from the parent point of view, the reset child is still the same child and only its completion is reported.\r\n\r\n## Actual Behavior\r\nThe parent receives ChildWorkflowExecutionTerminated event instead.\r\n\r\n## Steps to Reproduce the Problem\r\n\r\n  1. Take [HelloChild Java Sample](https://github.com/temporalio/java-samples/blob/cd68261f5837aded1e30437af56db0891712b7cf/src/main/java/io/temporal/samples/hello/HelloChild.java#L36).\r\n  1. Add Workflow.sleep(Duration.ofHours(1)) as the first line of the child workflow\r\n  1. Start the sample\r\n  1. Reset the child workflow using CLI command: \r\n`tctl wf reset -w <childId> --event_id 4  --reason restart`\r\n  1. The parent  receives the child terminated exception:\r\n```\r\nio.temporal.failure.ChildWorkflowFailure: workflowId='569e551a-f856-3c61-8686-788743138d21', runId='fee60ec8-8dad-40ac-b120-f121527cf38b', workflowType='GreetingChild', initiatedEventId=5, startedEventId=6, namespace='', retryState=RETRY_STATE_NON_RETRYABLE_FAILURE\r\n\tat java.lang.Thread.getStackTrace(Thread.java:1559)\r\n\tat io.temporal.internal.sync.CompletablePromiseImpl.throwFailure(CompletablePromiseImpl.java:136)\r\n\tat io.temporal.internal.sync.CompletablePromiseImpl.getImpl(CompletablePromiseImpl.java:95)\r\n\tat io.temporal.internal.sync.CompletablePromiseImpl.get(CompletablePromiseImpl.java:74)\r\n\tat io.temporal.samples.hello.HelloChild$GreetingWorkflowImpl.getGreeting(HelloChild.java:67)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat io.temporal.internal.sync.POJOWorkflowImplementationFactory$POJOWorkflowImplementation$RootWorkflowInboundCallsInterceptor.execute(POJOWorkflowImplementationFactory.java:289)\r\n\tat io.temporal.internal.sync.POJOWorkflowImplementationFactory$POJOWorkflowImplementation.execute(POJOWorkflowImplementationFactory.java:253)\r\n\tat io.temporal.internal.sync.WorkflowExecuteRunnable.run(WorkflowExecuteRunnable.java:52)\r\n\tat io.temporal.internal.sync.SyncWorkflow.lambda$start$0(SyncWorkflow.java:119)\r\n\tat io.temporal.internal.sync.CancellationScopeImpl.run(CancellationScopeImpl.java:104)\r\n\tat io.temporal.internal.sync.WorkflowThreadImpl$RunnableWrapper.run(WorkflowThreadImpl.java:107)\r\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\r\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\nCaused by: io.temporal.failure.TerminatedFailure: null\r\n\tat io.temporal.internal.statemachines.ChildWorkflowStateMachine.notifyTerminated(ChildWorkflowStateMachine.java:303)\r\n\tat io.temporal.internal.statemachines.FixedTransitionAction.apply(FixedTransitionAction.java:45)\r\n\tat io.temporal.internal.statemachines.StateMachine.executeTransition(StateMachine.java:137)\r\n\tat io.temporal.internal.statemachines.StateMachine.handleHistoryEvent(StateMachine.java:91)\r\n\tat io.temporal.internal.statemachines.EntityStateMachineBase.handleEvent(EntityStateMachineBase.java:63)\r\n\tat io.temporal.internal.statemachines.WorkflowStateMachines.handleEventImpl(WorkflowStateMachines.java:210)\r\n\tat io.temporal.internal.statemachines.WorkflowStateMachines.handleEvent(WorkflowStateMachines.java:178)\r\n\tat io.temporal.internal.replay.ReplayWorkflowRunTaskHandler.handleEvent(ReplayWorkflowRunTaskHandler.java:140)\r\n\tat io.temporal.internal.replay.ReplayWorkflowRunTaskHandler.handleWorkflowTaskImpl(ReplayWorkflowRunTaskHandler.java:180)\r\n\tat io.temporal.internal.replay.ReplayWorkflowRunTaskHandler.handleWorkflowTask(ReplayWorkflowRunTaskHandler.java:150)\r\n\tat io.temporal.internal.replay.ReplayWorkflowTaskHandler.handleWorkflowTaskWithEmbeddedQuery(ReplayWorkflowTaskHandler.java:202)\r\n\tat io.temporal.internal.replay.ReplayWorkflowTaskHandler.handleWorkflowTask(ReplayWorkflowTaskHandler.java:112)\r\n\tat io.temporal.internal.worker.WorkflowWorker$TaskHandlerImpl.handle(WorkflowWorker.java:309)\r\n\tat io.temporal.internal.worker.WorkflowWorker$TaskHandlerImpl.handle(WorkflowWorker.java:275)\r\n\tat io.temporal.internal.worker.PollTaskExecutor.lambda$process$0(PollTaskExecutor.java:73)\r\n\t... 3 common frames omitted\r\n```\r\n## Specifications\r\n\r\n  - Version:\r\n```\r\ntemporal-java-sdk[side-effect !]$ docker ps\r\nCONTAINER ID        IMAGE                           COMMAND                  CREATED             STATUS              PORTS                                                                      NAMES\r\na0082ddf82b5        temporalio/web:0.29.0           \"docker-entrypoint.s…\"   11 days ago         Up 11 days          0.0.0.0:8088->8088/tcp                                                     docker_temporal-web_1\r\nb48134a85124        temporalio/admin-tools:0.29.0   \"tail -f /dev/null\"      11 days ago         Up 11 days                                                                                     docker_temporal-admin-tools_1\r\neb70ad1ba9aa        temporalio/server:0.29.0        \"/docker-entrypoint.…\"   11 days ago         Up 11 days          6933-6935/tcp, 6939/tcp, 7234-7235/tcp, 7239/tcp, 0.0.0.0:7233->7233/tcp   docker_temporal_1\r\n517cd71bd8a2        mysql:5.7                       \"docker-entrypoint.s…\"   11 days ago         Up 11 days          0.0.0.0:3306->3306/tcp, 33060/tcp                                          docker_mysql_1\r\n```\r\n\r\n","closedAt":"2023-08-10T19:05:34Z","comments":[{"id":"IC_kwDODNqesM5EWKSI","author":{"login":"elb3k"},"authorAssociation":"CONTRIBUTOR","body":"@mfateev  https://github.com/temporalio/temporal/pull/2913 should address this issue.","createdAt":"2022-06-04T17:59:51Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/725#issuecomment-1146659976","viewerDidAuthor":false}],"createdAt":"2020-09-12T19:19:36Z","labels":[{"id":"MDU6TGFiZWwxNjIxMDMwNzg0","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyNTc2NTM1ODQ2","name":"difficulty: easy","description":"","color":"68d662"},{"id":"MDU6TGFiZWwyODE3MDk3ODQ0","name":"planning","description":"","color":"006b75"},{"id":"MDU6TGFiZWwzMTM4ODI4MTE3","name":"up-for-grabs","description":"Issues to consider for external contribution","color":"69CD90"}],"milestone":null,"number":725,"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"state":"CLOSED","title":"Resetting open child workflow should not sent Terminated Failure to the parent","updatedAt":"2023-08-10T19:05:35Z","url":"https://github.com/temporalio/temporal/issues/725"}
