{"assignees":[],"author":{"id":"MDQ6VXNlcjUyMjI1MTI=","is_bot":false,"login":"hazcod","name":"Niels Hofmans"},"body":"**Is your feature request related to a problem? Please describe.**\r\nCurrently docker will assume the container is ready once it is running, while the temporal engine is still warming up, leading to all sorts of problems.\r\n\r\n**Describe the solution you'd like**\r\nImplement the HEALTHCHECK directive in your Dockerfile(s).\r\n\r\n**Describe alternatives you've considered**\r\nRestarting clients.\r\n\r\n**Additional context**\r\n","closedAt":null,"comments":[{"id":"IC_kwDODNqesM5BKnEI","author":{"login":"berardino"},"authorAssociation":"NONE","body":"As a work around, until the HEALTHCHECK is added to the docker image,  I was able to implement a healthcheck in the docker-compose file as follow:\r\n\r\n```yaml\r\nhealthcheck:\r\n      test: [ \"CMD\", \"tctl\",\"cluster\",\"h\" ]\r\n      interval: 10s\r\n      timeout: 1m\r\n      retries: 10\r\n```","createdAt":"2022-04-08T19:50:53Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/453#issuecomment-1093300488","viewerDidAuthor":false},{"id":"IC_kwDODNqesM5EjsXM","author":{"login":"igrayson"},"authorAssociation":"NONE","body":"This is the docker-compose health-check that worked for me:\r\n```yaml\r\n    healthcheck:\r\n      test:\r\n        [\r\n          \"CMD\",\r\n          \"tctl\",\r\n          \"--address\",\r\n          \"temporal:7233\",\r\n          \"workflow\",\r\n          \"list\"\r\n        ]\r\n      interval: 1s\r\n      timeout: 5s\r\n      retries: 30\r\n```\r\n\r\nMy temporal service didn't listen on `127.0.0.1`, so I added an `--address`. I used `workflow list` instead of `cluster h` as the latter doesn't seem to wait for the default namespace to be created causing a race condition for the error \"namespace:default not found\".","createdAt":"2022-06-08T17:39:34Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":13}}],"url":"https://github.com/temporalio/temporal/issues/453#issuecomment-1150207436","viewerDidAuthor":false},{"id":"IC_kwDODNqesM5Quowg","author":{"login":"tarampampam"},"authorAssociation":"NONE","body":"In addition, if you didn't want to set the container name, you can force temporal listening on any interface, eg:\r\n\r\n```yaml\r\nservices:\r\n  temporal:\r\n    image: temporalio/auto-setup:1.19\r\n    ports: ['7233:7233/tcp']\r\n    environment: # https://github.com/temporalio/docker-builds/blob/main/docker/auto-setup.sh\r\n      # ...\r\n      BIND_ON_IP: 0.0.0.0\r\n      TEMPORAL_BROADCAST_ADDRESS: 127.0.0.1\r\n    healthcheck:\r\n      test: ['CMD-SHELL', 'tctl --address 127.0.0.1:7233 workflow list']\r\n      interval: 1s\r\n      timeout: 5s\r\n      start_period: 2s\r\n```","createdAt":"2022-12-16T08:49:05Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":3}},{"content":"HEART","users":{"totalCount":3}}],"url":"https://github.com/temporalio/temporal/issues/453#issuecomment-1354402848","viewerDidAuthor":false},{"id":"IC_kwDODNqesM6Llc9m","author":{"login":"Mahmoud-Elbahnasawy"},"authorAssociation":"NONE","body":"This is the health check that worker for me \r\n```\r\n      test:\r\n        [\"CMD\",\"tctl\", \"--address\", \"temporal:7233\", \"workflow\", \"list\", \"||\", \"exit 1\"]\r\n      interval: 1s\r\n      timeout: 5s\r\n      retries: 30\r\n```\r\n      and i added a condition on the container that needs to the wait the for the health check command to be succeeded this condition \r\n\r\n```\r\n    depends_on:\r\n      temporal:\r\n        condition: service_healthy\r\n```\r\n","createdAt":"2024-09-10T19:26:49Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}},{"content":"HOORAY","users":{"totalCount":2}},{"content":"HEART","users":{"totalCount":1}}],"url":"https://github.com/temporalio/temporal/issues/453#issuecomment-2341850982","viewerDidAuthor":false},{"id":"IC_kwDODNqesM616Cf4","author":{"login":"adriantaut"},"authorAssociation":"NONE","body":"this would be very helpful, especially for running ECS Task healthchecks inside the container...unfortunately the `tctl` only performs healthchecks for the `frontend` service, while there is no easy way to do healthchecks on `matching/history` services","createdAt":"2025-07-09T09:34:43Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/453#issuecomment-3051890680","viewerDidAuthor":false}],"createdAt":"2020-06-14T12:41:44Z","labels":[{"id":"MDU6TGFiZWwxNjIxMDMwNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMDAxNDk5NzYw","name":"operations","description":"","color":"f9d0c4"},{"id":"MDU6TGFiZWwzMTM4ODI4MTE3","name":"up-for-grabs","description":"Issues to consider for external contribution","color":"69CD90"},{"id":"LA_kwDODNqesM8AAAABGnQ9aA","name":"P1","description":"","color":"B60205"}],"milestone":null,"number":453,"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"state":"OPEN","title":"Feature: implement docker healthcheck","updatedAt":"2025-07-09T09:34:43Z","url":"https://github.com/temporalio/temporal/issues/453"}
