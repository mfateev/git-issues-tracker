{"assignees":[{"id":"U_kgDODSi3zA","login":"simvlad","name":"Vladyslav Simonenko","databaseId":0}],"author":{"id":"MDQ6VXNlcjk0NDcyOTc=","is_bot":false,"login":"tunsuy","name":""},"body":"## Expected Behavior\n\n\n## Actual Behavior\n\n\n## Steps to Reproduce the Problem\n\n start temporal worker servcie, log is:\n\n```\nTEMPORAL_ADDRESS is not set, setting it to 9.139.60.15:7233\n2025/07/14 12:28:05 Loading config; env=docker,zone=,configDir=config\n2025/07/14 12:28:05 Loading config files=[config/docker.yaml]\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.568Z\",\"msg\":\"Build info.\",\"git-time\":\"2025-03-27T22:45:52.000Z\",\"git-revision\":\"a31fd7a9e5db4c28627eb18676558e974e95e1ba\",\"git-modified\":false,\"go-arch\":\"amd64\",\"go-os\":\"linux\",\"go-version\":\"go1.23.2\",\"cgo-enabled\":false,\"server-version\":\"1.27.2\",\"debug-mode\":false,\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/cmd/server/main.go:175\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.568Z\",\"msg\":\"dynamic config changed for the key: worker.historyscannerverifyretention oldValue: nil newValue: { constraints: {} value: true }\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/common/dynamicconfig/file_based_client.go:361\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.568Z\",\"msg\":\"dynamic config changed for the key: worker.historyscannerdataminage oldValue: nil newValue: { constraints: {} value: 604800000000000 }\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/common/dynamicconfig/file_based_client.go:361\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.568Z\",\"msg\":\"dynamic config changed for the key: limit.historycount.error oldValue: nil newValue: { constraints: {} value: 102400 }\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/common/dynamicconfig/file_based_client.go:361\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.568Z\",\"msg\":\"dynamic config changed for the key: history.cachettl oldValue: nil newValue: { constraints: {} value: 600000000000 }\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/common/dynamicconfig/file_based_client.go:361\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.568Z\",\"msg\":\"dynamic config changed for the key: worker.historyscannerenabled oldValue: nil newValue: { constraints: {} value: true }\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/common/dynamicconfig/file_based_client.go:361\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.568Z\",\"msg\":\"dynamic config changed for the key: frontend.namespacecount oldValue: nil newValue: { constraints: {} value: 200000000 }\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/common/dynamicconfig/file_based_client.go:361\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.568Z\",\"msg\":\"dynamic config changed for the key: worker.executionsscannerenabled oldValue: nil newValue: { constraints: {} value: true }\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/common/dynamicconfig/file_based_client.go:361\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.569Z\",\"msg\":\"dynamic config changed for the key: limit.historysize.error oldValue: nil newValue: { constraints: {} value: 209715200 }\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/common/dynamicconfig/file_based_client.go:361\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.569Z\",\"msg\":\"dynamic config changed for the key: history.cacheinitialsize oldValue: nil newValue: { constraints: {} value: 32 }\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/common/dynamicconfig/file_based_client.go:361\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.569Z\",\"msg\":\"Updated dynamic config\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/common/dynamicconfig/file_based_client.go:207\"}\n{\"level\":\"warn\",\"ts\":\"2025-07-14T12:28:05.569Z\",\"msg\":\"Not using any authorizer and flag `--allow-no-auth` not detected. Future versions will require using the flag `--allow-no-auth` if you do not want to set an authorizer.\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/cmd/server/main.go:205\"}\n{\"level\":\"warn\",\"ts\":\"2025-07-14T12:28:05.585Z\",\"msg\":\"Supplied configuration key/value mismatches persisted cluster metadata. Continuing with the persisted value as this value cannot be changed once initialized.\",\"component\":\"metadata-initializer\",\"key\":\"persistence.numHistoryShards\",\"ignored-value\":32,\"value\":512,\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/temporal/fx.go:822\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.586Z\",\"msg\":\"Use rpc address 127.0.0.1:7233 for cluster active.\",\"component\":\"metadata-initializer\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/temporal/cluster_metadata_loader.go:92\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.587Z\",\"msg\":\"Service is not requested, skipping initialization.\",\"service\":\"history\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/temporal/fx.go:490\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.587Z\",\"msg\":\"Service is not requested, skipping initialization.\",\"service\":\"matching\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/temporal/fx.go:510\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.587Z\",\"msg\":\"Service is not requested, skipping initialization.\",\"service\":\"frontend\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/temporal/fx.go:539\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.587Z\",\"msg\":\"Service is not requested, skipping initialization.\",\"service\":\"internal-frontend\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/temporal/fx.go:539\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.594Z\",\"msg\":\"Quota changed\",\"service\":\"worker\",\"component\":\"persistence\",\"scope\":\"host\",\"current-quota\":null,\"new-quota\":500,\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/common/quotas/calculator/logged_calculator.go:124\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.600Z\",\"msg\":\"Initialized service resolver for persistence rate limiting\",\"service\":\"worker\",\"service\":\"worker\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/service/fx.go:91\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.600Z\",\"msg\":\"historyClient: ownership caching disabled\",\"service\":\"worker\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/client/history/client.go:86\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.606Z\",\"msg\":\"creating new visibility manager\",\"visibility_plugin_name\":\"mysql8\",\"visibility_index_name\":\"temporal_visibility\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/common/persistence/visibility/factory.go:155\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.606Z\",\"msg\":\"Starting server for services\",\"value\":{\"worker\":{}},\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/temporal/server_impl.go:107\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.607Z\",\"msg\":\"PProf listen on \",\"host\":\"localhost\",\"port\":7936,\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/common/pprof/pprof.go:82\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.619Z\",\"msg\":\"RuntimeMetricsReporter started\",\"service\":\"worker\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/common/metrics/runtime.go:141\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.620Z\",\"msg\":\"worker starting\",\"service\":\"worker\",\"component\":\"worker\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/service/worker/service.go:242\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.622Z\",\"msg\":\"Membership heartbeat upserted successfully\",\"address\":\"9.139.60.15\",\"port\":6939,\"hostId\":\"fe07872e-60ad-11f0-aada-525400ad8fb7\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/common/membership/ringpop/monitor.go:340\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.623Z\",\"msg\":\"bootstrap hosts fetched\",\"bootstrap-hostports\":\"9.139.62.137:6934,9.139.60.191:6933,9.139.62.44:6935,9.139.63.38:6935,9.139.60.167:6939,9.139.60.15:6939,9.139.62.114:6934,9.139.60.9:6934,9.139.61.143:6933,9.139.62.241:6935,9.139.60.113:6933,9.139.63.153:6933,9.139.62.183:6939,9.139.63.242:6934,9.139.61.241:6939,9.139.62.154:6934,9.139.62.83:6933,9.139.63.55:6935,9.139.60.6:6935,9.139.63.75:6939\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/common/membership/ringpop/monitor.go:382\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.636Z\",\"msg\":\"Current reachable members\",\"component\":\"service-resolver\",\"service\":\"frontend\",\"addresses\":[\"9.139.60.113:7233\",\"9.139.60.191:7233\",\"9.139.61.143:7233\",\"9.139.62.83:7233\",\"9.139.63.153:7233\"],\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/common/membership/ringpop/service_resolver.go:329\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.636Z\",\"msg\":\"Current reachable members\",\"component\":\"service-resolver\",\"service\":\"history\",\"addresses\":[\"9.139.60.9:7234\",\"9.139.62.114:7234\",\"9.139.62.137:7234\",\"9.139.62.154:7234\",\"9.139.63.242:7234\"],\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/common/membership/ringpop/service_resolver.go:329\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.637Z\",\"msg\":\"Current reachable members\",\"component\":\"service-resolver\",\"service\":\"matching\",\"addresses\":[\"9.139.60.6:7235\",\"9.139.62.241:7235\",\"9.139.62.44:7235\",\"9.139.63.38:7235\",\"9.139.63.55:7235\"],\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/common/membership/ringpop/service_resolver.go:329\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.638Z\",\"msg\":\"Current reachable members\",\"component\":\"service-resolver\",\"service\":\"worker\",\"addresses\":[\"9.139.60.15:0\",\"9.139.60.167:0\",\"9.139.61.241:0\",\"9.139.62.183:0\",\"9.139.63.75:0\"],\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/common/membership/ringpop/service_resolver.go:329\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.656Z\",\"msg\":\"temporal-sys-tq-scanner-workflow workflow successfully started\",\"service\":\"worker\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/service/worker/scanner/scanner.go:295\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.657Z\",\"msg\":\"temporal-sys-executions-scanner-workflow workflow successfully started\",\"service\":\"worker\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/service/worker/scanner/scanner.go:295\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.657Z\",\"msg\":\"temporal-sys-history-scanner-workflow workflow successfully started\",\"service\":\"worker\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/service/worker/scanner/scanner.go:295\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.872Z\",\"msg\":\"Started Worker\",\"service\":\"worker\",\"Namespace\":\"temporal-system\",\"TaskQueue\":\"temporal-sys-executions-scanner-taskqueue-0\",\"WorkerID\":\"temporal-system@9.139.60.15:0\",\"logging-call-at\":\"/opt/hostedtoolcache/go/1.23.2/x64/src/sync/oncefunc.go:57\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.876Z\",\"msg\":\"Started Worker\",\"service\":\"worker\",\"Namespace\":\"temporal-system\",\"TaskQueue\":\"temporal-sys-tq-scanner-taskqueue-0\",\"WorkerID\":\"temporal-system@9.139.60.15:0\",\"logging-call-at\":\"/opt/hostedtoolcache/go/1.23.2/x64/src/sync/oncefunc.go:57\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.879Z\",\"msg\":\"Started Worker\",\"service\":\"worker\",\"Namespace\":\"temporal-system\",\"TaskQueue\":\"temporal-sys-history-scanner-taskqueue-0\",\"WorkerID\":\"temporal-system@9.139.60.15:0\",\"logging-call-at\":\"/opt/hostedtoolcache/go/1.23.2/x64/src/sync/oncefunc.go:57\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.887Z\",\"msg\":\"Started Worker\",\"service\":\"worker\",\"Namespace\":\"temporal-system\",\"TaskQueue\":\"temporal-sys-processor-parent-close-policy\",\"WorkerID\":\"temporal-system@9.139.60.15:0\",\"logging-call-at\":\"/opt/hostedtoolcache/go/1.23.2/x64/src/sync/oncefunc.go:57\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.891Z\",\"msg\":\"Started Worker\",\"service\":\"worker\",\"Namespace\":\"temporal-system\",\"TaskQueue\":\"default-worker-tq\",\"WorkerID\":\"temporal-system@temporal-worker-768cdf67cc-s7bc5\",\"logging-call-at\":\"/opt/hostedtoolcache/go/1.23.2/x64/src/sync/oncefunc.go:57\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.893Z\",\"msg\":\"Started Worker\",\"service\":\"worker\",\"Namespace\":\"temporal-system\",\"TaskQueue\":\"temporal-sys-migration-activity-tq\",\"WorkerID\":\"temporal-system@temporal-worker-768cdf67cc-s7bc5\",\"logging-call-at\":\"/opt/hostedtoolcache/go/1.23.2/x64/src/sync/oncefunc.go:57\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.895Z\",\"msg\":\"Started Worker\",\"service\":\"worker\",\"Namespace\":\"temporal-system\",\"TaskQueue\":\"temporal-sys-delete-namespace-activity-tq\",\"WorkerID\":\"temporal-system@temporal-worker-768cdf67cc-s7bc5\",\"logging-call-at\":\"/opt/hostedtoolcache/go/1.23.2/x64/src/sync/oncefunc.go:57\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.896Z\",\"msg\":\"Started Worker\",\"service\":\"worker\",\"Namespace\":\"temporal-system\",\"TaskQueue\":\"temporal-sys-add-search-attributes-activity-tq\",\"WorkerID\":\"temporal-system@temporal-worker-768cdf67cc-s7bc5\",\"logging-call-at\":\"/opt/hostedtoolcache/go/1.23.2/x64/src/sync/oncefunc.go:57\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.898Z\",\"msg\":\"Started Worker\",\"service\":\"worker\",\"Namespace\":\"temporal-system\",\"TaskQueue\":\"temporal-sys-dlq-activity-tq\",\"WorkerID\":\"temporal-system@temporal-worker-768cdf67cc-s7bc5\",\"logging-call-at\":\"/opt/hostedtoolcache/go/1.23.2/x64/src/sync/oncefunc.go:57\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.898Z\",\"msg\":\"none\",\"component\":\"worker-manager\",\"lifecycle\":\"Started\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/service/worker/worker.go:124\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.898Z\",\"msg\":\"none\",\"component\":\"perns-worker-manager\",\"lifecycle\":\"Starting\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/service/worker/pernamespaceworker.go:176\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.898Z\",\"msg\":\"none\",\"component\":\"perns-worker-manager\",\"lifecycle\":\"Started\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/service/worker/pernamespaceworker.go:188\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:05.898Z\",\"msg\":\"worker service started\",\"service\":\"worker\",\"component\":\"worker\",\"address\":\"9.139.60.15:0\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/service/worker/service.go:271\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:06.445Z\",\"msg\":\"Current reachable members\",\"component\":\"service-resolver\",\"service\":\"worker\",\"addresses\":[\"9.139.60.15:0\",\"9.139.60.167:0\",\"9.139.61.241:0\",\"9.139.62.170:0\",\"9.139.62.183:0\",\"9.139.63.75:0\"],\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/common/membership/ringpop/service_resolver.go:329\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:07.624Z\",\"msg\":\"Current reachable members\",\"component\":\"service-resolver\",\"service\":\"worker\",\"addresses\":[\"9.139.60.15:0\",\"9.139.60.167:0\",\"9.139.61.241:0\",\"9.139.62.170:0\",\"9.139.62.183:0\",\"9.139.63.56:0\",\"9.139.63.75:0\"],\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/common/membership/ringpop/service_resolver.go:329\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:11.760Z\",\"msg\":\"Current reachable members\",\"component\":\"service-resolver\",\"service\":\"worker\",\"addresses\":[\"9.139.60.15:0\",\"9.139.60.167:0\",\"9.139.62.170:0\",\"9.139.62.183:0\",\"9.139.63.56:0\",\"9.139.63.75:0\"],\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/common/membership/ringpop/service_resolver.go:329\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:28:14.770Z\",\"msg\":\"Current reachable members\",\"component\":\"service-resolver\",\"service\":\"worker\",\"addresses\":[\"9.139.60.15:0\",\"9.139.60.167:0\",\"9.139.62.170:0\",\"9.139.63.56:0\",\"9.139.63.75:0\"],\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/common/membership/ringpop/service_resolver.go:329\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:30:42.485Z\",\"msg\":\"Executions scavenger starting\",\"service\":\"worker\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/service/worker/scanner/executions/scavenger.go:135\"}\n{\"level\":\"info\",\"ts\":\"2025-07-14T12:30:42.485Z\",\"msg\":\"Executions scavenger started\",\"service\":\"worker\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/service/worker/scanner/executions/scavenger.go:140\"}\n{\"level\":\"error\",\"ts\":\"2025-07-14T12:31:03.960Z\",\"msg\":\"Operation failed with internal error.\",\"error\":\"ListConcreteExecutions is not implemented\",\"error-type\":\"serviceerror.Unimplemented\",\"operation\":\"ListConcreteExecutions\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/common/persistence/persistence_metric_clients.go:1319\",\"stacktrace\":\"go.temporal.io/server/common/log.(*zapLogger).Error\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/common/log/zap_logger.go:154\\ngo.temporal.io/server/common/persistence.updateErrorMetric\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/common/persistence/persistence_metric_clients.go:1319\\ngo.temporal.io/server/common/persistence.(*metricEmitter).recordRequestMetrics\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/common/persistence/persistence_metric_clients.go:1291\\ngo.temporal.io/server/common/persistence.(*executionPersistenceClient).ListConcreteExecutions.func1\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/common/persistence/persistence_metric_clients.go:352\\ngo.temporal.io/server/common/persistence.(*executionPersistenceClient).ListConcreteExecutions\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/common/persistence/persistence_metric_clients.go:354\\ngo.temporal.io/server/common/persistence.(*executionRetryablePersistenceClient).ListConcreteExecutions.func1\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/common/persistence/persistence_retryable_clients.go:350\\ngo.temporal.io/server/common/backoff.ThrottleRetryContext\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/common/backoff/retry.go:89\\ngo.temporal.io/server/common/persistence.(*executionRetryablePersistenceClient).ListConcreteExecutions\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/common/persistence/persistence_retryable_clients.go:354\\ngo.temporal.io/server/service/worker/scanner/executions.(*task).Run.(*task).getPaginationFn.func1\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/service/worker/scanner/executions/task.go:218\\ngo.temporal.io/server/common/collection.(*PagingIteratorImpl[...]).getNextPage\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/common/collection/paging_iterator.go:116\\ngo.temporal.io/server/common/collection.NewPagingIteratorWithToken[...]\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/common/collection/paging_iterator.go:68\\ngo.temporal.io/server/service/worker/scanner/executions.(*task).Run\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/service/worker/scanner/executions/task.go:116\\ngo.temporal.io/server/service/worker/scanner/executor.(*fixedPoolExecutor).worker\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/service/worker/scanner/executor/executor.go:144\"}\n{\"level\":\"error\",\"ts\":\"2025-07-14T12:31:03.960Z\",\"msg\":\"unable to paginate concrete execution\",\"service\":\"worker\",\"shard-id\":6,\"error\":\"ListConcreteExecutions is not implemented\",\"logging-call-at\":\"/home/runner/work/docker-builds/docker-builds/temporal/service/worker/scanner/executions/task.go:124\",\"stacktrace\":\"go.temporal.io/server/common/log.(*zapLogger).Error\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/common/log/zap_logger.go:154\\ngo.temporal.io/server/service/worker/scanner/executions.(*task).Run\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/service/worker/scanner/executions/task.go:124\\ngo.temporal.io/server/service/worker/scanner/executor.(*fixedPoolExecutor).worker\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/service/worker/scanner/executor/executor.go:144\"}\npanic: runtime error: invalid memory address or nil pointer dereference\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x38 pc=0x271c865]\n\ngoroutine 25316 [running]:\ngo.temporal.io/server/common/persistence/versionhistory.GetVersionHistory(...)\n\t/home/runner/work/docker-builds/docker-builds/temporal/common/persistence/versionhistory/version_histories.go:61\ngo.temporal.io/server/common/persistence/versionhistory.GetCurrentVersionHistory(...)\n\t/home/runner/work/docker-builds/docker-builds/temporal/common/persistence/versionhistory/version_histories.go:193\ngo.temporal.io/server/service/worker/scanner/executions.(*mutableStateValidator).Validate(0xc000fb9c00, {0x317a396?, 0x18?}, 0xc000fb9f08)\n\t/home/runner/work/docker-builds/docker-builds/temporal/service/worker/scanner/executions/mutable_state_validator.go:80 +0x65\ngo.temporal.io/server/service/worker/scanner/executions.(*task).validate(0xc0008d2e40, 0xc000fb9f08)\n\t/home/runner/work/docker-builds/docker-builds/temporal/service/worker/scanner/executions/task.go:171 +0x59b\ngo.temporal.io/server/service/worker/scanner/executions.(*task).Run(0xc0008d2e40)\n\t/home/runner/work/docker-builds/docker-builds/temporal/service/worker/scanner/executions/task.go:129 +0x493\ngo.temporal.io/server/service/worker/scanner/executor.(*fixedPoolExecutor).worker(0xc000e49450)\n\t/home/runner/work/docker-builds/docker-builds/temporal/service/worker/scanner/executor/executor.go:144 +0x9b\ncreated by go.temporal.io/server/service/worker/scanner/executor.(*fixedPoolExecutor).Start in goroutine 25311\n\t/home/runner/work/docker-builds/docker-builds/temporal/service/worker/scanner/executor/executor.go:106 +0x45\n\n```\n\n## Specifications\n\n<img width=\"978\" height=\"545\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/0903b500-7f5d-42a8-ac94-b494b4121298\" />\n","closedAt":"2025-08-07T23:24:55Z","comments":[{"id":"IC_kwDODNqesM629iCx","author":{"login":"tunsuy"},"authorAssociation":"NONE","body":"```\n// GetVersionHistory gets the VersionHistory according to index provided.\nfunc GetVersionHistory(h *historyspb.VersionHistories, index int32) (*historyspb.VersionHistory, error) {\n\tif index < 0 || index >= int32(len(h.Histories)) {\n\t\treturn nil, serviceerror.NewInternal(\"version histories index is out of range.\")\n\t}\n\n\treturn h.Histories[index], nil\n}\n```\n\nh may be is nil?","createdAt":"2025-07-14T13:15:55Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/8037#issuecomment-3069583537","viewerDidAuthor":false},{"id":"IC_kwDODNqesM65tGM0","author":{"login":"yycptt"},"authorAssociation":"MEMBER","body":"Thanks for reporting the issue @tunsuy \n\nThe issue is actually [here](https://github.com/temporalio/temporal/blob/7e20e7d81ad654d16d9466889a9afc2c3261850d/service/worker/scanner/executions/task.go#L101), the logic didn't return on errors and continued to validate an empty record causing the NPE. We will work on a fix for that.\n\n\n> ListConcreteExecutions is not implemented\n\nHowever, ^ log message suggests that you are using sql DB and should not turn on the execution scanner. SQL don't have that persistence api implementation and basically doesn't support execution scanner. I can see \n```\ndynamic config changed for the key: worker.executionsscannerenabled oldValue: nil newValue: { constraints: {} value: true }\"\n```\nin the log.\n\nSo for mitigation, turn off that feature flag and terminate any workflow in temporal-system namespace with workflow type `temporal-sys-executions-scanner-workflow`. \n\nTo prevent this, I guess we will add a check and only start execution scanner when the underlying DB is not SQL. Will need to talk to the team about that.\n\n","createdAt":"2025-07-25T01:23:09Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/8037#issuecomment-3115606836","viewerDidAuthor":false}],"createdAt":"2025-07-14T13:11:46Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"}],"milestone":null,"number":8037,"reactionGroups":[],"state":"CLOSED","title":"worker service abnormal restart","updatedAt":"2025-08-07T23:24:55Z","url":"https://github.com/temporalio/temporal/issues/8037"}
