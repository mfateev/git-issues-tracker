{"assignees":[],"author":{"id":"MDQ6VXNlcjMwMDg0MDQz","is_bot":false,"login":"VikasNS","name":"Vikas NS"},"body":"## Expected Behavior\r\n1. We use AWS S3 to store archived workflows.\r\n2. Authentication is via AWS Keys. The keys are pulled every 8 hours and written to the credential file. This is done as our keys are valid only for 8 hours.\r\n3. I expect temporal to use the latest keys from the credential file each and every time when connecting to AWS S3.\r\n\r\n\r\n## Actual Behavior\r\n1. Archiver object which does the archiving (which containers the AWS session object) is created only once for the first call and is cached. There after for subsequent calls, the same archiver object is used.\r\n2. This means that the AWS Keys present at the first call (at the start of the application) is used for the whole life cycle.\r\n3. This will result in archival failure after 8 hours and the keys expire after 8 hours.\r\n\r\nI feel the root of the problem is that temporal assumes that the credentials will stay the same for the whole lifecycle of the application which isn't true.\r\n\r\n\r\n## Steps to Reproduce the Problem\r\n\r\n  1. Setup AWS S3 archival\r\n  2. Configure the AWS Keys to expire , say 4 hours from creation.\r\n  3. Archival will stop working after 4 hours.\r\n\r\nThis has been discussed here -> https://community.temporal.io/t/aws-keys-updated-every-10-hours-in-credential-file/3612\r\n\r\n## Specifications\r\n\r\n  - Version: 1.1.12\r\n  - Platform: Java\r\n","closedAt":null,"comments":[{"id":"IC_kwDODNqesM49yswf","author":{"login":"yiminc"},"authorAssociation":"MEMBER","body":"This is experimental feature, we will address this once we have resource to work on productionize this.","createdAt":"2022-02-11T22:39:46Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/2470#issuecomment-1036700703","viewerDidAuthor":false},{"id":"IC_kwDODNqesM5FrEbh","author":{"login":"jontro"},"authorAssociation":"CONTRIBUTOR","body":"Not sure that this use case is supported by the aws go sdk yet. See this discussion for more context and a possible workaround: https://github.com/aws/aws-sdk-go/issues/1993","createdAt":"2022-06-28T16:07:28Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/2470#issuecomment-1168918241","viewerDidAuthor":false}],"createdAt":"2022-02-05T12:56:38Z","labels":[{"id":"MDU6TGFiZWwxNjIxMDMwNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTM4ODI4MTE3","name":"up-for-grabs","description":"Issues to consider for external contribution","color":"69CD90"}],"milestone":null,"number":2470,"reactionGroups":[],"state":"OPEN","title":"Temporal assumes the credentials of storage service used for archival will stay the same through out the life cycle of the application.","updatedAt":"2023-03-03T20:20:38Z","url":"https://github.com/temporalio/temporal/issues/2470"}
