{"assignees":[{"id":"MDQ6VXNlcjU4MzkxOQ==","login":"underrun","name":"J Derek Wilson","databaseId":0},{"id":"MDQ6VXNlcjIyMzI1MjQ=","login":"alexshtin","name":"Alex Shtin","databaseId":0},{"id":"MDQ6VXNlcjExODM4OTgx","login":"feedmeapples","name":"Ruslan","databaseId":0}],"author":{"id":"MDQ6VXNlcjUyMjI1MTI=","is_bot":false,"login":"hazcod","name":"Niels Hofmans"},"body":"**Is your feature request related to a problem? Please describe.**\r\nRunning amd64 builds on Apple Silicon is very slow and will trigger a qemu crash on Docker for Mac on Apple Silicon hardware.\r\n\r\n**Describe the solution you'd like**\r\nPush builds native to Apple Silicon and ARM in general.\r\n\r\n\r\n**Additional context**\r\n```\r\ntemporal_1    | 2021/02/19 07:15:42 Schema updated from 1.3 to 1.4\r\ntemporal_1    | 2021/02/19 07:15:42 UpdateSchemeTask done\r\ntemporal_1    | + VISIBILITY_SCHEMA_DIR=/etc/temporal/schema/postgresql/v96/visibility/versioned\r\ntemporal_1    | + temporal-sql-tool --plugin postgres --ep postgres -u root -p 26257 create --db temporal_visibility\r\ntemporal_1    | + temporal-sql-tool --plugin postgres --ep postgres -u root -p 26257 --db temporal_visibility setup-schema -v 0.0\r\ntemporal_1    | qemu: uncaught target signal 11 (Segmentation fault) - core dumped\r\ntemporal_1    | /start.sh: line 68:    64 Segmentation fault      temporal-sql-tool --plugin postgres --ep $POSTGRES_SEEDS -u $POSTGRES_USER -p $DB_PORT --db $VISIBILITY_DBNAME setup-schema -v 0.0\r\n```\r\n","closedAt":"2022-10-08T05:54:26Z","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDc4MjE0NDM0NQ==","author":{"login":"tristan-hyams"},"authorAssociation":"NONE","body":"Not a Temporal Server issue, while still frustrating. Looks like many users have this problem on the A14 chipsets.\r\n\r\nhttps://github.com/docker/for-mac/issues/5123","createdAt":"2021-02-19T15:22:32Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1305#issuecomment-782144345","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDc4NTA2MDI1Mw==","author":{"login":"hazcod"},"authorAssociation":"CONTRIBUTOR","body":"I guess it's still nice to be able to push native `arm64` builds now go `1.16` is out.","createdAt":"2021-02-24T13:04:09Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1305#issuecomment-785060253","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDgwNTU2NzQ4MQ==","author":{"login":"hazcod"},"authorAssociation":"CONTRIBUTOR","body":"FYI now temporal builds with Go 1.16, we should push arm64 builds.","createdAt":"2021-03-24T07:22:53Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"url":"https://github.com/temporalio/temporal/issues/1305#issuecomment-805567481","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDgwODMxMDI3Mw==","author":{"login":"hazcod"},"authorAssociation":"CONTRIBUTOR","body":"@wxing1292 FYI we're still not pushing arm64 builds to Docker hub.","createdAt":"2021-03-26T15:27:32Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1305#issuecomment-808310273","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg0ODI4MjkxMw==","author":{"login":"pquerna"},"authorAssociation":"CONTRIBUTOR","body":"Also needs `temporalio/base-builder` to have an arm build: https://hub.docker.com/r/temporalio/base-builder","createdAt":"2021-05-25T21:36:29Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1305#issuecomment-848282913","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg2MDk2OTkyNw==","author":{"login":"alexshtin"},"authorAssociation":"CONTRIBUTOR","body":"With #1575 merged it becomes easier to build ARM images. I did it locally with simple command:\r\n```\r\ndocker buildx build --platform linux/arm64 --output type=image .\r\n```\r\n\r\nWe will consider adding ARM to our release images.","createdAt":"2021-06-14T20:27:33Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":7}},{"content":"EYES","users":{"totalCount":1}}],"url":"https://github.com/temporalio/temporal/issues/1305#issuecomment-860969927","viewerDidAuthor":false},{"id":"IC_kwDODNqesM42Ppmp","author":{"login":"hazcod"},"authorAssociation":"CONTRIBUTOR","body":"Is there an ETA on this? :-)\r\nI still can't run temporal on my development machines.","createdAt":"2021-09-01T08:44:25Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"EYES","users":{"totalCount":2}}],"url":"https://github.com/temporalio/temporal/issues/1305#issuecomment-910072233","viewerDidAuthor":false},{"id":"IC_kwDODNqesM444Tz5","author":{"login":"brent-bradbury-stoke-space"},"authorAssociation":"NONE","body":"I am seeing this error on 1.12.3 and 1.13.0 with some subtle differences on an M1 Mac.\r\n\r\n1) On 1.12.3, I am able to have **success** if I delete the postgres container and image and allow docker-compose to build them fresh. \r\n2) On 1.12.3, I see a **segfault** if I start with an existing postgres container. On 1.12.3, this comes with a helpful error message:\r\n\r\n>   ```\r\n> temporal                | {\"level\":\"info\",\"ts\":\"2021-10-28T20:43:47.526Z\",\"msg\":\"Get dynamic \r\n> config\",\"name\":\"system.advancedVisibilityWritingMode\",\"value\":\"on\",\"default-value\":\"on\",\"logging-call- \r\n> at\":\"config.go:79\"}\r\n> temporal                | Unable to start server. Error: sql schema version compatibility check failed: version mismatch for \r\n> keyspace/database: \"temporal\". Expected version: 1.6 cannot be greater than Actual version: 0.0\r\n> ```\r\n\r\n3) On 1.13.0, I get a **segfault** with postgres in either state. There is **not** a helpful error message, just a segfault.\r\n> ```\r\n> temporal                | qemu: uncaught target signal 11 (Segmentation fault) - core dumped\r\n> temporal                | ./auto-setup.sh: line 173:    52 Segmentation fault      temporal-sql-tool --plugin postgres --ep > \"${POSTGRES_SEEDS}\" -u \"${POSTGRES_USER}\" -p \"${DB_PORT}\" --db \"${DBNAME}\" update-schema -d \"${SCHEMA_DIR}\"\r\n> ```\r\n\r\n...Thus I think there is some relationship between this bug and the degree to which the postgres database is initialized. ","createdAt":"2021-10-28T22:59:30Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1305#issuecomment-954285305","viewerDidAuthor":false},{"id":"IC_kwDODNqesM5AcBfc","author":{"login":"feedmeapples"},"authorAssociation":"CONTRIBUTOR","body":"there is a set of new GHA pipelines that build both arm64 and amd64 images:\r\n\r\nbuild & release of base*-images\r\nhttps://github.com/temporalio/docker-builds/actions/workflows/release-base-image.yml\r\n\r\nbuild of `server`, `admin-tools` and `auto-setup` images:\r\nhttps://github.com/temporalio/docker-builds/actions/workflows/docker.yml\r\n\r\nrelease of `server`, `admin-tools` and `auto-setup` images:\r\nhttps://github.com/temporalio/docker-builds/actions/workflows/release-temporal.yml","createdAt":"2022-03-28T20:07:43Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1305#issuecomment-1081087964","viewerDidAuthor":false}],"createdAt":"2021-02-19T07:18:15Z","labels":[{"id":"MDU6TGFiZWwxNjIxMDMwNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMDE5ODkxMzc4","name":"packaging","description":"","color":"baf702"},{"id":"MDU6TGFiZWwyMDE5OTE0ODQ5","name":"docker","description":"","color":"eda6d4"},{"id":"MDU6TGFiZWwyODE3MDk3ODQ0","name":"planning","description":"","color":"006b75"}],"milestone":null,"number":1305,"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":11}}],"state":"CLOSED","title":"Feature: provide arm64 builds to Docker Hub","updatedAt":"2022-10-08T05:54:26Z","url":"https://github.com/temporalio/temporal/issues/1305"}
