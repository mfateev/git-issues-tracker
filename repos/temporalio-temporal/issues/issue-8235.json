{"assignees":[],"author":{"id":"MDQ6VXNlcjIyMTIzNTQ=","is_bot":false,"login":"loicsaintroch","name":"Lo√Øc Saint-Roch"},"body":"## Expected Behavior\r\n\r\nWhen passing both a workflow and run ID, the SDK should return the desired run for the given workflow, even though this workflow has been archived, right?\r\n\r\nSo this code should work:\r\n```go\r\nwr := c.GetWorkflow(context.Background(), WorkflowId, RunId)\r\nerr = wr.Get(context.Background(), &ptr)\r\nif err != nil {\r\n  // ...\r\n}\r\n```\r\n\r\n## Actual Behavior\r\n\r\nBut when executing this, I have the following error:\r\n```bash\r\nWorkflow executionsRow not found.  WorkflowId: <id>, RunId: <id>\r\n```\r\n\r\nIt looks like the error comes from [temporalio/temporal/blob/master/common/persistence/sql/execution.go#L257](https://github.com/temporalio/temporal/blob/master/common/persistence/sql/execution.go#L257)\r\n\r\n## Steps to Reproduce the Problem\r\n\r\n  1. Run a workflow, and wait for it to be archived.\r\n  2. With the SDK, get the workflow by passing its ID and a run ID.\r\n\r\n(I use the file storage for archival, which works fine.)\r\n\r\n## Specifications\r\n\r\n  - Version: SDK v1.8.0, Server v1.11.2\r\n  - Platform: `darwin`\r\n","closedAt":null,"comments":[{"id":"IC_kwDODNqesM6_-Sb-","author":{"login":"loicsaintroch"},"authorAssociation":"NONE","body":"In case anyone else has issue related to this one, here is a little snippet of the workaround I use for now:\r\n\r\n```go\r\n// Try to find the desired workflow, with no run ID. If no workflow is returned,\r\n// continue so we can try to find if from the archival store.\r\nw := c.GetWorkflow(context.Background(), workflowID, \"\")\r\nerr = w.Get(context.Background(), &result)\r\nif err != nil {\r\n  if _, notFound := err.(*serviceerror.NotFound); !notFound {\r\n    // return ...\r\n  }\r\n}\r\n\r\n// Build the search query for the archival store.\r\nsearch := &workflowservice.ListArchivedWorkflowExecutionsRequest{\r\n  Namespace: \"\",\r\n  Query:     fmt.Sprintf(\"WorkflowId = '%s'\", workflowID),\r\n}\r\n\r\n// Try to find the workflow from the archived ones.\r\nworkflows, err := c.ListArchivedWorkflow(context.Background(), search)\r\nif err != nil {\r\n  // return ...\r\n}\r\n\r\n// Save the workflow ID and run ID from the executions returned by the\r\n// archival store. In my case I just need the first one returned.\r\nworkflowID = workflows.Executions[0].Execution.WorkflowId\r\nrunID := workflows.Executions[0].Execution.RunId\r\n\r\n// Iter over events found for the given workflow ID and run ID.\r\niter := c.GetWorkflowHistory(context.Background(), workflowID, runID, false, 1)\r\nevents := []*history.HistoryEvent{}\r\nfor iter.HasNext() {\r\n  event, err := iter.Next()\r\n  if err != nil {\r\n    // return ...\r\n  }\r\n\r\n  // Only add the events we desire. In this case when a workflow is started (2),\r\n  // completed (3), or failed (4).\r\n  if event.EventType == 2 || event.EventType == 3 || event.EventType == 4 {\r\n    events = append(events, event)\r\n  }\r\n}\r\n\r\n// ...\r\n\r\n// Try to unmarshal the data of the payload found.\r\nerr = json.Unmarshal(events[0].GetWorkflowExecutionCompletedEventAttributes().Result.Payloads[0].Data, &result)\r\nif err != nil {\r\n  // return ...\r\n}\r\n```\r\n\r\nNot sure if this is best / idiomatic way to achieve this, but it fits perfectly for my use case.","createdAt":"2021-08-25T14:23:28Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/8235#issuecomment-3220776702","viewerDidAuthor":false}],"createdAt":"2021-08-06T08:22:53Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"}],"milestone":null,"number":8235,"reactionGroups":[],"state":"OPEN","title":"GetWorkflow doesn't find archived one","updatedAt":"2025-08-25T15:40:13Z","url":"https://github.com/temporalio/temporal/issues/8235"}
