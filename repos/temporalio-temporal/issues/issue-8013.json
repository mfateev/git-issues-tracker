{"assignees":[],"author":{"id":"MDQ6VXNlcjIwNTUyNDYw","is_bot":false,"login":"genek96","name":"Евгений Ишутин"},"body":"## Expected Behavior\nWhen a workflow is created with a custom search attribute, and the ListWorkflows method is called using this attribute, we expect the result to either include the matching workflow or return no results (if the visibility task has not yet been processed).\n\n\n## Actual Behavior\nIn some cases, the method returns a workflow that does not contain the requested search attribute. This workflow was created at the same time (within the same second) as the expected one.\n\n\n## Steps to Reproduce the Problem\n\n  1. Start a workflow using the .NET SDK with TypedSearchAttributes, like this:\n```c#\nvar handle = await client.StartWorkflowAsync(\n    workflowRunCall,\n    new(options.WorkflowId.ToString(), GetQueueName<TWorkflow>())\n    {\n        TypedSearchAttributes = GetSearchAttributes(options)\n    }\n);\n```\nHere, the method GetSearchAttributes returns a SearchAttributeCollection. It includes a single attribute: orderId, of type Guid (UUIDv4).\n\n 2. Start another workflow of the same type with the orderId attribute set to a different UUIDv4.\n 3. After about 2 seconds, call ListWorkflowsAsync with the desired orderId value:\n\n```\nvar query = $\"orderId='{orderId}'\";\nvar workflows = client.ListWorkflowsAsync(query);\n```\n\n 4. The result contains one workflow, but it is not the expected one. Instead, it returns the workflow that was created at the same second as the expected one.\n 5. After a while (we have checked after 15 minutes) the index became consistent and search works correctly.\n\n\n## Additional Notes\nThis behavior appears approximately once every 1,000–2,000 workflow runs.\n\nWhile we understand that the visibility store is eventually consistent, it is unexpected for the result to return an incorrect workflow, rather than the correct one or an empty result.\n\n## Specifications\n\n  - Version: 1.26\n  - Persistence storage: Cassandra 4.1.5\n  - Visibility storage: postgreSQL 16\n  - Platform: all\n","closedAt":null,"comments":[],"createdAt":"2025-07-04T11:40:38Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"}],"milestone":null,"number":8013,"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"state":"OPEN","title":"List workflows by custom search attributes sometimes returns wrong value","updatedAt":"2025-07-04T11:45:58Z","url":"https://github.com/temporalio/temporal/issues/8013"}
