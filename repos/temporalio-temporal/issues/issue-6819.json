{"assignees":[],"author":{"id":"MDQ6VXNlcjExODE2MTg1","is_bot":false,"login":"smile-yi","name":"王中艺"},"body":"The server grpc \"MaxRecvMsgSize\" iuses the default value of 4M and is not rewritten, but the client sdk grpc \"MaxSendMsgSize\" is rewritten to 128M. What is the reason for this?\r\n\r\nserver: \r\n```\r\nfunc NewService(\r\n\tserver *grpc.Server,\r\n\tserviceConfig *configs.Config,\r\n\tvisibilityMgr manager.VisibilityManager,\r\n\thandler *Handler,\r\n\tlogger log.Logger,\r\n\tgrpcListener net.Listener,\r\n\tmembershipMonitor membership.Monitor,\r\n\tmetricsHandler metrics.Handler,\r\n\thealthServer *health.Server,\r\n) *Service {\r\n\treturn &Service{\r\n\t\tserver:            server,\r\n\t\thandler:           handler,\r\n\t\tvisibilityManager: visibilityMgr,\r\n\t\tconfig:            serviceConfig,\r\n\t\tlogger:            logger,\r\n\t\tgrpcListener:      grpcListener,\r\n\t\tmembershipMonitor: membershipMonitor,\r\n\t\tmetricsHandler:    metricsHandler,\r\n\t\thealthServer:      healthServer,\r\n\t}\r\n}\r\n```\r\n\r\nclient: \r\n```\r\ndefaultMaxPayloadSize = 128 * mb\r\n...\r\nopts = append(opts, securityOptions...)\r\nopts = append(opts, grpc.WithDefaultCallOptions(grpc.MaxCallSendMsgSize(maxPayloadSize)))\r\nopts = append(opts, grpc.WithDefaultCallOptions(grpc.MaxCallRecvMsgSize(maxPayloadSize)))\r\n```\r\n","closedAt":null,"comments":[{"id":"IC_kwDODNqesM6fgCvr","author":{"login":"AlbertZheng"},"authorAssociation":"NONE","body":"Same question! and this caused an critical error \"io.grpc.StatusRuntimeException: RESOURCE_EXHAUSTED: grpc: received message larger than max (5214441 vs. 4194304)\" in our prod envs.\n\nI suggest if the server codes can be improved to use the same grpc \"MaxRecvMsgSize\" (= 128M)  with the client sdk grpc \"MaxSendMsgSize\", this problem will be resolved right away!","createdAt":"2025-02-22T03:15:25Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/6819#issuecomment-2675977195","viewerDidAuthor":false}],"createdAt":"2024-11-15T02:27:16Z","labels":[],"milestone":null,"number":6819,"reactionGroups":[],"state":"OPEN","title":"Why is the default value of the SDK client grpc \"MaxSendMsgSize\" inconsistent with the server grpc \"MaxRecvMsgSize\"?","updatedAt":"2025-02-22T03:15:27Z","url":"https://github.com/temporalio/temporal/issues/6819"}
