{"assignees":[],"author":{"id":"MDQ6VXNlcjI5MTU4OTcx","is_bot":false,"login":"jpds","name":"Jonathan Davies"},"body":"## Actual Behavior\n\nThe tests for 1.28.1 fail with this index out of range error (edit: also verified that this happens on `master` with Go 1.25.0):\n\n```\n$ nix-build -A temporal\nthis derivation will be built:\n  /nix/store/6m05da84v48da31w1rrny70mxkrlcwyp-temporal-1.28.1.drv\nthese 3 paths will be fetched (74.82 MiB download, 530.78 MiB unpacked):\n  /nix/store/g026m2zmhiah7izdmmvgsq847z2sh1h1-go-1.24.6\n  /nix/store/504v301gh8iaz29cih9y0xkcgbbnp3w3-source\n  /nix/store/hcdf04mgvypa9b598rncy4h4k6wz9cal-temporal-1.28.1-go-modules\ncopying path '/nix/store/504v301gh8iaz29cih9y0xkcgbbnp3w3-source' from 'https://cache.nixos.org'...\ncopying path '/nix/store/hcdf04mgvypa9b598rncy4h4k6wz9cal-temporal-1.28.1-go-modules' from 'https://cache.nixos.org'...\ncopying path '/nix/store/g026m2zmhiah7izdmmvgsq847z2sh1h1-go-1.24.6' from 'https://cache.nixos.org'...\nbuilding '/nix/store/6m05da84v48da31w1rrny70mxkrlcwyp-temporal-1.28.1.drv'...\nRunning phase: unpackPhase\nunpacking source archive /nix/store/504v301gh8iaz29cih9y0xkcgbbnp3w3-source\nsource root is source\nRunning phase: patchPhase\nRunning phase: updateAutotoolsGnuConfigScriptsPhase\nRunning phase: configurePhase\nRunning phase: buildPhase\nBuilding subPackage ./api/adminservice/v1\n...\nBuilding subPackage ./tools/tests\nbuildPhase completed in 3 minutes 36 seconds\nRunning phase: checkPhase\nok      go.temporal.io/server/chasm     0.042s\nok      go.temporal.io/server/client/history    0.935s\n?       go.temporal.io/server/client/history/historytest        [no test files]\nok      go.temporal.io/server/client/matching   0.009s\nok      go.temporal.io/server/cmd/tools/genrpcserverinterceptors        0.007s\nok      go.temporal.io/server/common    0.015s\nok      go.temporal.io/server/common/aggregate  0.003s [no tests to run]\nok      go.temporal.io/server/common/api        0.007s\nok      go.temporal.io/server/common/archiver   0.057s\nok      go.temporal.io/server/common/archiver/filestore 0.027s\nok      go.temporal.io/server/common/archiver/gcloud    0.035s\nok      go.temporal.io/server/common/archiver/gcloud/connector  0.031s\nok      go.temporal.io/server/common/archiver/s3store   0.037s\nok      go.temporal.io/server/common/auth       0.047s\nok      go.temporal.io/server/common/authorization      2.802s\nok      go.temporal.io/server/common/backoff    2.397s\nok      go.temporal.io/server/common/cache      0.033s\nok      go.temporal.io/server/common/checksum   0.013s\nok      go.temporal.io/server/common/circuitbreaker     0.013s\nok      go.temporal.io/server/common/clock      0.010s\nok      go.temporal.io/server/common/clock/hybrid_logical_clock 0.004s\nok      go.temporal.io/server/common/cluster    0.013s\nok      go.temporal.io/server/common/codec      0.009s\nok      go.temporal.io/server/common/codec/gob  0.004s\nok      go.temporal.io/server/common/collection 0.352s\nok      go.temporal.io/server/common/config     0.024s\nok      go.temporal.io/server/common/deadlock   0.026s\nok      go.temporal.io/server/common/definition 0.005s\nok      go.temporal.io/server/common/dynamicconfig      0.060s\nok      go.temporal.io/server/common/effect     0.003s\nok      go.temporal.io/server/common/failure    0.005s\nok      go.temporal.io/server/common/finalizer  0.115s\nok      go.temporal.io/server/common/future     0.026s\nok      go.temporal.io/server/common/goro       0.017s\nok      go.temporal.io/server/common/headers    0.008s\nok      go.temporal.io/server/common/locks      1.447s\nok      go.temporal.io/server/common/log        0.009s\nok      go.temporal.io/server/common/log/tag    0.005s\nok      go.temporal.io/server/common/masker     0.004s\nok      go.temporal.io/server/common/membership 0.011s\nok      go.temporal.io/server/common/membership/ringpop 28.143s\nok      go.temporal.io/server/common/metrics    0.228s\nok      go.temporal.io/server/common/metrics/metricstest        0.011s\nok      go.temporal.io/server/common/metrics/tally/statsd       0.004s\nok      go.temporal.io/server/common/namespace  0.011s\nok      go.temporal.io/server/common/namespace/nsmanager        0.012s\nok      go.temporal.io/server/common/namespace/nsregistry       2.028s\nok      go.temporal.io/server/common/namespace/nsreplication    0.018s\nok      go.temporal.io/server/common/nexus      0.221s\nok      go.temporal.io/server/common/number     0.004s\nok      go.temporal.io/server/common/payload    0.006s\nok      go.temporal.io/server/common/payloads   0.006s\nok      go.temporal.io/server/common/persistence        0.165s\nok      go.temporal.io/server/common/persistence/cassandra      0.022s\nok      go.temporal.io/server/common/persistence/client 6.029s\nok      go.temporal.io/server/common/persistence/faultinjection 0.021s\nok      go.temporal.io/server/common/persistence/nosql/nosqlplugin/cassandra/gocql      0.021s\n--- FAIL: TestSessionTestSuite (0.00s)\n    --- FAIL: TestSessionTestSuite/TestFixedAddressTranslator (0.00s)\n        panic.go:115: test panicked: runtime error: index out of range [0] with length 0\n            goroutine 12 [running]:\n            runtime/debug.Stack()\n                /nix/store/g026m2zmhiah7izdmmvgsq847z2sh1h1-go-1.24.6/share/go/src/runtime/debug/stack.go:26 +0x5e\n            github.com/stretchr/testify/suite.failOnPanic(0xc000655880, {0x12dfe60, 0xc00014e438})\n                /build/source/vendor/github.com/stretchr/testify/suite/suite.go:89 +0x37\n            github.com/stretchr/testify/suite.Run.func1.1()\n                /build/source/vendor/github.com/stretchr/testify/suite/suite.go:188 +0x299\n            panic({0x12dfe60?, 0xc00014e438?})\n                /nix/store/g026m2zmhiah7izdmmvgsq847z2sh1h1-go-1.24.6/share/go/src/runtime/panic.go:792 +0x132\n            go.temporal.io/server/common/persistence/nosql/nosqlplugin/cassandra/translator.(*fixedTranslatorPluginTestSuite).TestFixedAddressTranslator(0xc0007a41e0)\n                /build/source/common/persistence/nosql/nosqlplugin/cassandra/translator/fixed_address_translator_test.go:55 +0x3e5\n            reflect.Value.call({0xc00061b940?, 0xc000622d50?, 0x7fffb113c6a8?}, {0x13c0088, 0x4}, {0xc000634f28, 0x1, 0x11848a0?})\n                /nix/store/g026m2zmhiah7izdmmvgsq847z2sh1h1-go-1.24.6/share/go/src/reflect/value.go:584 +0xca6\n            reflect.Value.Call({0xc00061b940?, 0xc000622d50?, 0x1def560?}, {0xc000634f28?, 0xf?, 0x0?})\n                /nix/store/g026m2zmhiah7izdmmvgsq847z2sh1h1-go-1.24.6/share/go/src/reflect/value.go:368 +0xb9\n            github.com/stretchr/testify/suite.Run.func1(0xc000655880)\n                /build/source/vendor/github.com/stretchr/testify/suite/suite.go:202 +0x476\n            testing.tRunner(0xc000655880, 0xc0005b6120)\n                /nix/store/g026m2zmhiah7izdmmvgsq847z2sh1h1-go-1.24.6/share/go/src/testing/testing.go:1792 +0xf4\n            created by testing.(*T).Run in goroutine 11\n                /nix/store/g026m2zmhiah7izdmmvgsq847z2sh1h1-go-1.24.6/share/go/src/testing/testing.go:1851 +0x413\nFAIL\nFAIL    go.temporal.io/server/common/persistence/nosql/nosqlplugin/cassandra/translator 0.020s\nFAIL\nerror: builder for '/nix/store/6m05da84v48da31w1rrny70mxkrlcwyp-temporal-1.28.1.drv' failed with exit code 1;\n       last 25 log lines:\n       >         panic.go:115: test panicked: runtime error: index out of range [0] with length 0\n       >             goroutine 12 [running]:\n       >             runtime/debug.Stack()\n       >                   /nix/store/g026m2zmhiah7izdmmvgsq847z2sh1h1-go-1.24.6/share/go/src/runtime/debug/stack.go:26 +0x5e\n       >             github.com/stretchr/testify/suite.failOnPanic(0xc000655880, {0x12dfe60, 0xc00014e438})\n       >                   /build/source/vendor/github.com/stretchr/testify/suite/suite.go:89 +0x37\n       >             github.com/stretchr/testify/suite.Run.func1.1()\n       >                    /build/source/vendor/github.com/stretchr/testify/suite/suite.go:188 +0x299\n       >             panic({0x12dfe60?, 0xc00014e438?})\n       >               /nix/store/g026m2zmhiah7izdmmvgsq847z2sh1h1-go-1.24.6/share/go/src/runtime/panic.go:792 +0x132\n       >             go.temporal.io/server/common/persistence/nosql/nosqlplugin/cassandra/translator.(*fixedTranslatorPluginTestSuite).TestFixedAddressTranslator(0xc0007a41e0)\n       >                   /build/source/common/persistence/nosql/nosqlplugin/cassandra/translator/fixed_address_translator_test.go:55 +0x3e5\n       >             reflect.Value.call({0xc00061b940?, 0xc000622d50?, 0x7fffb113c6a8?}, {0x13c0088, 0x4}, {0xc000634f28, 0x1, 0x11848a0?})\n       >                   /nix/store/g026m2zmhiah7izdmmvgsq847z2sh1h1-go-1.24.6/share/go/src/reflect/value.go:584 +0xca6\n       >             reflect.Value.Call({0xc00061b940?, 0xc000622d50?, 0x1def560?}, {0xc000634f28?, 0xf?, 0x0?})\n       >                  /nix/store/g026m2zmhiah7izdmmvgsq847z2sh1h1-go-1.24.6/share/go/src/reflect/value.go:368 +0xb9\n       >             github.com/stretchr/testify/suite.Run.func1(0xc000655880)\n       >                     /build/source/vendor/github.com/stretchr/testify/suite/suite.go:202 +0x476\n       >             testing.tRunner(0xc000655880, 0xc0005b6120)\n       >              /nix/store/g026m2zmhiah7izdmmvgsq847z2sh1h1-go-1.24.6/share/go/src/testing/testing.go:1792 +0xf4\n       >             created by testing.(*T).Run in goroutine 11\n       >                /nix/store/g026m2zmhiah7izdmmvgsq847z2sh1h1-go-1.24.6/share/go/src/testing/testing.go:1851 +0x413\n       > FAIL\n       > FAIL     go.temporal.io/server/common/persistence/nosql/nosqlplugin/cassandra/translator 0.020s\n       > FAIL\n       For full logs, run:\n         nix log /nix/store/6m05da84v48da31w1rrny70mxkrlcwyp-temporal-1.28.1.drv\n```\n\n## Specifications\n\n  - Version: 1.28.1\n  - Platform: NixOS","closedAt":"2025-09-18T22:55:22Z","comments":[{"id":"IC_kwDODNqesM7FSb7-","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"Looks like you have an issue with DNS resolution on your machine where you cannot resolve the `temporal.io` domain.\n\nArguably this isn't something that should be done in a unit test but there's not much motivation to change that.\nFeel free to contribute an alternative implementation for this test.\n\nhttps://github.com/temporalio/temporal/blob/3c70576d102810ca3021bca04b4b8293f3473e1a/common/persistence/nosql/nosqlplugin/cassandra/translator/fixed_address_translator_test.go#L50","createdAt":"2025-09-18T22:55:22Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/8294#issuecomment-3309944574","viewerDidAuthor":false}],"createdAt":"2025-09-06T07:13:34Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"}],"milestone":null,"number":8294,"reactionGroups":[],"state":"CLOSED","title":"TestFixedAddressTranslator index out of range","updatedAt":"2025-09-18T22:55:22Z","url":"https://github.com/temporalio/temporal/issues/8294"}
