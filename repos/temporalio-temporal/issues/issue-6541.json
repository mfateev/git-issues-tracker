{"assignees":[],"author":{"id":"MDQ6VXNlcjIyNzg5ODUx","is_bot":false,"login":"ndtretyak","name":"Nikolay Tretyak"},"body":"## Expected Behavior\r\n`ListQueues` (and other methods using `getAnyClient`) handles history hosts failures.\r\n\r\n## Actual Behavior\r\n\r\n`cachingRedirector` handles history failures in its `redirectLoop` and removes failed hosts from the cache\r\nhttps://github.com/temporalio/temporal/blob/86817057833b6c44d47c8da6920b7af783348355/client/history/caching_redirector.go#L110-L113\r\n\r\nHowever, `ListQueues` does not use `redirectLoop` and calls corresponding client's method directly.\r\nhttps://github.com/temporalio/temporal/blob/86817057833b6c44d47c8da6920b7af783348355/client/history/client.go#L298-L308\r\n\r\nThat causes a broken host not to be removed from the cache.\r\n\r\n## Steps to Reproduce the Problem\r\n\r\n  1. Use `cachingRedirector`\r\n  1. Turn off a history host\r\n  1. Call `ListQueues`\r\n\r\n## Specifications\r\n\r\n  - Version:\r\n  - Platform:\r\n","closedAt":null,"comments":[],"createdAt":"2024-09-22T08:59:59Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"}],"milestone":null,"number":6541,"reactionGroups":[],"state":"OPEN","title":"getAnyClient with cachingRedirector problem","updatedAt":"2024-09-22T08:59:59Z","url":"https://github.com/temporalio/temporal/issues/6541"}
