{"assignees":[],"author":{"id":"MDQ6VXNlcjExOTQyMg==","is_bot":false,"login":"tsurdilo","name":"Tihomir Surdilovic"},"body":"How issue was found:\nTry adding same search attribute multiple times via cli - cli always gives \"ok\" response, for example try running this command multiple times:\n\n          temporal operator search-attribute create --name MyCustomSA --type Keyword\n          Search attributes have been added\n\nWhen adding SA server has this loop where it creates aliasToFieldMap - https://github.com/temporalio/temporal/blob/4c2403736409e6f38972df3be4de480026a5b6fa/service/frontend/operator_handler.go#L279\n\nIn this loop server logs the warn message with errSearchAttributeAlreadyExistsMessage\nbut because it does not add anything to map it just returns nil - https://github.com/temporalio/temporal/blob/4c2403736409e6f38972df3be4de480026a5b6fa/service/frontend/operator_handler.go#L334\n\ninstead of serviceerror\nthis then in turn return nil to cli as response. cli does check for already exists error, but since server returns nil, error is never shown to user.\n\nAsk is to change this code on server to return serviceError instead that tells cli/sdk/clients that they are trying to create a SA that already exists   ","closedAt":null,"comments":[{"id":"IC_kwDODNqesM7c-MZC","author":{"login":"DEVMANISHOFFL"},"authorAssociation":"NONE","body":"Hiii, I m interested in contributing to the project and this looks like a good starting point..... Is this issue still available to be picked up??\nIf so, I woudl love to work on it.","createdAt":"2026-01-03T19:17:31Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/8631#issuecomment-3707291202","viewerDidAuthor":false},{"id":"IC_kwDODNqesM7eDBVD","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"I'll post this for discussion internally and see what people think is the right behavior.\nSometimes we use a request ID for deduplication, looks like here we opted to ignore duplication regardless of whether we think the request was a duplicate (for reasons I can understand).","createdAt":"2026-01-08T19:23:47Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/8631#issuecomment-3725333827","viewerDidAuthor":false},{"id":"IC_kwDODNqesM7eDDwL","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"I'm also concerned with changing this behavior now for backwards compatibility reasons. Users may already have the expectation that this request is idempotent. I would propose improving the server / CLI output to report that the search attribute already existed but not fail the API call or CLI command.","createdAt":"2026-01-08T19:26:45Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/8631#issuecomment-3725343755","viewerDidAuthor":false},{"id":"IC_kwDODNqesM7eEVPL","author":{"login":"rodrigozhou"},"authorAssociation":"MEMBER","body":"The main reason why it doesn't return already exists error is because of dual visibility. When running with dual visibility, it's possible that custom search attributes had been added to the primary one which is Elasticsearch, and you need to add to the secondary (also Elasticsearch).","createdAt":"2026-01-08T20:35:36Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/8631#issuecomment-3725677515","viewerDidAuthor":false}],"createdAt":"2025-11-13T14:13:11Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"}],"milestone":null,"number":8631,"reactionGroups":[],"state":"OPEN","title":"Trying to create search attribute that already exists should return error","updatedAt":"2026-01-08T20:42:28Z","url":"https://github.com/temporalio/temporal/issues/8631"}
