{"assignees":[],"author":{"id":"U_kgDOCeJu7w","is_bot":false,"login":"thatmlopsguy","name":""},"body":"## Expected Behavior\n\nDeploy Temporal using RDS connection.\n\n## Actual Behavior\n\nTemporal canÂ´t connect to RDS\n\n```\nsql schema version compatibility check failed: unable to read DB schema version keyspace/database: temporal error: no usable database connection found\n```\n\n```yaml\napiVersion: v1\ndata:\n  config_template.yaml: |-\n    log:\n      stdout: true\n      level: \"debug,info\"\n\n    persistence:\n      defaultStore: default\n      visibilityStore: visibility\n      numHistoryShards: 512\n      datastores:\n        default:\n          sql:\n            pluginName: \"postgres12\"\n            driverName: \"postgres12\"\n            databaseName: \"temporal\"\n            connectAddr: \"XXXXXXXXXXXXXXXX.us-east-1.rds.amazonaws.com:5432\"\n            connectProtocol: \"tcp\"\n            user: temporal\n            password: {{ .Env.TEMPORAL_STORE_PASSWORD | quote }}\n            maxConnLifetime: 1h\n            maxConns: 20\n            secretName: \"\"\n        visibility:\n          sql:\n            pluginName: \"postgres12\"\n            driverName: \"postgres12\"\n            databaseName: \"temporal_visibility\"\n            connectAddr: \"XXXXXXXXXXXXXXXX.us-east-1.rds.amazonaws.com:5432\"\n            connectProtocol: \"tcp\"\n            user: \"temporal\"\n            password: {{ .Env.TEMPORAL_VISIBILITY_STORE_PASSWORD  | quote }}\n            maxConnLifetime: 1h\n            maxConns: 20\n            secretName: \"\"\n```\n\nI am able to deploy using the following docker-compose\n\n```yaml\nversion: \"3.5\"\nservices:\n  temporal:\n    container_name: temporal\n    environment:\n      - DBNAME=temporal\n      - VISIBILITY_DBNAME=temporal_visibility # it creates the database automatically\n      - DB=postgres12\n      - DB_PORT=5432\n      - POSTGRES_USER=temporal\n      - POSTGRES_PWD=XXXXXXXXXXXXXX\n      - POSTGRES_SEEDS=XXXXXXXXXXXXXX.us-east-1.rds.amazonaws.com\n      - DYNAMIC_CONFIG_FILE_PATH=config/dynamicconfig/development-sql.yaml\n      - TEMPORAL_ADDRESS=temporal:7233\n      - TEMPORAL_CLI_ADDRESS=temporal:7233\n      ### Added variables\n      - POSTGRES_TLS_ENABLED=true\n      - POSTGRES_TLS_DISABLE_HOST_VERIFICATION=true\n      - SQL_TLS_ENABLED=true\n      - SQL_HOST_VERIFICATION=false\n    image: temporalio/auto-setup:${TEMPORAL_VERSION}\n    networks:\n      - temporal-network\n    ports:\n      - 7233:7233\n    volumes:\n      - ./dynamicconfig:/etc/temporal/config/dynamicconfig\n  # I use the auto-setup.sh script.\n  # temporal-admin-tools:\n  #   container_name: temporal-admin-tools\n  #   depends_on:\n  #     - temporal\n  #   environment:\n  #     - TEMPORAL_ADDRESS=temporal:7233\n  #     - TEMPORAL_CLI_ADDRESS=temporal:7233\n  #   image: temporalio/admin-tools:${TEMPORAL_ADMINTOOLS_VERSION}\n  #   networks:\n  #     - temporal-network\n  #   stdin_open: true\n  #   tty: true\n  temporal-ui:\n    container_name: temporal-ui\n    depends_on:\n      - temporal\n    environment:\n      - TEMPORAL_ADDRESS=temporal:7233\n      - TEMPORAL_CORS_ORIGINS=http://localhost:3000\n    image: temporalio/ui:${TEMPORAL_UI_VERSION}\n    networks:\n      - temporal-network\n    ports:\n      - 8080:8080\nnetworks:\n  temporal-network:\n    driver: bridge\n    name: temporal-network\n```\n\n\n## Specifications\n\n  - Version: 0.52.0 (helm chart)\n  - Platform: kubernetes\n","closedAt":"2025-06-30T21:01:52Z","comments":[{"id":"IC_kwDODNqesM6v1d0O","author":{"login":"thatmlopsguy"},"authorAssociation":"NONE","body":"I am able to deploy temporal if `rds.force_ssl=0`. I see several open issues with the same problem. How to setup temporal with RDS and TLS enabled.\n\nRelated: https://github.com/airbytehq/airbyte/issues/39636","createdAt":"2025-06-06T17:59:22Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/7873#issuecomment-2950028558","viewerDidAuthor":false},{"id":"IC_kwDODNqesM6v2izM","author":{"login":"1nu"},"authorAssociation":"NONE","body":"Try adding the following TLS configuration:\n```\n      datastores:\n        default:\n          sql:\n            pluginName: \"postgres12\"\n            ...\n            tls:\n             enabled: true\n             enableHostVerification: false\n```\n\nFor more details: https://docs.temporal.io/references/configuration#tls-1","createdAt":"2025-06-06T19:09:03Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/temporal/issues/7873#issuecomment-2950311116","viewerDidAuthor":false},{"id":"IC_kwDODNqesM6zcAIr","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"@thatmlopsguy can you confirm that the recommendation above fixes your issue?","createdAt":"2025-06-26T22:59:18Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/7873#issuecomment-3010462251","viewerDidAuthor":false},{"id":"IC_kwDODNqesM6zkUl6","author":{"login":"thatmlopsguy"},"authorAssociation":"NONE","body":"I imported the AWS CA certificate also to work.\n\nhttps://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.SSL.html","createdAt":"2025-06-27T11:14:14Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/7873#issuecomment-3012643194","viewerDidAuthor":false},{"id":"IC_kwDODNqesM60DF9V","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"IIUC we can close the issue since the proposed configuration works as expected.\n@thatmlopsguy please reopen if you are unsatisfied with the resolution.","createdAt":"2025-06-30T21:01:52Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/7873#issuecomment-3020709717","viewerDidAuthor":false}],"createdAt":"2025-06-06T10:35:50Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"}],"milestone":null,"number":7873,"reactionGroups":[],"state":"CLOSED","title":"Helm chart Temporal Connection to RDS","updatedAt":"2025-06-30T21:01:52Z","url":"https://github.com/temporalio/temporal/issues/7873"}
