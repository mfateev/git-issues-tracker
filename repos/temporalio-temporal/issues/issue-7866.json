{"assignees":[],"author":{"id":"MDQ6VXNlcjMwODI0ODQ1","is_bot":false,"login":"Mahee777","name":""},"body":"Hi Team,\n\n**Problem Statement**\nWe are using a self-hosted Temporal service and attempting to enable the archival feature. However, we are unable to access AWS S3 from the Temporal service because it does not support AWS STS. The Temporal server requires actual access_key and secret, but due to infrastructure restrictions, we cannot use actual AWS credentials. Our infrastructure supports STS, but the Temporal server does not. Is there an alternative solution that can work in this scenario?\n\n**Expected Behavior**\ntemporal server should be able to connect with S3 bucker and archive.\n\n**Actual Behavior**\ngetting 403 \n","closedAt":null,"comments":[{"id":"IC_kwDODNqesM6vNOGz","author":{"login":"Protozet"},"authorAssociation":"NONE","body":"@Mahee777 - Were you able to get it running using the actual AWS access key and secret? Can you share your archival values ?","createdAt":"2025-06-04T10:26:46Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/7866#issuecomment-2939478451","viewerDidAuthor":false},{"id":"IC_kwDODNqesM6vOL9i","author":{"login":"Mahee777"},"authorAssociation":"NONE","body":"@Protozet its working with actual AWS access and secret key. \n\nHere is the archival values\n\nhistory:\n        enableRead: true\n        provider:\n            filestore: null\n            gstorage: null\n            s3store:\n                endpoint: null\n                logLevel: 0\n                region: us-east-1\n                s3ForcePathStyle: false\n        state: enabled\n    visibility:\n        enableRead: true\n        provider:\n            filestore: null\n            gstorage: null\n            s3store:\n                endpoint: null\n                logLevel: 0\n                region: us-east-1\n                s3ForcePathStyle: false\n        state: enabled\nnamespaceDefaults:\n    archival:\n        history:\n            URI: s3://dev-workflow-temporal-archive-bucket\n            state: enabled\n        visibility:\n            URI: s3://dev-workflow-temporal-archive-bucket\n            state: enabled","createdAt":"2025-06-04T11:48:07Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/7866#issuecomment-2939731810","viewerDidAuthor":false},{"id":"IC_kwDODNqesM682xxx","author":{"login":"erka"},"authorAssociation":"CONTRIBUTOR","body":"@Mahee777 You need a role for the Temporal and then set that role to environment variable `AWS_ROLE_ARN`. It really depends on the your setup how it should be configured. EC2, ECS, EKS, etc will have own steps. Like https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-ec2.html. \n\nAlso you will need access key and secret to assume into the role with STS in any case. ","createdAt":"2025-08-08T16:14:57Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/7866#issuecomment-3168476273","viewerDidAuthor":false}],"createdAt":"2025-06-04T08:17:36Z","labels":[{"id":"MDU6TGFiZWwxNjIxMDMwNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":7866,"reactionGroups":[],"state":"OPEN","title":"AWS STS for connecting S3 for archival","updatedAt":"2025-08-08T16:14:57Z","url":"https://github.com/temporalio/temporal/issues/7866"}
