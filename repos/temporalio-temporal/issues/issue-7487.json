{"assignees":[],"author":{"id":"MDQ6VXNlcjUxNzY4Mw==","is_bot":false,"login":"Sushisource","name":"Spencer Judge"},"body":"I went to try to finish https://github.com/temporalio/sdk-core/issues/867 real quick only to find it's very difficult to inspect the full Failure responses in anything other than Go.\n\nWhen you get back from a client query call looks like this:\n```\n[core/../tests/integ_tests/queries_tests.rs:273:5] &q_resp = Status {\n    code: InvalidArgument,\n    message: \"oh no broken\",\n    details: b\"\\x08\\x03\\x12\\x0coh no broken\\x1a\\\\\\nCtype.googleapis.com/temporal.api.errordetails.v1.QueryFailedFailure\\x12\\x15\\n\\x13\\n\\x0coh no broken\\x12\\x03src\",\n    metadata: MetadataMap {\n        headers: {\n            \"content-type\": \"application/grpc\",\n        },\n    },\n    source: None,\n}\n```\nThere are a few issues here:\nhttps://github.com/temporalio/api/blob/master/temporal/api/workflowservice/v1/service.proto#L551 's comment should say something about how the encoded failure is packed into the Status details field, which ostensibly, should be that it follows the guidance here: https://google.aip.dev/193#statusdetails and attaches some an `Any` containing an `ErrorInfo` followed by an `Any` Wrapping a `QueryFailedFailure`\nAFAICT it's not doing that, though. I can't actually tell how this binary string is constructed. Luckily no SDK is using this yet so we can fix it. If it's not following the guidance (maybe it is and somehow I'm just not unpacking it right, but I don't think so), we should adhere to that. \n\nFrom my reading of the binary it looks like it's just directly serializing a https://github.com/temporalio/api-go/blob/master/serviceerror/query_failed.go#L35 somehow, which maybe is OK for api-go users, but isn't for anyone else.","closedAt":null,"comments":[],"createdAt":"2025-03-19T00:41:22Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"}],"milestone":null,"number":7487,"reactionGroups":[],"state":"OPEN","title":"grpc Status response to query errors contains malformed details","updatedAt":"2025-03-19T00:41:22Z","url":"https://github.com/temporalio/temporal/issues/7487"}
