{"assignees":[{"id":"MDQ6VXNlcjIwNjgxMjQ=","login":"rodrigozhou","name":"Rodrigo Zhou","databaseId":0}],"author":{"id":"MDQ6VXNlcjIwNjM5Ng==","is_bot":false,"login":"cretz","name":"Chad Retz"},"body":"## Expected Behavior\r\n\r\nWhen starting server (i.e. with `go.temporal.io/server/temporal.Server.Start`) with `system.forceSearchAttributesCacheRefreshOnRead` dyn config as `true` and then using operator service immediately register search attributes, I should be able to start a workflow right away.\r\n\r\n## Actual Behavior\r\n\r\nSometimes the workflow fails with \"Namespace default has no mapping defined for search attribute <whatever>\". And when it does succeed, the logs have warnings like:\r\n\r\n```\r\ntime=2024-06-26T10:51:28.528 level=WARN msg=\"Search attribute DotNetTemporalTestText already exists.\" service=frontend namespace=default visibility-search-attribute=DotNetTemporalTestText\r\ntime=2024-06-26T10:51:28.528 level=WARN msg=\"Search attribute DotNetTemporalTestBool already exists.\" service=frontend namespace=default visibility-search-attribute=DotNetTemporalTestBool\r\ntime=2024-06-26T10:51:28.534 level=WARN msg=\"Search attribute DotNetTemporalTestDateTime already exists.\" service=frontend namespace=default visibility-search-attribute=DotNetTemporalTestDateTime\r\ntime=2024-06-26T10:51:28.534 level=WARN msg=\"Search attribute DotNetTemporalTestDouble already exists.\" service=frontend namespace=default visibility-search-attribute=DotNetTemporalTestDouble\r\ntime=2024-06-26T10:51:28.534 level=WARN msg=\"Search attribute DotNetTemporalTestKeyword already exists.\" service=frontend namespace=default visibility-search-attribute=DotNetTemporalTestKeyword\r\ntime=2024-06-26T10:51:28.534 level=WARN msg=\"Search attribute DotNetTemporalTestKeywordList already exists.\" service=frontend namespace=default visibility-search-attribute=DotNetTemporalTestKeywordList\r\ntime=2024-06-26T10:51:28.534 level=WARN msg=\"Search attribute DotNetTemporalTestLong already exists.\" service=frontend namespace=default visibility-search-attribute=DotNetTemporalTestLong\r\n```\r\n\r\n## Steps to Reproduce the Problem\r\n\r\nStart server programmatically with `system.forceSearchAttributesCacheRefreshOnRead` dyn config as `true`, then use `OperatorService.AddSearchAttributes` immediately to add attributes, then use client immediately to start workflow. Note, it works sometimes and fails others.","closedAt":"2024-11-18T23:30:17Z","comments":[],"createdAt":"2024-06-26T16:15:52Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"}],"milestone":null,"number":6195,"reactionGroups":[],"state":"CLOSED","title":"Starting server + adding search attributes doesn't make the attributes immediately available","updatedAt":"2024-11-18T23:30:17Z","url":"https://github.com/temporalio/temporal/issues/6195"}
