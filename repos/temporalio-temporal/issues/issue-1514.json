{"assignees":[],"author":{"id":"MDQ6VXNlcjEwNjg4NTg=","is_bot":false,"login":"ramielrowe","name":"Andrew Melton"},"body":"**Is your feature request related to a problem? Please describe.**\r\nMy team is currently in the research phase for a new workflow system, and temporal seems like a particularly good fit for our needs. But, we are not familiar with operating Cassandra. We are in the Google Cloud, which offers a similar row store to Cassandra. We would eventually be moving large scale existing workflows (100's of executions per second), so I'm assuming that the SQL persistence would not scale as easily as Cassandra or BigTable.\r\n\r\nCasssandra provides more complex consistency guarantees than BigTable. BigTable can only atomically update a single row. And to further complicate things, can only atomically assert the value of a single column. I gave the Cassandra implementation a look, and it seems like the only query that may be a problem is [UpdateCurrentWorkflowExecutionForNewQuery](https://github.com/temporalio/temporal/blob/master/common/persistence/cassandra/cassandraPersistence.go#L150). It would be possible to read the row, assert the value of `current_run_id`, `workflow_last_write_version`, `workflow_state`, and then in a second atomic write, assert that the value of `current_run_id` hasn't changed before writing the new values. I am wondering if that would be consistent enough for the needs of this particular query.\r\n\r\n**Describe the solution you'd like**\r\nI am wondering if anyone has considered alternatives to Cassandra and traditional relational SQL databases, in particular BigTable? If there are any guidelines on necessary features for a database around consistency?\r\n\r\n**Describe alternatives you've considered**\r\nGoogle's Cloud Spanner is a large scale SQL database that offers even more flexible consistency than Cassandra. But, is significantly more expensive than BigTable for high write throughput applications.\r\n\r\n**Additional context**\r\nNone","closedAt":"2021-06-09T21:26:51Z","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDgzMjI0ODMxNg==","author":{"login":"wxing1292"},"authorAssociation":"CONTRIBUTOR","body":"Have 0 exp using big table, so i need to ask few questions\r\n\r\ndoes big table support multi-row transaction within a DB shard?\r\ndoes big table support conditional updates?\r\n\r\nfrom my understanding, spanner maybe more applicable?","createdAt":"2021-05-04T21:05:18Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1514#issuecomment-832248316","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDgzMjI1NTI0Mg==","author":{"login":"ramielrowe"},"authorAssociation":"NONE","body":"BigTable has no real concept of transactions, and it's sharding mechanisms are completely hidden from the end user. It only provides consistency at the row level.\r\n\r\nBigTable does support conditional updates, but it is tricky to do so over multiple columns. One way to do this is to issue a read for columns X, Y and Z. Compare their values, and then issue an atomic write to X, Y and Z, if-and-only-if they haven't changed since the first read.","createdAt":"2021-05-04T21:17:45Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1514#issuecomment-832255242","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDgzMjI2MDIyOA==","author":{"login":"wxing1292"},"authorAssociation":"CONTRIBUTOR","body":"according to https://cloud.google.com/bigtable/docs/overview#other-storage-options\r\nbig table is not targeted as a OLTP database, so if your target is to use a google product, consider spanner or cloud sql","createdAt":"2021-05-04T21:28:01Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1514#issuecomment-832260228","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDgzMjI3MzE0MQ==","author":{"login":"ramielrowe"},"authorAssociation":"NONE","body":"Gotcha, I now see where y'all are using transactions. Which does exclude BigTable. Spanner is expensive enough that we will likely consider taking on running Cassandra. Thanks for looking into this!","createdAt":"2021-05-04T21:48:27Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1514#issuecomment-832273141","viewerDidAuthor":false}],"createdAt":"2021-05-03T15:31:19Z","labels":[{"id":"MDU6TGFiZWwyMDE5OTA0OTIw","name":"discussion","description":"","color":"3ffcb0"},{"id":"MDU6TGFiZWwyNzcwMzY2NzYw","name":"close-after-30-days","description":"","color":"1d76db"}],"milestone":null,"number":1514,"reactionGroups":[],"state":"CLOSED","title":"Feasibility of a BigTable based persistence implementation","updatedAt":"2021-06-09T21:26:51Z","url":"https://github.com/temporalio/temporal/issues/1514"}
