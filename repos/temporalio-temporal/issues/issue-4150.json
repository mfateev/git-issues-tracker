{"assignees":[],"author":{"id":"MDQ6VXNlcjM4MjU3MTY=","is_bot":false,"login":"mindaugasrukas","name":"Mind.R."},"body":"**Is your feature request related to a problem? Please describe.**\r\nCurrently, server version upgrade requires manual sequential upgrades:\r\n\r\nhttps://docs.temporal.io/cluster-deployment-guide#upgrade-server:\r\n```\r\nWhen upgrading your Temporal Server version, ensure that you upgrade sequentially.\r\nFor example, when upgrading from v1.n.x, always upgrade to v1.n+1.x (or the next available version),\r\nand so on until you get to the required version.\r\n```\r\n\r\n**Describe the solution you'd like**\r\nVersion upgrades should be done automatically using Up & Down migrations.\r\n\r\n\r\n","closedAt":"2023-10-21T20:20:54Z","comments":[{"id":"IC_kwDODNqesM5ZrJt_","author":{"login":"dnr"},"authorAssociation":"MEMBER","body":"The sequential requirement is not (just) for database schema upgrades, it's for metadata in other places, e.g. cluster metadata table or history shard metadata or queue metadata. Those are encoded in protos so they can't be upgraded by DDL at the database level. And for history shard metadata in particular, migrations would have to obey all the locking rules, so they basically have to be done by the history service itself.","createdAt":"2023-04-12T02:51:36Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/4150#issuecomment-1504484223","viewerDidAuthor":false},{"id":"IC_kwDODNqesM5fAho3","author":{"login":"mindaugasrukas"},"authorAssociation":"CONTRIBUTOR","body":"> The sequential requirement is not (just) for database schema upgrades, it's for metadata in other places, e.g. cluster metadata table or history shard metadata or queue metadata. Those are encoded in protos so they can't be upgraded by DDL at the database level. And for history shard metadata in particular, migrations would have to obey all the locking rules, so they basically have to be done by the history service itself.\r\n\r\nI don't see this as a blocker.\r\n[updated the description] Those upgrades are not limited to only running schema migrations. They can run metadata and other migrations too.\r\nIn other words, decouple migration logic from the service.","createdAt":"2023-06-16T01:57:26Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/4150#issuecomment-1593973303","viewerDidAuthor":false}],"createdAt":"2023-04-10T17:10:09Z","labels":[{"id":"MDU6TGFiZWwxNjIxMDMwNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":4150,"reactionGroups":[],"state":"CLOSED","title":"Remove requirement for sequential server version upgrades","updatedAt":"2023-10-21T20:20:54Z","url":"https://github.com/temporalio/temporal/issues/4150"}
