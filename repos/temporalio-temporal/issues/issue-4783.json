{"assignees":[{"id":"MDQ6VXNlcjQ2NjcyMw==","login":"dnr","name":"David Reiss","databaseId":0}],"author":{"id":"U_kgDOBaJ48w","is_bot":false,"login":"ddavidyuk","name":""},"body":"## Expected Behavior\r\nWhen using Temporal's default JWT authorizer, users with `temporal-system:read` permission should have access to `temporal.api.operatorservice.v1.OperatorService/ListSearchAttributes` API\r\n\r\nhttps://github.com/temporalio/temporal/blob/release/v1.21.x/common/authorization/frontend_api.go#L50\r\n\r\n## Actual Behavior\r\nUsers with `temporal-system:read` permission do NOT have access to the `ListSearchAttributes` API. This can be confirmed via CLI (`temporal operator search-attribute list`) or just by opening Temporal UI.\r\nIn case of CLI we get `Request unauthorized` error, when opening Temporal UI we get redirected back to the login screen after authentication because of the 403 Forbidden error to the `/search-attributes` endpoint\r\n\r\n## Steps to Reproduce the Problem\r\n\r\n  1. Deploy Temporal with default authorizer\r\n  2. Configure an Oauth2 client in your auth provider to add `permissions: [ \"temporal-system:read\" ]` claim to the access token.\r\n  3. Request to list search attributes via `tctl` or `temporal cli` with your access token or open Temporal UI.\r\n\r\n## Specifications\r\n\r\n  - Version: Temporal v1.21.4\r\n","closedAt":"2023-08-28T18:29:36Z","comments":[{"id":"IC_kwDODNqesM5kdLge","author":{"login":"yiminc"},"authorAssociation":"MEMBER","body":"related https://github.com/temporalio/temporal/issues/4654","createdAt":"2023-08-20T19:21:42Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/4783#issuecomment-1685370910","viewerDidAuthor":false},{"id":"IC_kwDODNqesM5lDdPO","author":{"login":"ddavidyuk"},"authorAssociation":"NONE","body":"Hi everyone! Any chance this can be released in 1.21.6? This blocks our upgrade to 1.21.x because users with temporal-system:read role cannot use Temporal UI (after logging in they are immediately redirected back to the login screen because of the 403 error for the ListSearchAttributes API).","createdAt":"2023-08-28T10:02:45Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/4783#issuecomment-1695405006","viewerDidAuthor":false},{"id":"IC_kwDODNqesM5lGTYr","author":{"login":"dnr"},"authorAssociation":"MEMBER","body":"Closed by #4794. Not sure about backporting yet.","createdAt":"2023-08-28T18:29:36Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/4783#issuecomment-1696151083","viewerDidAuthor":false}],"createdAt":"2023-08-18T09:23:31Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"}],"milestone":null,"number":4783,"reactionGroups":[],"state":"CLOSED","title":"temporal-system:read role should have access to ListSearchAttributes RO API (when using default authorizer)","updatedAt":"2023-08-28T18:29:36Z","url":"https://github.com/temporalio/temporal/issues/4783"}
