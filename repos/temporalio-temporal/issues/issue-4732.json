{"assignees":[],"author":{"id":"MDQ6VXNlcjc3NTQxMjA=","is_bot":false,"login":"yycptt","name":"Yichao Yang"},"body":"## Expected Behavior\r\nWhen a retry `policy` is created with `backoff.NewExponentialRetryPolicy(initialInterval).WithMaximumAttempts(X)`, `backoff.ThrottleRetry(op, policy, nil)` will run `op` at most X times.\r\n\r\n## Actual Behavior\r\n`op` will be run at most X+1 times\r\n\r\n## Steps to Reproduce the Problem\r\n\r\nFollowing test will fail. \r\n```\r\nfunc (s *RetryPolicySuite) TestMaxAttempts() {\r\n\tmaxAttempts := 3\r\n\tpolicy := NewExponentialRetryPolicy(time.Millisecond * 50).\r\n\t\tWithMaximumAttempts(3)\r\n\r\n\tattempt := 0\r\n\terr := ThrottleRetry(func() error {\r\n\t\tattempt++\r\n\t\treturn fmt.Errorf(\"fake error\")\r\n\t}, policy, nil)\r\n\ts.Error(err)\r\n\ts.Equal(maxAttempts, attempt) // attempt will be 4\r\n}\r\n```\r\n\r\n## Specifications\r\n\r\n  - Version:\r\n  - Platform:\r\n","closedAt":"2023-08-10T18:44:41Z","comments":[],"createdAt":"2023-08-04T21:08:57Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"}],"milestone":null,"number":4732,"reactionGroups":[],"state":"CLOSED","title":"Expected behavior of backoff.RetryPolicy.WithMaximumAttempts() ?","updatedAt":"2023-08-10T18:44:41Z","url":"https://github.com/temporalio/temporal/issues/4732"}
