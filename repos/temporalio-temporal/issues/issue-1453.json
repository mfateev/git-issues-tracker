{"assignees":[],"author":{"id":"MDQ6VXNlcjIwNTc0Mg==","is_bot":false,"login":"esdrasbeleza","name":"Esdras Beleza"},"body":"## Expected Behavior\r\n\r\nIf an activity returns an error from some custom error from my system, it's wrapped and I can check it using `errors.Is`.\r\n\r\n## Actual Behavior\r\n\r\nMy error message is wrapped there, but I can't compare/check it.\r\n\r\n## Steps to Reproduce the Problem\r\n\r\n```golang\r\nvar ErrNotFound = errors.New(\"not found!\")\r\n\r\nfunc TestWorkflowTestSuite(t *testing.T) {\r\n\tsuite.Run(t, new(WorkflowTestSuite))\r\n}\r\n\r\ntype WorkflowTestSuite struct {\r\n\tsuite.Suite\r\n\ttestsuite.WorkflowTestSuite\r\n\tenv *testsuite.TestWorkflowEnvironment\r\n}\r\n\r\nfunc (s *WorkflowTestSuite) SetupTest() {\r\n\ts.env = s.NewTestWorkflowEnvironment()\r\n}\r\n\r\nfunc (s *WorkflowTestSuite) TearDownTestSuite() {\r\n\ts.env.AssertExpectations(s.T())\r\n}\r\n\r\nfunc (s *WorkflowTestSuite) Test_WorkflowErrorHandling() {\r\n\tactivity := func(number int) error {\r\n\t\treturn fmt.Errorf(\"error: %w\", ErrNotFound)\r\n\t}\r\n\ts.env.RegisterActivity(activity)\r\n\r\n\tworkflow := func(ctx workflow.Context, number int) error {\r\n\t\tctx = workflow.WithActivityOptions(ctx, workflow.ActivityOptions{\r\n\t\t\tStartToCloseTimeout: time.Minute,\r\n\t\t\tRetryPolicy: &temporal.RetryPolicy{\r\n\t\t\t\tMaximumAttempts:    3,\r\n\t\t\t\tBackoffCoefficient: 2,\r\n\t\t\t},\r\n\t\t})\r\n\r\n\t\tif err := workflow.ExecuteActivity(ctx, activity, number).Get(ctx, nil); err != nil {\r\n\t\t\treturn err\r\n\t\t}\r\n\r\n\t\treturn nil\r\n\t}\r\n\ts.env.RegisterWorkflow(workflow)\r\n\ts.env.ExecuteWorkflow(workflow, 123)\r\n\r\n\ts.True(s.env.IsWorkflowCompleted())\r\n\terr := s.env.GetWorkflowError()\r\n\ts.ErrorIs(err, ErrNotFound)\r\n}\r\n```\r\n\r\nThe result will be:\r\n\r\n```\r\nError:      \tTarget error should be in err chain:\r\n                    expected: \"not found!\"\r\n                    in chain: \"workflow execution error (type: func2, workflowID: default-test-workflow-id, runID: default-test-run-id): activity error (type: func1, scheduledEventID: 0, startedEventID: 0, identity: ): error: not found! (type: wrapError, retryable: true): not found!\"\r\n                        \"activity error (type: func1, scheduledEventID: 0, startedEventID: 0, identity: ): error: not found! (type: wrapError, retryable: true): not found!\"\r\n                        \"error: not found! (type: wrapError, retryable: true): not found!\"\r\n                        \"not found!\"\r\n```\r\n\r\n## Specifications\r\n\r\n  - Version: v1.5.0; 1.6.0\r\n  - Platform: macOS\r\n","closedAt":"2021-04-12T15:06:43Z","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDgxNzg4OTQxMQ==","author":{"login":"esdrasbeleza"},"authorAssociation":"NONE","body":"Closing the issue here, since I think it belongs to sdk-go and [I copied it there](https://github.com/temporalio/sdk-go/issues/403). Sorry!","createdAt":"2021-04-12T15:06:43Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/1453#issuecomment-817889411","viewerDidAuthor":false}],"createdAt":"2021-04-12T13:24:52Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"}],"milestone":null,"number":1453,"reactionGroups":[],"state":"CLOSED","title":"Can't use `errors.Is` to check a returned error","updatedAt":"2021-04-12T15:06:43Z","url":"https://github.com/temporalio/temporal/issues/1453"}
