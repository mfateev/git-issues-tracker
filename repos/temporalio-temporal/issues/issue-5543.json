{"assignees":[],"author":{"id":"MDQ6VXNlcjMxODkxNzkw","is_bot":false,"login":"vikingUnet","name":"Maxim Sherstuk"},"body":"Hello!\r\n\r\nI [found](https://github.com/temporalio/temporal/blob/main/schema/cassandra/temporal/schema.cql#L185) creating indexes in schema description:\r\n```\r\nCREATE INDEX cm_lastheartbeat_idx on cluster_membership (last_heartbeat);\r\nCREATE INDEX cm_sessionstart_idx on cluster_membership (session_start);\r\n```\r\n\r\nAs i know, indexes are not very good works in cassandra for big clusters because have a lot of [restrictions](https://docs.datastax.com/en/cql-oss/3.3/cql/cql_using/useWhenIndex.html#Whennottouseanindex).\r\n\r\nHave you considered to create invert tables instead of using indexes - like tables cluster_membership_by_last_heartbeat and cluster_membership_by_session_start to detect correct membership_partition value and query with this to cluster_membership table?\r\n\r\n```\r\nCREATE TABLE cluster_membership_by_last_heartbeat\r\n(\r\n    last_heartbeat timestamp,\r\n    membership_partition tinyint,\r\n    PRIMARY KEY (last_heartbeat)\r\n) WITH COMPACTION = {\r\n    'class': 'org.apache.cassandra.db.compaction.SizeTieredCompactionStrategy'\r\n  };\r\n\r\nCREATE TABLE cluster_membership_by_session_start\r\n(\r\n    session_start timestamp,\r\n    membership_partition tinyint,\r\n    PRIMARY KEY (session_start)\r\n) WITH COMPACTION = {\r\n    'class': 'org.apache.cassandra.db.compaction.SizeTieredCompactionStrategy'\r\n  };\r\n```\r\n\r\nThanks a lot!\r\n","closedAt":null,"comments":[],"createdAt":"2024-03-15T08:46:55Z","labels":[{"id":"MDU6TGFiZWwxNjIxMDMwNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":5543,"reactionGroups":[],"state":"OPEN","title":"Remove indexes from schema Temporal in cassandra","updatedAt":"2024-03-15T08:46:55Z","url":"https://github.com/temporalio/temporal/issues/5543"}
