{"assignees":[],"author":{"id":"MDQ6VXNlcjUzMjEwOA==","is_bot":false,"login":"Spikhalskiy","name":"Dmitry Spikhalsky"},"body":"## Actual Behavior\r\n\r\n`ResetWorkflowExecutionRequest` has an optional parameter `requestId`.\r\nIt's very easy for Temporal API users of our API to specify a `ResetWorkflowExecutionRequest` instance without `requestId` and don't specify this parameter at all.\r\nIt looks like `resetWorkflowExecution` is idempotent and duplicate requests with the same `requestId` is getting ignored, including an empty one.\r\nSuch a request will work right at the first invocation, which makes the problem even hard to catch.\r\n\r\n## Expected Behavior\r\n\r\nThis behavior looks like a bug for a user, because they expect subsequent requests to work in the same way as the first one.\r\n\r\n## Proposed solutions\r\n\r\nEither of\r\n1. Making `ResetWorkflowExecutionRequest#requestId` mandatory.\r\n2. if `ResetWorkflowExecutionRequest ` has an empty `requestId`, server generate a random id / doesn't deduplicate requests with an empty `requestId`.\r\n3. server should error out on a request with an empty `requestId`.\r\n\r\n## Original support question\r\n\r\n> I'm working on resetting a workflow, which works great, the first time I reset it and I get a new run with the same Workflow ID, but a new Run ID. Any consecutive resets though, fail to do anything at all, no matter what I try.\r\n> Is it supposed to be like this, or have I missed something?\r\n> \r\n> Code used to reset:\r\n> ```\r\n>         val reset = ResetWorkflowExecutionRequest.newBuilder()\r\n>             .setNamespace(\"default\")\r\n>             .setWorkflowExecution(WorkflowExecution.newBuilder()\r\n>                 .setWorkflowId(id)\r\n>                 .build())\r\n>             .setWorkflowTaskFinishEventId(3)\r\n>             .setReason(\"Reset\")\r\n>             .build()\r\n> \r\n>         workflowService.blockingStub().resetWorkflowExecution(reset)\r\n> ```\r\n\r\n  - Version: v1.13.1\r\n","closedAt":"2021-11-12T22:40:42Z","comments":[],"createdAt":"2021-11-05T21:48:08Z","labels":[{"id":"MDU6TGFiZWwxNjIxMDMwNzg0","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMDE5NzgzNzUw","name":"API","description":"Issues/features involving the API","color":"3d910f"}],"milestone":null,"number":2140,"reactionGroups":[],"state":"CLOSED","title":"resetWorkflowExecution deduplicates requests with empty requestId","updatedAt":"2021-11-12T22:40:42Z","url":"https://github.com/temporalio/temporal/issues/2140"}
