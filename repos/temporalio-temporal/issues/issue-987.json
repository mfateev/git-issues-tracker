{"assignees":[],"author":{"id":"MDQ6VXNlcjE3NjY1MTU=","is_bot":false,"login":"samarabbas","name":"Samar Abbas"},"body":"**Is your feature request related to a problem? Please describe.**\r\nA bug in activity could result in incorrect return type causing another activity to fail continuously.  Provide a mechanism to force complete an activity in retry without restarting the workflow.  \r\n\r\n**Describe the solution you'd like**\r\nRespondActivityTaskCompletedById api does not support retry attempt as input argument.  Also need a way to allow completion when activity is backing off and not started at all.\r\n\r\n**Describe alternatives you've considered**\r\nA clear and concise description of any alternative solutions or features you've considered.\r\n\r\n**Additional context**\r\nAdd any other context or screenshots about the feature request here.\r\n","closedAt":"2025-01-21T14:45:04Z","comments":[{"id":"IC_kwDODNqesM5JdUCC","author":{"login":"zengzilu"},"authorAssociation":"NONE","body":"+1","createdAt":"2022-08-31T03:36:27Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/987#issuecomment-1232420994","viewerDidAuthor":false},{"id":"IC_kwDODNqesM5NXIjF","author":{"login":"jdupl123"},"authorAssociation":"NONE","body":"+1","createdAt":"2022-11-01T01:51:46Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/987#issuecomment-1297909957","viewerDidAuthor":false},{"id":"IC_kwDODNqesM5Vqsit","author":{"login":"p4p4"},"authorAssociation":"NONE","body":"+1\r\nFor me, it would be a convenient way to “repair” a single blocked WF if an activity is periodically failing. In  a way, activity complete could allow to “repair forward” (skip over a failing activity), like reset already allows to “repair backwards” (go back to an earlier state of the workflow execution). \r\n\r\nOf course it is notbest practice to (manually) repair workflows all the time, but in some edge cases and incidents it would be great to have the possibility. Redeploying an updated activity worker might not always be a solution.\r\n\r\n@mfateev was also supporting this idea.\r\n![image](https://user-images.githubusercontent.com/1523187/229063838-a5e80218-02a2-444b-a445-0ff6cf1fcfcf.png)\r\n\r\nEventually, this could even be integrated into the WebUI, so that e.g. also a support engineer could repair a workflow.","createdAt":"2023-02-20T16:11:06Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/temporal/issues/987#issuecomment-1437255853","viewerDidAuthor":false},{"id":"IC_kwDODNqesM5VuO7t","author":{"login":"p4p4"},"authorAssociation":"NONE","body":"similarly, a `tctl workflow complete` command might also be handy to complete whole (child) workflows, what do you think?","createdAt":"2023-02-21T09:56:44Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/987#issuecomment-1438183149","viewerDidAuthor":false},{"id":"IC_kwDODNqesM54CvH1","author":{"login":"alexseedkou"},"authorAssociation":"CONTRIBUTOR","body":"Hi, I am interested in working on this issue. \r\n\r\nBased on my understanding, if a workflow has multiple activities, the failure from one of them will result in the following activities' failure. Currently, the only way to fix this is to start the workflow from the beginning. We want to introduce a mechanism to retry the first failed activity when we find it is incorrect to prevent the cascading.\r\n\r\nIs my understanding above correct? If so, how this is different from the retry options when we start a workflow with an activity [here](https://github.com/temporalio/samples-go/blob/main/retryactivity/retry_activity_workflow.go#L20)? We can handle the incorrect output from an activity with the retry options above. \r\n\r\nAlso, a way to reproduce this would be very helpful. Thank you!","createdAt":"2024-03-21T22:50:13Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/987#issuecomment-2013983221","viewerDidAuthor":false},{"id":"IC_kwDODNqesM54mm2c","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"This is fairly easy to add.\r\n\r\nFirst we need to understand how to expose this in the API.\r\nI would add a `bool skip_started_check` or `bool force` field in the [`RespondActivityTaskCompletedByIdRequest`](https://github.com/temporalio/api/blob/0a9dcf0be2a1383bf9a613f47a39cd09119e0a34/temporal/api/workflowservice/v1/request_response.proto#L489) message and the other RPCs that resolve an activity (`RespondActivityTaskFailedByIdRequest`, `RespondActivityTaskCanceledByIdRequest`).\r\n\r\nThen we need to relax [this condition](https://github.com/temporalio/temporal/blob/39eba206446fb33c892433e9a76fc5e89b8b255c/service/history/api/respondactivitytaskcompleted/api.go#L100) if the flag is set (in all corresponding APIs).\r\n\r\n","createdAt":"2024-03-27T17:34:36Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/987#issuecomment-2023386524","viewerDidAuthor":false},{"id":"IC_kwDODNqesM54mnzG","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"If you want to take this on, you should start by making a PR to the https://github.com/temporalio/api repo and if this is accepted, you can continue to implement in the server (this) repo.","createdAt":"2024-03-27T17:35:54Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/987#issuecomment-2023390406","viewerDidAuthor":false},{"id":"IC_kwDODNqesM54pJmC","author":{"login":"alexseedkou"},"authorAssociation":"CONTRIBUTOR","body":"Hi @bergundy, thank you for your reply.\r\n\r\nMay I know if my understanding above is correct regarding this issue, and how this is different from the retry options when we start a workflow with an activity [here](https://github.com/temporalio/samples-go/blob/main/retryactivity/retry_activity_workflow.go#L20)?\r\n\r\nThank you in advance for your guidance.\r\n\r\n","createdAt":"2024-03-27T21:51:36Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/987#issuecomment-2024053122","viewerDidAuthor":false},{"id":"IC_kwDODNqesM54xxbX","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"This issue is for allowing completing and failing activities that are currently backing off.\r\nSeems like that's not what you want @alexseedkou based on your comment here:\r\n\r\n> Based on my understanding, if a workflow has multiple activities, the failure from one of them will result in the following activities' failure. Currently, the only way to fix this is to start the workflow from the beginning. We want to introduce a mechanism to retry the first failed activity when we find it is incorrect to prevent the cascading.\r\n\r\nIIUC, you could reset the workflow to just before the activity was scheduled. Does that address your need?\r\nFeel free to tag me on the Temporal community Slack to continue the discussion.\r\n","createdAt":"2024-03-28T23:28:39Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/987#issuecomment-2026313431","viewerDidAuthor":false},{"id":"IC_kwDODNqesM55od1h","author":{"login":"alexseedkou"},"authorAssociation":"CONTRIBUTOR","body":"An update on this issue:\r\n\r\nTeam has discussed this issue internally and decided to change the server behavior to accept activity completions even if the activity is currently backing off by default/\r\n\r\n","createdAt":"2024-04-05T21:29:16Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/987#issuecomment-2040651105","viewerDidAuthor":false},{"id":"IC_kwDODNqesM59Ny-8","author":{"login":"mjameswh"},"authorAssociation":"MEMBER","body":"We'll need to update API and SDKs documentation to reflect the fact that `RespondActivityTaskCompleted` and `RespondActivityTaskCompletedById` have different behaviors.","createdAt":"2024-05-08T14:50:29Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/987#issuecomment-2100768700","viewerDidAuthor":false},{"id":"IC_kwDODNqesM6bRBnM","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"Closed by https://github.com/temporalio/temporal/pull/5724","createdAt":"2025-01-21T14:45:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/987#issuecomment-2604931532","viewerDidAuthor":false},{"id":"IC_kwDODNqesM6sY-ws","author":{"login":"GSmithApps"},"authorAssociation":"MEMBER","body":"@bergundy this is marked as completed, but I get `...unable to fail Activity: invalid activityID or activity already timed out or invoking workflow is completed` when I try to fail a retrying activity from the CLI.\n\nI believe this whole issue is not complete, but has been split, and the remaining part is [#5877](https://github.com/temporalio/temporal/issues/5877), correct?","createdAt":"2025-05-19T20:48:48Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/temporal/issues/987#issuecomment-2892229676","viewerDidAuthor":false}],"createdAt":"2020-11-13T17:03:26Z","labels":[{"id":"MDU6TGFiZWwxNjIxMDMwNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyNTc2NTM1ODQ2","name":"difficulty: easy","description":"","color":"68d662"},{"id":"MDU6TGFiZWwzMTM4ODI4MTE3","name":"up-for-grabs","description":"Issues to consider for external contribution","color":"69CD90"}],"milestone":null,"number":987,"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":3}}],"state":"CLOSED","title":"Force complete activity when it is retrying","updatedAt":"2025-05-19T20:48:49Z","url":"https://github.com/temporalio/temporal/issues/987"}
