{"assignees":[],"author":{"id":"MDQ6VXNlcjE1ODExNjA2","is_bot":false,"login":"harish4459","name":""},"body":"## Expected Behavior\r\n\r\nApplication should work normally after upgrading\r\n\r\n## Actual Behavior\r\n\r\nApplication is crashing after upgrading to version 1.24.1\r\n\r\n\r\n## Steps to Reproduce the Problem\r\n\r\n  postgreSQL Schema upgrade to PostgreSQL schema v1.12 from v1.11  is successfully done.\r\n  Application upgrade to version 1.24.1 from older version was successful .\r\n\r\n Our setup is we are using single db schema (core) and not using visibility schema but there are few tables from visibility schema in our core db.\r\n As per logs error seems to be it is hitting visibility schema tables but not sure what is causing this ?\r\n\r\n## Specifications\r\n\r\n  - Version: 1.24.1 with postgresSQL \r\n  - Platform: AWS EKS version 1.29\r\n\r\n![image](https://github.com/user-attachments/assets/267808ed-11e2-408d-bd48-2cb704407acc)\r\n\r\n\r\ntemporal-frontend logs-\r\n\r\n`{\"level\":\"error\",\"ts\":\"2024-11-20T06:57:21.362Z\",\"msg\":\"service failures\",\"operation\":\"CountWorkflowExecutions\",\"wf-namespace\":\"default\",\"error\":\"CountWorkflowExecutions operation failed. Query failed: pq: column \\\"temporalnamespacedivision\\\" does not exist\",\"logging-call-at\":\"telemetry.go:411\",\"stacktrace │\r\n│ \":\"go.temporal.io/server/common/log.(*zapLogger).Error\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/common/log/zap_logger.go:156\\ngo.temporal.io/server/common/rpc/interceptor.(*TelemetryInterceptor).handleError\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/common/rpc/interceptor/te │\r\n│ lemetry.go:411\\ngo.temporal.io/server/common/rpc/interceptor.(*TelemetryInterceptor).UnaryIntercept\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/common/rpc/interceptor/telemetry.go:202\\ngoogle.golang.org/grpc.getChainUnaryHandler.func1\\n\\t/home/runner/go/pkg/mod/google.golang.org/grpc@v1.63.2/ │\r\n│ server.go:1186\\ngo.temporal.io/server/service/frontend.(*RedirectionInterceptor).handleRedirectAPIInvocation.func2\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/service/frontend/redirection_interceptor.go:245\\ngo.temporal.io/server/service/frontend.(*NoopRedirectionPolicy).WithNamespaceRedirect │\r\n│ \\n\\t/home/runner/work/docker-builds/docker-builds/temporal/service/frontend/dc_redirection_policy.go:125\\ngo.temporal.io/server/service/frontend.(*RedirectionInterceptor).handleRedirectAPIInvocation\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/service/frontend/redirection_interceptor.go:242\\ng │\r\n│ o.temporal.io/server/service/frontend.(*RedirectionInterceptor).Intercept\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/service/frontend/redirection_interceptor.go:202\\ngoogle.golang.org/grpc.getChainUnaryHandler.func1\\n\\t/home/runner/go/pkg/mod/google.golang.org/grpc@v1.63.2/server.go:1186\\ngo │\r\n│ .temporal.io/server/common/authorization.(*Interceptor).Intercept\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/common/authorization/interceptor.go:181\\ngoogle.golang.org/grpc.getChainUnaryHandler.func1\\n\\t/home/runner/go/pkg/mod/google.golang.org/grpc@v1.63.2/server.go:1186\\ngo.temporal.io/ser │\r\n│ ver/service/frontend.GrpcServerOptionsProvider.NewServerMetricsContextInjectorInterceptor.func2\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/common/metrics/grpc.go:66\\ngoogle.golang.org/grpc.getChainUnaryHandler.func1\\n\\t/home/runner/go/pkg/mod/google.golang.org/grpc@v1.63.2/server.go:1186\\ngo │\r\n│ .opentelemetry.io/contrib/instrumentation/google.golang.org/grpc/otelgrpc.UnaryServerInterceptor.func1\\n\\t/home/runner/go/pkg/mod/go.opentelemetry.io/contrib/instrumentation/google.golang.org/grpc/otelgrpc@v0.51.0/interceptor.go:315\\ngoogle.golang.org/grpc.getChainUnaryHandler.func1\\n\\t/home/runner/go/pkg/ │\r\n│ mod/google.golang.org/grpc@v1.63.2/server.go:1186\\ngo.temporal.io/server/common/rpc/interceptor.(*NamespaceLogInterceptor).Intercept\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/common/rpc/interceptor/namespace_logger.go:85\\ngoogle.golang.org/grpc.getChainUnaryHandler.func1\\n\\t/home/runner/go/ │\r\n│ pkg/mod/google.golang.org/grpc@v1.63.2/server.go:1186\\ngo.temporal.io/server/common/rpc/interceptor.(*NamespaceValidatorInterceptor).NamespaceValidateIntercept\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/common/rpc/interceptor/namespace_validator.go:135\\ngoogle.golang.org/grpc.getChainUnaryHa │\r\n│ ndler.func1\\n\\t/home/runner/go/pkg/mod/google.golang.org/grpc@v1.63.2/server.go:1186\\ngo.temporal.io/server/common/utf8validator.(*Validator).Intercept\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/common/utf8validator/validate.go:182\\ngoogle.golang.org/grpc.getChainUnaryHandler.func1\\n\\t/home/ │\r\n│ runner/go/pkg/mod/google.golang.org/grpc@v1.63.2/server.go:1186\\ngo.temporal.io/server/service/frontend.GrpcServerOptionsProvider.NewServiceErrorInterceptor.func1\\n\\t/home/runner/work/docker-builds/docker-builds/temporal/common/rpc/grpc.go:178\\ngoogle.golang.org/grpc.NewServer.chainUnaryServerInterceptors. │\r\n│ chainUnaryInterceptors.func1\\n\\t/home/runner/go/pkg/mod/google.golang.org/grpc@v1.63.2/server.go:1177\\ngo.temporal.io/api/workflowservice/v1._WorkflowService_CountWorkflowExecutions_Handler\\n\\t/home/runner/go/pkg/mod/go.temporal.io/api@v1.32.1/workflowservice/v1/service_grpc.pb.go:2217\\ngoogle.golang.org/g │\r\n│ rpc.(*Server).processUnaryRPC\\n\\t/home/runner/go/pkg/mod/google.golang.org/grpc@v1.63.2/server.go:1369\\ngoogle.golang.org/grpc.(*Server).handleStream\\n\\t/home/runner/go/pkg/mod/google.golang.org/grpc@v1.63.2/server.go:1780\\ngoogle.golang.org/grpc.(*Server).serveStreams.func2.1\\n\\t/home/runner/go/pkg/mod/go │\r\n│ ogle.golang.org/grpc@v1.63.2/server.go:1019\"}`\r\n\r\n\r\n","closedAt":null,"comments":[],"createdAt":"2024-11-20T07:00:15Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"}],"milestone":null,"number":6844,"reactionGroups":[],"state":"OPEN","title":"Temporal 1.24.1 <- 1.23.1 upgrade error","updatedAt":"2024-11-20T07:01:42Z","url":"https://github.com/temporalio/temporal/issues/6844"}
