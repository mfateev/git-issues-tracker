{"assignees":[{"id":"MDQ6VXNlcjQ2NjcyMw==","login":"dnr","name":"David Reiss","databaseId":0}],"author":{"id":"MDQ6VXNlcjg0NDExMDE0","is_bot":false,"login":"yiminc","name":"Yimin Chen"},"body":"Each matching task as TTL associated with them (at persistence layer). After task is expired, they will be removed from persistence and won't be read back by matching task reader.\r\nHowever, if a task is read into matching task queue manager, but sitting in memory queue waiting for poller to pick them up, they won't expire anymore. So if the poller is slow in consuming them (for example by PerTaskQueueRateLimit), those task in matching task queue manager in-memory queue could expire and still be matched to a poller, but before returning to poller, matching needs to recordActivityTaskStarted which will fail because history already timeout that task as it is already expired. \r\n\r\nWe need to check if task is already expired before match it to a poller.\r\n","closedAt":"2022-07-28T17:50:46Z","comments":[],"createdAt":"2022-07-27T05:20:36Z","labels":[{"id":"MDU6TGFiZWwyMDE5ODE3MzQ2","name":"potential-bug","description":"","color":"66b9cc"}],"milestone":null,"number":3150,"reactionGroups":[],"state":"CLOSED","title":"Discard expired task before dispatch them","updatedAt":"2022-07-28T17:50:46Z","url":"https://github.com/temporalio/temporal/issues/3150"}
