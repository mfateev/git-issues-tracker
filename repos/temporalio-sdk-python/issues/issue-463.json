{"assignees":[],"author":{"id":"MDQ6VXNlcjY3NzM4NTI=","is_bot":false,"login":"BrianKopp","name":"Brian Kopp"},"body":"I am unable to use the python SDK to connect to a temporal cluster when using self-generated TLS certificates due to domain name validation. We use generic self-generated TLS certificates as part of our testing process against various temporal clusters. In other SDK's & the CLI, we usually disable domain name validation in order to enable this standardization.  E.g. by using the `TEMPORAL_TLS_DISABLE_HOST_VERIFICATION` environment variable [in the CLI](https://docs.temporal.io/cli) or the `SimpleSslContextBuilder setUseInsecureTrustManager` method [in java](https://community.temporal.io/t/java-client-with-tls/5313). In the python SDK, I get the following error:\r\n\r\n```\r\n  File \"/usr/local/lib64/python3.11/site-packages/temporalio/client.py\", line 164, in connect\r\n    await temporalio.service.ServiceClient.connect(connect_config),\r\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/usr/local/lib64/python3.11/site-packages/temporalio/service.py\", line 184, in connect\r\n    return await _BridgeServiceClient.connect(config)\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/usr/local/lib64/python3.11/site-packages/temporalio/service.py\", line 711, in connect\r\n    await client._connected_client()\r\n  File \"/usr/local/lib64/python3.11/site-packages/temporalio/service.py\", line 724, in _connected_client\r\n    self._bridge_client = await temporalio.bridge.client.Client.connect(\r\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/usr/local/lib64/python3.11/site-packages/temporalio/bridge/client.py\", line 87, in connect\r\n    await temporalio.bridge.temporal_sdk_bridge.connect_client(\r\nRuntimeError: Failed client connect: Server connection error: tonic::transport::Error(Transport, hyper::Error(Connect, Custom { kind: InvalidData, error: InvalidCertificate(NotValidForName) }))\r\n```\r\n\r\n### Describe the solution you'd like\r\n\r\nIt would be great to be able to disable hostname validation as part of the [TlsConfig class](https://python.temporal.io/temporalio.service.TLSConfig.html). It appears that the client TLS is configured [here in the rust SDK](https://github.com/temporalio/sdk-core/blob/f673f1da17ded3cf3679f4a87db27d9d7d316e88/client/src/lib.rs#L406). Perhaps a hostname validation disable flag could drive the behavior down here somewhere.\r\n\r\n### Additional context\r\n\r\nI'm happy to help contribute on this if that would be welcome. Thanks!\r\n","closedAt":"2024-11-19T17:24:23Z","comments":[{"id":"IC_kwDOGusT1c5xV-jX","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"We can look into having a disable host verification option\r\n\r\n> NotValidForName\r\n\r\nSo it looks like the cert for the server is for a different name than the host you're connecting to. You should be able to set `TlsConfig.domain` as an expected domain from the cert the server uses instead of it default to the given host (this is SNI override).\r\n\r\n","createdAt":"2024-01-20T02:01:54Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-python/issues/463#issuecomment-1901586647","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c6wNn7p","author":{"login":"burnhamd"},"authorAssociation":"NONE","body":"Bringing this back up.  We have same issue where regulatory requirements dictate that we encrypt in transit even within vpc in AWS.  This becomes difficult when trying to fake a CA in our environment also opened a issue for the rust client https://github.com/temporalio/sdk-core/issues/932","createdAt":"2025-06-09T16:56:35Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/463#issuecomment-2956361449","viewerDidAuthor":false}],"createdAt":"2024-01-19T18:16:56Z","labels":[{"id":"LA_kwDOGusT1c7gQgHN","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":463,"reactionGroups":[],"state":"CLOSED","title":"[Feature Request] Support disabling host verification","updatedAt":"2025-06-09T16:56:36Z","url":"https://github.com/temporalio/sdk-python/issues/463"}
