{"assignees":[],"author":{"id":"U_kgDOBZKo7w","is_bot":false,"login":"hebrd","name":"hebrd"},"body":"\n\n### Description:\nI’m trying to retrieve the worker ID that is executing the current activity. However, I couldn’t find a way to do this using `activity.info()`. Here’s what I’ve tried so far:\n\n#### Approaches I Attempted:\n1. **Using `get_workflow_execution_history`:**\n   - I wasn’t able to retrieve the activity started event while the activity is still executing. It seems this approach only works for completed activities.\n\n2. **Setting the Worker ID in `Info`:**\n   - I considered adding the worker ID into `Info` manually but couldn’t figure out how to achieve this in practice.\n\n---\n\n### Questions:\n- Is there a built-in way to get the worker ID for the worker executing the current activity?\n- If not, is there a recommended approach or workaround to track which worker is running an activity at runtime?\n\n---\n\n### Context:\n- **Use Case:** Tracking or debugging activities in distributed workflows by identifying the specific worker executing the activity.\n- **Environment:** [Include Temporal version, SDK (e.g., Java, Go, Python), and any relevant configuration details]\n\nAny guidance or suggestions would be greatly appreciated!\n\n---\n\nThis version structures the issue clearly, explains what you’ve already tried, and provides enough context for maintainers to understand your challenge. Adding environment details also helps them reproduce the issue if needed.","closedAt":"2025-02-04T18:16:12Z","comments":[{"id":"IC_kwDOGusT1c6buPbr","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"Can you clarify what you mean by \"worker ID\"?\n\nDo you mean \"identity\" of the worker? The identity is set by you when creating the client and you can make it global (if it is a global, which it should be) or pass it in to the activity class for access. The same goes for any worker-level value you might want to access in the activity. In next release, assuming you have not overridden it when creating the worker, this will be available via `activity.client().service_client.config.identity`. But this identity just defaults to `f\"{os.getpid()}@{socket.gethostname()}\"` which is information you can also just use yourself in the activity.\n\nDoes this help? Also, feel free to join us on Slack or our forums for general questions.","createdAt":"2025-01-24T13:56:23Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/747#issuecomment-2612590315","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c6dCrte","author":{"login":"dandavison"},"authorAssociation":"MEMBER","body":"Hi @hebrd, I'm going to close this since I think @cretz's answer should give you what you need. But feel free to keep discussing here (or in Slack).","createdAt":"2025-02-04T18:16:12Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/747#issuecomment-2634726238","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c6doyKA","author":{"login":"hebrd"},"authorAssociation":"NONE","body":"> Can you clarify what you mean by \"worker ID\"?\n> \n> Do you mean \"identity\" of the worker? The identity is set by you when creating the client and you can make it global (if it is a global, which it should be) or pass it in to the activity class for access. The same goes for any worker-level value you might want to access in the activity. In next release, assuming you have not overridden it when creating the worker, this will be available via `activity.client().service_client.config.identity`. But this identity just defaults to `f\"{os.getpid()}@{socket.gethostname()}\"` which is information you can also just use yourself in the activity.\n> \n> Does this help? Also, feel free to join us on Slack or our forums for general questions.\n\nApologies for the delayed response during my vacation.\nRegarding my specific situation, one temporal client has multiple workers. When an activity is created, I cannot determine which worker will be responsible for executing it until runtime. Therefore, I am unable to pass the worker's identity to the activity class beforehand.\nI believe the `activity.client().service_client.config.identity` feature in the upcoming release will address our requirements. Looking forward to its release!","createdAt":"2025-02-08T08:06:41Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/747#issuecomment-2644714112","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c6d3c32","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"> one temporal client has multiple workers [...] I believe the activity.client().service_client.config.identity feature in the upcoming release will address our requirements\n\nBut this is the one client across multiple workers, so this is the client identity (which is the worker identity by default), so it is the same for all activities on all workers of that client. If you need activities on different workers to have different state, consider using activity methods and instantiating different instances, e.g. one worker has `activities=[MyActivity(myState1).my_activity]` while the other has `activities=[MyActivity(myState2).my_activity]`.","createdAt":"2025-02-10T16:17:26Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/747#issuecomment-2648559094","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c6eSKSC","author":{"login":"hebrd"},"authorAssociation":"NONE","body":"> But this is the one client across multiple workers, so this is the client identity (which is the worker identity by default), so it is the same for all activities on all workers of that client. If you need activities on different workers to have different state, consider using activity methods and instantiating different instances, e.g. one worker has `activities=[MyActivity(myState1).my_activity]` while the other has `activities=[MyActivity(myState2).my_activity]`.\n\nI have several workers with different identities for one client , for example:\n```python\nworkers = []\n    futures = []\n    for i in range(worker_num):\n        worker_name = f\"{worker_prefix}-{i + 1}@{socket.gethostname()}\"\n        worker = Worker(\n            client,\n            task_queue=q_name,\n            workflows=[BotActionWorkflow],\n            activities=[execute_action],\n            identity=worker_name,\n            interceptors=[ActivityStatusInterceptor()],\n            max_concurrent_activities=max_activity\n        )\n        workers.append(worker)\n        futures.append(worker.run())\n        logger.info(\"worker added: {}\", worker_name)\n```\n\nWhat i want is to get worker identity executing current activity in `ActivityStatusInterceptor`, would you please advise?","createdAt":"2025-02-13T05:56:22Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/747#issuecomment-2655560834","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c6eW54V","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"If you want worker-specific state in your interceptors, you should pass the state to the interceptor on instantiation, e.g `ActivityStatusInterceptor(worker_name)`. You can then store/use this in the interceptor and it is different per worker.","createdAt":"2025-02-13T14:40:25Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/747#issuecomment-2656804373","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c6eeGx-","author":{"login":"hebrd"},"authorAssociation":"NONE","body":"Thank you, Cretz. My concern is that I cannot determine the worker's identity before an activity is dynamically dispatched to a random worker.","createdAt":"2025-02-14T09:13:44Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/747#issuecomment-2658692222","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c6eiAK_","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"But you know that each worker has its own instance of the interceptor so you know if the interceptor for an activity is called, its state (e.g. worker identity) is only for the worker you're running on.","createdAt":"2025-02-14T16:03:16Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/747#issuecomment-2659713727","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c6emO3I","author":{"login":"hebrd"},"authorAssociation":"NONE","body":"Got it finally. Thank you for your patience and assistance.","createdAt":"2025-02-15T08:49:21Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-python/issues/747#issuecomment-2660822472","viewerDidAuthor":false}],"createdAt":"2025-01-24T03:25:09Z","labels":[],"milestone":null,"number":747,"reactionGroups":[],"state":"CLOSED","title":"How to Get the Worker ID Executing the Current Activity?","updatedAt":"2025-02-15T08:49:22Z","url":"https://github.com/temporalio/sdk-python/issues/747"}
