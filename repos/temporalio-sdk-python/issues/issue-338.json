{"assignees":[],"author":{"id":"MDQ6VXNlcjI4MjQ4","is_bot":false,"login":"masylum","name":"Pau Ramon Revilla"},"body":"### What are you really trying to do?\r\n\r\nWhen I need to import activities for a given workflow, the type system fails to recognize the activity type.\r\n\r\n### Describe the bug\r\n\r\nI'm currently using pyright and it tells me that the `activity` parameter when calling `workflow.execute_activity` should be a string. It's doing so because it does not match any of the overloads. When I bring the activity to the same file (so I bypass the `workflow.unsafe.imports_passed_through`) then the type system is happy\r\n\r\n### Minimal Reproduction\r\n\r\nI will use a simplified example from the README:\r\n\r\n```py\r\n# activities.py\r\nfrom temporalio import activity\r\n\r\n@activity.defn\r\nasync def say_hello(name: str) -> str:\r\n    return f\"Hello, {name}!\"\r\n\r\n# workflow.py\r\nfrom temporalio import workflow\r\n\r\n# Import our activity, passing it through the sandbox\r\nwith workflow.unsafe.imports_passed_through():\r\n    from .activities import say_hello\r\n\r\n@workflow.defn\r\nclass SayHello:\r\n    @workflow.run\r\n    async def run(self, name: str) -> str:\r\n        return await workflow.execute_activity(\r\n            say_hello, name\r\n```\r\n\r\nThis makes pyright complain:\r\n\r\n```\r\nArgument of type \"Module(\"say_hello\") | ((params: str) -> Coroutine[Any, Any, str])\" cannot be assigned to parameter \"activity\" of type \"str\" in function \"execute_activity\"\r\nType \"Module(\"say_hello\") | ((params: str) -> Coroutine[Any, Any, str])\" cannot be assigned to type \"str\"\r\nType \"Module(\"say_hello\")\" cannot be assigned to type \"str\" [reportGeneralTypeIssues]\r\n```\r\n\r\n### Environment/Versions\r\n\r\nPython 3.11.4\r\n\r\n### Additional context\r\n\r\n<!-- Add any other context about the problem here. -->\r\n","closedAt":"2023-07-11T16:46:10Z","comments":[{"id":"IC_kwDOGusT1c5gxxr1","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"Does this occur with MyPy? I wonder why Pyright is considering `say_hello` a module or a function here instead of just a function? I think this may be a Pyright bug, because surrounding an import with something should not change its types from a static analysis perspective.","createdAt":"2023-07-06T13:15:04Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/338#issuecomment-1623661301","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c5hOXec","author":{"login":"masylum"},"authorAssociation":"NONE","body":"hmm... Honestly, I've treid to setup nvim with mypy and I failed miserably. Feel free to close it if that's just a pyright bug","createdAt":"2023-07-11T16:46:06Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/338#issuecomment-1631156124","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c5hOn1N","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"I am not sure it is a PyRight bug specifically, but yes, if you cannot replicate except with PyRight it might be a PyRight bug worth submitting to them.","createdAt":"2023-07-11T17:33:27Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/338#issuecomment-1631223117","viewerDidAuthor":false}],"createdAt":"2023-07-06T08:38:09Z","labels":[{"id":"LA_kwDOGusT1c7gQgHK","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":338,"reactionGroups":[],"state":"CLOSED","title":"[Bug] Wrong types when using \"workflow.unsafe.imports_passed_through\"","updatedAt":"2023-07-11T17:33:28Z","url":"https://github.com/temporalio/sdk-python/issues/338"}
