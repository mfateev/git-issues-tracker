{"assignees":[],"author":{"id":"U_kgDOCZoBEQ","is_bot":false,"login":"irdbl","name":"Kevin Pham"},"body":"In the middle of a workflow, if you call `upsert_search_attributes` with an empty input:\r\n\r\n```python\r\nempty = []\r\nworkflow.upsert_search_attributes(empty)\r\n```\r\n\r\nYou'll get a completely inscrutable and hard to debug error like so:\r\n\r\n```\r\nFailed completing activation on workflow with run ID 27fa7d71-76a8-4b3b-be33-1e0d11afc5a4\r\nTraceback (most recent call last):\r\n  File \".../.venv/lib/python3.12/site-packages/temporalio/worker/_workflow.py\", line 320, in _handle_activation\r\n    await self._bridge_worker().complete_workflow_activation(completion)\r\n  File \".../.venv/lib/python3.12/site-packages/temporalio/bridge/worker.py\", line 117, in complete_workflow_activation\r\n    await self._ref.complete_workflow_activation(comp.SerializeToString())\r\nRuntimeError: Completion failure: Lang SDK sent us a malformed workflow completion for run (27fa7d71-76a8-4b3b-be33-1e0d11afc5a4): At least one workflow command in the completion contained an empty variant\r\n```","closedAt":null,"comments":[{"id":"IC_kwDOGusT1c6KqyRI","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"Saw the attached PR, thanks!","createdAt":"2024-09-03T13:02:51Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/629#issuecomment-2326471752","viewerDidAuthor":false}],"createdAt":"2024-09-02T22:14:28Z","labels":[{"id":"LA_kwDOGusT1c7gQgHK","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":629,"reactionGroups":[],"state":"OPEN","title":"[Bug] workflow.upsert_search_attributes() will bork SDK on empty inputs","updatedAt":"2024-09-03T13:02:53Z","url":"https://github.com/temporalio/sdk-python/issues/629"}
