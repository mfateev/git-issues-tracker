{"assignees":[],"author":{"id":"MDQ6VXNlcjIwNjM5Ng==","is_bot":false,"login":"cretz","name":"Chad Retz"},"body":"### Is your feature request related to a problem? Please describe.\r\n\r\nMany libraries have not upgraded to 4.x while many have (including us). Depending on libraries that haven't is causing a problem for users. Most libraries seem to know they need to move to protobuf 4.x but just haven't done it.\r\n\r\n### Describe the solution you'd like\r\n\r\nConsider options for supporting both. This could likely take the form of:\r\n\r\n* Generating proto 3.x form in addition to proto 4.x form\r\n* Changing generation script to have the `__all__` from the `__init__` of the proto packages switch to importing the 3.x generated code if determined to be on 3.x\r\n* Adding a CI step that confirms proto 3 works with tests and is generated properly\r\n* Experiment with ways to have 4.x be the default depended on version but that 3.x works. This may prove to be a bit difficult (can we have an \"extra\" that downgrades? can we ask users to force downgrade/shade?). IIRC Poetry doesn't support transitive overrides for example.\r\n  * I don't think we want 4.x to be an optional extra, I think we want it default because of a bug in 3.x w/ C static state sharing across imports which harms our sandbox.","closedAt":"2022-11-29T13:06:49Z","comments":[{"id":"IC_kwDOGusT1c5ObO5w","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"https://github.com/open-telemetry/opentelemetry-python/issues/2880#issuecomment-1314293057 mentions that we may be able to just generate with proto 3.20+. Need to try this.","createdAt":"2022-11-15T19:20:39Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/181#issuecomment-1315761776","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c5POT9R","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"This is complicated by the fact that we use https://pypi.org/project/grpcio-tools/ to generate our protobufs and the last version that supports proto 3.x (https://pypi.org/project/grpcio-tools/1.48.2/) doesn't have a Python 3.11 build. So code can't even be generated on latest Python when older proto library is in use.","createdAt":"2022-11-28T13:57:01Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/181#issuecomment-1329151825","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c5PiQNa","author":{"login":"schibrikov"},"authorAssociation":"CONTRIBUTOR","body":"Thanks a lot for working on this @cretz !\r\n\r\nDo you have any idea on when this might be released?","createdAt":"2022-12-01T20:15:26Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/181#issuecomment-1334379354","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c5PiZJU","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"@schibrikov - I do not, but hopefully soon. Beta 4 should be released soon (but no exact date)","createdAt":"2022-12-01T20:36:45Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"ROCKET","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-python/issues/181#issuecomment-1334415956","viewerDidAuthor":false}],"createdAt":"2022-11-01T22:43:55Z","labels":[{"id":"LA_kwDOGusT1c7gQgHN","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":181,"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"state":"CLOSED","title":"[Feature Request] Review options for allowing protobuf 3.x to work with this library","updatedAt":"2022-12-01T20:39:29Z","url":"https://github.com/temporalio/sdk-python/issues/181"}
