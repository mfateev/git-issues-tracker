{"assignees":[],"author":{"id":"MDQ6VXNlcjIwNjM5Ng==","is_bot":false,"login":"cretz","name":"Chad Retz"},"body":"### Describe the solution you'd like\r\n\r\nWrite a test confirming that baggage is properly serialized/rehydrated to/within activities and if it is not, fix that.","closedAt":"2025-10-27T21:32:40Z","comments":[{"id":"IC_kwDOGusT1c5jUJtj","author":{"login":"recht"},"authorAssociation":"NONE","body":"I did a quick change to `_TracingActivityInboundInterceptor` to add attach/detach calls, and then it works:\r\n```\r\n        ctx = self.root._context_from_headers(input.headers)\r\n        with self.root.tracer.start_as_current_span(\r\n            f\"RunActivity:{info.activity_type}\",\r\n            context=ctx,\r\n            attributes={\r\n                \"temporalWorkflowID\": info.workflow_id,\r\n                \"temporalRunID\": info.workflow_run_id,\r\n                \"temporalActivityID\": info.activity_id,\r\n            },\r\n        ):\r\n            token = opentelemetry.context.attach(ctx)\r\n            try:\r\n                return await super().execute_activity(input)\r\n            finally:\r\n                opentelemetry.context.detach(token)\r\n\r\n```","createdAt":"2023-08-04T22:11:28Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/362#issuecomment-1666227043","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c5jUKQi","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"Thanks! I guess it's intentional that https://opentelemetry-python.readthedocs.io/en/latest/api/trace.html#opentelemetry.trace.Tracer.start_as_current_span does not do that.","createdAt":"2023-08-04T22:14:23Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/362#issuecomment-1666229282","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c5jUK_S","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"At first glance, this appears caused by a known OTel Python bug https://github.com/open-telemetry/opentelemetry-python/issues/3350 (as linked from https://github.com/open-telemetry/opentelemetry-python/issues/2432). We will workaround by re-attaching the context (so long as we don't lose the span we created). I will write tests to confirm.","createdAt":"2023-08-04T22:18:50Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/362#issuecomment-1666232274","viewerDidAuthor":false}],"createdAt":"2023-08-04T22:07:04Z","labels":[{"id":"LA_kwDOGusT1c7gQgHN","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":362,"reactionGroups":[],"state":"CLOSED","title":"[Feature Request] Make sure OTel baggage propagates properly throughout activities","updatedAt":"2025-10-27T21:32:40Z","url":"https://github.com/temporalio/sdk-python/issues/362"}
