{"assignees":[],"author":{"id":"MDQ6VXNlcjc0OTMwOA==","is_bot":false,"login":"dmarcato","name":"Dario Marcato"},"body":"### What are you really trying to do?\n\nI have a `sync` activity that triggers a utility method that needs to make sure it's not being called inside a workflow.\nAt a high level, the code is structured like this:\n```python\n# activities.py\n@activity.defn\ndef my_activity(arg: MyArg):\n    utility.do_stuff()\n\n# utility.py\ndef do_stuff():\n    if workflow.in_workflow():\n        raise RuntimeError(\"Can not call from inside a workflow\")\n```\n\n### Describe the bug\n\nThe activity triggers the following error:\n```\nRuntimeError\nno running event loop\n```\nwhich can be traced to the `maybe_current()` method:\n\n![Image](https://github.com/user-attachments/assets/d7e13842-fe27-4315-8de2-de20d8b6647a)\n\n### Minimal Reproduction\n\nThe example above should be enough to reproduce.\nThe worker is configured with a `ThreadPoolExecutor` to execute the `sync` activities.\n\n### Environment/Versions\n\n- Temporal Version: Python 1.11.0\n- Running inside Docker\n","closedAt":"2025-06-05T22:47:16Z","comments":[{"id":"IC_kwDOGusT1c6uBBx2","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"Thanks, good find. We expect this to be able to be called from all contexts and we need to return `False` (via `None` on maybe_current) if there is no running loop. We will fix.","createdAt":"2025-05-29T14:00:25Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HOORAY","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-python/issues/878#issuecomment-2919505014","viewerDidAuthor":false}],"createdAt":"2025-05-28T18:46:26Z","labels":[{"id":"LA_kwDOGusT1c7gQgHK","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":878,"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"state":"CLOSED","title":"[Bug] workflow.in_workflow() expects to be called in a thread with a running event loop","updatedAt":"2025-06-05T22:47:16Z","url":"https://github.com/temporalio/sdk-python/issues/878"}
