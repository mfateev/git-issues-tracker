{"assignees":[],"author":{"id":"MDQ6VXNlcjU0NzI4NTk=","is_bot":false,"login":"VegetarianOrc","name":"Alex Mazzeo"},"body":"### What are you really trying to do?\n\nLeverage `SandboxImportNotificationPolicy.WARN_ON_UNINTENTIONAL_PASSTHROUGH` to identify imports that aren't intentionally passed through to the sandbox.\n\n### Describe the bug\n\nUsing a sandboxed runner with the workflows defined in a separate from the worker triggers the unintentional passthrough warning. The workflow must be loaded into the sandbox each time and therefore should be exempt from this warning.\n\n### Minimal Reproduction\n\n```python\n# workflows.py\nfrom datetime import timedelta\n\nfrom temporalio import workflow\n\nfrom warning.activities import echo_activity\n\n\n@workflow.defn\nclass ExampleWorkflow:\n    @workflow.run\n    async def run(self) -> str:\n        activity_result = await workflow.execute_activity(\n            echo_activity,\n            \"example\",\n            task_queue=\"example-task-queue\",\n            start_to_close_timeout=timedelta(seconds=10),\n        )\n\n        return activity_result\n```\n\n```python\n# activities.py\nfrom temporalio import activity\n\n\n@activity.defn\nasync def echo_activity(input: str) -> str:\n    return f\"hello {input}\"\n\n```\n\n```python\n# worker.py\nimport asyncio\n\nfrom temporalio.client import Client\nfrom temporalio.envconfig import ClientConfig\nfrom temporalio.worker import Worker\nfrom temporalio.worker.workflow_sandbox import (\n    SandboxedWorkflowRunner,\n    SandboxRestrictions,\n)\nfrom temporalio.workflow import SandboxImportNotificationPolicy\n\nfrom warning.activities import echo_activity\nfrom warning.workflows import ExampleWorkflow\n\n\nasync def main():\n    config = ClientConfig.load_client_connect_config()\n    config.setdefault(\"target_host\", \"localhost:7233\")\n\n    # Start client\n    client = await Client.connect(**config)\n\n    worker = Worker(\n        client,\n        task_queue=\"example-task-queue\",\n        workflows=[ExampleWorkflow],\n        activities=[echo_activity],\n        workflow_runner=SandboxedWorkflowRunner(\n            restrictions=SandboxRestrictions.default.with_import_notification_policy(\n                SandboxImportNotificationPolicy.WARN_ON_DYNAMIC_IMPORT\n                | SandboxImportNotificationPolicy.WARN_ON_UNINTENTIONAL_PASSTHROUGH\n            )\n        ),\n    )\n\n    await worker.run()\n\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n```\n\nStarting the above worker yields this log on startup and workflow execution:\n\n> uv run warning/worker.py\n/.../temporalio/worker/workflow_sandbox/_importer.py:323: UserWarning: Module warning.workflows was not intentionally passed through to the sandbox.\n  warnings.warn(\n/.../temporalio/worker/workflow_sandbox/_importer.py:323: UserWarning: Module warning.activities was not intentionally passed through to the sandbox.\n  warnings.warn(\n\n### Environment/Versions\n\n<!-- Please complete the following information where relevant. -->\n\n- Temporal Version: SDK 1.20\n\n### Additional context\n\n<!-- Add any other context about the problem here. -->\n","closedAt":null,"comments":[],"createdAt":"2025-12-17T23:35:07Z","labels":[{"id":"LA_kwDOGusT1c7gQgHK","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":1254,"reactionGroups":[],"state":"OPEN","title":"[Bug] `SandboxImportNotificationPolicy.WARN_ON_UNINTENTIONAL_PASSTHROUGH` warns on import of the workflow itself to the sandbox","updatedAt":"2025-12-17T23:35:07Z","url":"https://github.com/temporalio/sdk-python/issues/1254"}
