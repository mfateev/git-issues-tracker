{"assignees":[],"author":{"id":"MDQ6VXNlcjEyMzAxNDA2","is_bot":false,"login":"gerryfp","name":"Gerry FP"},"body":"### What are you really trying to do?\n\nI'm having issue with creating helper function to execute activity. My main goal is to have execute activities with the same configuration. Without helper function it works just fine, but after creating a helper function and called it inside workflow, it asks to provide task queue. I would expect the code to behave exactly the same way.\n\n### Describe the bug\nCode\n```\nasync def execute_activity_base(\n    temporal_activity,\n    job_id,\n    start_to_close_timeout=timedelta(hours=1),\n):\n    return await workflow.execute_activity(\n        temporal_activity,\n        job_id,\n        start_to_close_timeout=start_to_close_timeout,\n        retry_policy=RetryPolicy(\n            initial_interval=timedelta(seconds=30),\n            backoff_coefficient=2.0,\n            maximum_attempts=3,\n            maximum_interval=timedelta(seconds=10),\n        ),\n    )\n```\n\nError message\n\n`2025-05-06T03:01:36.718693Z  WARN temporal_sdk_core::worker::workflow: Error while completing workflow activation error=status: InvalidArgument, message: \"invalid TaskQueue on ScheduleActivityTaskCommand: missing task queue name. ActivityId=3 ActivityType=estimated_generation\", details: [], metadata: MetadataMap { headers: {\"content-type\": \"application/grpc\", \"server\": \"temporal\", \"date\": \"Tue, 06 May 2025 03:01:36 GMT\"} }`\n\n### Minimal Reproduction\n\n1. Instead of calling workflow.execute_activity in workflow call the helper method defined above. And the method is define in a different file.\n\n### Environment/Versions\n- Temporal Version: 1.9.0\n","closedAt":"2025-09-23T20:02:11Z","comments":[{"id":"IC_kwDOGusT1c6qYUun","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"I am unable to replicate. For instance, the following code works as expected:\n\n```python\n@activity.defn\nasync def say_hello(name: str) -> str:\n    return f\"Hello, {name}!\"\n\n@workflow.defn\nclass ActivityHelperWorkflow:\n    @workflow.run\n    async def run(self, name: str) -> str:\n        return await self.my_execute_activity_helper(name)\n\n    async def my_execute_activity_helper(self, name: str) -> str:\n        return await workflow.execute_activity(\n            say_hello,\n            name,\n            start_to_close_timeout=timedelta(seconds=30)\n        )\n```\n\nCan you provide a full standalone replication with workflow and everything? Can just alter https://github.com/temporalio/samples-python/blob/main/hello/hello_activity.py to replicate your error if that helps.","createdAt":"2025-05-07T13:00:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/855#issuecomment-2858503079","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c6qdkWk","author":{"login":"gerryfp"},"authorAssociation":"NONE","body":"Here you go:\n\n```py\nfrom .helper import execute_activity_base\n\n@activity.defn\nasync def say_hello(name: str) -> str:\n    return f\"Hello, {name}!\"\n\n@workflow.defn\nclass ActivityHelperWorkflow:\n    @workflow.run\n    async def run(self, name: str) -> str:\n        return await execute_activity_base(say_hello, name)\n```\n\n```py\n# THIS IS helper.py\nasync def execute_activity_base(\n    temporal_activity,\n    name,\n    start_to_close_timeout=timedelta(hours=1),\n):\n    return await workflow.execute_activity(\n        say_hello,\n        name,\n        start_to_close_timeout=start_to_close_timeout,\n        retry_policy=RetryPolicy(\n            initial_interval=timedelta(seconds=30),\n            backoff_coefficient=2.0,\n            maximum_attempts=3,\n            maximum_interval=timedelta(seconds=10),\n        ),\n    )\n```","createdAt":"2025-05-07T18:48:36Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/855#issuecomment-2859877796","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c6qp1fa","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"The code you pasted has two bugs. First, in `helper.py`, you have to replace `say_hello` with `temporal_activity`. Second, if you run this you get \"Maximum interval cannot be less than initial interval\" because the retry policy is invalid (can set to 30 like initial interval). \n\nI assume those two bugs aren't related to your problem though. When fixing those two bugs, I am unable to replicate anything concerning task queue, the code works just fine. If it still happens for you, we can open a draft PR on the samples repo with this as a test case to try to get it to fail CI tests to confirm it is not something unique to your environment.","createdAt":"2025-05-08T13:34:13Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/855#issuecomment-2863093722","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c6tfjk_","author":{"login":"gerryfp"},"authorAssociation":"NONE","body":"This is so weird, when I set initial_interval=timedelta(seconds=1), it works perfectly. But if I change it to initial_interval=timedelta(seconds=30), it throws an “invalid TaskQueue” error. There must be a bug somewhere internally.","createdAt":"2025-05-26T22:53:17Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/855#issuecomment-2910730559","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c6tnPry","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"I am still not able to replicate even with that retry policy. Can you provide a full, standalone replication? If easiest, can open a draft PR to the samples-python repo, e.g. changing https://github.com/temporalio/samples-python/blob/main/hello/hello_activity.py to replicate what you are seeing.","createdAt":"2025-05-27T14:31:24Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/855#issuecomment-2912746226","viewerDidAuthor":false}],"createdAt":"2025-05-07T04:11:33Z","labels":[{"id":"LA_kwDOGusT1c7gQgHK","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":855,"reactionGroups":[],"state":"CLOSED","title":"[Bug] Helper execute activity doesn't work as expected","updatedAt":"2025-09-23T20:02:11Z","url":"https://github.com/temporalio/sdk-python/issues/855"}
