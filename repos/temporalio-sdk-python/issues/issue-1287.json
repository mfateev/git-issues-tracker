{"assignees":[],"author":{"id":"MDQ6VXNlcjI2Mzk0NDkz","is_bot":false,"login":"millerick","name":"Michael Millerick"},"body":"### What are you really trying to do?\n\nWe noticed that one of our services was able to use `requests` to send HTTP requests, while others were not.  We eventually tracked it down to a difference in `urllib3` between services.\n\n### Describe the bug\n\nWhen `urllib3==1.26.19` is installed alongside `requests`, workflow code is able to avoid the sandbox restrictions and send HTTP requests without the sandbox detecting and raising an exception.\n<img width=\"1002\" height=\"310\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/e003b06e-1da9-4d8f-852f-e28139ad7622\" />\n\n`urllib3==2.6.2` is correctly detected by the sandbox and creates an error as expected\n```\ntemporalio.worker.workflow_sandbox._restrictions.RestrictedWorkflowAccessError: Cannot access http.client.IncompleteRead.__mro_entries__ from inside a workflow. If this is code from a module not used in a workflow or known to only be used deterministically from a workflow, mark the import as pass through.\n```\n\n### Minimal Reproduction\n\nClone https://github.com/millerick/temporal-sandbox-restriction-bug and follow instructions in the README.\n\n### Environment/Versions\n\nThis is what I was running for the minimal reproduction, but I assume it happens in all cases\n\n- OS and processor: M3 Mac\n- Temporal Version: Python SDK 1.21.1\n\n### Additional context\n\nn/a\n","closedAt":"2026-01-22T17:17:30Z","comments":[{"id":"IC_kwDOGusT1c7ho8_B","author":{"login":"tconley1428"},"authorAssociation":"MEMBER","body":"The sandbox is best effort, we don't guarantee it will prevent every potential issue. Additionally, importing `requests` as pass through indicates that you are trying to use it in the workflow and know what you are doing. Note: `workflow.unsafe`. If you don't pass through the import, it fails as expected. The difference between the two versions likely has to do with when exactly the library tries to do the restricted thing, but I don't have details there.","createdAt":"2026-01-22T17:17:30Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/1287#issuecomment-3785609153","viewerDidAuthor":false}],"createdAt":"2026-01-20T20:51:26Z","labels":[{"id":"LA_kwDOGusT1c7gQgHK","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":1287,"reactionGroups":[],"state":"CLOSED","title":"[Bug] workflow sandbox does not always restrict usage of urllib3","updatedAt":"2026-01-22T17:17:36Z","url":"https://github.com/temporalio/sdk-python/issues/1287"}
