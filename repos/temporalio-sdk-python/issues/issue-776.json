{"assignees":[],"author":{"id":"MDQ6VXNlcjE3NTY4NTQ5","is_bot":false,"login":"funkindy","name":"Alexey Trofimov"},"body":"I am implementing async logging inside my workflow. I use structlog lib async methods which use thread executor for default logging methods (.info -> await .ainfo).\n\nThe problem now is that run_in_executor is not implemented on Temporal's event loop, so invoking `await asyncio.get_running_loop().run_in_executor(...)` in structlog's internals causes NotImplementedError\n\n\nIs it possible to implement  `_WorkflowInstanceImpl.run_in_executor`, or is it pointless on python-SDK architecture?\n\nThank you.","closedAt":"2025-02-26T18:10:27Z","comments":[{"id":"IC_kwDOGusT1c6gCoDm","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"The async loop in workflows is a custom deterministic loop with no thread capabilities by intention, because threads are non-deterministic.\n\nIf you need to violate the determinism rules to issue log statements, you cannot use the deterministic loop to do it, you will have to take the same approach as calling your asyncio loop from outside the loop in any other fashion. This is usually `asyncio.run_coroutine_threadsafe(my_async_call(), my_primary_loop).result()`.\n\nBut what is the use case for _async_  logging from inside a workflow instead of synchronous logging? Also, you may consider replacing the base logger of `workflow.logger` (i.e. `workflow.logger.logger`) with this other equivalent and use `workflow.logger`, or at the least, make sure you don't log during replay in your logger (meaning check `not workflow.unsafe.is_replaying()`).","createdAt":"2025-02-26T13:48:41Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HEART","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-python/issues/776#issuecomment-2685042918","viewerDidAuthor":false}],"createdAt":"2025-02-26T09:37:07Z","labels":[{"id":"LA_kwDOGusT1c7gQgHN","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":776,"reactionGroups":[],"state":"CLOSED","title":"[Feature Request] Implement run_in_executor on _WorkflowInstanceImpl","updatedAt":"2025-02-26T18:10:27Z","url":"https://github.com/temporalio/sdk-python/issues/776"}
