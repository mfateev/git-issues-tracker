{"assignees":[],"author":{"id":"MDQ6VXNlcjQwMDYwMTA=","is_bot":false,"login":"maver1ck","name":"Maciek BryÅ„ski"},"body":"## Summary\n`temporalio.contrib.opentelemetry.TracingInterceptor` does not put workflow input/output values on the spans it exports. Only the workflow/run IDs show up, so downstream OTEL backends (Langfuse in my case) cannot see what was invoked.\n\n## Reproduction\n1. Save the script below as `temporal_minimal_otel_bug.py` (needs a Temporal dev server on `localhost:7233`.\n```python\n\"\"\"Minimal Temporal workflow runner with optional OpenTelemetry tracing.\"\"\"\n\nfrom __future__ import annotations\n\nimport asyncio\nimport logging\nimport os\nimport uuid\n\nfrom opentelemetry import trace\nfrom opentelemetry.sdk.resources import Resource\nfrom opentelemetry.sdk.trace import TracerProvider\nfrom opentelemetry.sdk.trace.export import ConsoleSpanExporter, SimpleSpanProcessor\nfrom temporalio import workflow\nfrom temporalio.client import Client\nfrom temporalio.worker import Worker\nfrom temporalio.contrib.opentelemetry import TracingInterceptor\n\n\nlog = logging.getLogger(__name__)\n\n\ndef _otel_interceptors() -> list[object]:\n    \"\"\"Return Temporal interceptors that emit OpenTelemetry spans when available.\"\"\"\n    if TracingInterceptor is None:\n        log.debug(\n            \"Skipping OpenTelemetry tracing; install temporalio[opentelemetry] extras to enable.\"\n        )\n        return []\n    log.info(\"OpenTelemetry tracing enabled for minimal PoC (console exporter).\")\n    return [TracingInterceptor()]\n\n\ndef _configure_console_exporter() -> None:\n    \"\"\"Set up a console exporter so spans are visible locally.\"\"\"\n    existing = trace.get_tracer_provider()\n    if isinstance(existing, TracerProvider):\n        # Already configured (e.g., tests) -> skip\n        return\n    resource = Resource.create({\"service.name\": os.getenv(\"OTEL_SERVICE_NAME\", \"temporal-minimal\")})\n    provider = TracerProvider(resource=resource)\n    provider.add_span_processor(SimpleSpanProcessor(ConsoleSpanExporter()))\n    trace.set_tracer_provider(provider)\n\n\n@workflow.defn(sandboxed=False)\nclass HelloWorkflow:\n    @workflow.run\n    async def run(self, name: str) -> str:\n        log.info(\"Running HelloWorkflow for %s\", name)\n        return f\"Hello, {name}!\"\n\n\nasync def main() -> None:\n    _configure_console_exporter()\n    interceptors = _otel_interceptors()\n    client = await Client.connect(\n        \"localhost:7233\",\n        interceptors=interceptors,\n    )\n\n    async with Worker(\n        client,\n        task_queue=\"minimal\",\n        workflows=[HelloWorkflow],\n    ):\n        result = await client.execute_workflow(\n            HelloWorkflow.run,\n            \"Temporal\",\n            id=f\"hello-{uuid.uuid4()}\",\n            task_queue=\"minimal\",\n        )\n        print(result)\n\n\nif __name__ == \"__main__\":\n    logging.basicConfig(level=logging.INFO)\n    asyncio.run(main())\n\n```\n\n2. Run `uv run python temporal_minimal_otel_bug.py`.\n3. Check stdout for Temporal spans. \n\n## Expected\nWorkflow spans include attributes for the serialized input and output (even truncated strings would work) so downstream tools can show what the workflow did.\n\n## Actual\nOnly identifiers are exported; input/output payloads are absent even though the Temporal history contains them.\n\n<img width=\"1298\" height=\"780\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/231dee49-232a-4cdc-91b6-6d912c183701\" />\n\n## Environment\n- temporalio==1.18.0\n- opentelemetry-sdk==1.38.0\n- Python 3.12\n- Temporal Server 2.41.0\n- OTLP exporter: HTTP/protobuf to Langfuse Cloud\n\n## Notes\nTemporal history for the same run shows one input payload and one output payload  The data is available; it just never makes it onto the spans.\n\n<img width=\"1308\" height=\"675\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/aebee8da-d95d-4ecd-8b71-e287d93f278c\" />\n","closedAt":"2025-12-05T19:24:04Z","comments":[{"id":"IC_kwDOGusT1c7OGARk","author":{"login":"tconley1428"},"authorAssociation":"MEMBER","body":"We'll take a look at the request. I think we would be unlikely to add that information by default, both because of compatibility guarantees and the potential for users who don't want to expose that information to downstream systems. An option to enrich with that information is potentially viable however.","createdAt":"2025-10-28T17:36:08Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/1190#issuecomment-3457680484","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c7XqkEl","author":{"login":"tconley1428"},"authorAssociation":"MEMBER","body":"We don't think it makes sense to add this behavior as a built in. It will often be surprisingly dangerous to output that much information to the tracing system. If you want to do this, we would currently recommend your own interceptor to add this information, or emitting your own span.","createdAt":"2025-12-05T19:24:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/1190#issuecomment-3618259237","viewerDidAuthor":false}],"createdAt":"2025-10-27T05:39:42Z","labels":[],"milestone":null,"number":1190,"reactionGroups":[],"state":"CLOSED","title":"OpenTelemetry spans missing workflow input/output attributes","updatedAt":"2025-12-05T19:24:05Z","url":"https://github.com/temporalio/sdk-python/issues/1190"}
