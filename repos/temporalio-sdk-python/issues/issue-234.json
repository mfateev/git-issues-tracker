{"assignees":[],"author":{"id":"MDQ6VXNlcjYwNTg4NTU4","is_bot":false,"login":"ferntheplant","name":"fern"},"body":"### What are you really trying to do?\r\n\r\n<!-- \r\nTell us at a high level what you're doing, to avoid XY problem (https://en.wikipedia.org/wiki/XY_problem) \r\n-->\r\nCreate activities corresponding to hitting different API endpoints. The endpoint responses are paginated and I want a separate iterator that controls pagination on behalf of the endpoint caller. So each activity would accept the params for the endpoint provided by the user + a cursor provided by the iterator. So an activity might look like:\r\n\r\n```python\r\nP = TypeVar(\"P\")\r\n@dataclass\r\nclass ApiParams(Generic[P]):\r\n    args: P\r\n    cursor: str\r\n\r\n@dataclass \r\nclass EndpointFooParams:\r\n    foo: str\r\n    bar: str\r\n\r\n@activity.defn\r\nasync def hit_endpoint_foo(param: ApiParams[EndpointFooParams]) -> list:\r\n    args = params.args\r\n    cursor = params.cursor\r\n    response = await api.foo(args.foo, args.bar, cursor)\r\n    return response.data\r\n```\r\n\r\n### Describe the bug\r\n\r\n<!-- A clear and concise description of what the bug is. -->\r\n\r\n<!-- If applicable, add screenshots or code blocks to help explain your problem. You can also use [Loom](http://loom.com/) to do short, free video bug reports. -->\r\n\r\nWhen running an activity defined like above I get a runtime error \r\n```  \r\n    a = param.args\r\n    ^^^^^^^^^^^\r\nAttributeError: 'dict' object has no attribute 'args'\r\n```\r\n\r\nThis indicates that the activity params dataclass was deserialized into a plain dictionary instead of a proper dataclass.\r\n\r\n### Minimal Reproduction\r\n\r\n<!-- \r\nModify our hello world templates to demonstrate:\r\n\r\n- TypeScript: https://github.com/temporalio/samples-typescript/tree/main/hello-world\r\n- Go: https://github.com/temporalio/money-transfer-project-template-go\r\n- Java: https://github.com/temporalio/money-transfer-project-template-java\r\n- PHP: https://github.com/temporalio/samples-php#samples\r\n-->\r\n```python\r\nimport asyncio\r\n\r\nfrom dataclasses import dataclass\r\nfrom typing import Generic, TypeVar\r\nfrom datetime import timedelta\r\n\r\nfrom temporalio import activity, workflow\r\nfrom temporalio.client import Client\r\nfrom temporalio.worker import Worker\r\n\r\nP = TypeVar(\"P\")\r\n\r\n@dataclass\r\nclass A:\r\n    foo: str\r\n\r\n@dataclass\r\nclass B(Generic[P]):\r\n    bar: str\r\n    nested_a: P\r\n\r\n@activity.defn\r\nasync def demo_activity(param: B[A]) -> str:\r\n    a = param.nested_a\r\n    return a.foo + param.bar\r\n\r\n@workflow.defn()\r\nclass BasicWorkflow:\r\n    @workflow.run\r\n    async def run(self, foo: str) -> str:\r\n        return await workflow.execute_activity(\r\n            demo_activity,\r\n            B(bar=foo, nested_a=A(foo=foo)),\r\n            start_to_close_timeout=timedelta(seconds=10)\r\n        )\r\n\r\nasync def main():\r\n    client = await Client.connect(\"localhost:7233\")\r\n\r\n    async with Worker(\r\n        client,\r\n        task_queue=\"basic\",\r\n        workflows=[BasicWorkflow],\r\n        activities=[demo_activity],\r\n    ):\r\n        await client.execute_workflow(\r\n            BasicWorkflow.run,\r\n            \"hello\",\r\n            id=\"basic\",\r\n            task_queue=\"basic\",\r\n        )\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    asyncio.run(main())\r\n\r\n```\r\n\r\n### Environment/Versions\r\n\r\n<!-- Please complete the following information where relevant. -->\r\n\r\n- OS and processor: M1 Mac running macOS 12.5.1\r\n- Temporal Version: python sdk 0.1b4\r\n- Are you using Docker or Kubernetes or building Temporal from source? Docker compose\r\n\r\n### Additional context\r\n\r\n<!-- Add any other context about the problem here. -->\r\nAs per [slack discussion](https://temporalio.slack.com/archives/CTT84RS0P/p1672273325314819) resolving dataclass generics for deserialization is not expected of temporal data converters. Resolution is to update readme to warn future users\r\n","closedAt":"2023-01-04T17:47:06Z","comments":[],"createdAt":"2022-12-29T01:15:39Z","labels":[{"id":"LA_kwDOGusT1c7gQgHK","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":234,"reactionGroups":[],"state":"CLOSED","title":"[Bug] Generic Nested Dataclasses not desrialized correctly","updatedAt":"2023-01-04T17:47:06Z","url":"https://github.com/temporalio/sdk-python/issues/234"}
