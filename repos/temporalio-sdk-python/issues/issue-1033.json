{"assignees":[],"author":{"id":"MDQ6VXNlcjk4OTgy","is_bot":false,"login":"AlmogBaku","name":"Almog Baku"},"body":"### What are you really trying to do?\n\nSimple naive test\n\n### Describe the bug\n\nCode below shows this weird error:\n```console\n============================= test session starts ==============================\nplatform darwin -- Python 3.12.11, pytest-8.4.1, pluggy-1.6.0 -- /Users/almogbaku/projects/poc/workflows/.venv/bin/python3\ncachedir: .pytest_cache\nrootdir: /Users/almogbaku/projects/poc/workflows\nconfigfile: pyproject.toml\nplugins: asyncio-1.1.0, anyio-4.10.0, cov-6.2.1, langsmith-0.4.14, logfire-4.3.3\nasyncio: mode=Mode.AUTO, asyncio_default_fixture_loop_scope=session, asyncio_default_test_loop_scope=function\ncollecting ... collected 1 item\n\nsrc/test.py::test_workflow_basic_startup \n-------------------------------- live log call ---------------------------------\nWARNING  temporalio.activity:_activity.py:365 Completing activity as failed\nTraceback (most recent call last):\n  File \"/Users/almogbaku/projects/poc/workflows/.venv/lib/python3.12/site-packages/temporalio/worker/_activity.py\", line 296, in _handle_start_activity_task\n    result = await self._execute_activity(start, running_activity, task_token)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/almogbaku/projects/poc/workflows/.venv/lib/python3.12/site-packages/temporalio/worker/_activity.py\", line 519, in _execute_activity\n    heartbeat_timeout=_proto_to_non_zero_timedelta(start.WAIT_TIMEOUT)\n                                                   ^^^^^^^^^^^^^^^^^^\nAttributeError: WAIT_TIMEOUT\nWARNING  temporalio.activity:_activity.py:365 Completing activity as failed\nTraceback (most recent call last):\n  File \"/Users/almogbaku/projects/poc/workflows/.venv/lib/python3.12/site-packages/temporalio/worker/_activity.py\", line 296, in _handle_start_activity_task\n    result = await self._execute_activity(start, running_activity, task_token)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/almogbaku/projects/poc/workflows/.venv/lib/python3.12/site-packages/temporalio/worker/_activity.py\", line 519, in _execute_activity\n    heartbeat_timeout=_proto_to_non_zero_timedelta(start.WAIT_TIMEOUT)\n                                                   ^^^^^^^^^^^^^^^^^^\nAttributeError: WAIT_TIMEOUT\nWARNING  temporalio.activity:_activity.py:365 Completing activity as failed\nTraceback (most recent call last):\n  File \"/Users/almogbaku/projects/poc/workflows/.venv/lib/python3.12/site-packages/temporalio/worker/_activity.py\", line 296, in _handle_start_activity_task\n    result = await self._execute_activity(start, running_activity, task_token)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/almogbaku/projects/poc/workflows/.venv/lib/python3.12/site-packages/temporalio/worker/_activity.py\", line 519, in _execute_activity\n    heartbeat_timeout=_proto_to_non_zero_timedelta(start.WAIT_TIMEOUT)\n                                                   ^^^^^^^^^^^^^^^^^^\nAttributeError: WAIT_TIMEOUT\nPASSED\n\n============================== 1 passed in 0.39s ===============================\n```\n\n### Minimal Reproduction\n\n```python\nfrom datetime import timedelta\n\nimport pytest\nfrom temporalio import activity, workflow\nfrom temporalio.client import WorkflowExecutionStatus\nfrom temporalio.testing import WorkflowEnvironment\nfrom temporalio.worker import Worker\n\n\n@workflow.defn\nclass BasicFake:\n    def __init__(self) -> None:\n        self._internal_state = {}\n\n    @workflow.run\n    async def run(self, input_params) -> None:\n        self._internal_state = await workflow.execute_activity(\n            'do_something',\n            input_params,\n            start_to_close_timeout=timedelta(seconds=30),\n        )\n\n        while True:\n            await workflow.sleep(1)\n\n\n@activity.defn(name=\"do_something\")\nasync def mock_do_something(input_params: dict) -> str:\n    return input_params['name']\n\n\n@pytest.mark.asyncio\nasync def test_workflow_basic_startup():\n    async with await WorkflowEnvironment.start_time_skipping() as env:\n        async with Worker(\n            env.client,\n            task_queue=\"test-queue\",\n            workflows=[BasicFake],\n            activities=[mock_do_something],\n        ):\n            handle = await env.client.start_workflow(\n                'BasicFake',\n                {\"name\": \"test\"},\n                id=\"test-id\",\n                task_queue=\"test-queue\",\n            )\n            await env.sleep(5)\n\n            try:\n                status = (await handle.describe()).status\n                assert WorkflowExecutionStatus.RUNNING == status\n            finally:\n                await handle.terminate()\n```\n\n### Environment/Versions\n\npython sdk 1.15.0\n","closedAt":"2025-08-19T09:56:10Z","comments":[{"id":"IC_kwDOGusT1c6-vREo","author":{"login":"AlmogBaku"},"authorAssociation":"NONE","body":"removing .venv and reinstalling fixed this. damn, sent until 6am on this","createdAt":"2025-08-19T09:56:11Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/1033#issuecomment-3200061736","viewerDidAuthor":false}],"createdAt":"2025-08-19T02:55:49Z","labels":[{"id":"LA_kwDOGusT1c7gQgHK","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":1033,"reactionGroups":[],"state":"CLOSED","title":"[Bug] heartbeat_timeout=_proto_to_non_zero_timedelta(start.WAIT_TIMEOUT)","updatedAt":"2025-08-19T09:56:11Z","url":"https://github.com/temporalio/sdk-python/issues/1033"}
