{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMTA4NTgz","is_bot":false,"login":"Kilo59","name":"Gabriel"},"body":"### Is your feature request related to a problem? Please describe.\n\n<!-- A clear and concise description of what the problem is. Ex. I'm always frustrated when [...] -->\n\nI'm often frustrated when I have some piece business logic as part of a Temporal Workflow that I also want to execute outside of a Temporal Worker. I would like to be able to avoid duplicating this code as much as possible.\n\n### Describe the solution you'd like\n\n<!-- A clear and concise description of what you want to happen. SCREENSHOTS OR CODE SAMPLES ARE VERY HELPFUL -->\n\nBeing able to call a `Workflow.run` method directly rather than only being able to run it via a temporal worker is one way to get around this issue.\n\nHowever the below example will throw a `temporalio.workflow._NotInWorkflowEventLoopError: Not in workflow event loop` error.\n\n\n```python\nimport asyncio\nimport dataclasses\n\nfrom temporalio import activity, workflow\n\n\n@dataclasses.dataclass\nclass MyArgs:\n    to_greet: str\n\n\n@workflow.defn\nclass GreetingWorkflow:\n    @workflow.run\n    async def run(self, arg: MyArgs) -> list[str]:\n        log: list[str] = []\n\n        hello = await workflow.execute_activity(\n            GreetingActivities.say_hello,\n            arg.to_greet,\n        )\n        print(hello)\n        log.append(hello)\n\n        goodbye = await workflow.execute_activity(\n            GreetingActivities.say_goodbye,\n            arg.to_greet,\n        )\n        print(goodbye)\n        log.append(goodbye)\n        return log\n\n\nclass GreetingActivities:\n    @activity.defn\n    async def say_hello(self, to_greet: str) -> str:\n        return f\"Hello {to_greet}!\"\n\n    @activity.defn\n    async def say_goodbye(self, to_greet: str) -> str:\n        return f\"Goodbye {to_greet}!\"\n\n\nif __name__ == \"__main__\":\n    wf = GreetingWorkflow()\n    asyncio.run(wf.run(MyArgs(to_greet=\"world\")))\n```\n\n\n### Additional context\n\n<!-- Add any other context or screenshots about the feature request here. -->\n\nI don't particular care about running the workflow per se, I just would like to avoid duplicating the \"activity\" orchestration logic in the workflow layer.\n\nAlso when run this way I don't expect to retain the standard temporal \"durable execution\" guarantees. ","closedAt":null,"comments":[{"id":"IC_kwDOGusT1c6v3CB7","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"> Being able to call a Workflow.run method directly rather than only being able to run it via a temporal worker is one way to get around this issue.\n\nThose calls like `workflow.execute_activity(...` are durable calls that only make sense when run in a worker-based environment. They make no sense outside of a durable context. It seems the request is to run Temporal without a server. It would not be reasonable to effectively embed all server logic like retries and such into the SDK, nor do we expect the primitives to be \"durable optional\".\n\n> Also when run this way I don't expect to retain the standard temporal \"durable execution\" guarantees.\n\nThe APIs are only designed for use in a durable environment. If you must have a durable and non-durable way to run the same code, you may consider your own abstraction that checks `workflow.in_workflow()` to fall back to whatever non-durable form you prefer (e.g. your durable-optional form of execute activity could fall back to just invoking with manual retry logic). But Temporal workflow primitives require the server to be present and require durability.","createdAt":"2025-06-06T19:25:28Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/891#issuecomment-2950439035","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c6wO5Rj","author":{"login":"Kilo59"},"authorAssociation":"NONE","body":"@cretz \n\nYeah (as I said) I don't care about the durable execution when calling the workflow this way.\n\nI assumed I was going to have to create my own abstraction, but I was hoping to avoid that.\nFor example is there a way to register a standard async event loop as \"Workflow EventLoop\" so that it doesn't throw this `temporalio.workflow._NotInWorkflowEventLoopError: Not in workflow event loop` error?\n\nBut assuming no, back to creating my own abstraction...\nIs there some kind of Workflow activity method registry that I can pull from? That way I could programatically know what activity methods the workflow would call?\nI would think something like this might also be useful when testing workflow business logic.","createdAt":"2025-06-09T19:03:46Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/891#issuecomment-2956694627","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c6wP_eq","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"> For example is there a way to register a standard async event loop as \"Workflow EventLoop\" so that it doesn't throw this temporalio.workflow._NotInWorkflowEventLoopError: Not in workflow event loop error?\n\nI am afraid not. The workflow event loop is a specially-crafted event loop to be deterministic and has certain things the rest of the workflow calls expect to be present. You can check `workflow.in_workflow()` and only call `workflow.` module calls if that is true.\n\n> Is there some kind of Workflow activity method registry that I can pull from? That way I could programatically know what activity methods the workflow would call?\n\nTo clarify, are you asking which activities are available to a workflow? Technically you can call any activity. While there are overloads for type-safe activity invocation, technically you can pass any string as the activity name. And you can invoke activities that could be on any other task queue on any other worker (even in a different programming language). So there is no centralized place to determine all activities a workflow could call. You can keep track of the activities you pass to your worker if you want to know which activities are available on that task queue (assuming you're not using dynamic activities).","createdAt":"2025-06-09T20:41:18Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/891#issuecomment-2956982186","viewerDidAuthor":false}],"createdAt":"2025-06-06T17:54:34Z","labels":[{"id":"LA_kwDOGusT1c7gQgHN","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":891,"reactionGroups":[],"state":"OPEN","title":"[Feature Request] Support executing Workflow directly","updatedAt":"2025-06-09T20:47:20Z","url":"https://github.com/temporalio/sdk-python/issues/891"}
