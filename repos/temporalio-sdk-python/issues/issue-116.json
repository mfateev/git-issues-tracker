{"assignees":[],"author":{"id":"MDQ6VXNlcjE4NjQ5MjY=","is_bot":false,"login":"adrianbeloqui","name":"Adrian Beloqui"},"body":"### What are you really trying to do?\r\n\r\nI am writing some example workflows and activities to test the capabilities of this library. As I was doing so, while trying to execute a child flow with the `search_attributes` parameter set and after trying many times and getting an exception every time I decided to try the exact example on https://github.com/temporalio/samples-python/blob/main/hello/hello_search_attributes.py and that worked. So, trying a bit more I realized that it seems like the format of the key of the search attribute must be title cased or it won't work.\r\n\r\n### Describe the bug\r\n\r\nSetting `search_attributes` with keys that are not title case fails with the below trace stack.\r\n\r\n```bash\r\n2022-08-29 21:33:02,745 - ERROR - Failed completing activation on workflow with run ID 79534a74-5e75-4f51-9ff4-a77bdfac8196\r\nTraceback (most recent call last):\r\n  File \"/home/vscode/.cache/pypoetry/virtualenvs/temporal-python--nLrvWXT-py3.10/lib/python3.10/site-packages/temporalio/worker/workflow.py\", line 215, in _handle_activation\r\n    await self._bridge_worker().complete_workflow_activation(completion)\r\n  File \"/home/vscode/.cache/pypoetry/virtualenvs/temporal-python--nLrvWXT-py3.10/lib/python3.10/site-packages/temporalio/bridge/worker.py\", line 76, in complete_workflow_activation\r\n    await self._ref.complete_workflow_activation(comp.SerializeToString())\r\nRuntimeError: Completion failure: Unhandled grpc error when completing workflow task: Status { code: InvalidArgument, message: \"BadSearchAttributes: search attribute customKeywordField is not defined\", metadata: MetadataMap { headers: {\"content-type\": \"application/grpc\"} }, source: None }\r\n```\r\n\r\n### Minimal Reproduction\r\n\r\n```python\r\nawait workflow.execute_child_workflow(\r\n            \"ChildWorkflow\",\r\n            {\"arg1\": 1, \"arg2\": 2},\r\n            id=\"child-workflow-1\",\r\n            task_timeout=timedelta(seconds=120),\r\n            retry_policy=RetryPolicy(\r\n                backoff_coefficient=2.0,\r\n                maximum_interval=timedelta(seconds=120),\r\n                maximum_attempts=5,\r\n                non_retryable_error_types=[\"MyCustomNonRetriableException\"],\r\n            ),\r\n            search_attributes={\"customKeywordField\": [\"old-value\"], \"another_format\":[\"\"]},\r\n)\r\n```\r\n\r\n### Environment/Versions\r\n\r\n<!-- Please complete the following information where relevant. -->\r\n\r\n- OS and processor: Mac running Colima\r\n- Temporal Version: `temporalio = \"^0.1b1\"`\r\n- Are you using Docker or Kubernetes or building Temporal from source?  Using Temporal's docker-compose provided environment. Executing workflow from a VSCode Dev Container using Python 3.10.6\r\n\r\n### Additional context\r\n\r\nNothing to add at this point\r\n","closedAt":"2022-08-30T15:00:17Z","comments":[{"id":"IC_kwDOGusT1c5JXg7K","author":{"login":"adrianbeloqui"},"authorAssociation":"NONE","body":"This might not be a bug. This might be my own misinterpretation of the search attributes and how they work.","createdAt":"2022-08-29T21:52:12Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/116#issuecomment-1230900938","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c5JXqSQ","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"> So, trying a bit more I realized that it seems like the format of the key of the search attribute must be title cased or it won't work.\r\n\r\nI think this depends on what the registered search attribute is. We do have default search attributes pre-registered in our docker-compose server like `CustomKeywordField` which appears pascal-cased, but that doesn't mean you can't register your own snake-cased name I believe. You can only set search attributes which have been registered/created on the server. See https://docs.temporal.io/tctl/admin/cluster/add-search-attributes for how to do this with the `tctl` CLI tool. If you run into any trouble with this, feel free to contact us on Slack or the forum.","createdAt":"2022-08-29T22:30:56Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/116#issuecomment-1230939280","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c5Ja5_t","author":{"login":"adrianbeloqui"},"authorAssociation":"NONE","body":"Hi @cretz, thank you for point me into the right direction, I was able to figure out. I can safely say that this feature to the extent I have tested it works well so I am going to close this issue.","createdAt":"2022-08-30T15:00:17Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-python/issues/116#issuecomment-1231790061","viewerDidAuthor":false}],"createdAt":"2022-08-29T21:42:10Z","labels":[{"id":"LA_kwDOGusT1c7gQgHK","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":116,"reactionGroups":[],"state":"CLOSED","title":"[Bug] Search attributes require specific non-documented format","updatedAt":"2022-08-30T15:00:18Z","url":"https://github.com/temporalio/sdk-python/issues/116"}
