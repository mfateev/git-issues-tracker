{"assignees":[],"author":{"id":"MDQ6VXNlcjUwODU3Nzk=","is_bot":false,"login":"dgjustice","name":"Daniel"},"body":"### What are you really trying to do?\r\n\r\nUsing a PEM file beginning with `-----BEGIN EC PRIVATE KEY-----`:\r\n\r\n#### Traceback\r\n\r\n```shell\r\nRuntimeError: Failed client connect: Server connection error: tonic::transport::Error(Transport, PrivateKeyParseError)\r\n```\r\n\r\n#### Temporary remedy\r\n\r\nConvert your pkey to pkcs8:\r\n\r\n```bash\r\nopenssl pkcs8 -topk8 -nocrypt -in key.pem -out key-pkcs8.pem\r\n```\r\n\r\n### Describe the bug\r\n\r\n`python-sdk` is pointing to an older commit in `sdk-core` which depends on an [older version](https://github.com/temporalio/sdk-core/blob/492d687be48ce6ee81ef7d55c825d366c1e3c4c5/client/Cargo.toml#L28) of `tonic`.\r\nThe key issue has been fixed in [this `tonic` PR](https://github.com/hyperium/tonic/pull/1145).\r\n\r\n### Minimal Reproduction\r\n\r\n```python\r\ndef setup_tls_config() -> TLSConfig:\r\n    \"\"\"Helper func to build TLSConfig struct.\"\"\"\r\n    with open(os.getenv(\"TEMPORAL_CLI_TLS_CERT\"), \"rb\") as f:\r\n        client_cert = f.read()\r\n    with open(os.getenv(\"TEMPORAL_CLI_TLS_KEY\"), \"rb\") as f:\r\n        client_private_key = f.read()\r\n    with open(os.getenv(\"TEMPORAL_CLI_TLS_CA\"), \"rb\") as f:\r\n        server_root_ca_cert = f.read()\r\n    return TLSConfig(\r\n        client_cert=client_cert,\r\n        client_private_key=client_private_key,\r\n        domain=os.getenv(\"TEMPORAL_CLI_TLS_SERVER_NAME\"),\r\n        server_root_ca_cert=server_root_ca_cert,\r\n    )\r\n```\r\n\r\n### Environment/Versions\r\n\r\n<!-- Please complete the following information where relevant. -->\r\n\r\n- OS and processor: Linux i7\r\n- Temporal Version: `temporalio==1.3.0`\r\n- Are you using Docker or Kubernetes or building Temporal from source? Kubernetes\r\n\r\n### Additional context\r\n\r\nIf updating to a more recent core SDK version is fairly straightforward, feel free to throw me some pointers, and I will put together a PR.\r\n","closedAt":"2023-08-31T14:09:52Z","comments":[{"id":"IC_kwDOGusT1c5kqRLw","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":":+1: We just overcame a hurdle to going past 0.8 Tonic (OTel libs), so we will be upgrading Tonic and all of these libraries before next release.","createdAt":"2023-08-22T19:29:59Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-python/issues/371#issuecomment-1688802032","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c5kqXeC","author":{"login":"dgjustice"},"authorAssociation":"NONE","body":"Awesome, good to know!","createdAt":"2023-08-22T19:46:51Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/371#issuecomment-1688827778","viewerDidAuthor":false}],"createdAt":"2023-08-21T23:24:36Z","labels":[{"id":"LA_kwDOGusT1c7gQgHK","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":371,"reactionGroups":[],"state":"CLOSED","title":"[Bug] mTLS doesn't support non-EC private keys","updatedAt":"2023-08-31T14:09:52Z","url":"https://github.com/temporalio/sdk-python/issues/371"}
