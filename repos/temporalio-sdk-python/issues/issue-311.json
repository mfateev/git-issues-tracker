{"assignees":[],"author":{"id":"MDQ6VXNlcjQzMDE4NTQw","is_bot":false,"login":"samuelmakarovskiy","name":""},"body":"### Is your feature request related to a problem? Please describe.\r\n\r\nHave noticed an interesting behavior that arose when all instances of a temporal server are brought down after a python worker has connected. The worker infinite retries polling to reconnect which is fine, but the real issue is that the console logs for the underlying rust core are not formatted like the python worker logic ones. See below:\r\n\r\n```\r\n^[[2m2023-04-13T14:17:45.292663Z^[[0m ^[[33m WARN^[[0m ^[[1mtemporal_client::retry^[[0m^[[2m:^[[0m gRPC call poll_workflow_task_queue retried 119 times ^[[3merror^[[0m^[[2m=^[[0mStatus { code: Unavailable, message: \"error trying to connect: dns error: failed to lookup address information: Name or service not known\", source: Some(tonic::transport::Error(Transport, hyper::Error(Connect, ConnectError(\"dns error\", Custom { kind: Uncategorized, error: \"failed to lookup address information: Name or service not known\" })))) }\r\n```\r\nFixing this would allow me to also guarantee any core issues can be detected by monitoring unified logs and not just stdout\r\n### Describe the solution you'd like\r\n\r\nCouple of things would work\r\n\r\n1. Could turn off pretty printing for the rust core logs so that at least I can make my application stdout logs match more reliably\r\n2. The sdk could support passing back core logs to python like it does for typescript (and maybe other sdks). I see it's not supported in the [code](https://github.com/temporalio/sdk-python/blob/dbf96fdbd5edb3dcb0da0590de6e3dd5b4bc270b/temporalio/runtime.py#L125-L126), but maybe worth clarifying why?\r\n\r\n### Additional context\r\n\r\n<!-- Add any other context or screenshots about the feature request here. -->\r\n","closedAt":"2023-11-06T17:39:39Z","comments":[{"id":"IC_kwDOGusT1c5Z2fjw","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"> Could turn off pretty printing for the rust core logs so that at least I can make my application stdout logs match more reliably\r\n\r\nThis can be disabled by setting `RUST_LOG_COLORS=never` env var I believe. Ref https://docs.rs/env_logger/latest/env_logger/#disabling-colors. (can probably also make it clear somehow on the tty that it does not support colors, e.g. `TERM=dumb`)\r\n\r\n> I see it's not supported in the [code](https://github.com/temporalio/sdk-python/blob/dbf96fdbd5edb3dcb0da0590de6e3dd5b4bc270b/temporalio/runtime.py#L125-L126), but maybe worth clarifying why?\r\n\r\nThe only real reason is you're the first to need it :-) This is something we can add I think. I will leave this issue open on the backlog and we will look into implementing it.","createdAt":"2023-04-13T18:47:24Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HEART","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-python/issues/311#issuecomment-1507457264","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c5Z2kFO","author":{"login":"samuelmakarovskiy"},"authorAssociation":"NONE","body":"> This can be disabled by setting RUST_LOG_COLORS=never env var I believe. Ref https://docs.rs/env_logger/latest/env_logger/#disabling-colors. (can probably also make it clear somehow on the tty that it does not support colors, e.g. TERM=dumb)\r\n\r\nDidn't seem to work, I think the [rust core](https://github.com/temporalio/sdk-core/blob/6146ed5709d6ed2cf24488e5df4930c7f0cb6ae1/core/src/telemetry/mod.rs#L188-L208) uses `tokio-rs/tracing`\r\n\r\nAnd from [this thread](https://github.com/foundry-rs/foundry/issues/1295#issuecomment-1098460733) appears the config requires the filter to have `set_ansi` on it, [defaults to true](https://docs.rs/tracing-subscriber/latest/tracing_subscriber/fmt/struct.Layer.html#method.set_ansi)\r\n","createdAt":"2023-04-13T19:03:11Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/311#issuecomment-1507475790","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c5Z2mit","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"I see! I opened https://github.com/temporalio/sdk-core/issues/529 to let that be disabled at runtime.","createdAt":"2023-04-13T19:13:05Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HEART","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-python/issues/311#issuecomment-1507485869","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c5k8k3-","author":{"login":"jmdacruz"},"authorAssociation":"CONTRIBUTOR","body":"Somewhat related to this topic, it would be nice to have more control on the structure of the Rust logging. One scenario is using structured (JSON) logging on the Python side, which currently gets mixed with the Rust log lines (as @samuelmakarovskiy shared on the description). Structured logging is desired in certain scenarios, like Kubernetes deployments where the infrastructure takes containers stdout/stderr and forwards that to some logging infrastructure.\r\n\r\nEdit: @cretz clarified on Slack that \"log forwarding\" in this context means forwarding to the Python side, which would effectively solve the problem","createdAt":"2023-08-25T16:10:54Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-python/issues/311#issuecomment-1693601278","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c5qitvl","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"After further discussion, we are going to wait on https://github.com/temporalio/sdk-core/issues/618 and have buffered, pushed logs be sent to Python logging.","createdAt":"2023-10-31T15:44:51Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/311#issuecomment-1787485157","viewerDidAuthor":false}],"createdAt":"2023-04-13T16:53:14Z","labels":[{"id":"LA_kwDOGusT1c7gQgHN","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":311,"reactionGroups":[],"state":"CLOSED","title":"[Feature Request] Log Forwarding Support for python-SDK","updatedAt":"2023-11-06T17:39:39Z","url":"https://github.com/temporalio/sdk-python/issues/311"}
