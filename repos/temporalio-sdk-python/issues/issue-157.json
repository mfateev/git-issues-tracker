{"assignees":[],"author":{"id":"MDQ6VXNlcjIwNjM5Ng==","is_bot":false,"login":"cretz","name":"Chad Retz"},"body":"### Describe the solution you'd like\r\n\r\nConfirm the Otel gRPC URL format (and if possible whether it works over TLS) via integration test","closedAt":"2022-10-27T18:32:47Z","comments":[{"id":"IC_kwDOGusT1c5MO2mn","author":{"login":"nrhodes"},"authorAssociation":"NONE","body":"Copied from the [slack thread](https://temporalio.slack.com/archives/CTT84RS0P/p1665750534907139?thread_ts=1665697686.033889&cid=CTT84RS0P):\r\nI modified the `hello_activity.py` sample in the `sample-python` repo to add a call to `init_telemetry`, specifying a localhost endpoint as follows:\r\n```\r\nasync def main():\r\n    # Uncomment the line below to see logging\r\n    #logging.basicConfig(level=logging.DEBUG)\r\n    open_telemetry_config = OtelCollectorConfig(\r\n            url=\"localhost:9999\", headers={\r\n            }\r\n        )\r\n    init_telemetry(\r\n        TelemetryConfig(\r\n        otel_metrics=open_telemetry_config,\r\n        otel_tracing=open_telemetry_config,\r\n        )\r\n    )\r\n    # Start client\r\n    client = await Client.connect(\"localhost:7233\")\r\n    # Run a worker for the workflow\r\n    async with Worker(\r\n        client,\r\n        task_queue=\"hello-activity-task-queue\",\r\n        workflows=[GreetingWorkflow],\r\n        activities=[compose_greeting],\r\n    ):\r\n        # While the worker is running, use the client to run the workflow and\r\n        # print out its result. Note, in many production setups, the client\r\n        # would be in a completely separate process from the worker.\r\n        result = await client.execute_workflow(\r\n            GreetingWorkflow.run,\r\n            \"World\",\r\n            id=\"hello-activity-workflow-id\",\r\n            task_queue=\"hello-activity-task-queue\",\r\n        )\r\n        print(f\"Result: {result}\")\r\n\r\n```\r\n\r\nI then checked with Wireshark and saw that there were no connections being made to port 9999 on the loopback interface. There were connections to the temporal server at 7233, as Iâ€™d expect.","createdAt":"2022-10-14T12:46:00Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/157#issuecomment-1278962087","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c5NH5FS","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"There's not a good way to put an integration test for the collector side in the primary SDK repo, so I added it to the PR at https://github.com/temporalio/samples-python/pull/18.\r\n\r\nThe issue here I think is that you have to use a real URL like `http://localhost:9999`.\r\n\r\n(closing as not completing because I won't do an integration test, but can reopen if there's a bug or can discuss on the sample)","createdAt":"2022-10-27T18:32:47Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/157#issuecomment-1293914450","viewerDidAuthor":false}],"createdAt":"2022-10-13T22:00:46Z","labels":[{"id":"LA_kwDOGusT1c7gQgHN","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":157,"reactionGroups":[],"state":"CLOSED","title":"[Feature Request] Integration test for Otel gRPC metrics collector","updatedAt":"2022-10-27T18:33:18Z","url":"https://github.com/temporalio/sdk-python/issues/157"}
