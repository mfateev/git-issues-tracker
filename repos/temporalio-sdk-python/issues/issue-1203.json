{"assignees":[],"author":{"id":"MDQ6VXNlcjg1NjUzMTg3","is_bot":false,"login":"brent-cybrid","name":"Brent Carrara"},"body":"### What are you really trying to do?\n\nWe're trying to access the `retry_policy` from the `activity.info` from within an activity.\n\n### Describe the bug\n\n`retry_policy` isn't set even though it's set on the `workflow.execute_activity` call.\n\n### Minimal Reproduction\n\n```python\n#!/usr/bin/env python3\n\"\"\"\nMinimal reproducible example demonstrating Temporal SDK bug:\nactivity.info().retry_policy is None even when workflow specifies retry_policy\n\nThis script is standalone and only requires: pip install temporalio\n\"\"\"\nimport asyncio\nfrom datetime import timedelta\nfrom temporalio import activity, workflow\nfrom temporalio.common import RetryPolicy\nfrom temporalio.testing import WorkflowEnvironment\nfrom temporalio.worker import Worker\n\n\n# Simple activity that captures what retry_policy information it receives\n@activity.defn\nasync def check_retry_policy_activity() -> dict:\n    \"\"\"Activity that returns information about the retry_policy it receives.\"\"\"\n    info = activity.info()\n\n    return {\n        'has_retry_policy_attr': hasattr(info, 'retry_policy'),\n        'rety_policy_is_set': info.retry_policy is not None if hasattr(info, 'retry_policy') else False,\n        'non_retryable_error_types': (\n            info.retry_policy.non_retryable_error_types\n            if (\n                hasattr(info, 'retry_policy')\n                and hasattr(info.retry_policy, 'non_retryable_error_types')\n            )\n            else None\n        )\n    }\n\n\n# Simple workflow that specifies retry_policy with non_retryable_error_types\n@workflow.defn\nclass RetryPolicyTestWorkflow:\n    \"\"\"Workflow that calls activity with specific retry_policy.\"\"\"\n\n    @workflow.run\n    async def run(self) -> dict:\n        # Execute activity with retry_policy that includes non_retryable_error_types\n        return await workflow.execute_activity(\n            check_retry_policy_activity,\n            start_to_close_timeout=timedelta(seconds=10),\n            retry_policy=RetryPolicy(\n                non_retryable_error_types=[\"MyNonRetryableError\", \"AnotherNonRetryableError\"]\n            ),\n        )\n\n\nasync def main():\n    \"\"\"Run the test workflow and verify retry_policy is available in activity.\"\"\"\n    \n    async with await WorkflowEnvironment.start_time_skipping() as env:\n        # Create worker with our workflow and activity\n        async with Worker(\n            env.client,\n            task_queue=\"test-queue\",\n            workflows=[RetryPolicyTestWorkflow],\n            activities=[check_retry_policy_activity],\n        ):\n            # Execute the workflow\n            result = await env.client.execute_workflow(\n                RetryPolicyTestWorkflow.run,\n                id=\"test-workflow-retry-policy\",\n                task_queue=\"test-queue\",\n            )\n\n            # Verify the bug\n            if result['rety_policy_is_set']:\n                return True\n            else:\n                print(\"BUG PRESENT: retry_policy is not set, even though workflow specifies it\")\n                return False\n\n\nif __name__ == \"__main__\":\n    success = asyncio.run(main())\n    exit(0 if success else 1)\n```\n\n### Environment/Versions\n\nTemporal Cloud\n\n### Additional context\n\n\n","closedAt":null,"comments":[{"id":"IC_kwDOGusT1c7PjFKm","author":{"login":"tconley1428"},"authorAssociation":"MEMBER","body":"Can you validate on a dev or real server as well? There are some things the time skipping server does differently from the standard servers. ","createdAt":"2025-11-03T19:07:52Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/1203#issuecomment-3482079910","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c7PyaS_","author":{"login":"michael-cybrid"},"authorAssociation":"NONE","body":"@brent-cybrid is a colleague of mine. We see this in Temporal Cloud as well.","createdAt":"2025-11-04T13:49:24Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-python/issues/1203#issuecomment-3486098623","viewerDidAuthor":false},{"id":"IC_kwDOGusT1c7fRRx4","author":{"login":"gow"},"authorAssociation":"MEMBER","body":"@michael-cybrid @brent-cybrid temporal cloud has received several updates since this bug report. Could you please confirm is you're still seeing this issue?","createdAt":"2026-01-13T18:47:23Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-python/issues/1203#issuecomment-3745848440","viewerDidAuthor":false}],"createdAt":"2025-10-31T21:11:02Z","labels":[{"id":"LA_kwDOGusT1c7gQgHK","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":1203,"reactionGroups":[],"state":"OPEN","title":"[Bug] `retry_policy` not set in `ativity.info()` despite being defined in the `workflow.execute_activity()` call","updatedAt":"2026-01-13T18:47:23Z","url":"https://github.com/temporalio/sdk-python/issues/1203"}
