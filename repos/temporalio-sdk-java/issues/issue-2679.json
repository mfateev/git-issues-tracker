{"assignees":[],"author":{"id":"MDQ6VXNlcjM1MTE2NDI4","is_bot":false,"login":"denvernyaw","name":"Nikita"},"body":"## Expected Behavior\nAccording to [javadoc](https://javadoc.io/doc/io.temporal/temporal-sdk/latest/io/temporal/client/WorkflowExecutionAlreadyStarted.html):\n\n> _There is a closed workflow with the same ID and the [WorkflowOptions.getWorkflowIdReusePolicy()](https://javadoc.io/static/io.temporal/temporal-sdk/1.31.0/io/temporal/client/WorkflowOptions.html#getWorkflowIdReusePolicy()) is WorkflowIdReusePolicy.WORKFLOW_ID_REUSE_POLICY_REJECT_DUPLICATE._\n\nSo we expect that second and further attempts to run workflow with the same workflowId will throw WorkflowExecutionAlreadyStarted exception.\n\n## Actual Behavior\nWhen running code from [this snippet](https://docs.temporal.io/develop/java/set-up-your-local-java#6-execute-the-workflow), but adding `.setWorkflowIdReusePolicy(WorkflowIdReusePolicy.WORKFLOW_ID_REUSE_POLICY_REJECT_DUPLICATE)` to WorkflowOptions â€“ second run of workflow with the same workflowId does not throw exception.\n\n## Steps to Reproduce the Problem\nRun this code twice and observe that there is no exception, and the single workflow run displayed in Temporal UI:\n `\n        WorkflowServiceStubs service = WorkflowServiceStubs.newLocalServiceStubs();\n        WorkflowClient client = WorkflowClient.newInstance(service);\n\n        SayHelloWorkflow workflow = client.newWorkflowStub(\n                SayHelloWorkflow.class,\n                WorkflowOptions.newBuilder()\n                        .setTaskQueue(\"my-task-queue\")\n                        .setWorkflowId(\"say-hello-workflow-id\")\n                        .setWorkflowIdReusePolicy(WorkflowIdReusePolicy.WORKFLOW_ID_REUSE_POLICY_REJECT_DUPLICATE)\n                        .build()\n        );\n\n        String result = workflow.sayHello(\"Temporal\");\n        System.out.println(\"Workflow result: \" + result);\n`\n\nProbably, javadoc out of sync with code.\nWe also debug the library and found that exception actually fired, but caught here: io.temporal.client.WorkflowInvocationHandler#startWorkflow#189\n\n## Specifications\n\n  - Version: 1.31.0\n  - Platform: temporal version 1.4.1 (Server 1.28.0, UI 2.39.0)\n\n<img width=\"904\" height=\"408\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/ab6f8340-e4f7-4c95-9da1-7724561b4b0b\" />\n\n<img width=\"1980\" height=\"585\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/607259de-691b-49f4-8235-1b0a0ceb727a\" />\n\n<img width=\"916\" height=\"411\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/29913505-ddeb-4315-a2cb-e16ccbf12baa\" />\n","closedAt":"2025-10-17T15:49:22Z","comments":[{"id":"IC_kwDODN12PM7LnfOW","author":{"login":"maciejdudko"},"authorAssociation":"MEMBER","body":"Hi @denvernyaw, this behavior is by design. When the workflow is started by calling the stub's workflow method, or by calling `WorkflowClient::execute`, it waits for the result of the workflow. If `WorkflowIdReusePolicy` is set to something other than `ALLOW_DUPLICATE`, then instead of throwing `WorkflowExecutionAlreadyStarted` on conflict, it will attach to the existing workflow execution and wait for its result (if the workflow already completed, it will return its result immediately). This behavior is called out in [WorkflowClient documentation](https://javadoc.io/doc/io.temporal/temporal-sdk/latest/io/temporal/client/WorkflowClient.html).\n\nOn the other hand, if the workflow is started by calling `WorkflowClient::start`, it will not wait for the workflow result, and will throw `WorkflowExecutionAlreadyStarted` on conflict.","createdAt":"2025-10-17T15:49:22Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/2679#issuecomment-3416126358","viewerDidAuthor":false}],"createdAt":"2025-10-09T16:15:40Z","labels":[],"milestone":null,"number":2679,"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"state":"CLOSED","title":"WorkflowIdReusePolicy.WORKFLOW_ID_REUSE_POLICY_REJECT_DUPLICATE does not throw WorkflowExecutionAlreadyStarted","updatedAt":"2025-10-17T15:49:33Z","url":"https://github.com/temporalio/sdk-java/issues/2679"}
