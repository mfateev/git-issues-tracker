{"assignees":[],"author":{"id":"MDQ6VXNlcjE5OTI3","is_bot":false,"login":"osi","name":"peter royal"},"body":"## Expected Behavior\r\n\r\nWhen using async completion of an activity returning a primitive value and completing with `null`, a `NullPointerException` should be generated in either the Workflow or when completing the Activity. (Similar to how auto-unboxing behaves)\r\n\r\n## Actual Behavior\r\n\r\nThe workflow has a return value of zero.\r\n\r\n## Steps to Reproduce the Problem\r\n\r\n  1. Create an activity method that returns a primitive, eg `long`. \r\n  1. Use `useLocalManualCompletion` to get a completion client\r\n  1. Complete the activity with null, eg `complete(null)`\r\n  2. Inspect the returned value of the activity in the workflow. It will be zero. \r\n\r\n## Specifications\r\n\r\n  - Version: 0.11.0\r\n  - Platform: using `TestWorkflowEnvironment`\r\n","closedAt":"2025-06-02T14:29:20Z","comments":[{"id":"IC_kwDODN12PM44zxsX","author":{"login":"vkoby"},"authorAssociation":"CONTRIBUTOR","body":"Hi @osi \r\nWould you mind sending a code sample? I couldn't reproduce your issue (see my attempt [here](https://github.com/temporalio/sdk-java/pull/846))\r\nAlso, I noticed that your version of SDK is super outdated, I would highly recommend to update.","createdAt":"2021-10-27T16:28:30Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/701#issuecomment-953096983","viewerDidAuthor":false},{"id":"IC_kwDODN12PM44zz4V","author":{"login":"Spikhalskiy"},"authorAssociation":"CONTRIBUTOR","body":"@vkoby So, the test in https://github.com/temporalio/sdk-java/pull/846 passes. According to the build status.\r\nIt shouldn't. This is exactly the problem that is reported in this issue.","createdAt":"2021-10-27T16:37:32Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/701#issuecomment-953105941","viewerDidAuthor":false},{"id":"IC_kwDODN12PM44z-cw","author":{"login":"vkoby"},"authorAssociation":"CONTRIBUTOR","body":"@Spikhalskiy @osi , Sorry, I wasn't clear:\r\nThe reported issue is that null is converted to zero, and the repro step 4 says it's converted to zero. That doesn't reproduce - we are seeing null propagated instead, which if converted to `int` will result in NPE.\r\nThere is a separate question whether we want null propagated in these cases, but that's not what that issue is about.","createdAt":"2021-10-27T17:26:52Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/701#issuecomment-953149232","viewerDidAuthor":false},{"id":"IC_kwDODN12PM440BkI","author":{"login":"osi"},"authorAssociation":"NONE","body":"Yes, I was on an older SDK. The missing detail in the reproduction steps is to invoke the activity synchronously from the workflow, so that there's unboxing required from the `null` completion value to the local primitive variable.\r\n\r\n(yes, this is a programming error in the activity to return null)","createdAt":"2021-10-27T17:41:42Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-java/issues/701#issuecomment-953161992","viewerDidAuthor":false}],"createdAt":"2021-09-08T16:49:03Z","labels":[{"id":"MDU6TGFiZWwxNjIyNzE5ODQx","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"LA_kwDODN12PM8AAAABTCzm8g","name":"good first issue","description":"","color":"37F0F1"}],"milestone":null,"number":701,"reactionGroups":[],"state":"CLOSED","title":"Async activity completion with primitive return value converts null to zero","updatedAt":"2025-06-02T14:29:25Z","url":"https://github.com/temporalio/sdk-java/issues/701"}
