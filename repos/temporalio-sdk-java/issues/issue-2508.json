{"assignees":[],"author":{"id":"U_kgDOBYremg","is_bot":false,"login":"fatekingsama","name":"Hui Qiao"},"body":"Some classes have been removed in the new version of grpc, and your grpc version is too old, causing startup errors\n\nCaused by: java.lang.NoClassDefFoundError: io/grpc/internal/AbstractManagedChannelImplBuilder\n\tat java.base/java.lang.ClassLoader.defineClass1(Native Method)\n\tat java.base/java.lang.ClassLoader.defineClass(ClassLoader.java:1027)\n\tat java.base/java.security.SecureClassLoader.defineClass(SecureClassLoader.java:150)\n\tat java.base/jdk.internal.loader.BuiltinClassLoader.defineClass(BuiltinClassLoader.java:862)\n\tat java.base/jdk.internal.loader.BuiltinClassLoader.findClassOnClassPathOrNull(BuiltinClassLoader.java:760)\n\tat java.base/jdk.internal.loader.BuiltinClassLoader.loadClassOrNull(BuiltinClassLoader.java:681)\n\tat java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:639)\n\tat java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:188)\n\tat java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:526)\n\tat io.temporal.serviceclient.ChannelManager.prepareChannel(ChannelManager.java:206)\n\tat io.temporal.serviceclient.ChannelManager.<init>(ChannelManager.java:118)\n\tat io.temporal.serviceclient.ChannelManager.<init>(ChannelManager.java:98)\n\tat io.temporal.serviceclient.WorkflowServiceStubsImpl.<init>(WorkflowServiceStubsImpl.java:84)\n\tat io.temporal.serviceclient.WorkflowServiceStubs.newServiceStubs(WorkflowServiceStubs.java:66)","closedAt":"2025-05-07T15:21:02Z","comments":[{"id":"IC_kwDODN12PM6qFL5f","author":{"login":"fatekingsama"},"authorAssociation":"NONE","body":"I’ve submitted a pull request to resolve the problem, but there are a few uncertainties in this update that I’d appreciate your input on.","createdAt":"2025-05-06T07:04:47Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/2508#issuecomment-2853486175","viewerDidAuthor":false},{"id":"IC_kwDODN12PM6qLFs5","author":{"login":"Quinn-With-Two-Ns"},"authorAssociation":"MEMBER","body":"The Java SDK intentionally builds with an older version of gRPC Java to maintain compatibility with the widest range of versions for our users. You are free and encouraged to use a higher version in your end application. The specific error on this issue doesn't really make sense to me since this is a very [old issue](https://github.com/grpc/grpc-java/issues/7552) that shouldn't be an issue for any library that compiled with any version <`1.36.0`","createdAt":"2025-05-06T15:30:35Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/2508#issuecomment-2855033657","viewerDidAuthor":false},{"id":"IC_kwDODN12PM6qLLar","author":{"login":"Quinn-With-Two-Ns"},"authorAssociation":"MEMBER","body":"I also manually confirmed the Java SDK CI all passes using `grpc-java` with `v1.72.0` as a test runtime depdency","createdAt":"2025-05-06T15:38:22Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/2508#issuecomment-2855057067","viewerDidAuthor":false},{"id":"IC_kwDODN12PM6qRqxQ","author":{"login":"fatekingsama"},"authorAssociation":"NONE","body":"@Quinn-With-Two-Ns Perhaps your test cases are not comprehensive enough? I have to forcefully upgrade your gRPC version to a newer one in order to avoid runtime errors. This issue doesn’t only affect your project—Quarkus encountered the same error as early as 2023, and they eventually resolved it by updating the gRPC version. [https://github.com/quarkusio/quarkus/issues/37806](url)","createdAt":"2025-05-07T01:26:23Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/2508#issuecomment-2856758352","viewerDidAuthor":false},{"id":"IC_kwDODN12PM6qRs3m","author":{"login":"fatekingsama"},"authorAssociation":"NONE","body":"You included some gRPC dependencies that I didn’t explicitly use, so their versions are brought in transitively through your library. This leads to certain errors, and I don’t think it’s fair for users of your library to bear the cost of diagnosing such issues. I firmly believe that open-source communities should strive to keep their third-party dependencies up to date. If some users require older versions of those dependencies, they can simply stick to using an older version of your library.","createdAt":"2025-05-07T01:33:37Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/2508#issuecomment-2856766950","viewerDidAuthor":false},{"id":"IC_kwDODN12PM6qaURx","author":{"login":"Quinn-With-Two-Ns"},"authorAssociation":"MEMBER","body":">Perhaps your test cases are not comprehensive enough?\n\nMy tests are the entire SDK test suite.\n\n\n>I have to forcefully upgrade your gRPC version to a newer one in order to avoid runtime errors.\n\nYes I would encourage you to use a later version of gRPC if you are able, I am glad you were able to resolve this issue.\n\nAs I said we use an older version of gRPC Java to maintain compatibility with the widest range of versions for our users. This is our teams current policy. I will look at adding the latest version of `grpc-java`  to our CI so we know the SDK will work with the latest version of `grpc-java` \n","createdAt":"2025-05-07T15:21:03Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/2508#issuecomment-2859025521","viewerDidAuthor":false},{"id":"IC_kwDODN12PM6qkd0p","author":{"login":"fatekingsama"},"authorAssociation":"NONE","body":"@Quinn-With-Two-Ns \n```groovy\n// Manually include our versions to resolve incompatibility issues caused by the old gRPC version used in the Temporal SDK\napi libs.grpc.inprocess\napi libs.grpc.netty.shaded\n```\n\nThese two JARs are not used directly in our codebase — they are transitive dependencies brought in by your SDK. As a result, their versions are inconsistent with the other gRPC dependencies we explicitly use. Unfortunately, gRPC introduced significant breaking changes between these versions, which led to runtime errors in our application.\n\nAs I mentioned in the link I shared earlier, Quarkus encountered this exact issue back in 2023 and resolved it by updating their gRPC version. I hope your team can also consider this problem carefully. Over time, more users like myself may be forced to spend time debugging issues like this and adding manual fixes — code that ideally shouldn’t be our responsibility to write.\n\nOf course, I understand it’s impossible to make every version of your SDK compatible with every user setup. That’s why I suggest that future releases deprecate support for older gRPC versions. After all, users who need older versions can continue using an older version of your SDK, right?\n\nOf course, this is just a suggestion. I respect your team's decision","createdAt":"2025-05-08T04:06:48Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/2508#issuecomment-2861686057","viewerDidAuthor":false}],"createdAt":"2025-05-06T01:17:10Z","labels":[],"milestone":null,"number":2508,"reactionGroups":[],"state":"CLOSED","title":"The version of grpc needs to be updated","updatedAt":"2025-05-08T04:11:48Z","url":"https://github.com/temporalio/sdk-java/issues/2508"}
