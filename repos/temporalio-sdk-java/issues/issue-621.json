{"assignees":[{"id":"MDQ6VXNlcjUzMjEwOA==","login":"Spikhalskiy","name":"Dmitry Spikhalsky","databaseId":0}],"author":{"id":"MDQ6VXNlcjExOTQyMg==","is_bot":false,"login":"tsurdilo","name":"Tihomir Surdilovic"},"body":"Trying out to use Java SDK OpenTracing support with Jaeger client:\r\n\r\n1. Add Jaeger client as depend:\r\n\r\n           implementation group: 'io.jaegertracing', name: 'jaeger-client', version: '1.6.0'\r\n\r\n2. Create a Tracer:\r\n\r\n        JaegerTracer tracer =\r\n        new Configuration(\"temporal-app\")\r\n          .withReporter(\r\n              new Configuration.ReporterConfiguration()\r\n                  .withSender(\r\n                      new Configuration.SenderConfiguration()\r\n                          .withEndpoint(\"http://localhost:14268/api/traces\")))\r\n          .withCodec(\r\n              new Configuration.CodecConfiguration()\r\n                  .withCodec(Format.Builtin.TEXT_MAP_INJECT, new TextMapCodec(false)))\r\n          .getTracer();\r\n\r\n\r\n(the .withCodec seems to do absolutely nothing, so can be removed in test even)\r\n\r\n3. Set the tracer in OpenTracingOptions\r\n\r\nTry tracing, you should get:\r\n    \r\n  Caused by: io.jaegertracing.internal.exceptions.UnsupportedFormatException: Builtin.TEXT_MAP_EXTRACT\r\n\r\n## Specifications\r\n\r\n  - Version: 1.1.0\r\n  - Platform:\r\n\r\n\r\nNote - to add Jaeger to your local docker compose yaml you can just add:\r\n\r\n\r\n     jaeger:\r\n     image: jaegertracing/all-in-one:latest\r\n     ports:\r\n       - \"5775:5775/udp\"\r\n       - \"6831:6831/udp\"\r\n       - \"6832:6832/udp\"\r\n       - \"5778:5778\"\r\n       - \"16686:16686\"\r\n       - \"14268:14268\"\r\n       - \"9411:9411\"\r\n\r\nin the services section","closedAt":"2021-08-10T20:18:56Z","comments":[{"id":"IC_kwDODN12PM41RaFK","author":{"login":"tsurdilo"},"authorAssociation":"MEMBER","body":"For a simple/local test just import the jaeger client lib (depends) and create a tracer with:\r\n\r\n     Reporter reporter = new InMemoryReporter();\r\n      Sampler sampler = new ConstSampler(true);\r\n      Tracer tracer = new JaegerTracer.Builder(\"temporal-test\")\r\n              .withReporter(reporter)\r\n              .withSampler(sampler)\r\n              .build();\r\n      GlobalTracer.registerIfAbsent(tracer);\r\n\r\nOr add it to options instead of setting it to GlobalTracer.\r\nThe same error comes up this way as well.","createdAt":"2021-08-05T19:55:25Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/621#issuecomment-893755722","viewerDidAuthor":false},{"id":"IC_kwDODN12PM41YQWX","author":{"login":"Spikhalskiy"},"authorAssociation":"CONTRIBUTOR","body":"It looks like Jaeger OpenTracing java client doesn't support TEXT_MAP_INJECT and TEXT_MAP_EXTRACT strategies. I filed an issue regarding that into Jaeger java client repo: https://github.com/jaegertracing/jaeger-client-java/issues/789\r\nTaking into account that Jaeger is a major OpenTracing/OpenTelementry solution, I implemented a workaround in temporal for this issue until it's addressed in Jaeger client: https://github.com/temporalio/sdk-java/pull/624 It includes an integration test for Jagger that checks that the setup works with the new encoding strategy: https://github.com/temporalio/sdk-java/pull/624/files#diff-223e2203835203c5115c3be51739372f23426ded63a3e0abf75a8d63d9ce8057R52","createdAt":"2021-08-09T21:09:01Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/621#issuecomment-895550871","viewerDidAuthor":false},{"id":"IC_kwDODN12PM41bFDV","author":{"login":"Spikhalskiy"},"authorAssociation":"CONTRIBUTOR","body":"Closed by #624","createdAt":"2021-08-10T20:18:56Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/621#issuecomment-896291029","viewerDidAuthor":false}],"createdAt":"2021-08-05T19:19:44Z","labels":[],"milestone":{"number":3,"title":"v1.3.0","description":"","dueOn":"2021-08-31T00:00:00Z"},"number":621,"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"state":"CLOSED","title":"Opentracing: \"UnsupportedFormatException: Builtin.TEXT_MAP_INJECT\" with Jaeger tracer","updatedAt":"2021-08-11T01:44:20Z","url":"https://github.com/temporalio/sdk-java/issues/621"}
