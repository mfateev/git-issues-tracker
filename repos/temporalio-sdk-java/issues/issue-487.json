{"assignees":[],"author":{"id":"MDQ6VXNlcjEwNjcyMjIy","is_bot":false,"login":"anandundavia","name":"Anand Undavia"},"body":"With Custom Search Attributes, I can set the values for the search attributes before starting the workflow using `WorkflowOptions`.\r\n\r\nConsider that I have added `LastEmailSentTimestamp` in my cluster.\r\n\r\nBefore beginning the workflow, I can set the search value with this piece of code.\r\n```java\r\n\r\nHashMap<String, Object> workflowSearchAttributes = new HashMap<>();\r\nworkflowSearchAttributes.put(\"LastEmailSentTimestamp\", -1);\r\n\r\nWorkflowOptions options = WorkflowOptions.newBuilder()\r\n.setSearchAttributes(workflowSearchAttributes) // Map of String -> Object\r\n.build()\r\n```\r\n\r\nIs there a way to update the search attribute once the workflow / activity are running ?\r\n\r\nFor example, Say I have an activity that sends an email. And a workflow to send monthly newsletter.\r\n```java\r\n@Override\r\npublic void sendMonthlyNewsLetter() {\r\n      while (true) {\r\n\t      newsLetterActivity.sendEmail();\r\n\t      long lastSentTimeStamp = Workflow.currentTimeMillis();\r\n\t      // --->  How to update the `lastSentTimeStamp` in the search attributes ?!\r\n\t      Workflow.sleep(Duration.ofDays(30));\r\n      }\r\n}\r\n```\r\n\r\nHow do I keep updating the search attributes while the workflow is still running ?!\r\n","closedAt":"2021-08-11T01:34:19Z","comments":[{"id":"IC_kwDODN12PM41bnPN","author":{"login":"Spikhalskiy"},"authorAssociation":"CONTRIBUTOR","body":"There is `Workflow.upsertSearchAttributes` to add/update search attributes from the workflow code. It's not possible from Activities runtime though, activities don't have an access to `Workflow` methods.","createdAt":"2021-08-11T01:34:19Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/487#issuecomment-896431053","viewerDidAuthor":false}],"createdAt":"2021-05-10T09:07:34Z","labels":[{"id":"MDU6TGFiZWwxNjIyNzE5ODQ4","name":"question","description":"Further information is requested","color":"BFD4F2"}],"milestone":null,"number":487,"reactionGroups":[],"state":"CLOSED","title":"How to set / update search attribute values during Workflow / Activity runtime ?","updatedAt":"2021-08-11T01:35:00Z","url":"https://github.com/temporalio/sdk-java/issues/487"}
