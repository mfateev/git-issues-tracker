{"assignees":[],"author":{"id":"MDQ6VXNlcjExOTQyMg==","is_bot":false,"login":"tsurdilo","name":"Tihomir Surdilovic"},"body":"Springboot autoconfig defines the primary WorkflowClient bean thats generated from config as:\r\n\r\n      @Bean(name = \"temporalWorkflowClient\")\r\n      public WorkflowClient client(ClientTemplate clientTemplate) {\r\n        return clientTemplate.getWorkflowClient();\r\n      }\r\n\r\nFor client app use case sometimes we need to create additional WorkflowClient beans (for example one for a different namespace thats part of the use case). Its not possible to do this via config so\r\nto do this currently once a custom WorkflowClient bean is created, for example:\r\n\r\n       @Bean(name = \"customWorkflowClient\")\r\n       public WorkflowClient secondClient() {\r\n         WorkflowServiceStubs service = WorkflowServiceStubs.newLocalServiceStubs();\r\n         return WorkflowClient.newInstance(\r\n        service, WorkflowClientOptions.newBuilder().setNamespace(\"xyz\").build());\r\n      }\r\n\r\nThere are two issues with this:\r\n1. you cannot autowire the default WorkflowServiceStubs here because of cyclic dependency on the default template. user has to create a new WorkflowServiceStubs which seems unnecessary. \r\n2. Once you define this you no longer can resolve autowiring default WorkflowClient generated from config unless you use its name Qualifier, for example you have to do:\r\n\r\n        @Autowired\r\n        @Qualifier(\"temporalWorkflowClient\") // gotta do this even if you don't autowire the custom one\r\n        WorkflowClient client;\r\n      \r\n        @Autowired\r\n        @Qualifier(\"customWorkflowClient\")\r\n        WorkflowClient customClient;\r\n\r\nI think it would help if we annotate the default WorkflowClient bean with @Primary in order to allow autowiring the default\r\none without having to use Qualifier directly everywhere in your code. \r\nAnother idea could be to allow config of multiple clients from config directly, but not sure this is best approach maybe.\r\n\r\nWdyt?\r\n","closedAt":"2025-05-02T20:38:36Z","comments":[{"id":"IC_kwDODN12PM5hOJzr","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"> For client app use case sometimes we need to create additional WorkflowClient beans\r\n\r\nMay need multiple clients for for worker apps too not just client apps.\r\n\r\nThis is similar to #1799 but more generic. There was internal discussion with myself and @Quinn-With-Two-Ns about how to possibly support multiple clients on multiple workers.\r\n\r\n> annotate the default WorkflowClient bean with @primary in order to allow autowiring the default\r\none without having to use Qualifier directly everywhere in your code.\r\n\r\nConcur on `@Primary` for the default, though we might need `@Qualifier` to support multiple clients on multiple workers, but maybe that's a separate issue.","createdAt":"2023-07-11T16:06:33Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/1811#issuecomment-1631100139","viewerDidAuthor":false},{"id":"IC_kwDODN12PM5kAvIh","author":{"login":"robzienert"},"authorAssociation":"NONE","body":"FWIW, this would work so `@Qualifier` is unnecessary; perhaps already known:\r\n\r\n```\r\n@Autowired\r\nWorkflowClient temporalWorkflowClient; // property named after the bean name\r\n```","createdAt":"2023-08-14T19:10:31Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/1811#issuecomment-1677914657","viewerDidAuthor":false}],"createdAt":"2023-07-11T13:35:42Z","labels":[{"id":"MDU6TGFiZWwxNjIyNzE5ODQ0","name":"enhancement","description":"User experience","color":"a2eeef"}],"milestone":null,"number":1811,"reactionGroups":[],"state":"CLOSED","title":"SpringBoot - add @Primary to temporalWorkflowClient WorkflowClient Bean","updatedAt":"2025-05-02T20:38:36Z","url":"https://github.com/temporalio/sdk-java/issues/1811"}
