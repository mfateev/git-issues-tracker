{"assignees":[],"author":{"id":"MDQ6VXNlcjYxNTY4","is_bot":false,"login":"GreyTeardrop","name":"Mykola Rybak"},"body":"## Overview & Expected Behavior\r\n\r\nThis issue is a \"follow-up\" for issue #300. With some manual tweaks described in that ticket, I got a workflow history JSON that Java SDK was able to parse, and the test below succeeded. I expected the test to fail if I made any significant or non-backward-compatible changes to the workflow.\r\n\r\n```java\r\nimport io.temporal.testing.WorkflowReplayer;\r\nimport org.junit.jupiter.api.Test;\r\n\r\npublic class SubmissionWorkflowReplayTest {\r\n\r\n    @Test\r\n    public void replayTest() throws Exception {\r\n        WorkflowReplayer.replayWorkflowExecutionFromResource(\r\n            \"submission_workflow.json\",\r\n            SubmissionWorkflowImpl.class\r\n        );\r\n    }\r\n}\r\n```\r\n\r\n## Actual Behavior\r\n\r\nThe replay test with Java SDK never fails given it can successfully parse the workflow history, regardless of what changes are made to the workflow or history JSON.\r\n\r\nThis seems to be caused by the [`Worker.replayWorkflowExecution()`](https://github.com/temporalio/sdk-java/blob/24a55be08d8cfaf0b8bb2bb49aab38e8344ce08c/temporal-sdk/src/main/java/io/temporal/worker/Worker.java#L386-L397) method that swallows all exceptions, including those that should signal that the replay has failed.\r\n\r\n```java\r\npublic void replayWorkflowExecution(WorkflowExecutionHistory history) throws Exception {\r\n  try {\r\n    workflowWorker.queryWorkflowExecution(\r\n        history,\r\n        WorkflowClient.QUERY_TYPE_REPLAY_ONLY,\r\n        String.class,\r\n        String.class,\r\n        new Object[] {});\r\n  } catch (Exception e) {\r\n\r\n  }\r\n}\r\n```\r\n\r\n## Steps to Reproduce the Problem\r\n\r\n  1. Create any workflow and execute it on a local Temporal server.\r\n  2. Export workflow execution history as JSON.\r\n  3. Tweak it so Java SDK could read it (required until #300 is fixed).\r\n  4. Run replay test and check that it succeeds.\r\n  5. Make any breaking change to the workflow logic.\r\n  6. Run the test again.\r\n  7. Observe that it still succeeds.\r\n\r\n## Specifications\r\n\r\n  - Version: Temporal Java SDK 1.0.4\r\n  - Platform: macOS\r\n","closedAt":"2021-01-17T22:47:51Z","comments":[],"createdAt":"2021-01-11T14:46:50Z","labels":[],"milestone":null,"number":301,"reactionGroups":[],"state":"CLOSED","title":"Worker.replayWorkflowExecution does not report replay failures","updatedAt":"2021-01-17T22:47:51Z","url":"https://github.com/temporalio/sdk-java/issues/301"}
