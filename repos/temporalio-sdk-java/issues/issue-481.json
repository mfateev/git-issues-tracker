{"assignees":[{"id":"MDQ6VXNlcjIwNTI3OTk5","login":"vkoby","name":"Vera","databaseId":0}],"author":{"id":"MDQ6VXNlcjM3ODEwOA==","is_bot":false,"login":"eminn","name":"Emin Demirci"},"body":"**Is your feature request related to a problem? Please describe.**\r\nI want the workers to stop trying to connecting to the server if the server is not available using `WorkflowServiceStubsOptions`\r\n\r\n**Describe the solution you'd like**\r\nI'd like to configure workers to stop polling/trying to connecting to the server if the server is not available after a specified time period.\r\n\r\n**Describe alternatives you've considered**\r\nN/A\r\n\r\n**Additional context**\r\nSlack discussion https://temporalio.slack.com/archives/CTT84KXK9/p1620663515093300","closedAt":"2021-05-28T20:57:14Z","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDgzNzM3MzM3OQ==","author":{"login":"Spikhalskiy"},"authorAssociation":"CONTRIBUTOR","body":"> workers to stop polling/trying\r\n\r\nI don't think that \"stopping\" is the right semantic here. We still want them to reconnect when the network or the server is back. But it would be good to expose backoffCoefficient config value for workers to slow them down up to some MaximumInterval (basically, expose RetryOptions).\r\n\r\nAlso, it would be great to expose backoffCoefficient for client stubs too as we discussed here with Vitaly: \r\nhttps://github.com/temporalio/sdk-java/pull/472/files#r627959282","createdAt":"2021-05-10T21:27:41Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/481#issuecomment-837373379","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDgzOTA0NzQxOA==","author":{"login":"vitarb"},"authorAssociation":"CONTRIBUTOR","body":"I think we may have both backoff and a parameter that specifies maximum retry period after which we give up and kill the worker. I can see situations where both types of behavior might be desirable based on the specifics of the deployment infrastructure being used.","createdAt":"2021-05-11T19:28:29Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"url":"https://github.com/temporalio/sdk-java/issues/481#issuecomment-839047418","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDgzOTM3OTc3MA==","author":{"login":"vkoby"},"authorAssociation":"CONTRIBUTOR","body":"Please take a look at [PollerOptions.java#L54](https://github.com/temporalio/sdk-java/blob/23bccf07d54982dd3048ab32f06c06c4811e74ce/temporal-sdk/src/main/java/io/temporal/internal/worker/PollerOptions.java#L54). We currently have default values for \r\n`pollBackoffCoefficient = 2`\r\n`pollBackoffInitialInterval = 100ms`\r\n`pollBackoffMaximumInterval = 1m`\r\nIn the end, the worker will keep polling the server every minute, which should be fine in most cases.\r\nDoes this work for you?","createdAt":"2021-05-12T02:15:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/481#issuecomment-839379770","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg0MTY5ODYxMA==","author":{"login":"eminn"},"authorAssociation":"NONE","body":"@vkoby In my case I'd need to stop them to fail a k8s deployment as keeping the workers running and letting them try to connect non-existing server would create a lot of noise in terms of logging. This way I don't need to implement a custom health check logic (e.g. checking the namespace exists), the workers will die after configured time or attempt count passes.\r\n","createdAt":"2021-05-15T17:37:24Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/481#issuecomment-841698610","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg0MjUzNjc3MQ==","author":{"login":"vkoby"},"authorAssociation":"CONTRIBUTOR","body":"@eminn Will implement health check. This has already been done in Go SDK see [client.go#L417](https://github.com/temporalio/sdk-go/blob/cea0147023cc324a8adce606d608cb7298e6cfcb/internal/client.go#L417)","createdAt":"2021-05-17T18:24:26Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/481#issuecomment-842536771","viewerDidAuthor":false}],"createdAt":"2021-05-10T16:34:13Z","labels":[{"id":"MDU6TGFiZWwxNjIyNzE5ODQ0","name":"enhancement","description":"User experience","color":"a2eeef"}],"milestone":null,"number":481,"reactionGroups":[],"state":"CLOSED","title":"Allow configuration of workers to back off completely if the server is not available","updatedAt":"2021-05-28T20:57:14Z","url":"https://github.com/temporalio/sdk-java/issues/481"}
