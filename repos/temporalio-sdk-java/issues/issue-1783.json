{"assignees":[],"author":{"id":"MDQ6VXNlcjIwODQyODY=","is_bot":false,"login":"wojked","name":"Wojciech Kedzierski"},"body":"I have a M1/M2 Mac and run my apps in docker containers.\r\n\r\nWhen developing in python on my mac directly, tests automatically download the `temporal-test-server` by hitting this endpoint first:\r\nhttps://temporal.download/temporal-test-server/default?arch=arm64&platform=darwin&sdk-name=sdk-python&sdk-version=1.2.0\r\n\r\nthat returns the following content\r\n```{\"archiveUrl\":\"https://temporal.download/assets/temporalio/sdk-java/releases/download/v1.17.0/temporal-test-server_1.17.0_macOS_amd64.tar.gz\",\"fileToExtract\":\"temporal-test-server_1.17.0_macOS_amd64/temporal-test-server\"}```\r\n\r\n**I am able to run tests \"directly\" on my local machine with pytest**\r\n\r\nBut when I try to test my app inside of a docker container that uses linux arm64 it fails because of two reasons:\r\n* RuntimeError: Failed starting test server: Permission denied (os error 13) if just run `pytest`\r\n* or `qemu-x86_64: Could not open '/lib64/ld-linux-x86-64.so.2': No such file or directory` if I provide pointer to a manually downloaded amd64 binary\r\n\r\nThis leads me to a quite obvious conclusion, that amd64 test server is not going to run within arm64.\r\n\r\n**I am unable to run temporal tests in docker on M1/M2 Macs**\r\n\r\n\r\n**Describe the solution you'd like**\r\nCould you provide builds for linux_arm64 target? This way tests would execute within a dockerised arm64 linux.\r\n\r\n**Describe alternatives you've considered**\r\n- I could use `WorkflowEnvironment.start_local()` instead of `WorkflowEnvironment.start_time_skipping()`\r\n- I could skip tests in docker, but is far from perfect.\r\n\r\n","closedAt":"2023-10-10T16:57:13Z","comments":[{"id":"IC_kwDODN12PM5edhg3","author":{"login":"wojked"},"authorAssociation":"NONE","body":"I am just starting to use temporal and followed the example project:\r\nhttps://github.com/temporalio/hello-world-project-template-python/blob/main/tests/test_run_worker.py\r\n\r\nRight now I am unsure why `.start_time_skipping()` was used instead of `.start_local()` in tests.\r\n`.start_local()` will run `temporalite` which seems like a good idea, so maybe it should be the way to test.","createdAt":"2023-06-09T15:48:21Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/1783#issuecomment-1584797751","viewerDidAuthor":false},{"id":"IC_kwDODN12PM5edsQw","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"Duplicate of #1407, but will leave open for a bit in case there are other questions.","createdAt":"2023-06-09T16:24:35Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-java/issues/1783#issuecomment-1584841776","viewerDidAuthor":false},{"id":"IC_kwDODN12PM5e08KX","author":{"login":"wojked"},"authorAssociation":"NONE","body":"Hey @cretz,\r\n\r\nI switched into `WorkflowEnvironment.start_local()` in my tests (instead of `WorkflowEnvironment.start_time_skipping()`) as I described in the \"considered alternatives\" without any negative effects (yet).\r\n\r\nI hope I will be able to deal with the lack of \"automatic time skipping\" by placing any \"sleeps\" in separated activities or individual functions that I will selectively mock in tests so do not see anything blocking me after all (for now).\r\n\r\nThank you for leaving it open, I feel we might close it as duplicate, but let's wait, maybe there are questions from other people too.\r\n","createdAt":"2023-06-14T10:33:06Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-java/issues/1783#issuecomment-1590936215","viewerDidAuthor":false},{"id":"IC_kwDODN12PM5oqHGb","author":{"login":"mjameswh"},"authorAssociation":"MEMBER","body":"There no longer seems to be any reason to keep this one open.\r\n\r\nClosing as duplicate of #1407.","createdAt":"2023-10-10T16:57:13Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/1783#issuecomment-1755869595","viewerDidAuthor":false}],"createdAt":"2023-06-09T13:59:51Z","labels":[{"id":"MDU6TGFiZWwxNjIyNzE5ODQ0","name":"enhancement","description":"User experience","color":"a2eeef"}],"milestone":null,"number":1783,"reactionGroups":[],"state":"CLOSED","title":"Test server for linux_arm64 target","updatedAt":"2023-10-10T16:57:14Z","url":"https://github.com/temporalio/sdk-java/issues/1783"}
