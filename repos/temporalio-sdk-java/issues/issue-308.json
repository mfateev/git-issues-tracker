{"assignees":[{"id":"MDQ6VXNlcjEzMTE2OTQ=","login":"vitarb","name":"Vitali","databaseId":0}],"author":{"id":"MDQ6VXNlcjEyMTE3OTIz","is_bot":false,"login":"rubyhfu","name":""},"body":"## Expected Behavior\r\nExpected no error logs using completionClient.completeExceptionally with any exception but it throws errors when used with ApplicationFailure.newNonRetryableFailure and ApplicationFailure.newFailure.\r\n\r\n## Actual Behavior\r\n[reactor-http-nio-1] ERROR reactor.core.publisher.Operators - Operator called default onErrorDropped\r\njava.lang.IllegalStateException: converter not set\r\n\tat io.temporal.common.converter.EncodedValues.toPayloads(EncodedValues.java:48) ~[temporal-sdk-1.0.0.jar:?]\r\n\tat io.temporal.failure.FailureConverter.exceptionToFailureNoUnwrapping(FailureConverter.java:210) ~[temporal-sdk-1.0.0.jar:?]\r\n\tat io.temporal.failure.FailureConverter.exceptionToFailure(FailureConverter.java:184) ~[temporal-sdk-1.0.0.jar:?]\r\n\tat io.temporal.internal.external.ManualActivityCompletionClientImpl.fail(ManualActivityCompletionClientImpl.java:163) ~[temporal-sdk-1.0.0.jar:?]\r\n\tat io.temporal.internal.sync.ActivityCompletionClientImpl.completeExceptionally(ActivityCompletionClientImpl.java:49) ~[temporal-sdk-1.0.0.jar:?]\r\n\r\n\r\n## Steps to Reproduce the Problem\r\n\r\n  1. Create a workflow with a simple activity, inject an ActivityCompletionClient into the activity\r\n  2. Inside the activity's async process, add:\r\n  completionClient.completeExceptionally(taskToken, ApplicationFailure.newNonRetryableFailure(\"xxx\", \"xxx\", \"xxx\"));\r\n  3. Invoke the workflow using TestWorkflowEnv, the above error logs should be printed\r\n\r\n\r\n## Specifications\r\n\r\n  - Version: temporal-sdk-1.0.0\r\n  - Platform: macOS Big Sur\r\n","closedAt":"2021-01-15T19:02:30Z","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDc1OTkyODA4Ng==","author":{"login":"mfateev"},"authorAssociation":"MEMBER","body":"I was able to reproduce the problem. Thanks a lot for reporting!","createdAt":"2021-01-14T05:04:19Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/308#issuecomment-759928086","viewerDidAuthor":true},{"id":"MDEyOklzc3VlQ29tbWVudDc2MTEyNjU0NA==","author":{"login":"vitarb"},"authorAssociation":"CONTRIBUTOR","body":"This issue should be addressed by #307 ","createdAt":"2021-01-15T19:02:30Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/308#issuecomment-761126544","viewerDidAuthor":false}],"createdAt":"2021-01-14T03:44:01Z","labels":[],"milestone":null,"number":308,"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"state":"CLOSED","title":"ActivityCompletionClient's completeExceptionally doesn't work with ApplicationFailure ","updatedAt":"2021-01-15T19:02:30Z","url":"https://github.com/temporalio/sdk-java/issues/308"}
