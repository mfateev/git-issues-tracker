{"assignees":[],"author":{"id":"MDQ6VXNlcjE0NjM2MjI=","is_bot":false,"login":"mfateev","name":"Maxim Fateev"},"body":"## Expected Behavior\r\nThe following works when using Workflow Client:\r\n\r\n```\r\npublic interface Retryable {\r\n    @SignalMethod\r\n    void retryNow();\r\n}\r\n\r\n@WorkflowInterface\r\npublic interface FileProcessingWorkflow extends Retryable {\r\n\r\n    @WorkflowMethod\r\n    String processFile(Arguments args);\r\n\r\n    @QueryMethod(name=\"history\")\r\n    List<String> getHistory();\r\n\r\n    @QueryMethod\r\n    String getStatus();\r\n\r\n    @SignalMethod\r\n    void abandon();\r\n}\r\n\r\n@WorkflowInterface\r\npublic interface MediaProcessingWorkflow extends Retryable {\r\n\r\n    @WorkflowMethod\r\n    String processBlob(Arguments args);\r\n}\r\n\r\nRetryable r1 = client.newWorkflowStub(Retryable.class, firstWorkflowId);\r\nRetryable r2 = client.newWorkflowStub(Retryable.class, secondWorkflowId);\r\nr1.retryNow();\r\nr2.retryNow();\r\n```\r\nThe same should work when signaling workflow from an external workflow:\r\n```\r\nWorkflow.newExternalWorkflowStub(Retryable.class, firstWorkflowId);\r\n\r\nRetryable r1 = Workflow.newExternalWorkflowStub(Retryable.class, firstWorkflowId);\r\nRetryable r2 = Workflow.newExternalWorkflowStub(Retryable.class, secondWorkflowId);\r\nr1.retryNow();\r\nr2.retryNow();\r\n```\r\n\r\n## Actual Behavior\r\nThe newExternalWorkflowStub fails with:\r\n```\r\nCaused by: java.lang.IllegalArgumentException: Missing required @WorkflowInterface annotation: interface ...Retryable\r\n\tat io.temporal.common.metadata.POJOWorkflowInterfaceMetadata.newInstanceInternal(POJOWorkflowInterfaceMetadata.java:179)\r\n\tat io.temporal.common.metadata.POJOWorkflowInterfaceMetadata.newInstance(POJOWorkflowInterfaceMetadata.java:108)\r\n\tat io.temporal.internal.sync.ExternalWorkflowInvocationHandler.<init>(ExternalWorkflowInvocationHandler.java:43)\r\n\tat io.temporal.internal.sync.WorkflowInternal.newExternalWorkflowStub(WorkflowInternal.java:412)\r\n\tat io.temporal.workflow.Workflow.newExternalWorkflowStub(Workflow.java:204)\r\n```\r\n\r\n","closedAt":"2025-05-26T17:06:29Z","comments":[{"id":"IC_kwDODN12PM6IJqD-","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"Arguably it shouldn't even work on the client. It'd make one wonder why a `@WorkflowInterface` is even needed ever if we can just assume it's there. In Python and .NET at least, we require the client class passed in to have this (even if it's a base class, to signify user intent). But I can understand if Java we don't want that.","createdAt":"2024-08-12T15:06:18Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/2180#issuecomment-2284232958","viewerDidAuthor":false},{"id":"IC_kwDODN12PM6IV1UU","author":{"login":"mfateev"},"authorAssociation":"MEMBER","body":"@WorkflowInterface defines a workflow type. There is no \"Retryable\" workflow type to register.","createdAt":"2024-08-13T23:57:54Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/2180#issuecomment-2287424788","viewerDidAuthor":true},{"id":"IC_kwDODN12PM6IbduC","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"I was under the impression the annotation is also meant to be required for caller use. I assume with this issue, we should accept basically any interface in Java including standard library ones (and that the client side already does)? I assume that it's at method call time on the proxy where we will fail for any non-signal/update/query-annotated method? It could be argued (and how we did it in .NET/Python) that if you're willing to define methods w/ Temporal annotations in an interface, you should mark that interface as one capable of being used as a workflow stub via the `@Workflow` annotation.\r\n\r\nBut I understand if in Java we expect methods at any level to have annotations but not classes. And of course there's value in consistency with client side. Can disregard my concern.","createdAt":"2024-08-14T14:14:33Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/2180#issuecomment-2288900994","viewerDidAuthor":false},{"id":"IC_kwDODN12PM6IfpFA","author":{"login":"mfateev"},"authorAssociation":"MEMBER","body":"The WorkflowClient.newWorkflowStub call [validates](https://github.com/temporalio/sdk-java/blob/201240a4f1075a48e23a3af17fd11a6d1c89bcd6/temporal-sdk/src/main/java/io/temporal/client/WorkflowClientInternalImpl.java#L175) that only methods that are annotated with signal/update/query are allowed at the interface.","createdAt":"2024-08-14T22:02:02Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/2180#issuecomment-2289996096","viewerDidAuthor":true}],"createdAt":"2024-08-11T18:58:44Z","labels":[],"milestone":null,"number":2180,"reactionGroups":[],"state":"CLOSED","title":"Workflow.newExternalWorkflowStub","updatedAt":"2025-05-26T17:06:29Z","url":"https://github.com/temporalio/sdk-java/issues/2180"}
