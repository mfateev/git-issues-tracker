{"assignees":[{"id":"MDQ6VXNlcjUzMjEwOA==","login":"Spikhalskiy","name":"Dmitry Spikhalsky","databaseId":0}],"author":{"id":"MDQ6VXNlcjIzNDQ0NzM5","is_bot":false,"login":"nvogety","name":"Neeharika V"},"body":"## Expected Behavior\r\nAll tests pass and Jacoco generates a coverage report\r\n\r\n## Actual Behavior\r\nJacoco fails and is not able to generate a report, since tests which used to be successful now fail after importing jacoco into build.gradle. \r\n\r\nRunning `./gradlew test` always results in `“org.gradle.api.tasks.TaskExecutionException: Execution failed for task '<classified-task>:test'”` which is caused by: `“org.gradle.api.GradleException: There were failing tests”`.  \r\n\r\nRunning `./gradlew jacocoTestReport` doesn't generate a report, either with a successful build or with an explicit failure, depending on if 'dependsOn test' is included under 'jacocoTestReport' in build.gradle. Regardless of build status, no reports are generated.\r\n\r\nI believe that synthetic methods (which jacoco may be creating) are not currently getting checked under getWorkflowInterfaceMethods in the POJOWorkflowInterfaceMetadata class, which is what is causing the failure. My test calls io.temporal.worker.Worker.addWorkflowImplementationFactory(). \r\n\r\n## Stacktrace\r\nNote: Some classified info has been obscured in the stack trace\r\n\r\n> Missing @WorkflowMethod, @SignalMethod or @QueryMethod annotation on private static boolean[] <classified-package>.$jacocoInit(java.lang.invoke.MethodHandles$Lookup,java.lang.String,java.lang.Class)\r\n> java.lang.IllegalArgumentException: Missing @WorkflowMethod, @SignalMethod or @QueryMethod annotation on private static boolean[] <classified-package>.$jacocoInit(java.lang.invoke.MethodHandles$Lookup,java.lang.String,java.lang.Class)\r\n> at io.temporal.common.metadata.POJOWorkflowInterfaceMetadata.getWorkflowInterfaceMethods(POJOWorkflowInterfaceMetadata.java:203)\r\n> at io.temporal.common.metadata.POJOWorkflowInterfaceMetadata.<init>(POJOWorkflowInterfaceMetadata.java:136)\r\n> at io.temporal.common.metadata.POJOWorkflowInterfaceMetadata.newInstance(POJOWorkflowInterfaceMetadata.java:109)\r\n> at io.temporal.common.metadata.POJOWorkflowInterfaceMetadata.newInstance(POJOWorkflowInterfaceMetadata.java:83)\r\n> at io.temporal.internal.sync.POJOWorkflowImplementationFactory.addWorkflowImplementationFactory(POJOWorkflowImplementationFactory.java:127)\r\n> at io.temporal.internal.sync.POJOWorkflowImplementationFactory.addWorkflowImplementationFactory(POJOWorkflowImplementationFactory.java:111)\r\n> at io.temporal.internal.sync.SyncWorkflowWorker.addWorkflowImplementationFactory(SyncWorkflowWorker.java:147)\r\n> at io.temporal.worker.Worker.addWorkflowImplementationFactory(Worker.java:289)\r\n> at<classified-package>.TestWorkflowFacade.getWorkflowClient(TestWorkflowFacade.java:252)\r\n> at <classified-package>.<test-class>.setup(<test-class>.java:310)\r\n> at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n> at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n> at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n> at java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n> at org.junit.internal.runners.MethodRoadie.runBefores(MethodRoadie.java:133)\r\n> at org.junit.internal.runners.MethodRoadie.runBeforesThenTestThenAfters(MethodRoadie.java:96)\r\n> at org.powermock.modules.junit4.internal.impl.PowerMockJUnit44RunnerDelegateImpl$PowerMockJUnit44MethodRunner.executeTest(PowerMockJUnit44RunnerDelegateImpl.java:310)\r\n> at org.powermock.modules.junit4.internal.impl.PowerMockJUnit47RunnerDelegateImpl$PowerMockJUnit47MethodRunner.executeTestInSuper(PowerMockJUnit47RunnerDelegateImpl.java:131)\r\n> at org.powermock.modules.junit4.internal.impl.PowerMockJUnit47RunnerDelegateImpl$PowerMockJUnit47MethodRunner.access$100(PowerMockJUnit47RunnerDelegateImpl.java:59)\r\n> at org.powermock.modules.junit4.internal.impl.PowerMockJUnit47RunnerDelegateImpl$PowerMockJUnit47MethodRunner$TestExecutorStatement.evaluate(PowerMockJUnit47RunnerDelegateImpl.java:147)\r\n> at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)\r\n> at org.powermock.modules.junit4.internal.impl.PowerMockJUnit47RunnerDelegateImpl$PowerMockJUnit47MethodRunner.evaluateStatement(PowerMockJUnit47RunnerDelegateImpl.java:107)\r\n> at org.powermock.modules.junit4.internal.impl.PowerMockJUnit47RunnerDelegateImpl$PowerMockJUnit47MethodRunner.executeTest(PowerMockJUnit47RunnerDelegateImpl.java:82)\r\n> at org.powermock.modules.junit4.internal.impl.PowerMockJUnit44RunnerDelegateImpl$PowerMockJUnit44MethodRunner.runBeforesThenTestThenAfters(PowerMockJUnit44RunnerDelegateImpl.java:298)\r\n> at org.junit.internal.runners.MethodRoadie.runTest(MethodRoadie.java:87)\r\n> at org.junit.internal.runners.MethodRoadie.run(MethodRoadie.java:50)\r\n> at org.powermock.modules.junit4.internal.impl.PowerMockJUnit44RunnerDelegateImpl.invokeTestMethod(PowerMockJUnit44RunnerDelegateImpl.java:218)\r\n> at org.powermock.modules.junit4.internal.impl.PowerMockJUnit44RunnerDelegateImpl.runMethods(PowerMockJUnit44RunnerDelegateImpl.java:160)\r\n> at org.powermock.modules.junit4.internal.impl.PowerMockJUnit44RunnerDelegateImpl$1.run(PowerMockJUnit44RunnerDelegateImpl.java:134)\r\n> at org.junit.internal.runners.ClassRoadie.runUnprotected(ClassRoadie.java:34)\r\n> at org.junit.internal.runners.ClassRoadie.runProtected(ClassRoadie.java:44)\r\n> at org.powermock.modules.junit4.internal.impl.PowerMockJUnit44RunnerDelegateImpl.run(PowerMockJUnit44RunnerDelegateImpl.java:136)\r\n> at org.powermock.modules.junit4.common.internal.impl.JUnit4TestSuiteChunkerImpl.run(JUnit4TestSuiteChunkerImpl.java:117)\r\n> at org.powermock.modules.junit4.common.internal.impl.AbstractCommonPowerMockRunner.run(AbstractCommonPowerMockRunner.java:57)\r\n> at org.powermock.modules.junit4.PowerMockRunner.run(PowerMockRunner.java:59)\r\n> at org.junit.runner.JUnitCore.run(JUnitCore.java:137)\r\n> at org.junit.runner.JUnitCore.run(JUnitCore.java:115)\r\n> at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)\r\n> at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)\r\n> at java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:195)\r\n> at java.base/java.util.Iterator.forEachRemaining(Iterator.java:133)\r\n> at java.base/java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)\r\n> at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484)\r\n> at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:474)\r\n> at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)\r\n> at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)\r\n> at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)\r\n> at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:497)\r\n> at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)\r\n> at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)\r\n> at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)\r\n> at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)\r\n> at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)\r\n> at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)\r\n> at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)\r\n> at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)\r\n> at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)\r\n> at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)\r\n> at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)\r\n> at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.processAllTestClasses(JUnitPlatformTestClassProcessor.java:99)\r\n> at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.access$000(JUnitPlatformTestClassProcessor.java:79)\r\n> at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor.stop(JUnitPlatformTestClassProcessor.java:75)\r\n> at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.stop(SuiteTestClassProcessor.java:61)\r\n> at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n> at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n> at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n> at java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n> at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n> at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n> at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n> at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n> at com.sun.proxy.$Proxy5.stop(Unknown Source)\r\n> at org.gradle.api.internal.tasks.testing.worker.TestWorker.stop(TestWorker.java:133)\r\n> at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n> at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n> at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n> at java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n> at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n> at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n> at org.gradle.internal.remote.internal.hub.MessageHubBackedObjectConnection$DispatchWrapper.dispatch(MessageHubBackedObjectConnection.java:182)\r\n> at org.gradle.internal.remote.internal.hub.MessageHubBackedObjectConnection$DispatchWrapper.dispatch(MessageHubBackedObjectConnection.java:164)\r\n> at org.gradle.internal.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:414)\r\n> at org.gradle.internal.concurrent.ExecutorPolicy$CatchAndRecordFailures.onExecute(ExecutorPolicy.java:64)\r\n> at org.gradle.internal.concurrent.ManagedExecutorImpl$1.run(ManagedExecutorImpl.java:48)\r\n> at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\r\n> at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\r\n> at org.gradle.internal.concurrent.ThreadFactoryImpl$ManagedThreadRunnable.run(ThreadFactoryImpl.java:56)\r\n> at java.base/java.lang.Thread.run(Thread.java:829)\r\n\r\n## Specifications\r\n  - Version: 1.11.0\r\n","closedAt":"2022-08-10T16:27:22Z","comments":[],"createdAt":"2022-07-29T14:50:01Z","labels":[{"id":"MDU6TGFiZWwxNjIyNzE5ODQx","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":{"number":18,"title":"1.16.0","description":"","dueOn":"2022-08-24T00:00:00Z"},"number":1331,"reactionGroups":[],"state":"CLOSED","title":"Jacoco fails to produce report due to tests failing","updatedAt":"2022-08-10T16:27:22Z","url":"https://github.com/temporalio/sdk-java/issues/1331"}
