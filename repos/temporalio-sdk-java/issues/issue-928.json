{"assignees":[{"id":"MDQ6VXNlcjUzMjEwOA==","login":"Spikhalskiy","name":"Dmitry Spikhalsky","databaseId":0}],"author":{"id":"MDQ6VXNlcjg3Mzg1NDc3","is_bot":false,"login":"mreardonx","name":""},"body":"## Expected Behavior\r\nThe Junit 5 TestActivityExtension lifecycle should support multiple test methods in a single test class.\r\n\r\n## Actual Behavior\r\nWith two test methods, the first test method completes as expected, but the second test method throws an exception when an activity task is submitted.\r\n\r\n```\r\nTask java.util.concurrent.FutureTask@39b85002 rejected from java.util.concurrent.ThreadPoolExecutor@377fb945[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 1]\r\njava.util.concurrent.RejectedExecutionException: Task java.util.concurrent.FutureTask@39b85002 rejected from java.util.concurrent.ThreadPoolExecutor@377fb945[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 1]\r\n\tat java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063)\r\n\tat java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830)\r\n\tat java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1379)\r\n\tat java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:134)\r\n\tat java.util.concurrent.Executors$DelegatedExecutorService.submit(Executors.java:681)\r\n\tat io.temporal.testing.TestActivityEnvironmentInternal$TestActivityExecutor.executeActivity(TestActivityEnvironmentInternal.java:345)\r\n\tat io.temporal.testing.TestActivityEnvironmentInternal$TestActivityExecutor.executeActivity(TestActivityEnvironmentInternal.java:298)\r\n\tat io.temporal.internal.sync.ActivityStubImpl.executeAsync(ActivityStubImpl.java:49)\r\n\tat io.temporal.internal.sync.ActivityStubBase.execute(ActivityStubBase.java:38)\r\n\tat io.temporal.internal.sync.ActivityInvocationHandler.lambda$getActivityFunc$0(ActivityInvocationHandler.java:77)\r\n\tat io.temporal.internal.sync.ActivityInvocationHandlerBase.invoke(ActivityInvocationHandlerBase.java:70)\r\n\tat io.temporal.internal.sync.DeterministicRunnerWrapper.lambda$invoke$0(DeterministicRunnerWrapper.java:43)\r\n\tat io.temporal.internal.sync.CancellationScopeImpl.run(CancellationScopeImpl.java:101)\r\n\tat io.temporal.internal.sync.WorkflowThreadImpl$RunnableWrapper.run(WorkflowThreadImpl.java:107)\r\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\r\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\n```\r\n\r\n## Steps to Reproduce the Problem\r\n\r\n  1. Modifiy the io.temporal.samples.hello.HelloDynamicActivityJUnit5Test test to have two test methods by making of copy of `testDynamicActivity` method and renaming it.\r\n  2. Run the unit test.  Both test cases should have passed, but only one will.\r\n\r\n## Specifications\r\n\r\n  - Version:  1.6.0\r\n  - Platform: Java 17, Junit 5\r\n","closedAt":"2022-07-28T17:35:31Z","comments":[{"id":"IC_kwDODN12PM5HTA9p","author":{"login":"Bennett-Lynch"},"authorAssociation":"NONE","body":"Possible root cause explained in https://github.com/temporalio/sdk-java/issues/1133#issuecomment-1197088838","createdAt":"2022-07-27T01:27:50Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/928#issuecomment-1196167017","viewerDidAuthor":false},{"id":"IC_kwDODN12PM5H4U5k","author":{"login":"Spikhalskiy"},"authorAssociation":"CONTRIBUTOR","body":"@eeshvardasikcm \r\n\r\n> I didn't get a response and noticed my comments were deleted. That's not very honorable of the gift I gave. Did I violate some commenting rules? I may not have read all of your rules.\r\n\r\nWe don't guarantee responses on community activity and preservation of all the comments. \r\nI found the comments irrelevant to the discussion and the issue, all 4 of them.\r\nTaking into account that there was a valuable up-to-the-point contribution from another community member later, I decided to trim these comments to keep the history and context of this issue clean for the next reader. One of the goals that I have maintaining this repo is to empower users to easily trace changes back to the issues and allow them to effectively grasp the context and reason for the changes that are made in Pull Requests.\r\n\r\nYou can always fork the repo and apply all the suggestions that you consider right, our license allows that.\r\n\r\n> So it appears you are going with a single solution instead of the architectural improvement that I indicated. \r\n\r\nCorrect, this issue doesn't need any architectural changes, it's a pretty trivial local mistake of the original implementers.\r\n\r\n> It's not my money your spending so I'm not losing money on this fix.\r\n\r\nSounds great.\r\n\r\nI attach the screenshots of the gift to this message for future readers that may want to evaluate it's value and relevance to this issue themselves.\r\n<img width=\"1067\" alt=\"Screen Shot 2022-08-05 at 12 30 06 AM\" src=\"https://user-images.githubusercontent.com/532108/183001803-0b2365d1-d04c-4766-955e-f62db052e23c.png\">\r\n\r\n\r\n","createdAt":"2022-08-05T01:43:49Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/928#issuecomment-1205948004","viewerDidAuthor":false}],"createdAt":"2021-12-10T17:45:50Z","labels":[{"id":"MDU6TGFiZWwxNjIyNzE5ODQx","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":{"number":17,"title":"1.15.0","description":"","dueOn":"2022-07-19T00:00:00Z"},"number":928,"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"state":"CLOSED","title":"TestActivityExtension lifecycle problems with more than a single test case","updatedAt":"2023-03-22T00:40:42Z","url":"https://github.com/temporalio/sdk-java/issues/928"}
