{"assignees":[],"author":{"id":"MDQ6VXNlcjE2NDc4NDQ1","is_bot":false,"login":"lverns","name":"Laverne Schrock"},"body":"## Expected Behavior\n\n` io.temporal.internal.client.external.GenericWorkflowClient` should allow all resources to be reclaimed and not block natural termination of the JVM.\n\nThe Reproduction steps should finish with the `java` process exiting.\n\n## Actual Behavior\n\nOnce the `asyncThrottlerExecutor` in that class has started a thread, there is no mechanism to terminate it, and the JVM will not exit unless `System.exit()` is manually called.\n\nThe `java` call does not exit.\n\n## Steps to Reproduce the Problem\n\n  1. Checkout the https://github.com/temporalio/money-transfer-project-java repo from the [Getting Started tutorial ](https://learn.temporal.io/getting_started/java/first_program_in_java/).\n  1. Add this commit on top: https://github.com/lverns/money-transfer-project-java/commit/2492e11338b1b6a3ac2c45f1bae113422bc2dd89\n  1. Generate a classpath: ` mvn dependency:build-classpath -Dmdep.outputFile=cp.txt`\n  2. Compile `mvn compile`\n  3. Run the worker:`mvn  exec:java  -Dexec.mainClass=\"moneytransferapp.MoneyTransferWorker\"     -Dorg.slf4j.simpleLogger.defaultLogLevel=warn`\n  4. In another terminal run the app: `java -cp $(cat cp.txt):target/classes moneytransferapp.TransferApp`\n  5. Observe that the app prints \"Got Transfer complete\", but the JVM remains running.\n  6. If you inspect the process with `jstack` you will see a non-daemon thread called `generic-wf-client-async-throttler` that is preventing the JVM from exiting.\n\n## Specifications\n\n  - Version: 1.24.1\n  - Platform: Linux \n  - Java Version: OpenJDK Runtime Environment (Red_Hat-21.0.6.0.7-1) (build 21.0.6+7)\n\n## Other notes\nThis seems to be a known issue based on a [comment in the code](https://github.com/temporalio/sdk-java/blob/6b05cd82de3aa76220a4ad3f9567f0ab0e657e48/temporal-sdk/src/main/java/io/temporal/internal/client/external/GenericWorkflowClientImpl.java#L42), but opening this bug for visibility.\n\nAn easy work around is to call `System.exit(0)`, but it seems possible that there are scenarios where a program might want to rely on the JVM's exit semantics.","closedAt":"2025-05-16T15:36:33Z","comments":[],"createdAt":"2025-03-18T21:29:00Z","labels":[],"milestone":null,"number":2450,"reactionGroups":[],"state":"CLOSED","title":"GenericWorkflowClient can prevent exit of JVM","updatedAt":"2025-05-16T15:36:33Z","url":"https://github.com/temporalio/sdk-java/issues/2450"}
