{"assignees":[{"id":"MDQ6VXNlcjIwNTI3OTk5","login":"vkoby","name":"Vera","databaseId":0}],"author":{"id":"MDQ6VXNlcjczMDk3NDA0","is_bot":false,"login":"madhukkc","name":"Madhusudanan K K C (makk)"},"body":"**Describe the bug**\r\nWhen i go to query page i see blank  page with \"no querires registered\" message\r\nbut my workfow as Query methods\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. use 1.6.3 server and 1.6.1/1.6,2/1.7.0 ui and use temporal hava sdk 1.0.5/1.0.5-snapshot\r\n2. submit a qorklfow and go to query tab\r\n\r\n**Expected behavior**\r\nqueries should be shown\r\n**Actual behavior**\r\ni see no queries registerd message\r\n**Screenshots**\r\n\r\n\r\n\r\n**Additional context**\r\nThe query names are pased by triggering an expception and  parsing exception log , refer [enhancment request](https://github.com/temporalio/sdk-java/issues/335) and [forum thread](https://community.temporal.io/t/io-temporal-internal-sync-syncworkflowcontext-query-uncategorized-exception-often-seen-in-server-log/1454?u=madhu)\r\n\r\nbetween 1.6.1 and 1.6.3 the excption logging has possibly changed and hence the queries are appearing blank\r\n\r\nPreviously ,i used to see this exception in server side when i go to query tab\r\n\r\n\"level\":\"error\",\"ts\":\"2021-02-06T14:01:06.842Z\",\"msg\":\"Uncategorized error\",\"service\":\"history\",\"wf-namespace-id\":\"493f72d9-4de5-4e0f-b113-3e37449990fa\",\"wf-id\":\"feb20210607-worflow\",\"error\":\"java.lang.IllegalArgumentException: Unknown query type: __cadence_web_list, knownTypes=**[getData, getState]**\r\n\r\nNow i see\r\n\r\n\"level\":\"error\",\"ts\":\"2021-02-18T07:42:13.879Z\",\"msg\":\"query directly though matching on sticky failed, will not attempt query on non-sticky\",\"service\":\"history\",\"shard-id\":4,\"address\":\"x.y.0.z:7234\",\"shard-item\":\"0xc0008db680\",\"component\":\"history-engine\",\"wf-namespace\":\"dev-cloud\",\"wf-id\":\"feb20210607-worflow\",\"wf-run-id\":\"f6786da3-086a-4945-b5c2-f76934731516\",\"wf-query-type\":\"__cadence_web_list\",\"error\":\"java.lang.IllegalStateException: Unknown query type: __cadence_web_list\\n\\tat io.temporal.internal.sync.QueryDispatcher.handleQuery(QueryDispatcher.java:78)\\n\\tat io.temporal.internal.sync.SyncWorkflowContext.handleQuery(SyncWorkflowContext.java:181)\\n\\tat io.temporal.internal.sync.WorkflowExecuteRunnable.handleQuery(WorkflowExecuteRunnable.java:76)\\n\\tat io.temporal.internal.sync.SyncWorkflow.query(SyncWorkflow.java:175)\\n\\tat io.temporal.internal.replay.ReplayWorkflowExecutor.query(ReplayWorkflowExecutor.java:137)\\n\\tat io.temporal.internal.replay.ReplayWorkflow\r\n\r\nPossibly thats why my query page is broken this is happening in 1.6.3\r\n\r\n\r\nrefer https://github.com/temporalio/web/issues/258\r\n","closedAt":"2021-02-26T00:59:46Z","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDc4MzY2NzY0NQ==","author":{"login":"feedmeapples"},"authorAssociation":"NONE","body":"Likely was caused by changes in `sdk-java`. Working with the sdk team to pinpoint to the issue and address it","createdAt":"2021-02-22T20:53:18Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/357#issuecomment-783667645","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDc4MzY2OTg5Mg==","author":{"login":"feedmeapples"},"authorAssociation":"NONE","body":"As per discussion with SDK team, moving this to `sdk-java` and assigning to @vkoby ","createdAt":"2021-02-22T20:57:42Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/357#issuecomment-783669892","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDc4MzY4MDcxMg==","author":{"login":"feedmeapples"},"authorAssociation":"NONE","body":"@vkoby `sdk-java` used to return an error message that would contain registered queries. For example `sdk-go` may return the following error message `'3 INVALID_ARGUMENT: unknown queryType __cadence_web_list. KnownQueryTypes=[__stack_trace __open_sessions state]'`\r\n\r\n`sdk-java` was returning a similar error. Please see an example in this old issue https://github.com/temporalio/web/issues/54 .\r\nPlease find what caused the change and make it return the old error message again","createdAt":"2021-02-22T21:17:26Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/357#issuecomment-783680712","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDc4MzY5MDM1Ng==","author":{"login":"feedmeapples"},"authorAssociation":"NONE","body":"p.s this is also tracked to be added into the frontend API","createdAt":"2021-02-22T21:35:00Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/357#issuecomment-783690356","viewerDidAuthor":false}],"createdAt":"2021-02-18T10:28:14Z","labels":[],"milestone":null,"number":357,"reactionGroups":[],"state":"CLOSED","title":"[Bug] Query page broken after upgrading to 1.6.3 server","updatedAt":"2021-02-26T00:59:46Z","url":"https://github.com/temporalio/sdk-java/issues/357"}
