{"assignees":[{"id":"MDQ6VXNlcjEzMTE2OTQ=","login":"vitarb","name":"Vitali","databaseId":0}],"author":{"id":"MDQ6VXNlcjE0NjM2MjI=","is_bot":false,"login":"mfateev","name":"Maxim Fateev"},"body":"To not tie up threads users requested support for activity implementations that return CompletableFuture. As we don't want to have Future in the activity API the strawman proposal is to add adapter methods that can be called from activity (similar to Async class from workflow package)\r\n\r\n```\r\nclass ActivityAsync {\r\n  public static <A1, R> R function(Functions.Func1<A1, CompletableFuture<R>> function, A1 arg1) { ... }\r\n  // similar methods for procedures and argument counts\r\n}\r\n```\r\nThen an activity implementation could look like:\r\n\r\n```\r\nString myActivity(String foo) {\r\n   return ActivityAsync.function(myActivityReturningFuture, foo);\r\n}\r\n\r\nCompletableFuture<String> myActivityReturningFuture(String foo) {\r\n   ...\r\n}\r\n```\r\n\r\nwhere only `myActivity` method is part of the interface. Then a dynamic proxy adapter can be written to convert from a class that has methods that return ComletableFutures to the activity interface that returns values:\r\n\r\n```\r\ninterface MyActivities {\r\n   String foo();\r\n   void bar();\r\n}\r\n\r\n@ActivitiesImplementation(implements=MyActivities.class)\r\nclass MyActivitiesImpl {\r\n   CompletableFuture<String> foo();\r\n   ComletableFuture<Void> bar();\r\n}\r\n\r\n```\r\nThen the Worker would just accept `MyActivitiesImpl` instance and internally create the dynamic proxy.","closedAt":"2021-01-04T18:51:47Z","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDU4MzYzOTU2OA==","author":{"login":"mfateev"},"authorAssociation":"MEMBER","body":"The same approach can be used for workflows implemented asynchronously with workflow implementation returning Promise.","createdAt":"2020-02-07T22:14:19Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/14#issuecomment-583639568","viewerDidAuthor":true},{"id":"MDEyOklzc3VlQ29tbWVudDc1NDE1MDcwMg==","author":{"login":"vitarb"},"authorAssociation":"CONTRIBUTOR","body":"Resolved in https://github.com/temporalio/sdk-java/pull/291\r\nWe now provide ability to get a completion client easily thus simplifying user experience.","createdAt":"2021-01-04T18:51:47Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-java/issues/14#issuecomment-754150702","viewerDidAuthor":false}],"createdAt":"2020-02-07T13:56:52Z","labels":[],"milestone":null,"number":14,"reactionGroups":[],"state":"CLOSED","title":"Simplify async activity implementation","updatedAt":"2021-01-04T18:51:48Z","url":"https://github.com/temporalio/sdk-java/issues/14"}
