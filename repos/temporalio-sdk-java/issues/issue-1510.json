{"assignees":[],"author":{"id":"MDQ6VXNlcjUzMjEwOA==","is_bot":false,"login":"Spikhalskiy","name":"Dmitry Spikhalsky"},"body":"## Actual Behavior\r\n\r\nFrom the investigation of a user problem:\r\n- [x] `worker.suspendPolling` stops local activity worker from polling. This leads to workflow tasks with local activities getting stuck in a heartbeat loop without making progress. Local activity poller should never stop polling. Local activity poller is an implementation detail and the only source it polls from is an internal worker queue.\r\n- [ ] User reported fact: During worker shutdown some activities are getting distributed to the worker (server registers the dispatch and an attempt), but never start execution on this worker that is shutting down. Theory: Worker long-poll thread can be interrupted when the server has already registered an attempt and already sent the task to the worker, but the worker didn't receive the task yet. Potential mitigation to think through: Server in this scenario should've to get CANCELLED (https://gitter.im/grpc/grpc?at=5afd98b79ad18967b9f2c464) and may register an activity failure.","closedAt":"2025-05-15T02:13:29Z","comments":[],"createdAt":"2022-11-09T16:11:00Z","labels":[{"id":"MDU6TGFiZWwxNjIyNzE5ODQx","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":{"number":12,"title":"Next","description":"","dueOn":null},"number":1510,"reactionGroups":[],"state":"CLOSED","title":"Investigate and fix graceful shutdown problems ","updatedAt":"2025-05-15T02:13:30Z","url":"https://github.com/temporalio/sdk-java/issues/1510"}
