{
  "summary": "TestWorkflowService generates task tokens that only include workflow and activity IDs, making them non-unique across retries. The real service generates unique tokens per retry, causing the test service to incorrectly allow a previous activity retry to complete a subsequent retry.",
  "category": "bug",
  "subcategory": "test-framework",
  "apis": [],
  "components": [
    "TestWorkflowService",
    "task-token-generation",
    "retry-handling"
  ],
  "concepts": [
    "retry",
    "task-token",
    "test-service",
    "idempotency",
    "token-uniqueness"
  ],
  "severity": "medium",
  "userImpact": "Test assertions may pass incorrectly when testing retry logic, failing to catch real bugs that would occur against the actual Temporal service.",
  "rootCause": "Task tokens generated by TestWorkflowService include only workflow and activity IDs without incorporating retry count, unlike the real service which generates unique tokens per retry attempt.",
  "proposedFix": "Include retry count in the token generation logic to make tokens unique across retries, matching real service behavior.",
  "workaround": null,
  "resolution": "fixed",
  "resolutionDetails": "Token generation was updated to include retry count, making test service behavior consistent with real service.",
  "related": [],
  "keyQuote": "We don't include retry count into the token, which is why previous activity retry can complete next one in the test service.",
  "number": 84,
  "repo": "temporalio-sdk-java",
  "generatedAt": "2026-01-11T17:53:24.106Z"
}