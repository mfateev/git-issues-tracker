{"assignees":[{"id":"MDQ6VXNlcjk5NTk3NjE=","login":"seregazhuk","name":"Sergey Zhuk","databaseId":0}],"author":{"id":"MDQ6VXNlcjk5NTk3NjE=","is_bot":false,"login":"seregazhuk","name":"Sergey Zhuk"},"body":"Workflow example to reproduce bug:\r\n\r\n```php\r\nclass DelayedWorkflow implements DelayedWorkflowInterface\r\n{\r\n    private bool $doCancel;\r\n\r\n    public function executeDelayed()\r\n    {\r\n        $this->doCancel = false;\r\n\r\n        yield Workflow::awaitWithTimeout(\r\n        \t30,\r\n        \tfn() => $this->doCancel\r\n        );\r\n\r\n        if ($this->doCancel) {\r\n            return 'CANCEL';\r\n        }\r\n\r\n        return 'OK';\r\n    }\r\n\r\n    public function cancel(): void\r\n    {\r\n        $this->doCancel = true;\r\n    }\r\n}\r\n```\r\n\r\nExpected behavior:\r\n1. Run the workflow, after 30 seconds workflow completes with result `OK`.\r\n2. Run the workflow, send `cancel` signal, workflow completes with result `CANCEL`.\r\n\r\nActual result:\r\n1. Run the workflow, after 30 seconds it still stays running. If after that I send cancel signal, workflow completes with result `OK`.\r\n2. Run the workflow, send cancel signal, workflow stays running. After 30 seconds it completes with result `CANCEL`.","closedAt":"2021-12-28T11:43:53Z","comments":[],"createdAt":"2021-12-23T05:54:09Z","labels":[{"id":"MDU6TGFiZWwyMzM5NDMzMTc0","name":"Bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":132,"reactionGroups":[],"state":"CLOSED","title":"[Bug] Workflow keeps stuck with awaitWithTimeout and signal","updatedAt":"2021-12-28T11:43:53Z","url":"https://github.com/temporalio/sdk-php/issues/132"}
