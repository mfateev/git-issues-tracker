{"assignees":[],"author":{"id":"MDQ6VXNlcjEzODE2NzA0","is_bot":false,"login":"root-aza","name":"Vlad Shashkov"},"body":"### What are you really trying to do?\r\n\r\n<!-- \r\nTell us at a high level what you're doing, to avoid XY problem (https://en.wikipedia.org/wiki/XY_problem) \r\n-->\r\n\r\n### Describe the bug\r\n\r\nDataConverter not supported types: null, true, false \r\n\r\nstackTrace:\r\n\r\n```json\r\n{\r\n    \"message\": \"Type named \\\"null\\\" is not a valid type name\",\r\n    \"source\": \"PHP_SDK\",\r\n    \"stackTrace\": \"Temporal\\\\Exception\\\\DataConverterException: Type named \\\"null\\\" is not a valid type name in /var/www/api/vendor/temporal/sdk/src/DataConverter/JsonConverter.php:190\\nStack trace:\\n#0 /var/www/api/vendor/temporal/sdk/src/DataConverter/JsonConverter.php(158): Temporal\\\\DataConverter\\\\JsonConverter->errorInvalidTypeName(Object(Temporal\\\\DataConverter\\\\Type))\\n#1 /var/www/api/src/Infrastructure/Temporal/DataConverter/SymfonySerializerDataConverter.php(54): Temporal\\\\DataConverter\\\\JsonConverter->fromPayload(Object(Temporal\\\\Api\\\\Common\\\\V1\\\\Payload), Object(Temporal\\\\DataConverter\\\\Type))\\n#2 /var/www/api/vendor/temporal/sdk/src/DataConverter/DataConverter.php(53): App\\\\Infrastructure\\\\Temporal\\\\DataConverter\\\\SymfonySerializerDataConverter->fromPayload(Object(Temporal\\\\Api\\\\Common\\\\V1\\\\Payload), Object(Temporal\\\\DataConverter\\\\Type))\\n#3 /var/www/api/vendor/temporal/sdk/src/DataConverter/EncodedValues.php(80): Temporal\\\\DataConverter\\\\DataConverter->fromPayload(Object(Temporal\\\\Api\\\\Common\\\\V1\\\\Payload), Object(Temporal\\\\DataConverter\\\\Type))\\n#4 /var/www/api/vendor/temporal/sdk/src/DataConverter/EncodedValues.php(169): Temporal\\\\DataConverter\\\\EncodedValues->getValue(0, Object(ReflectionNamedType))\\n#5 /var/www/api/vendor/react/promise/src/FulfilledPromise.php(28): Temporal\\\\DataConverter\\\\EncodedValues::Temporal\\\\DataConverter\\\\{closure}(Object(Temporal\\\\DataConverter\\\\EncodedValues))\\n#6 /var/www/api/vendor/react/promise/src/Promise.php(134): React\\\\Promise\\\\FulfilledPromise->then(Object(Closure), NULL)\\n#7 /var/www/api/vendor/react/promise/src/Promise.php(168): React\\\\Promise\\\\Promise::React\\\\Promise\\\\{closure}(Object(React\\\\Promise\\\\FulfilledPromise))\\n#8 /var/www/api/vendor/react/promise/src/Promise.php(231): React\\\\Promise\\\\Promise->settle(Object(React\\\\Promise\\\\FulfilledPromise))\\n#9 /var/www/api/vendor/react/promise/src/Deferred.php(36): React\\\\Promise\\\\Promise::React\\\\Promise\\\\{closure}(Object(Temporal\\\\DataConverter\\\\EncodedValues))\\n#10 /var/www/api/vendor/temporal/sdk/src/Internal/Transport/CompletableResult.php(137): React\\\\Promise\\\\Deferred->resolve(Object(Temporal\\\\DataConverter\\\\EncodedValues))\\n#11 /var/www/api/vendor/temporal/sdk/src/Internal/Events/EventEmitterTrait.php(47): Temporal\\\\Internal\\\\Transport\\\\CompletableResult->Temporal\\\\Internal\\\\Transport\\\\{closure}()\\n#12 /var/www/api/vendor/temporal/sdk/src/WorkerFactory.php(278): Temporal\\\\WorkerFactory->emit('tick')\\n#13 /var/www/api/vendor/temporal/sdk/src/WorkerFactory.php(393): Temporal\\\\WorkerFactory->tick()\\n#14 /var/www/api/vendor/temporal/sdk/src/WorkerFactory.php(261): Temporal\\\\WorkerFactory->dispatch('\\\\n%\\\\x08\\\\xACF* \\\\n\\\\x1E\\\\n\\\\x16\\\\n\\\\x08en...', Array)\\n#15 /var/www/api/src/Infrastructure/Temporal/UI/Cli/WorkerCommand.php(37): Temporal\\\\WorkerFactory->run()\\n#16 /var/www/api/vendor/symfony/console/Command/Command.php(312): App\\\\Infrastructure\\\\Temporal\\\\UI\\\\Cli\\\\WorkerCommand->execute(Object(Symfony\\\\Component\\\\Console\\\\Input\\\\ArgvInput), Object(Symfony\\\\Component\\\\Console\\\\Output\\\\ConsoleOutput))\\n#17 /var/www/api/vendor/symfony/console/Application.php(1040): Symfony\\\\Component\\\\Console\\\\Command\\\\Command->run(Object(Symfony\\\\Component\\\\Console\\\\Input\\\\ArgvInput), Object(Symfony\\\\Component\\\\Console\\\\Output\\\\ConsoleOutput))\\n#18 /var/www/api/vendor/symfony/framework-bundle/Console/Application.php(88): Symfony\\\\Component\\\\Console\\\\Application->doRunCommand(Object(App\\\\Infrastructure\\\\Temporal\\\\UI\\\\Cli\\\\WorkerCommand), Object(Symfony\\\\Component\\\\Console\\\\Input\\\\ArgvInput), Object(Symfony\\\\Component\\\\Console\\\\Output\\\\ConsoleOutput))\\n#19 /var/www/api/vendor/symfony/console/Application.php(314): Symfony\\\\Bundle\\\\FrameworkBundle\\\\Console\\\\Application->doRunCommand(Object(App\\\\Infrastructure\\\\Temporal\\\\UI\\\\Cli\\\\WorkerCommand), Object(Symfony\\\\Component\\\\Console\\\\Input\\\\ArgvInput), Object(Symfony\\\\Component\\\\Console\\\\Output\\\\ConsoleOutput))\\n#20 /var/www/api/vendor/symfony/framework-bundle/Console/Application.php(77): Symfony\\\\Component\\\\Console\\\\Application->doRun(Object(Symfony\\\\Component\\\\Console\\\\Input\\\\ArgvInput), Object(Symfony\\\\Component\\\\Console\\\\Output\\\\ConsoleOutput))\\n#21 /var/www/api/vendor/symfony/console/Application.php(168): Symfony\\\\Bundle\\\\FrameworkBundle\\\\Console\\\\Application->doRun(Object(Symfony\\\\Component\\\\Console\\\\Input\\\\ArgvInput), Object(Symfony\\\\Component\\\\Console\\\\Output\\\\ConsoleOutput))\\n#22 /var/www/api/vendor/symfony/runtime/Runner/Symfony/ConsoleApplicationRunner.php(54): Symfony\\\\Component\\\\Console\\\\Application->run(Object(Symfony\\\\Component\\\\Console\\\\Input\\\\ArgvInput), Object(Symfony\\\\Component\\\\Console\\\\Output\\\\ConsoleOutput))\\n#23 /var/www/api/vendor/autoload_runtime.php(29): Symfony\\\\Component\\\\Runtime\\\\Runner\\\\Symfony\\\\ConsoleApplicationRunner->run()\\n#24 /var/www/api/bin/console(11): require_once('/var/www/api/ve...')\\n#25 {main}\",\r\n    \"cause\": null,\r\n    \"applicationFailureInfo\": {\r\n        \"type\": \"Temporal\\\\Exception\\\\DataConverterException\",\r\n        \"nonRetryable\": false,\r\n        \"details\": null\r\n    },\r\n    \"failureInfo\": \"applicationFailureInfo\"\r\n}\r\n\r\n```\r\n\r\n\r\n\r\n### Minimal Reproduction\r\n\r\n```php\r\n<?php\r\n\r\n#[Activity]\r\nfinal readonly class VantaBankNotificationActivityHandler implements VantaBankLoanNotificationActivity\r\n{\r\n    public function __construct(\r\n        private LoanNotificationClient $client\r\n    ) {\r\n    }\r\n\r\n\r\n    /**\r\n     * @throws ClientException\r\n     */\r\n    #[ActivityMethod]\r\n    public function notify(Uid $id, LoanEventType $event, \\DateTimeImmutable $date): null\r\n    {\r\n        $this->client->dispatchEvent($id, $event, $date);\r\n\r\n        return null;\r\n    }\r\n}\r\n```\r\n\r\n\r\n\r\n\r\n### Environment/Versions\r\n- Sdk versions 2.5.1\r\n\r\n### Additional context\r\n\r\n<!-- Add any other context about the problem here. -->\r\n","closedAt":"2023-07-12T11:06:00Z","comments":[{"id":"IC_kwDOEY5HBM5hRW6F","author":{"login":"root-aza"},"authorAssociation":"CONTRIBUTOR","body":"Hi. problem still exists. \r\n\r\ncomposer.lock\r\n\r\n![Screenshot 2023-07-12 at 13 43 32](https://github.com/temporalio/sdk-php/assets/13816704/5b1759f4-1142-4da1-a070-8a9ac9e8f8e9)\r\n\r\n\r\n```json\r\n{\r\n  \"message\": \"Type named \\\"null\\\" is not a valid type name\",\r\n  \"source\": \"PHP_SDK\",\r\n  \"stackTrace\": \"Temporal\\\\Exception\\\\DataConverterException: Type named \\\"null\\\" is not a valid type name in /var/www/api/vendor/temporal/sdk/src/DataConverter/JsonConverter.php:190\\nStack trace:\\n#0 /var/www/api/vendor/temporal/sdk/src/DataConverter/JsonConverter.php(158): Temporal\\\\DataConverter\\\\JsonConverter->errorInvalidTypeName(Object(Temporal\\\\DataConverter\\\\Type))\\n#1 /var/www/api/src/Infrastructure/Temporal/DataConverter/SymfonySerializerDataConverter.php(53): Temporal\\\\DataConverter\\\\JsonConverter->fromPayload(Object(Temporal\\\\Api\\\\Common\\\\V1\\\\Payload), Object(Temporal\\\\DataConverter\\\\Type))\\n#2 /var/www/api/vendor/temporal/sdk/src/DataConverter/DataConverter.php(53): App\\\\Infrastructure\\\\Temporal\\\\DataConverter\\\\SymfonySerializerDataConverter->fromPayload(Object(Temporal\\\\Api\\\\Common\\\\V1\\\\Payload), Object(Temporal\\\\DataConverter\\\\Type))\\n#3 /var/www/api/vendor/temporal/sdk/src/DataConverter/EncodedValues.php(80): Temporal\\\\DataConverter\\\\DataConverter->fromPayload(Object(Temporal\\\\Api\\\\Common\\\\V1\\\\Payload), Object(Temporal\\\\DataConverter\\\\Type))\\n#4 /var/www/api/vendor/temporal/sdk/src/DataConverter/EncodedValues.php(169): Temporal\\\\DataConverter\\\\EncodedValues->getValue(0, Object(ReflectionNamedType))\\n#5 /var/www/api/vendor/react/promise/src/FulfilledPromise.php(28): Temporal\\\\DataConverter\\\\EncodedValues::Temporal\\\\DataConverter\\\\{closure}(Object(Temporal\\\\DataConverter\\\\EncodedValues))\\n#6 /var/www/api/vendor/react/promise/src/Promise.php(134): React\\\\Promise\\\\FulfilledPromise->then(Object(Closure), NULL)\\n#7 /var/www/api/vendor/react/promise/src/Promise.php(168): React\\\\Promise\\\\Promise::React\\\\Promise\\\\{closure}(Object(React\\\\Promise\\\\FulfilledPromise))\\n#8 /var/www/api/vendor/react/promise/src/Promise.php(231): React\\\\Promise\\\\Promise->settle(Object(React\\\\Promise\\\\FulfilledPromise))\\n#9 /var/www/api/vendor/react/promise/src/Deferred.php(36): React\\\\Promise\\\\Promise::React\\\\Promise\\\\{closure}(Object(Temporal\\\\DataConverter\\\\EncodedValues))\\n#10 /var/www/api/vendor/temporal/sdk/src/Internal/Transport/CompletableResult.php(137): React\\\\Promise\\\\Deferred->resolve(Object(Temporal\\\\DataConverter\\\\EncodedValues))\\n#11 /var/www/api/vendor/temporal/sdk/src/Internal/Events/EventEmitterTrait.php(47): Temporal\\\\Internal\\\\Transport\\\\CompletableResult->Temporal\\\\Internal\\\\Transport\\\\{closure}()\\n#12 /var/www/api/vendor/temporal/sdk/src/WorkerFactory.php(278): Temporal\\\\WorkerFactory->emit('tick')\\n#13 /var/www/api/vendor/temporal/sdk/src/WorkerFactory.php(393): Temporal\\\\WorkerFactory->tick()\\n#14 /var/www/api/vendor/temporal/sdk/src/WorkerFactory.php(261): Temporal\\\\WorkerFactory->dispatch('\\\\n%\\\\x08\\\\xAAF* \\\\n\\\\x1E\\\\n\\\\x16\\\\n\\\\x08en...', Array)\\n#15 /var/www/api/src/Infrastructure/Temporal/UI/Cli/WorkerCommand.php(37): Temporal\\\\WorkerFactory->run()\\n#16 /var/www/api/vendor/symfony/console/Command/Command.php(312): App\\\\Infrastructure\\\\Temporal\\\\UI\\\\Cli\\\\WorkerCommand->execute(Object(Symfony\\\\Component\\\\Console\\\\Input\\\\ArgvInput), Object(Symfony\\\\Component\\\\Console\\\\Output\\\\ConsoleOutput))\\n#17 /var/www/api/vendor/symfony/console/Application.php(1040): Symfony\\\\Component\\\\Console\\\\Command\\\\Command->run(Object(Symfony\\\\Component\\\\Console\\\\Input\\\\ArgvInput), Object(Symfony\\\\Component\\\\Console\\\\Output\\\\ConsoleOutput))\\n#18 /var/www/api/vendor/symfony/framework-bundle/Console/Application.php(88): Symfony\\\\Component\\\\Console\\\\Application->doRunCommand(Object(App\\\\Infrastructure\\\\Temporal\\\\UI\\\\Cli\\\\WorkerCommand), Object(Symfony\\\\Component\\\\Console\\\\Input\\\\ArgvInput), Object(Symfony\\\\Component\\\\Console\\\\Output\\\\ConsoleOutput))\\n#19 /var/www/api/vendor/symfony/console/Application.php(314): Symfony\\\\Bundle\\\\FrameworkBundle\\\\Console\\\\Application->doRunCommand(Object(App\\\\Infrastructure\\\\Temporal\\\\UI\\\\Cli\\\\WorkerCommand), Object(Symfony\\\\Component\\\\Console\\\\Input\\\\ArgvInput), Object(Symfony\\\\Component\\\\Console\\\\Output\\\\ConsoleOutput))\\n#20 /var/www/api/vendor/symfony/framework-bundle/Console/Application.php(77): Symfony\\\\Component\\\\Console\\\\Application->doRun(Object(Symfony\\\\Component\\\\Console\\\\Input\\\\ArgvInput), Object(Symfony\\\\Component\\\\Console\\\\Output\\\\ConsoleOutput))\\n#21 /var/www/api/vendor/symfony/console/Application.php(168): Symfony\\\\Bundle\\\\FrameworkBundle\\\\Console\\\\Application->doRun(Object(Symfony\\\\Component\\\\Console\\\\Input\\\\ArgvInput), Object(Symfony\\\\Component\\\\Console\\\\Output\\\\ConsoleOutput))\\n#22 /var/www/api/vendor/symfony/runtime/Runner/Symfony/ConsoleApplicationRunner.php(54): Symfony\\\\Component\\\\Console\\\\Application->run(Object(Symfony\\\\Component\\\\Console\\\\Input\\\\ArgvInput), Object(Symfony\\\\Component\\\\Console\\\\Output\\\\ConsoleOutput))\\n#23 /var/www/api/vendor/autoload_runtime.php(29): Symfony\\\\Component\\\\Runtime\\\\Runner\\\\Symfony\\\\ConsoleApplicationRunner->run()\\n#24 /var/www/api/bin/console(11): require_once('/var/www/api/ve...')\\n#25 {main}\",\r\n  \"encodedAttributes\": null,\r\n  \"cause\": null,\r\n  \"applicationFailureInfo\": {\r\n    \"type\": \"Temporal\\\\Exception\\\\DataConverterException\",\r\n    \"nonRetryable\": false,\r\n    \"details\": null\r\n  }\r\n}\r\n```\r\n\r\n\r\n\r\n\r\n\r\n","createdAt":"2023-07-12T06:44:07Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/328#issuecomment-1631940229","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5hRXAi","author":{"login":"root-aza"},"authorAssociation":"CONTRIBUTOR","body":"@roxblnfk cc","createdAt":"2023-07-12T06:44:30Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/328#issuecomment-1631940642","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5hSR--","author":{"login":"roxblnfk"},"authorAssociation":"COLLABORATOR","body":"@root-aza did you restart RR server after SDK update?\r\nI tested it with that activity\r\nhttps://github.com/temporalio/sdk-php/blob/894a808d03c256407ad828cceaf18d32fc1a6026/tests/Fixtures/src/Activity/Php82TypesActivity.php#L22","createdAt":"2023-07-12T09:39:09Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/328#issuecomment-1632182206","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5hSuq6","author":{"login":"root-aza"},"authorAssociation":"CONTRIBUTOR","body":"Hhm. Yep. right now it's working ðŸ˜‚\r\n","createdAt":"2023-07-12T11:05:57Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/328#issuecomment-1632299706","viewerDidAuthor":false}],"createdAt":"2023-07-09T15:37:11Z","labels":[{"id":"MDU6TGFiZWwyMzM5NDMzMTc0","name":"Bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":328,"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"state":"CLOSED","title":"[Bug] DataConverter type named \"null\" is not a valid type name","updatedAt":"2023-07-12T11:06:00Z","url":"https://github.com/temporalio/sdk-php/issues/328"}
