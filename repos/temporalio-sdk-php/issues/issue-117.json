{"assignees":[],"author":{"id":"MDQ6VXNlcjY4MTU3MTQ=","is_bot":false,"login":"xepozz","name":"Dmitrii Derepko"},"body":"**Describe the bug**\r\nI send an array from my activity as a result, but in promise step **then** I get **stdClass** instead of array.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Create activity that will send an associative array.\r\n2. Create workflow where you call activity and add post-processing in **then** step.\r\n3. Try to get value from **result** as if it array.\r\n\r\n**Expected behavior**\r\nI get value\r\n\r\n\r\n**Expected behavior**\r\nI get an error `PanicError: Cannot use object of type stdClass as array (type: Error, retryable: true)`\r\n\r\n**Screenshots/Terminal ouput**\r\n![image](https://user-images.githubusercontent.com/6815714/125174609-46f6ee80-e1cf-11eb-88ce-09608ec4c7a0.png)\r\n\r\nYou can use this snippet:\r\n```php\r\n#[\\Temporal\\Activity\\ActivityInterface(prefix: \"app.\")]\r\nclass CommonActivity\r\n{\r\n    public function slow(string $name): array\r\n    {\r\n        return [\r\n            'result' => 'Hello, ' . $name,\r\n        ];\r\n    }\r\n}\r\n```\r\n\r\n```php\r\n#[\\Temporal\\Workflow\\WorkflowInterface]\r\nfinal class FastWorkflow\r\n{\r\n    #[\\Temporal\\Workflow\\WorkflowMethod(\"wf\")]\r\n    public function run(string $name, int $count): \\Generator\r\n    {\r\n        $activity = Workflow::newActivityStub(\r\n            CommonActivity::class\r\n        );\r\n\r\n        $activity->slow($name)->then(function ($result) {\r\n            $result['result'];\r\n        });\r\n\r\n        return 0;\r\n    }\r\n}\r\n```\r\n\r\nAs I understand the problem is locating [here](https://github.com/temporalio/sdk-php/blob/master/src/DataConverter/JsonConverter.php#L86). But I don't know how to solve it.","closedAt":"2023-04-19T13:08:15Z","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDg3NzY5NzU1Nw==","author":{"login":"SerafimArts"},"authorAssociation":"CONTRIBUTOR","body":"Hello! This is not a bug (More precisely, this is documented behavior). Please use DTO instead. \r\nRelated issue https://github.com/temporalio/sdk-php/issues/93#issuecomment-804008399","createdAt":"2021-07-10T20:12:13Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/117#issuecomment-877697557","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg3NzcwMTM3Nw==","author":{"login":"xepozz"},"authorAssociation":"COLLABORATOR","body":"Then can you make behaviour more predictable:\r\nif you return `['key' => 'test']` it will be converted to an object, but if you return `['test']` it will be converted to an array.\r\n","createdAt":"2021-07-10T20:42:37Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/117#issuecomment-877701377","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg3NzcwMjUxMg==","author":{"login":"SerafimArts"},"authorAssociation":"CONTRIBUTOR","body":"> if you return ['key' => 'test'] it will be converted to an object, but if you return ['test'] it will be converted to an array.\r\n\r\nNow that's how it works, isn't it?","createdAt":"2021-07-10T20:51:08Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/117#issuecomment-877702512","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg3NzcwNTQ1NA==","author":{"login":"xepozz"},"authorAssociation":"COLLABORATOR","body":"Yes, it is. But it isn't clear.","createdAt":"2021-07-10T21:15:54Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/117#issuecomment-877705454","viewerDidAuthor":false}],"createdAt":"2021-07-10T19:42:17Z","labels":[{"id":"MDU6TGFiZWwyMzM5NDMzMTc4","name":"Duplicate","description":"This issue or pull request already exists","color":"cfd3d7"}],"milestone":null,"number":117,"reactionGroups":[],"state":"CLOSED","title":"[Bug] Wrong activity response type","updatedAt":"2023-04-19T13:08:15Z","url":"https://github.com/temporalio/sdk-php/issues/117"}
