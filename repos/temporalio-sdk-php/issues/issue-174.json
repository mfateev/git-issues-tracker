{"assignees":[{"id":"MDQ6VXNlcjk5NTk3NjE=","login":"seregazhuk","name":"Sergey Zhuk","databaseId":0}],"author":{"id":"MDQ6VXNlcjMyODg1NjU=","is_bot":false,"login":"jcontesse","name":""},"body":"I am trying to halt process execution until one of two condition are met.\r\nThese conditions are set by two distinct signals.\r\n\r\nIn general, everything works fine but in some cases (and it is often... maybe 10% of the cases), the signal is received and processed but the instance does not continue its execution. I have not been able to identify a pattern.\r\n\r\nSo I am waiting for the conditions like this:\r\n\r\n`yield Workflow::await(fn() => !is_null($this->authorizationId) || $this->exitProcess);`\r\n\r\nWaiting to execute one of these signals:\r\n\r\n```\r\n    public function workflowAuthorizationExecuted(int $taskId)\r\n\t{\r\n\t\t$this->authorizationId = $taskId;\r\n\t}\r\n\r\n    public function indicationHasBeenSuspended()\r\n\t{\r\n\t\t$this->exitProcess = true;\r\n\t}\r\n```\r\nMaybe I am doing something wrong, but I find it strange that some instances work and some don't.\r\nFor those instances that don't work, even if I resend the signal nothing happens.\r\nHow can I make sure the instance is waiting in the \"await\" command?\r\n\r\nI haven't been able to replicate in our DEV or QA environment. It is happening in production.\r\nI have attached my workflow definition.\r\n\r\nI am using docker under Alpine Linux v3.11.\r\n- RR_VERSION: 2.8.4\r\n- PHP_IMAGE_VERSION: 8.1.4-cli\r\n- mysql:8\r\n- temporalio/auto-setup:1.15.0\r\n[AutorizarIndicacionWorkflow.php.txt](https://github.com/temporalio/sdk-php/files/8758303/AutorizarIndicacionWorkflow.php.txt)\r\n\r\n","closedAt":"2022-06-09T15:25:43Z","comments":[{"id":"IC_kwDOEY5HBM5DttLD","author":{"login":"jcontesse"},"authorAssociation":"NONE","body":"This is my SDK version\r\n```\r\n{\r\n    \"require\": {\r\n        \"spiral/roadrunner\": \"^2.8\",\r\n        \"temporal/sdk\": \"^1.1\",\r\n        \"nyholm/psr7\": \"^1.5\"\r\n    }\r\n}\r\n```\r\n\r\nI see issue #170 has some similarities. I am not sure if this happens after a worker crashes.","createdAt":"2022-05-24T15:10:17Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/174#issuecomment-1136054979","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5Dt47Z","author":{"login":"seregazhuk"},"authorAssociation":"CONTRIBUTOR","body":"@jcontesse can you try the latest SDK version? We have recently fixed similar issues with awaits and signals.","createdAt":"2022-05-24T15:52:10Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/174#issuecomment-1136103129","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5ECmor","author":{"login":"jcontesse"},"authorAssociation":"NONE","body":"So I am now using the following versions:\r\n\r\n- PHP_IMAGE_VERSION: 8.1.4-cli\r\n- mysql:8\r\n- temporalio/auto-setup:1.15.0\r\n- \"spiral/roadrunner\": \"^2.10.1\",\r\n- \"temporal/sdk\": \"^1.3\",\r\n- \"nyholm/psr7\": \"^1.5\"\r\n\r\nI ran the process for almost a week but unfortunately today the same thing happened.\r\nA couple of processes hanged after the signal was received with no apparent explanation.\r\n\r\nIt seems this started happening after one of the workers failed (not sure what happened). I have attached that instance's execution log.\r\n\r\nShould I update temporal?\r\nWhat other information can I gert in order to be more helpful?\r\n\r\n[Worker Error.txt](https://github.com/temporalio/sdk-php/files/8800946/Worker.Error.txt)\r\n.","createdAt":"2022-05-30T23:17:44Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/174#issuecomment-1141533227","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5EJL7w","author":{"login":"seregazhuk"},"authorAssociation":"CONTRIBUTOR","body":"ping @rustatian \r\nMaybe it relates to our worker fixes? ðŸ¤” ","createdAt":"2022-06-01T08:07:58Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/174#issuecomment-1143258864","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5EJfZW","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"@jcontesse @seregazhuk Yeah, I guess so.  We will fix that in the RR `v2.10.3`.","createdAt":"2022-06-01T09:10:44Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/174#issuecomment-1143338582","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5EPJ7-","author":{"login":"seregazhuk"},"authorAssociation":"CONTRIBUTOR","body":"@jcontesse please try to update RR to `v2.10.3` and sdk to `v1.3.2`. Hope, it will help you.","createdAt":"2022-06-02T12:47:33Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/174#issuecomment-1144823550","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5EnwB2","author":{"login":"seregazhuk"},"authorAssociation":"CONTRIBUTOR","body":"Closing due to no activity.","createdAt":"2022-06-09T15:25:43Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/174#issuecomment-1151271030","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5EoWYr","author":{"login":"jcontesse"},"authorAssociation":"NONE","body":"It has been nearly one week running RR v2.10.3 and sdk v1.3.2 with no issues. It seems the issue has been fixed. We are still monitoring.","createdAt":"2022-06-09T17:53:28Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HOORAY","users":{"totalCount":3}}],"url":"https://github.com/temporalio/sdk-php/issues/174#issuecomment-1151428139","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5EoWoP","author":{"login":"seregazhuk"},"authorAssociation":"CONTRIBUTOR","body":"Great news! ðŸš€ ","createdAt":"2022-06-09T17:54:39Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/174#issuecomment-1151429135","viewerDidAuthor":false}],"createdAt":"2022-05-23T22:05:30Z","labels":[{"id":"MDU6TGFiZWwyMzM5NDMzMTc0","name":"Bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":174,"reactionGroups":[],"state":"CLOSED","title":"Process execution does not continue after await condition is satissfied (through signals)","updatedAt":"2022-06-09T17:54:39Z","url":"https://github.com/temporalio/sdk-php/issues/174"}
