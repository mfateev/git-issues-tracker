{"assignees":[{"id":"MDQ6VXNlcjk5NTk3NjE=","login":"seregazhuk","name":"Sergey Zhuk","databaseId":0}],"author":{"id":"MDQ6VXNlcjIwNDE1ODU4","is_bot":false,"login":"koekaverna","name":"Egor"},"body":"### What are you really trying to do?\r\nI made repo with example https://github.com/koekaverna/samples-php/tree/background-child/app/src/ChildBackground\r\n<!-- \r\nTell us at a high level what you're doing, to avoid XY problem (https://en.wikipedia.org/wiki/XY_problem) \r\n-->\r\n\r\n### Describe the bug\r\nI expect that parent workflow return result imidiately when there is no `yield` on child workflow. It does not. It was waiting for child process done and had timeout exception.\r\n<!-- A clear and concise description of what the bug is. -->\r\n\r\n<!-- If applicable, add screenshots or code blocks to help explain your problem. You can also use [Loom](http://loom.com/) to do short, free video bug reports. -->\r\n\r\n### Minimal Reproduction\r\nLook at the repo\r\n<!-- \r\nModify our hello world templates to demonstrate:\r\n\r\n- TypeScript: https://github.com/temporalio/samples-typescript/tree/main/hello-world\r\n- Go: https://github.com/temporalio/money-transfer-project-template-go\r\n- Java: https://github.com/temporalio/money-transfer-project-template-java\r\n- PHP: https://github.com/temporalio/samples-php#samples\r\n-->\r\n\r\n### Environment/Versions\r\n\r\n<!-- Please complete the following information where relevant. -->\r\n- I am using docker-compose from source\r\n\r\n### Additional context\r\n\r\n<!-- Add any other context about the problem here. -->\r\n","closedAt":"2022-06-29T11:26:17Z","comments":[{"id":"IC_kwDOEY5HBM5EoYb3","author":{"login":"seregazhuk"},"authorAssociation":"CONTRIBUTOR","body":"Hi @koekaverna! The parent workflow always waits till the child workflow is finished.\r\nRelated docs:\r\n\r\n[Policy](https://docs.temporal.io/docs/concepts/what-is-a-parent-close-policy/)\r\n[Execution concepts](https://docs.temporal.io/docs/concepts/what-is-a-child-workflow-execution/)","createdAt":"2022-06-09T18:02:35Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/184#issuecomment-1151436535","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5ErTfw","author":{"login":"koekaverna"},"authorAssociation":"NONE","body":"> Hi @koekaverna! The parent workflow always waits till the child workflow is finished. Related docs:\r\n> \r\n> [Policy](https://docs.temporal.io/docs/concepts/what-is-a-parent-close-policy/)  \r\n[Execution concepts](https://docs.temporal.io/docs/concepts/what-is-a-child-workflow-execution/)\r\n\r\n> A Parent Workflow Execution must await on the Child Workflow Execution to spawn. The Parent can **optionally** await on the result of the Child Workflow Execution.\r\n\r\n![image](https://user-images.githubusercontent.com/20415858/173043142-d21051b6-9729-4d2a-acf9-979f2d128bac.png)\r\n\r\nIt seems parent workflow should not await child workflow. After child workflow starts it is optional to wait results.\r\n@seregazhuk ","createdAt":"2022-06-10T10:10:55Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/184#issuecomment-1152202736","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5EtJ8_","author":{"login":"seregazhuk"},"authorAssociation":"CONTRIBUTOR","body":"@koekaverna Oh, sorry. The parent workflow waits till the child starts. Once it is started the parent can be completed. But here the child emmidiately fails (with `throw new IllegalStateException(\"not yet\");`). In this case the parent also waits and fails. Try to remove your exception throwing.","createdAt":"2022-06-10T19:58:01Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/184#issuecomment-1152687935","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5E1zlq","author":{"login":"koekaverna"},"authorAssociation":"NONE","body":"> Try to remove your exception throwing.\r\n\r\nIt does not solve the problem. Why parent workflow waits child, when no result is awaited with yield?\r\n\r\nI have this scenario:\r\n1. Send the request1 to the server1 using workflow.\r\n2. Waiting it for the _response_.\r\n3. Log the _response_ using another request2 to a logging server2\r\n4. Return result of the _response_\r\n\r\nIn this case server2 can be anavailabale for sometime and I want to retry request2 until it will be done.\r\nI need return result of request1 imideately after I get response from server1.\r\nI do not need to wait the result of request2 in the worklow.\r\n\r\nIs it possible somehow to do this?\r\n\r\n@seregazhuk ","createdAt":"2022-06-14T09:40:44Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/184#issuecomment-1154955626","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5FHnC2","author":{"login":"seregazhuk"},"authorAssociation":"CONTRIBUTOR","body":"Yes, there is an issue with parent/child workflows ðŸ˜ž we are working on it. As a quick solution I can see - separate it to two different workflows. ","createdAt":"2022-06-19T05:50:22Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/184#issuecomment-1159622838","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5Fy3mP","author":{"login":"koekaverna"},"authorAssociation":"NONE","body":"Wow it's amazing ðŸŽ‰ ","createdAt":"2022-06-30T09:06:33Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"ROCKET","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-php/issues/184#issuecomment-1170962831","viewerDidAuthor":false}],"createdAt":"2022-06-07T09:00:09Z","labels":[{"id":"MDU6TGFiZWwyMzM5NDMzMTc0","name":"Bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":184,"reactionGroups":[],"state":"CLOSED","title":"[Bug] Abandoned child workflow don't release flow","updatedAt":"2022-06-30T09:06:33Z","url":"https://github.com/temporalio/sdk-php/issues/184"}
