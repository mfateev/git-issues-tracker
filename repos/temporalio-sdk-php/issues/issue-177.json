{"assignees":[{"id":"MDQ6VXNlcjQxNTI0ODE=","login":"roxblnfk","name":"Aleksei Gagarin","databaseId":0},{"id":"MDQ6VXNlcjgwNDAzMzg=","login":"rustatian","name":"Valery Piashchynski","databaseId":0}],"author":{"id":"MDQ6VXNlcjU5MTY2OTQ4","is_bot":false,"login":"corelix","name":"Dmytro Pylypenko"},"body":"### Describe the bug\r\n\r\nSometimes when a child worker process throws an exception, the parent worker process throws the following panic error:\r\n```\r\nPanicError: flush queue: SoftJobError:\r\n\tcodec_execute:\r\n\tsync_worker_exec:\r\n\tsync_worker_exec_payload: LogicException: Got the response to undefined request 10389 in /srv/vendor/temporal/sdk/src/Internal/Transport/Client.php:60\r\n```\r\nand after it:\r\n```\r\nPanicError: unknown command CommandType: ChildWorkflow, ID: edfb1479-3d88-407e-a428-7e304e0d7bdf, possible causes are nondeterministic workflow definition code or incompatible change in the workflow definition \r\n```\r\n<img width=\"1560\" alt=\"Screenshot 2022-05-26 at 20 57 30\" src=\"https://user-images.githubusercontent.com/59166948/170547569-46ac4993-c9de-4ce4-911a-2c41346982f3.png\">\r\n\r\n\r\n### Environment/Versions\r\n\r\n- Temporal Version: 1.16.2 and 1.2.0 SDK\r\n- We use Kubernetes\r\n\r\n### Additional context\r\n\r\nWe tried to scale the pods so that can be split in different zones for fault tolerance. Maybe that causing these problems.\r\n","closedAt":"2022-12-19T15:07:11Z","comments":[{"id":"IC_kwDOEY5HBM5D4haz","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"Hey @dmitry-pilipenko üëãüèª. I guess the problem is in the workers' restarts. `SoftJobError` indicates some error that leads to process (PHP) restart. I expect that fix will be released the following week.","createdAt":"2022-05-26T18:34:08Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1138890419","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5D4jpW","author":{"login":"corelix"},"authorAssociation":"NONE","body":"@rustatian Can I do something about it now? This happens in a production now :(","createdAt":"2022-05-26T18:45:52Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1138899542","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5D4lrp","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"@dmitry-pilipenko, I'm not sure what is the initial reason for this error. Could you please turn on `debug` in the logs and send me this file? Especially before and after this error.","createdAt":"2022-05-26T18:56:55Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1138907881","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5D4p2W","author":{"login":"corelix"},"authorAssociation":"NONE","body":"@rustatian I hope this helps you:\r\n[wf-default-6f974d785d-7rspn.log](https://github.com/temporalio/sdk-php/files/8781518/wf-default-6f974d785d-7rspn.log)\r\n[temporalio-history-85d87b8945-vks9v.log](https://github.com/temporalio/sdk-php/files/8781520/temporalio-history-85d87b8945-vks9v.log)\r\n\r\n","createdAt":"2022-05-26T19:17:10Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1138924950","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5D4tD_","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"@dmitry-pilipenko Thank you. Could you please update RR version? You use an unsupported version (`v2.7.4`). You may try `v2.10.2`.","createdAt":"2022-05-26T19:34:08Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1138938111","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5EAaqj","author":{"login":"corelix"},"authorAssociation":"NONE","body":"> @dmitry-pilipenko Thank you. Could you please update RR version? You use an unsupported version (`v2.7.4`). You may try `v2.10.2`.\r\n\r\n@rustatian RR updates helped me. Your quick response helped me a lot. Thank you for this!","createdAt":"2022-05-30T10:04:36Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":3}}],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1140959907","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5E8h1H","author":{"login":"corelix"},"authorAssociation":"NONE","body":"@rustatian this problem is still observed, but now it is in cases unknown to me.\r\n\r\nVersions:\r\nRR - 2.10.2\r\nTemporal Version: 1.16.2 and 1.3.2 SDK\r\n\r\nProbably due to the fact that we use a wait with a timeout and then throw a custom exception.\r\nExample:\r\n```php\r\n        yield Temporal::awaitWithTimeout(\r\n            $interval = CarbonInterval::minutes(30),\r\n            fn () => $this->answer !== null\r\n        );\r\n        if ($this->answer === null) {\r\n            throw new ReplyTimeout($interval);\r\n        }\r\n```\r\n\r\nTrace:\r\n```\r\nPanicError: sync_worker_exec: SoftJobError:\r\n\tsync_worker_exec_payload: LogicException: Got the response to undefined request 12445 in /srv/vendor/temporal/sdk/src/Internal/Transport/Client.php:60\r\nStack trace:\r\n#0 /srv/vendor/temporal/sdk/src/WorkerFactory.php(389): Temporal\\Internal\\Transport\\Client->dispatch()\r\n#1 /srv/vendor/temporal/sdk/src/WorkerFactory.php(261): Temporal\\WorkerFactory->dispatch()\r\n#2 /srv/src/Infrastructure/CLI/TemporalWorker.php(67): Temporal\\WorkerFactory->run()\r\n#3 /srv/vendor/symfony/console/Command/Command.php(308): App\\Infrastructure\\CLI\\TemporalWorker->execute()\r\n#4 /srv/vendor/symfony/console/Application.php(989): Symfony\\Component\\Console\\Command\\Command->run()\r\n#5 /srv/vendor/symfony/console/Application.php(299): Symfony\\Component\\Console\\Application->doRunCommand()\r\n#6 /srv/vendor/symfony/console/Application.php(171): Symfony\\Component\\Console\\Application->doRun()\r\n#7 /srv/vendor/helpcrunch/foundation/src/Runtime/Handler.php(29): Symfony\\Component\\Console\\Application->run()\r\n#8 /srv/vendor/helpcrunch/foundation/src/Runtime/Runner.php(34): Helpcrunch\\Foundation\\Runtime\\Handler->__invoke()\r\n#9 /srv/vendor/autoload_runtime.php(29): Helpcrunch\\Foundation\\Runtime\\Runner->run()\r\n#10 /srv/bin/app(11): require('...')\r\n#11 {main} \r\nprocess event for default [panic]:\r\ngithub.com/temporalio/roadrunner-temporal/aggregatedpool.(*Workflow).OnWorkflowTaskStarted(0xc0007a7b30, 0xc00065ba08?)\r\n\tgithub.com/temporalio/roadrunner-temporal@v1.4.1/aggregatedpool/workflow.go:153 +0x2e8\r\ngo.temporal.io/sdk/internal.(*workflowExecutionEventHandlerImpl).ProcessEvent(0xc000835c98, 0xc001a4db80, 0x0?, 0x1)\r\n\tgo.temporal.io/sdk@v1.14.0/internal/internal_event_handlers.go:815 +0x203\r\ngo.temporal.io/sdk/internal.(*workflowExecutionContextImpl).ProcessWorkflowTask(0xc00079f960, 0xc001b1df50)\r\n\tgo.temporal.io/sdk@v1.14.0/internal/internal_task_handlers.go:878 +0xca8\r\ngo.temporal.io/sdk/internal.(*workflowTaskHandlerImpl).ProcessWorkflowTask(0xc0006c0210, 0xc001b1df50, 0xc000572300)\r\n\tgo.temporal.io/sdk@v1.14.0/internal/internal_task_handlers.go:727 +0x485\r\ngo.temporal.io/sdk/internal.(*workflowTaskPoller).processWorkflowTask(0xc0001131e0, 0xc001b1df50)\r\n\tgo.temporal.io/sdk@v1.14.0/internal/internal_task_pollers.go:284 +0x2cd\r\ngo.temporal.io/sdk/internal.(*workflowTaskPoller).ProcessTask(0xc0001131e0, {0x15e0ae0?, 0xc001b1df50?})\r\n\tgo.temporal.io/sdk@v1.14.0/internal/internal_task_pollers.go:255 +0x6c\r\ngo.temporal.io/sdk/internal.(*baseWorker).processTask(0xc000170500, {0x15e06a0?, 0xc0007b8e40})\r\n\tgo.temporal.io/sdk@v1.14.0/internal/internal_worker_base.go:398 +0x167\r\ncreated by go.temporal.io/sdk/internal.(*baseWorker).runTaskDispatcher\r\n\tgo.temporal.io/sdk@v1.14.0/internal/internal_worker_base.go:302 +0xb5\r\n```\r\n\r\nLog file:\r\n[wf-default-5794999ddc-r4h94.log](https://github.com/temporalio/sdk-php/files/8911557/wf-default-5794999ddc-r4h94.log)\r\n","createdAt":"2022-06-15T17:00:39Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1156717895","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5E8ksV","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"Did you update RR to v2.10.4 ?","createdAt":"2022-06-15T17:12:54Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1156729621","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5E8lZY","author":{"login":"corelix"},"authorAssociation":"NONE","body":"> \r\n\r\nyes, I have updated my last comment and added more details","createdAt":"2022-06-15T17:16:11Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1156732504","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5E8r6u","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"> > \r\n> \r\n> yes, I have updated my last comment and added more details\r\n\r\nYou didn't update RR, because, according to the stack trace, you are using the temporal plugin version 1.4.1, but in the 2.10.4 it was updated to v1.4.7.","createdAt":"2022-06-15T17:45:27Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1156759214","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5E8toA","author":{"login":"corelix"},"authorAssociation":"NONE","body":"@rustatian my current RR version is 2.10.2. If I update to 2.10.4 will my problem go away?","createdAt":"2022-06-15T17:53:51Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1156766208","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5E8zoG","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"> @rustatian my current RR version is 2.10.2. If I update to 2.10.4 will my problem go away?\r\n\r\nYes, we fixed this problem in the latest version.","createdAt":"2022-06-15T18:23:25Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1156790790","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5E_LAE","author":{"login":"corelix"},"authorAssociation":"NONE","body":"@rustatian update didn't help :(\r\n<img width=\"561\" alt=\"Screenshot 2022-06-16 at 11 58 05\" src=\"https://user-images.githubusercontent.com/59166948/174033624-782b7db1-0679-4e89-b59b-19f4cc8c129e.png\">\r\n\r\n[wf-default-7f9b7d986b-5bqtw.log](https://github.com/temporalio/sdk-php/files/8917341/wf-default-7f9b7d986b-5bqtw.log)\r\n","createdAt":"2022-06-16T08:58:30Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1157410820","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5E_mna","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"@dmitry-pilipenko Please, attach the entire sample (link to your repo is preferable) in the description to reproduce your issue.\r\n\r\nlike this one for example: https://github.com/Torrion/temporal-worker-pool-leak-test","createdAt":"2022-06-16T10:56:39Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1157523930","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5E_69C","author":{"login":"corelix"},"authorAssociation":"NONE","body":"@rustatian, I can provide a child workflow that has problems:\r\nhttps://github.com/helpcrunch/temporal/blob/main/workflows.php","createdAt":"2022-06-16T12:32:42Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1157607234","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5E_9Si","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"> @rustatian, I can provide a child workflow that has problems: https://github.com/helpcrunch/temporal/blob/main/workflows.php\r\n\r\nPlease, remove the not needed parts from your code and provide a minimal example to run it with rr, as I showed in the sample. The minimal example should reproduce the bug and contain all code to run it (your `.rr.yaml` should also be included).\r\n","createdAt":"2022-06-16T12:43:22Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1157616802","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5FeCTx","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"@dmitry-pilipenko Friendly ping üòÉ ","createdAt":"2022-06-24T11:56:53Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1165501681","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5F4DJn","author":{"login":"corelix"},"authorAssociation":"NONE","body":"@rustatian I haven't been able to reproduce yet.\r\nOur workflows generated dynamically from user settings and I'm trying to find what is causing this problem. It hasn't been done locally yet.\r\nOne of the main differences: locally I deployed using docker-compose, and in production using a k8s.\r\n\r\nThe problem appears only for flows where we waiting signal with a timeout. Do you have any hypotheses that might help?\r\n```\r\n        yield Temporal::awaitWithTimeout(\r\n            $interval = CarbonInterval::minutes(30),\r\n            fn () => $this->answer !== null\r\n        );\r\n        if ($this->answer === null) {\r\n            throw new ReplyTimeout($interval);\r\n        }\r\n```\r\n\r\nIt's execute in a child workflow. After that parent workflow got error: \r\n\r\n```json\r\n{\r\n    \"eventTime\": \"2022-07-01T10:17:00.000Z\",\r\n    \"eventType\": \"WorkflowTaskStarted\",\r\n    \"eventId\": \"26\",\r\n    \"details\": {\r\n      \"scheduledEventId\": \"25\",\r\n      \"identity\": \"default:3bfa8009-a174-424b-a20c-2eb5f01c93e8\",\r\n      \"requestId\": \"3bb264c4-76ac-4962-a6be-8d128650c38c\",\r\n      \"eventId\": \"26\",\r\n      \"eventType\": \"WorkflowTaskStarted\",\r\n      \"kvps\": [\r\n        {\r\n          \"key\": \"eventTime\",\r\n          \"value\": \"Jul 1st 1:17:00 pm\"\r\n        },\r\n        {\r\n          \"key\": \"eventId\",\r\n          \"value\": \"26\"\r\n        },\r\n        {\r\n          \"key\": \"scheduledEventId\",\r\n          \"value\": \"25\"\r\n        },\r\n        {\r\n          \"key\": \"identity\",\r\n          \"value\": \"default:3bfa8009-a174-424b-a20c-2eb5f01c93e8\"\r\n        },\r\n        {\r\n          \"key\": \"requestId\",\r\n          \"value\": \"3bb264c4-76ac-4962-a6be-8d128650c38c\"\r\n        }\r\n      ],\r\n      \"eventTime\": \"Jul 1st 1:17:00 pm\"\r\n    },\r\n    \"eventTimeDisplay\": \"Jul 1st 1:17:00 pm\",\r\n    \"timeElapsedDisplay\": \"15s\",\r\n    \"eventSummary\": {\r\n      \"requestId\": \"3bb264c4-76ac-4962-a6be-8d128650c38c\",\r\n      \"eventId\": \"26\",\r\n      \"eventType\": \"WorkflowTaskStarted\",\r\n      \"kvps\": [\r\n        {\r\n          \"key\": \"requestId\",\r\n          \"value\": \"3bb264c4-76ac-4962-a6be-8d128650c38c\"\r\n        }\r\n      ]\r\n    },\r\n    \"eventFullDetails\": {\r\n      \"scheduledEventId\": \"25\",\r\n      \"identity\": \"default:3bfa8009-a174-424b-a20c-2eb5f01c93e8\",\r\n      \"requestId\": \"3bb264c4-76ac-4962-a6be-8d128650c38c\",\r\n      \"eventId\": \"26\",\r\n      \"eventType\": \"WorkflowTaskStarted\",\r\n      \"kvps\": [\r\n        {\r\n          \"key\": \"scheduledEventId\",\r\n          \"value\": \"25\"\r\n        },\r\n        {\r\n          \"key\": \"identity\",\r\n          \"value\": \"default:3bfa8009-a174-424b-a20c-2eb5f01c93e8\"\r\n        },\r\n        {\r\n          \"key\": \"requestId\",\r\n          \"value\": \"3bb264c4-76ac-4962-a6be-8d128650c38c\"\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  {\r\n    \"eventTime\": \"2022-07-01T10:17:00.000Z\",\r\n    \"eventType\": \"WorkflowTaskFailed\",\r\n    \"eventId\": \"27\",\r\n    \"details\": {\r\n      \"scheduledEventId\": \"25\",\r\n      \"startedEventId\": \"26\",\r\n      \"cause\": \"WORKFLOW_TASK_FAILED_CAUSE_NON_DETERMINISTIC_ERROR\",\r\n      \"failure\": {\r\n        \"message\": \"unknown command CommandType: ChildWorkflow, ID: 31ab4b00-a18a-44e8-851a-baf9de182600, possible causes are nondeterministic workflow definition code or incompatible change in the workflow definition\",\r\n        \"source\": \"GoSDK\",\r\n        \"stackTrace\": \"process event for default [panic]:\\ngo.temporal.io/sdk/internal.panicIllegalState(...)\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_decision_state_machine.go:409\\ngo.temporal.io/sdk/internal.(*commandsHelper).getCommand(0x8?, {0x3?, {0xc000bc2d50?, 0x0?}})\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_decision_state_machine.go:881 +0x109\\ngo.temporal.io/sdk/internal.(*commandsHelper).handleStartChildWorkflowExecutionInitiated(0x7f7cc1a01f18?, {0xc000bc2d50?, 0xc000196000?})\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_decision_state_machine.go:1124 +0x29\\ngo.temporal.io/sdk/internal.(*workflowExecutionEventHandlerImpl).ProcessEvent(0xc001373770, 0xc00156aa00, 0xd8?, 0x0)\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_event_handlers.go:905 +0x6ae\\ngo.temporal.io/sdk/internal.(*workflowExecutionContextImpl).ProcessWorkflowTask(0xc0007f9080, 0xc000559680)\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_task_handlers.go:902 +0xd68\\ngo.temporal.io/sdk/internal.(*workflowTaskHandlerImpl).ProcessWorkflowTask(0xc000a40c60, 0xc000559680, 0xc000702510)\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_task_handlers.go:749 +0x485\\ngo.temporal.io/sdk/internal.(*workflowTaskPoller).processWorkflowTask(0xc0005b3a00, 0xc000559680)\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_task_pollers.go:284 +0x2cd\\ngo.temporal.io/sdk/internal.(*workflowTaskPoller).ProcessTask(0xc0005b3a00, {0x16063c0?, 0xc000559680?})\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_task_pollers.go:255 +0x6c\\ngo.temporal.io/sdk/internal.(*baseWorker).processTask(0xc00067e8c0, {0x1605f80?, 0xc00047f9c0})\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_worker_base.go:400 +0x167\\ncreated by go.temporal.io/sdk/internal.(*baseWorker).runTaskDispatcher\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_worker_base.go:305 +0xb5\",\r\n        \"cause\": null,\r\n        \"applicationFailureInfo\": {\r\n          \"type\": \"PanicError\",\r\n          \"nonRetryable\": true,\r\n          \"details\": null\r\n        },\r\n        \"failureInfo\": \"applicationFailureInfo\"\r\n      },\r\n      \"identity\": \"default:3bfa8009-a174-424b-a20c-2eb5f01c93e8\",\r\n      \"baseRunId\": \"\",\r\n      \"newRunId\": \"\",\r\n      \"forkEventVersion\": \"0\",\r\n      \"binaryChecksum\": \"23bc61c98cc56611c0691d0c4fd23834\",\r\n      \"eventId\": \"27\",\r\n      \"eventType\": \"WorkflowTaskFailed\",\r\n      \"kvps\": [\r\n        {\r\n          \"key\": \"eventTime\",\r\n          \"value\": \"Jul 1st 1:17:00 pm\"\r\n        },\r\n        {\r\n          \"key\": \"eventId\",\r\n          \"value\": \"27\"\r\n        },\r\n        {\r\n          \"key\": \"scheduledEventId\",\r\n          \"value\": \"25\"\r\n        },\r\n        {\r\n          \"key\": \"startedEventId\",\r\n          \"value\": \"26\"\r\n        },\r\n        {\r\n          \"key\": \"cause\",\r\n          \"value\": \"WORKFLOW_TASK_FAILED_CAUSE_NON_DETERMINISTIC_ERROR\"\r\n        },\r\n        {\r\n          \"key\": \"failure\",\r\n          \"value\": \"PanicError: unknown command CommandType: ChildWorkflow, ID: 31ab4b00-a18a-44e8-851a-baf9de182600, possible causes are nondeterministic workflow definition code or incompatible change in the workflow definition \\nprocess event for default [panic]:\\ngo.temporal.io/sdk/internal.panicIllegalState(...)\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_decision_state_machine.go:409\\ngo.temporal.io/sdk/internal.(*commandsHelper).getCommand(0x8?, {0x3?, {0xc000bc2d50?, 0x0?}})\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_decision_state_machine.go:881 +0x109\\ngo.temporal.io/sdk/internal.(*commandsHelper).handleStartChildWorkflowExecutionInitiated(0x7f7cc1a01f18?, {0xc000bc2d50?, 0xc000196000?})\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_decision_state_machine.go:1124 +0x29\\ngo.temporal.io/sdk/internal.(*workflowExecutionEventHandlerImpl).ProcessEvent(0xc001373770, 0xc00156aa00, 0xd8?, 0x0)\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_event_handlers.go:905 +0x6ae\\ngo.temporal.io/sdk/internal.(*workflowExecutionContextImpl).ProcessWorkflowTask(0xc0007f9080, 0xc000559680)\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_task_handlers.go:902 +0xd68\\ngo.temporal.io/sdk/internal.(*workflowTaskHandlerImpl).ProcessWorkflowTask(0xc000a40c60, 0xc000559680, 0xc000702510)\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_task_handlers.go:749 +0x485\\ngo.temporal.io/sdk/internal.(*workflowTaskPoller).processWorkflowTask(0xc0005b3a00, 0xc000559680)\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_task_pollers.go:284 +0x2cd\\ngo.temporal.io/sdk/internal.(*workflowTaskPoller).ProcessTask(0xc0005b3a00, {0x16063c0?, 0xc000559680?})\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_task_pollers.go:255 +0x6c\\ngo.temporal.io/sdk/internal.(*baseWorker).processTask(0xc00067e8c0, {0x1605f80?, 0xc00047f9c0})\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_worker_base.go:400 +0x167\\ncreated by go.temporal.io/sdk/internal.(*baseWorker).runTaskDispatcher\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_worker_base.go:305 +0xb5\"\r\n        },\r\n        {\r\n          \"key\": \"identity\",\r\n          \"value\": \"default:3bfa8009-a174-424b-a20c-2eb5f01c93e8\"\r\n        },\r\n        {\r\n          \"key\": \"baseRunId\",\r\n          \"value\": \"\"\r\n        },\r\n        {\r\n          \"key\": \"newRunId\",\r\n          \"value\": \"\"\r\n        },\r\n        {\r\n          \"key\": \"forkEventVersion\",\r\n          \"value\": \"0\"\r\n        },\r\n        {\r\n          \"key\": \"binaryChecksum\",\r\n          \"value\": \"23bc61c98cc56611c0691d0c4fd23834\"\r\n        }\r\n      ],\r\n      \"eventTime\": \"Jul 1st 1:17:00 pm\"\r\n    },\r\n    \"eventTimeDisplay\": \"Jul 1st 1:17:00 pm\",\r\n    \"timeElapsedDisplay\": \"15s\",\r\n    \"eventSummary\": {\r\n      \"message\": \"unknown command CommandType: ChildWorkflow, ID: 31ab4b00-a18a-44e8-851a-baf9de182600, possible causes are nondeterministic workflow definition code or incompatible change in the workflow definition\",\r\n      \"eventId\": \"27\",\r\n      \"eventType\": \"WorkflowTaskFailed\",\r\n      \"kvps\": [\r\n        {\r\n          \"key\": \"message\",\r\n          \"value\": \"unknown command CommandType: ChildWorkflow, ID: 31ab4b00-a18a-44e8-851a-baf9de182600, possible causes are nondeterministic workflow definition code or incompatible change in the workflow definition\"\r\n        }\r\n      ]\r\n    },\r\n    \"eventFullDetails\": {\r\n      \"scheduledEventId\": \"25\",\r\n      \"startedEventId\": \"26\",\r\n      \"cause\": \"WORKFLOW_TASK_FAILED_CAUSE_NON_DETERMINISTIC_ERROR\",\r\n      \"failure\": {\r\n        \"message\": \"unknown command CommandType: ChildWorkflow, ID: 31ab4b00-a18a-44e8-851a-baf9de182600, possible causes are nondeterministic workflow definition code or incompatible change in the workflow definition\",\r\n        \"source\": \"GoSDK\",\r\n        \"stackTrace\": \"process event for default [panic]:\\ngo.temporal.io/sdk/internal.panicIllegalState(...)\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_decision_state_machine.go:409\\ngo.temporal.io/sdk/internal.(*commandsHelper).getCommand(0x8?, {0x3?, {0xc000bc2d50?, 0x0?}})\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_decision_state_machine.go:881 +0x109\\ngo.temporal.io/sdk/internal.(*commandsHelper).handleStartChildWorkflowExecutionInitiated(0x7f7cc1a01f18?, {0xc000bc2d50?, 0xc000196000?})\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_decision_state_machine.go:1124 +0x29\\ngo.temporal.io/sdk/internal.(*workflowExecutionEventHandlerImpl).ProcessEvent(0xc001373770, 0xc00156aa00, 0xd8?, 0x0)\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_event_handlers.go:905 +0x6ae\\ngo.temporal.io/sdk/internal.(*workflowExecutionContextImpl).ProcessWorkflowTask(0xc0007f9080, 0xc000559680)\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_task_handlers.go:902 +0xd68\\ngo.temporal.io/sdk/internal.(*workflowTaskHandlerImpl).ProcessWorkflowTask(0xc000a40c60, 0xc000559680, 0xc000702510)\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_task_handlers.go:749 +0x485\\ngo.temporal.io/sdk/internal.(*workflowTaskPoller).processWorkflowTask(0xc0005b3a00, 0xc000559680)\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_task_pollers.go:284 +0x2cd\\ngo.temporal.io/sdk/internal.(*workflowTaskPoller).ProcessTask(0xc0005b3a00, {0x16063c0?, 0xc000559680?})\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_task_pollers.go:255 +0x6c\\ngo.temporal.io/sdk/internal.(*baseWorker).processTask(0xc00067e8c0, {0x1605f80?, 0xc00047f9c0})\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_worker_base.go:400 +0x167\\ncreated by go.temporal.io/sdk/internal.(*baseWorker).runTaskDispatcher\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_worker_base.go:305 +0xb5\",\r\n        \"cause\": null,\r\n        \"applicationFailureInfo\": {\r\n          \"type\": \"PanicError\",\r\n          \"nonRetryable\": true,\r\n          \"details\": null\r\n        },\r\n        \"failureInfo\": \"applicationFailureInfo\"\r\n      },\r\n      \"identity\": \"default:3bfa8009-a174-424b-a20c-2eb5f01c93e8\",\r\n      \"baseRunId\": \"\",\r\n      \"newRunId\": \"\",\r\n      \"forkEventVersion\": \"0\",\r\n      \"binaryChecksum\": \"23bc61c98cc56611c0691d0c4fd23834\",\r\n      \"eventId\": \"27\",\r\n      \"eventType\": \"WorkflowTaskFailed\",\r\n      \"kvps\": [\r\n        {\r\n          \"key\": \"scheduledEventId\",\r\n          \"value\": \"25\"\r\n        },\r\n        {\r\n          \"key\": \"startedEventId\",\r\n          \"value\": \"26\"\r\n        },\r\n        {\r\n          \"key\": \"cause\",\r\n          \"value\": \"WORKFLOW_TASK_FAILED_CAUSE_NON_DETERMINISTIC_ERROR\"\r\n        },\r\n        {\r\n          \"key\": \"failure\",\r\n          \"value\": \"PanicError: unknown command CommandType: ChildWorkflow, ID: 31ab4b00-a18a-44e8-851a-baf9de182600, possible causes are nondeterministic workflow definition code or incompatible change in the workflow definition \\nprocess event for default [panic]:\\ngo.temporal.io/sdk/internal.panicIllegalState(...)\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_decision_state_machine.go:409\\ngo.temporal.io/sdk/internal.(*commandsHelper).getCommand(0x8?, {0x3?, {0xc000bc2d50?, 0x0?}})\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_decision_state_machine.go:881 +0x109\\ngo.temporal.io/sdk/internal.(*commandsHelper).handleStartChildWorkflowExecutionInitiated(0x7f7cc1a01f18?, {0xc000bc2d50?, 0xc000196000?})\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_decision_state_machine.go:1124 +0x29\\ngo.temporal.io/sdk/internal.(*workflowExecutionEventHandlerImpl).ProcessEvent(0xc001373770, 0xc00156aa00, 0xd8?, 0x0)\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_event_handlers.go:905 +0x6ae\\ngo.temporal.io/sdk/internal.(*workflowExecutionContextImpl).ProcessWorkflowTask(0xc0007f9080, 0xc000559680)\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_task_handlers.go:902 +0xd68\\ngo.temporal.io/sdk/internal.(*workflowTaskHandlerImpl).ProcessWorkflowTask(0xc000a40c60, 0xc000559680, 0xc000702510)\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_task_handlers.go:749 +0x485\\ngo.temporal.io/sdk/internal.(*workflowTaskPoller).processWorkflowTask(0xc0005b3a00, 0xc000559680)\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_task_pollers.go:284 +0x2cd\\ngo.temporal.io/sdk/internal.(*workflowTaskPoller).ProcessTask(0xc0005b3a00, {0x16063c0?, 0xc000559680?})\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_task_pollers.go:255 +0x6c\\ngo.temporal.io/sdk/internal.(*baseWorker).processTask(0xc00067e8c0, {0x1605f80?, 0xc00047f9c0})\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_worker_base.go:400 +0x167\\ncreated by go.temporal.io/sdk/internal.(*baseWorker).runTaskDispatcher\\n\\tgo.temporal.io/sdk@v1.15.0/internal/internal_worker_base.go:305 +0xb5\"\r\n        },\r\n        {\r\n          \"key\": \"identity\",\r\n          \"value\": \"default:3bfa8009-a174-424b-a20c-2eb5f01c93e8\"\r\n        },\r\n        {\r\n          \"key\": \"baseRunId\",\r\n          \"value\": \"\"\r\n        },\r\n        {\r\n          \"key\": \"newRunId\",\r\n          \"value\": \"\"\r\n        },\r\n        {\r\n          \"key\": \"forkEventVersion\",\r\n          \"value\": \"0\"\r\n        },\r\n        {\r\n          \"key\": \"binaryChecksum\",\r\n          \"value\": \"23bc61c98cc56611c0691d0c4fd23834\"\r\n        }\r\n      ]\r\n    }\r\n  }\r\n```","createdAt":"2022-07-01T13:00:06Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1172320871","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5F4EVJ","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"@dmitry-pilipenko üëãüèª \r\nMight be you use a different RR version locally and in the k8s?\r\nWe had this issue in our past versions.","createdAt":"2022-07-01T13:04:43Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1172325705","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5F4JuZ","author":{"login":"corelix"},"authorAssociation":"NONE","body":"> @dmitry-pilipenko üëãüèª\r\n> Might be you use a different RR version locally and in the k8s?\r\n> We had this issue in our past versions.\r\n\r\n@rustatian versions are completely identical.\r\nk8s:\r\n<img width=\"486\" alt=\"Screenshot 2022-07-01 at 16 21 29\" src=\"https://user-images.githubusercontent.com/59166948/176902932-f37f056f-6b02-4ef3-b42a-349b8f677081.png\">\r\n<img width=\"684\" alt=\"Screenshot 2022-07-01 at 16 23 06\" src=\"https://user-images.githubusercontent.com/59166948/176903186-7a92a5d8-7a22-4143-bd57-fdafd44865a6.png\">\r\n\r\ndocker-compose:\r\n<img width=\"790\" alt=\"Screenshot 2022-07-01 at 16 25 04\" src=\"https://user-images.githubusercontent.com/59166948/176903525-a842fdaf-8dfd-4aa4-a29a-cd8bcadf5bd9.png\">\r\n<img width=\"464\" alt=\"Screenshot 2022-07-01 at 16 25 31\" src=\"https://user-images.githubusercontent.com/59166948/176903597-d1bbd334-dc24-4465-adb8-079545efce59.png\">\r\n\r\n","createdAt":"2022-07-01T13:25:43Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1172347801","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5F4MM7","author":{"login":"corelix"},"authorAssociation":"NONE","body":"@rustatian Now I found a case when there was no awaiting with a timeout in the flow, but it still cause the problem.\r\nI exported the workflow logs from the admin:\r\n[c0818c95 9669 4de5 ab5e 855e2de2f2d8 - e121f3e0-3df8-4e25-b0c0-d0e5de289955.json.zip](https://github.com/temporalio/sdk-php/files/9029226/c0818c95.9669.4de5.ab5e.855e2de2f2d8.-.e121f3e0-3df8-4e25-b0c0-d0e5de289955.json.zip)\r\n\r\n","createdAt":"2022-07-01T13:36:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1172357947","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5F4NSK","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"@dmitry-pilipenko Thanks for the logs, but to help you, we need to reproduce this issue. Please, as I suggested earlier, create a repository with a reproducible sample that includes `.rr.yaml` and sample minimum app. It can either be in Docker or run with `rr serve`.","createdAt":"2022-07-01T13:41:00Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1172362378","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5MnBDB","author":{"login":"Zylius"},"authorAssociation":"CONTRIBUTOR","body":"IDK if this maybe of help, but I've experienced the same issue twice, both times our pods were lacking available memory. IDK how this happens and if it would be the same to you.","createdAt":"2022-10-20T10:25:51Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1285296321","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5MnBiG","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"> IDK if this maybe of help, but I've experienced the same issue twice, both times our pods were lacking available memory. IDK how this happens and if it would be the same to you.\r\n\r\nDo you have a supervisor in the RR's configuration?","createdAt":"2022-10-20T10:27:21Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1285298310","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5MnCld","author":{"login":"Zylius"},"authorAssociation":"CONTRIBUTOR","body":"Nope, we probably should, but after increasing memory everything is stable, handling 4+Million workflows a day for half a year now. I'll enable it when I get the chance.","createdAt":"2022-10-20T10:29:26Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1285302621","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5MnCvN","author":{"login":"Zylius"},"authorAssociation":"CONTRIBUTOR","body":"It's not that PHP or RR was leaking memory, we falsely set the memory too low constraining the pod.","createdAt":"2022-10-20T10:30:02Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1285303245","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5MnDH_","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"> Nope, we probably should, but after increasing memory everything is stable, handling 4+Million workflows a day for half a year now. I'll enable it when I get the chance.\r\n\r\nwow, that's big numbers üòÆ\r\n\r\nMight be OOM kill the workflow worker?","createdAt":"2022-10-20T10:31:35Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1285304831","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5MnD1m","author":{"login":"Zylius"},"authorAssociation":"CONTRIBUTOR","body":"Yeah, it should kill the whole pod cause of OOM, but it gets into a weird state before that with `undefined request`. I haven't investigated it enough to reproduce it :( ","createdAt":"2022-10-20T10:34:29Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1285307750","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5MnEZp","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"Ok, thanks. Please keep us updated; if we can reproduce this weird issue, we will fix it ASAP.","createdAt":"2022-10-20T10:36:52Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HEART","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1285310057","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5MnGFV","author":{"login":"Zylius"},"authorAssociation":"CONTRIBUTOR","body":"I'll try to reproduce it with OOM when I get some free time :D :pray: ","createdAt":"2022-10-20T10:43:56Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}},{"content":"HEART","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1285316949","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5OAFAU","author":{"login":"cv65kr"},"authorAssociation":"CONTRIBUTOR","body":"@rustatian Hi, I noticed same issue, `sync_worker_exec: SoftJobError:\\\\n\\\\tsync_worker_exec_payload: LogicException: Got the response to undefined request 9022`\r\n\r\nI can say that, container was not restarted from 2 weeks. I have a memory limit per worker (temporal.activities.supervisor.max_worker_memory).\r\n\r\nLooks like there is memory leak somewhere, because memory is not released after execution - keeps growing.\r\n<img width=\"815\" alt=\"image\" src=\"https://user-images.githubusercontent.com/9404962/200824302-005347d5-d665-458c-aca3-61e1290a1e2e.png\">\r\n\r\n--\r\nUpdate:\r\nLooks like in_memory `request` property is not cleared properly:\r\n<img width=\"1241\" alt=\"image\" src=\"https://user-images.githubusercontent.com/9404962/200839094-ad6886e5-e3d4-4f29-9228-111e6a2a4944.png\">\r\n\r\nMin reproduce:\r\n1. .rr\r\n```\r\nversion: \"2.7\"\r\n# Application configuration\r\nrpc:\r\n    listen: tcp://127.0.0.1:6001\r\n\r\nserver:\r\n    command: \"php worker.php\"\r\n\r\n# Workflow and activity mesh service\r\ntemporal:\r\n    address: \"host.docker.internal:7233\"\r\n    activities:\r\n      num_workers: 1\r\n      supervisor:\r\n        max_worker_memory: 64\r\n      debug: true\r\n\r\nlogs:\r\n  level: debug\r\n  mode: development\r\n\r\nkv:\r\n    test:\r\n        driver: memory\r\n        config:\r\n            interval: 10\r\n\r\n```\r\n\r\n2. Add group `xxx` annotation to random test, I added to SagaTestCase - testGetResult.\r\n3. Add breakpoint on `src/Internal/Transport/Client.php` L135 - `unset($this->requests[$id]);` and wait 5 sec\r\n4. Run `vendor/bin/phpunit --group xxx --repeat 10`\r\n\r\n\r\nThe problem could be that PHP in_memory property is not shared between workers, so multiple workers can receive same request and by that property in workers are not cleared properly.\r\nPossible solution could be add expire time of request per worker.","createdAt":"2022-11-09T11:59:39Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1308643348","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5OA5Jg","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"Hey @cv65kr üëãüèª \r\n\r\nThanks for the detailed report üëçüèª. We have a few guesses on how to fix that. @roxblnfk is working on that now.","createdAt":"2022-11-09T14:34:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"EYES","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1308856928","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5PQxw9","author":{"login":"roxblnfk"},"authorAssociation":"COLLABORATOR","body":"@cv65kr hello. Could you provide some information about that image?\r\n\r\n<img width=\"815\" alt=\"image\" src=\"https://user-images.githubusercontent.com/9404962/200824302-005347d5-d665-458c-aca3-61e1290a1e2e.png\">\r\n\r\nWhat does mean each curve?  \r\nThe gray curve is a workflow worker memory usage and the blue curve is an activity worker memory usage, right?\r\n\r\nOr both are the same but in different scale? :) I need to know which worker is in the chart.\r\n","createdAt":"2022-11-28T21:45:34Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1329798205","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5PiYFz","author":{"login":"cv65kr"},"authorAssociation":"CONTRIBUTOR","body":"@roxblnfk Hi, sorry for late response, but I missed somehow notification. Both are ECS memory utilization for worker (by worker I mean container with Roadrunner which using only Temporal plugin). I don't have metrics directly from Roadrunner because it not supporting Datadog.\r\n\r\nAnd yes it just a different scale. Sorry for being not descriptive, my fault üòû \r\n\r\n","createdAt":"2022-12-01T20:32:06Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1334411635","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5PikZy","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"Hey @cv65kr üëãüèª \r\nCould you please try to reduce the `cache_size` option in the RR's configuration: https://github.com/roadrunner-server/roadrunner/blob/master/.rr.yaml#L182?\r\n\r\nTemporal saves the whole our `workflow definition` structure, which is pretty big. Could you please set it to, let's say, 10 and observe memory consumption?","createdAt":"2022-12-01T21:22:43Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1334462066","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5Pil2B","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"> I don't have metrics directly from Roadrunner because it not supporting Datadog\r\n\r\nYou may use the metrics plugin and get the information directly about the Go runtime. Unfortunately, I think we should not rely on `uber/tally` since they are veeeery slow in reviewing PRs that they are not interested in.\r\n","createdAt":"2022-12-01T21:28:02Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1334467969","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5Pil88","author":{"login":"cv65kr"},"authorAssociation":"CONTRIBUTOR","body":"Hi @rustatian I will try on monday","createdAt":"2022-12-01T21:28:23Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"ROCKET","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1334468412","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5P5w78","author":{"login":"cv65kr"},"authorAssociation":"CONTRIBUTOR","body":"@rustatian Sorry for delay, I needed couple days to ensure that those changes not generate any issues.\r\nI tested it with workflow like:\r\n```php\r\n#[WorkflowMethod]\r\npublic function start(): iterable\r\n{\r\n    while(true) {\r\n        $result = yield $this->activity->execute();\r\n            if ($result) {\r\n                break;\r\n             }\r\n    yield Workflow::timer(CarbonInterval::minutes(2));\r\n   }\r\n}\r\n``` \r\nIt's kinda simulation of polling status.\r\n\r\nSo e.g. in last 11 hours it growing up 27.23% to 28.02% and still growing up. With two enabled workflows. (Numbers are small because traffic is small).\r\n\r\nWill try to run it with higher traffic.","createdAt":"2022-12-07T07:57:02Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1340542716","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5P8k-3","author":{"login":"cv65kr"},"authorAssociation":"CONTRIBUTOR","body":"@rustatian I did more tests and on screenshot I marked places when I triggered workflows (20 for one time). Still looks like memory is not released properly because I expected that memory will goes down instead of straight line (there wasn't any awaiting workflows/activities).\r\n\r\nThis time chart is based on metrics from RR.\r\n\r\n![image](https://user-images.githubusercontent.com/9404962/206242875-18a80b1b-e6a3-4e08-ba3b-6428af3b508d.png)\r\n\r\n\r\nConfiguration:\r\n```\r\nmetrics:\r\n  address: 127.0.0.1:8234\r\n\r\ntemporal:\r\n    address: ${TEMPORAL_CLI_ADDRESS}\r\n    cache_size: 10\r\n    activities:\r\n        num_workers: 8\r\n        debug: true\r\n    metrics:\r\n        driver: prometheus\r\n        address: 127.0.0.1:8233\r\n\r\n````","createdAt":"2022-12-07T17:00:37Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1341280183","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5P8lob","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"Thanks @cv65kr üëçüèª \r\n\r\n@roxblnfk Seems like we leak (I mean, PHP) üò¢","createdAt":"2022-12-07T17:02:27Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1341282843","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5QI0Eu","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"@cv65kr Hey üëãüèª \r\n\r\nWhat is your temporal PHP SDK version? And PHP version?\r\n\r\nI tried to reproduce the memory leak on the latest version, and it seems that the memory usage is pretty stable.","createdAt":"2022-12-09T16:08:11Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1344487726","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5QI3IW","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"I missed that, but do not use the `debug` option with the activities pool while testing. RR, in that case, allocates a worker on-demand before the request, which is unsuitable for memory testing.","createdAt":"2022-12-09T16:18:42Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1344500246","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5QI8ZD","author":{"login":"cv65kr"},"authorAssociation":"CONTRIBUTOR","body":"Hi @rustatian \r\n\r\nI am using the v2.3.1 of SDK and PHP 8.1.\r\n\r\nI tried today without debug mode as well, and memory is still not released.\r\n<img width=\"534\" alt=\"image\" src=\"https://user-images.githubusercontent.com/9404962/206749511-527b74b9-5c9c-413f-9997-4aff54eb4dfa.png\">\r\n\r\nYou can tell me how you tested it? Let's compare our steps.","createdAt":"2022-12-09T16:40:24Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1344521795","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5QI9Ny","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"But what is the scale of that chart? What is on Y-axis?","createdAt":"2022-12-09T16:44:03Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1344525170","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5QI9h-","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"I used that workflow: https://github.com/temporalio/sdk-php/issues/177#issuecomment-1340542716\r\nStarted one every second for more than 3h. The config is the same as yours, except for the `debug` mode.\r\n\r\nFor sure, the memory grows when everything is started until the GO's GC is called, for example. But it should be stable then. \r\n\r\nHere is, for example, GO's RSS memory:\r\n![image](https://user-images.githubusercontent.com/8040338/206751010-302a5b89-7150-4db8-9842-5cf269229df0.png)\r\n\r\nAnd this is the worker's memory and RR's memory (virtual):\r\n![image](https://user-images.githubusercontent.com/8040338/206751134-aa22d4e2-7518-4935-89fb-5f24831a13f3.png)\r\n ","createdAt":"2022-12-09T16:45:25Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1344526462","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5QI95f","author":{"login":"cv65kr"},"authorAssociation":"CONTRIBUTOR","body":"@rustatian sorry crazy day \r\n<img width=\"1714\" alt=\"image\" src=\"https://user-images.githubusercontent.com/9404962/206750881-5284f1b1-0e4b-4a47-82b8-181215d1fd06.png\">\r\n\r\nAnd I started around 40 workflows on my machine during this time","createdAt":"2022-12-09T16:47:06Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1344527967","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5QI-js","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"And, this is fine. It's only 4MB for the PHP workers (all as far as I understand) and RR.\r\n\r\nThis is my bench env: \r\n![image](https://user-images.githubusercontent.com/8040338/206751400-1767d936-2cd3-4b4e-86eb-41b1fa331fa6.png)\r\n\r\nTemporal + RR + workflows (new one every 800ms).","createdAt":"2022-12-09T16:50:12Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1344530668","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5QI_Os","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"I'll leave this bench overnight; let's see after that.","createdAt":"2022-12-09T16:53:22Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1344533420","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5QJLnV","author":{"login":"cv65kr"},"authorAssociation":"CONTRIBUTOR","body":"@rustatian I really need vacations, ofc nothing happen on your machine because I sent you wrong workflow example. My big apologies üò¢ \r\n\r\nI prepared repo with my test code, in README you will find all necessary informations. Now we should be on the same page.\r\n\r\nhttps://github.com/cv65kr/temporal-sdk-leaks\r\n\r\nIf you need we can talk about that on some communicator.\r\n\r\n<img width=\"1714\" alt=\"image\" src=\"https://user-images.githubusercontent.com/9404962/206762003-91882f0a-aea1-47be-bee6-ec2b87ea4dfe.png\">\r\n","createdAt":"2022-12-09T17:41:42Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1344584149","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5QJTb8","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"We all need some vacation üòÜ Sure, I'll try to run your sample üëçüèª Thanks ‚ö° ","createdAt":"2022-12-09T18:15:43Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"LAUGH","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1344616188","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5QJzuE","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"@cv65kr Yeah, it seems that you're right, 1 hour: 40->111Mb... ~2200 executions. Thanks, we have at least test for that now üëçüèª ","createdAt":"2022-12-09T20:25:50Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1344748420","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5QJ4zK","author":{"login":"cv65kr"},"authorAssociation":"CONTRIBUTOR","body":"@rustatian thanks for letting know. Do you think the problem is with RR or PHP SDK?","createdAt":"2022-12-09T20:51:44Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1344769226","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5QJ5mr","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"Definitely not with RR. According to a test, RR even won't need to run a GC (only forced GC every minute by the Go runtime). You may see that here on the screenshot: https://github.com/temporalio/sdk-php/issues/177#issuecomment-1344530668\r\n(thanks pointers üòÑ)\r\n\r\nThis is smt with the PHP workflow logic. Alex @roxblnfk is already looking into the issue. I guess this is not an easy case since the `temporal` in a PHP world is a pretty new concept, but we're working hard on resolving that case. Sorry for the inconvenience üò≠","createdAt":"2022-12-09T20:56:12Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1344772523","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5QJ8UG","author":{"login":"cv65kr"},"authorAssociation":"CONTRIBUTOR","body":"Right, good point. \r\n\r\nI profiled SDK yesterday and issue might be cause by circular references, so PHP GC is not able to clean memory properly. Thanks for your input and help, I really appreciate that üëç  We are on the same page. I will try to help as well and if I discover something I will immediately share with you guys. ","createdAt":"2022-12-09T21:06:29Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HEART","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1344783622","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5QltRn","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"When the worker fails due to the memory limit being exceeded, I see this error: \r\n![image](https://user-images.githubusercontent.com/8040338/207699777-fda5f7e1-b215-4d92-a7db-5c5338dc26e9.png)\r\n\r\nSo now, I can confirm that the memory leak is the reason for this error.","createdAt":"2022-12-14T19:50:46Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1352062055","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5QoT6G","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"Hey @Zylius @cv65kr üëãüèª\r\nWe've found the code, which smells, on it now üëçüèª ","createdAt":"2022-12-15T08:58:54Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HEART","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1352744582","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5QoUco","author":{"login":"cv65kr"},"authorAssociation":"CONTRIBUTOR","body":"Hi @rustatian Can you elaborate more? I am very curious üòÑ ","createdAt":"2022-12-15T09:00:57Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1352746792","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5QoVwh","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"The leak was in the timer's cleanup routine where `awaitWithTimeout` was triggered by the internal timeout.  @roxblnfk Will push the PR later (and you'll be able to review it üòÑ )","createdAt":"2022-12-15T09:05:00Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HEART","users":{"totalCount":3}}],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1352752161","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5QoWTk","author":{"login":"wolfy-j"},"authorAssociation":"COLLABORATOR","body":"Basically we have internal code to make sure that no floating timers left after leaving awaitWithTimeout. This optimization did not behave as expected, but we properly isolated the issue, so patch is on it's way.","createdAt":"2022-12-15T09:06:47Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HEART","users":{"totalCount":3}}],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1352754404","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5Qo1TD","author":{"login":"Zylius"},"authorAssociation":"CONTRIBUTOR","body":"Great job guys thank you ;)","createdAt":"2022-12-15T10:48:24Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HEART","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1352881347","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5QsPD-","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"@Zylius @cv65kr Guys, could you please set the `sticky_cache` size to, let's say, 10k? On the latest PHP-SDK version. The memory will grow since the WFs will be uploaded to the PHP worker, but it should stop growing.","createdAt":"2022-12-15T22:07:17Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1353773310","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5QuXCb","author":{"login":"cv65kr"},"authorAssociation":"CONTRIBUTOR","body":"@rustatian I had in the past 10k value because it was default one and I can tell that problem existed as well. I changed it according to your comment - https://github.com/temporalio/sdk-php/issues/177#issuecomment-1334462066","createdAt":"2022-12-16T07:31:58Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1354330267","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5QubKO","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"@cv65kr That's strange. Because for your test, If I use a 10k `cache_size`, the memory grows up to 60-70MB and stops growing while workflows are added and executed.","createdAt":"2022-12-16T07:55:08Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1354347150","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5Que5K","author":{"login":"cv65kr"},"authorAssociation":"CONTRIBUTOR","body":"@rustatian I have more complex workflows on my application and traffic is kinda huge, so that could be a reason why you are not able to reproduce it. I will try a bit later to test it with higher value for `cache_size`.\r\n\r\nFrom the other hand why setting from RR could have so big impact for PHP? My assumption is RR memory should be increased but for PHP nothing should happen because RR send signals with data from in memory cache.\r\n\r\nEven with disabled cache_size option it should not generate leaks. I mean it should work slower and processing less workflow/activities but memory should be on same level (from PHP side).","createdAt":"2022-12-16T08:11:47Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1354362442","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5QvauT","author":{"login":"wolfy-j"},"authorAssociation":"COLLABORATOR","body":"Okay, i **think** we did it (including reproducable env). So the problem was in collapsing of awaitWithTimeout in cases when workflow was interruped inside this statement (i.e. when you have more workflow running that your cache allows). Without cache offloading - no memory leaks, that's why it took so much time to figure out. \r\n\r\nVery interesting edge case, only reproducable for awaitWithTimeout (due to internal Promise chain), but **i think** we confirmed patch is working. Stay tuned.\r\n\r\n> Even with disabled cache_size option it should not generate leaks. I mean it should work slower and processing less workflow/activities but memory should be on same level (from PHP side).\r\n\r\nWell, at the end of the day, hitting cache_limit was the reason of the leak. We were not offloading past workflow from memory completelly.","createdAt":"2022-12-16T11:41:17Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1354607507","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5Qv_h9","author":{"login":"rustatian"},"authorAssociation":"COLLABORATOR","body":"I can confirm that I don't see that the memory grows after the fix (not released yet):\r\n![image](https://user-images.githubusercontent.com/8040338/208107095-c978ffe7-d078-4f74-9a68-abe2e7f4356c.png)\r\n\r\n\r\nEDIT: Even with the `cache_size` = 1.","createdAt":"2022-12-16T13:21:18Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1354758269","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5QwBHx","author":{"login":"cv65kr"},"authorAssociation":"CONTRIBUTOR","body":"Great news guys! Looking forward to see PR and generally way how you solved this issue","createdAt":"2022-12-16T13:27:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1354764785","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM5Q72ZO","author":{"login":"roxblnfk"},"authorAssociation":"COLLABORATOR","body":"Fixed in [v2.3.2](https://github.com/temporalio/sdk-php/releases/tag/v2.3.2)","createdAt":"2022-12-19T15:45:31Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/177#issuecomment-1357866574","viewerDidAuthor":false}],"createdAt":"2022-05-26T18:04:31Z","labels":[{"id":"MDU6TGFiZWwyMzM5NDMzMTc0","name":"Bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":177,"reactionGroups":[],"state":"CLOSED","title":"[Bug] Got the response to undefined request due to the memory leak in the WF worker","updatedAt":"2022-12-19T15:45:31Z","url":"https://github.com/temporalio/sdk-php/issues/177"}
