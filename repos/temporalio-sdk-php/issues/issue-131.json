{"assignees":[{"id":"MDQ6VXNlcjk5NTk3NjE=","login":"seregazhuk","name":"Sergey Zhuk","databaseId":0}],"author":{"id":"MDQ6VXNlcjk5NTk3NjE=","is_bot":false,"login":"seregazhuk","name":"Sergey Zhuk"},"body":"### Description of the bug\r\n\r\nTrying to execute the same activity method multiple times with different args inside my workflow. Sometimes the code inside the activity does not run, but in the history it says its completed (no exceptions thrown)...\r\n\r\n### To Reproduce\r\nworkflow code (activity mentioned is \"notifyCustomer\"):\r\n```php\r\n    #[WorkflowMethod]\r\n    public function create($projectPayload)\r\n    {\r\n        $customer = yield $this->externalActivities->execute(\"createCustomer\", [$projectPayload->hostName]);\r\n\r\n        $property = yield $this->externalActivities->execute(\"createProperty\", [$projectPayload->zipCode]);\r\n\r\n\r\n        $createProjectWorkflow = $this->externalProjectWorkflow->execute([false]);\r\n\r\n\r\n        yield Workflow::await(fn() => $this->projectOfferAccepted);\r\n        yield $this->notificationActivities->notifyCustomer(\"A cleaner accepted your project offer\");\r\n\r\n\r\n        yield Workflow::await(fn() => $this->projectPreCharged);\r\n        yield $this->notificationActivities->notifyCustomer(\"We reserved the project amount in you credit card\");\r\n\r\n\r\n        yield Workflow::await(fn() => $this->projectStarted);\r\n        yield $this->notificationActivities->notifyCustomer(\"The cleaner has started the project\");\r\n\r\n\r\n        yield Workflow::await(fn() => $this->projectFinished);\r\n        yield $this->notificationActivities->notifyCustomer(\"The cleaner has finished the project\");\r\n\r\n\r\n        yield Workflow::await(fn() => $this->paymentCreated);\r\n        yield $this->notificationActivities->notifyCustomer(\"We successfully charged your credit card with the project amount\");\r\n    }\r\n```\r\n\r\nActivity code:\r\n```php\r\n#[ActivityMethod]\r\n    public function notifyCustomer(string $message)\r\n    {\r\n        Notification::create([\r\n            \"message\" => $message\r\n        ]);\r\n\r\n        return Str::random();\r\n    }\r\n```\r\n\r\n### Screenshots/Terminal output\r\n\r\nHistory with one of those been successfully executed and the other returning null:\r\n<img width=\"1259\" alt=\"Captura de Tela 2021-12-10 Ã s 13 52 33\" src=\"https://user-images.githubusercontent.com/9959761/145711398-23dbe278-fafb-4ad6-a292-84a6f0410482.png\">\r\n### Additional context\r\n\r\nIt might be because of the same activity name method... When changed the code to this:\r\n\r\n```php\r\nyield Workflow::await(fn() => $this->projectOfferAccepted);\r\n        yield $this->notificationActivities->notifyCustomer(\"A cleaner accepted your project offer\");\r\n\r\n\r\n        yield Workflow::await(fn() => $this->projectPreCharged);\r\n        yield $this->notificationActivities->notifyCustomer2(\"We reserved the project amount in you credit card\");\r\n\r\n\r\n        yield Workflow::await(fn() => $this->projectStarted);\r\n        yield $this->notificationActivities->notifyCustomer3(\"The cleaner has started the project\");\r\n\r\n\r\n        yield Workflow::await(fn() => $this->projectFinished);\r\n        yield $this->notificationActivities->notifyCustomer4(\"The cleaner has finished the project\");\r\n\r\n\r\n        yield Workflow::await(fn() => $this->paymentCreated);\r\n        yield $this->notificationActivities->notifyCustomer5(\"We successfully charged your credit card with the project amount\");\r\n```\r\n\r\nAnd it worked (tried sometimes to make sure it was not a coincidence)\r\n\r\n","closedAt":"2022-01-30T19:47:50Z","comments":[{"id":"IC_kwDOEY5HBM49G5Gm","author":{"login":"seregazhuk"},"authorAssociation":"CONTRIBUTOR","body":"Closing due to no feedback.","createdAt":"2022-01-30T19:47:50Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/131#issuecomment-1025216934","viewerDidAuthor":false}],"createdAt":"2021-12-12T12:05:34Z","labels":[{"id":"MDU6TGFiZWwyMzM5NDMzMTc0","name":"Bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":131,"reactionGroups":[],"state":"CLOSED","title":"[Bug] Activity code is not invoked inside await","updatedAt":"2022-01-30T19:47:50Z","url":"https://github.com/temporalio/sdk-php/issues/131"}
