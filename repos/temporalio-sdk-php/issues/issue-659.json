{"assignees":[],"author":{"id":"MDQ6VXNlcjEyOTA5Mzkw","is_bot":false,"login":"designbyjr","name":""},"body":"# Bug Report: `Class \"Grpc\\ChannelCredentials\" not found` in Laravel/Artisan Context\n\n### What are you really trying to do?\n\nI'm integrating Laravel with Temporal workflows using the `keepsuit/laravel-temporal` package. The goal is to execute Temporal workflows from Laravel Artisan commands, specifically testing the connection between Laravel and a Temporal Docker container setup.\n\n### Describe the bug\n\nThe `Grpc\\ChannelCredentials` class is not found when accessing Temporal SDK through Laravel Artisan commands, despite the gRPC PHP extension being properly loaded and the class being accessible in direct PHP CLI contexts.\n\n**Error Message:**\n```\nClass \"Grpc\\ChannelCredentials\" not found\nFile: /vendor/temporal/sdk/src/Client/GRPC/BaseClient.php:74\n```\n\n**Key Observations:**\n- ✅ gRPC extension loads correctly in PHP CLI: `phpversion('grpc')` returns `1.75.0`\n- ✅ `class_exists('Grpc\\ChannelCredentials')` returns `true` in direct PHP scripts\n- ✅ Direct PHP scripts can successfully create Temporal clients and connect to Temporal server\n- ❌ Laravel Artisan commands fail with \"ChannelCredentials not found\" error\n- ❌ Issue persists even with `php -d auto_prepend_file= artisan` approach\n\n**Code causing the issue (BaseClient.php:74):**\n```php\n['credentials' => \\Grpc\\ChannelCredentials::createInsecure()],\n```\n\n### Minimal Reproduction\n\n**Working Direct PHP Script:**\n```php\n<?php\nrequire_once 'vendor/autoload.php';\nuse Temporal\\Client\\GRPC\\ServiceClient;\nuse Temporal\\Client\\WorkflowClient;\n\n// This works perfectly\n$client = WorkflowClient::create(ServiceClient::create('localhost:7233'));\necho \"Success: Temporal client created\\n\";\n```\n\n**Failing Laravel Artisan Command:**\n```php\n<?php\n// In a Laravel Artisan command\nuse Temporal\\Client\\WorkflowClientInterface;\n\npublic function handle() {\n    $client = app(WorkflowClientInterface::class); // Fails with ChannelCredentials error\n}\n```\n\n**Test Environment Setup:**\n- Temporal Server: Docker container on `localhost:7233` \n- Laravel: v12.x with `keepsuit/laravel-temporal: ^2.1`\n- MAMP Pro with PHP 8.3.0\n\n### Environment/Versions\n\n- **OS and processor:** M2 Mac (macOS) 15.6.1 (24G90)\n- **Temporal Server Version:** 1.29.0 (Docker: `temporalio/auto-setup:1.29.0`)\n- **Temporal SDK Version:** 2.15.1 (via `keepsuit/laravel-temporal: 2.1.3`)\n- **PHP Version:** 8.3.0 (MAMP Pro)\n- **gRPC Extension:** 1.75.0\n- **gRPC Composer Package:** 1.74.0\n- **Using Docker:** Yes, Temporal server runs in Docker containers\n- **Laravel Framework:** 12.x with Laravel Octane (FrankenPHP)\n\n### Additional context\n\n**Key Findings:**\n1. **Version Mismatch:** gRPC PHP extension (1.75.0) vs Composer package (1.74.0), though compatibility tests pass\n2. **Context Sensitivity:** The issue only occurs within Laravel/Artisan context, not direct PHP CLI\n3. **Autoloading:** Issue persists even when bypassing Laravel's auto_prepend_file\n4. **Extension Verification:** `extension_loaded('grpc')` and `get_declared_classes()` show gRPC is properly loaded\n5. **Laravel Integration:** Using `keepsuit/laravel-temporal` which has dependency constraint `temporal/sdk ~2.15.0`\n\n**Environment Details:**\n```bash\n# gRPC Extension Info\nphp -r \"echo phpversion('grpc');\"  # 1.75.0\nphp -r \"var_dump(class_exists('Grpc\\\\ChannelCredentials'));\"  # bool(true)\n\n# Composer Dependencies\ncomposer show temporal/sdk | grep versions    # 2.15.1\ncomposer show grpc/grpc | grep versions       # 1.74.0\ncomposer show keepsuit/laravel-temporal       # 2.1.3\n```\n\n**Hypothesis:** \nThere appears to be a namespace or autoloading conflict between Laravel's service container resolution and the gRPC extension's class registration, potentially related to how Laravel Octane/RoadRunner manages persistent processes and class loading.\n\n**Workaround Attempted:**\nUsing `php -d auto_prepend_file= artisan` to bypass Laravel's bootstrapping still results in the same error, suggesting the issue is deeper in the Laravel service container or autoloader interaction.","closedAt":"2025-10-13T06:59:11Z","comments":[{"id":"IC_kwDOEY5HBM7KbHVY","author":{"login":"roxblnfk"},"authorAssociation":"COLLABORATOR","body":"Hi! Since the SDK works fine in vanilla PHP and other bridges, this looks like a keepsuit/laravel-temporal bridge issue. Please open it at `keepsuit/laravel-temporal` instead.\n\nOf course, if the bridge maintainers confirm it's actually an SDK problem, don't hesitate to reopen this issue. Thanks!\n","createdAt":"2025-10-13T06:59:11Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/659#issuecomment-3396105560","viewerDidAuthor":false}],"createdAt":"2025-10-12T13:58:58Z","labels":[{"id":"MDU6TGFiZWwyMzM5NDMzMTc0","name":"Bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":659,"reactionGroups":[],"state":"CLOSED","title":"Bug Report: Class \"Grpc\\ChannelCredentials\" not found in Laravel/Artisan Context","updatedAt":"2025-10-13T07:01:11Z","url":"https://github.com/temporalio/sdk-php/issues/659"}
