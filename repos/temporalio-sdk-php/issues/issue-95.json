{"assignees":[],"author":{"id":"MDQ6VXNlcjc0Nzk0Nw==","is_bot":false,"login":"kozlice","name":"Valentin Nazarov"},"body":"**Describe the bug**\r\nNon-retryable exceptions list in RetryOptions does not work as expected.\r\n\r\n**To Reproduce**\r\nType hints (`@psalm-type ExceptionsList = array<class-string<\\Throwable>>`) and documentation (https://docs.temporal.io/docs/php-retries) tell us to provide a list of class names:\r\n```php\r\n$retryOptions = RetryOptions::new()\r\n    ->withNonRetryableExceptions([\r\n        \\InvalidArgumentException::class,\r\n        \\LogicException::class,\r\n    ])\r\n    ->withMaximumAttempts(3)\r\n    ->withInitialInterval(new \\DateInterval('PT5S'))\r\n    ->withBackoffCoefficient(1)\r\n;\r\n```\r\nThen I throw `RuntimeException` inside an activity method, which is not on the list. However, instead of an expected retry I saw this in Temporal web UI:\r\n```\r\nPanicError: assert(Assert::valuesInstanceOf($exceptions, \\Throwable::class)) (type: AssertionError, retryable: true) \r\n```\r\n\r\n**Expected behavior**\r\nProcess should respect the class list I provide.\r\n\r\n**Reason**\r\nThe problem is with the `Temporal\\Internal\\Assert::valuesSubclassOf` method. PHP's `instanceof` won't work here:\r\n\r\n```php\r\n\r\n$v = \\InvalidArgumentException::class;\r\n$of = \\Throwable::class;\r\n\r\nvar_dump($v instanceof $of); // false, because $v is just a string\r\nvar_dump(is_subclass_of($v, $of)); // true, it checks hierarchy internally\r\n```\r\n\r\nI'll submit a PR to fix this shortly.","closedAt":"2021-04-05T11:33:36Z","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDgxMzM1MDM0NA==","author":{"login":"SerafimArts"},"authorAssociation":"CONTRIBUTOR","body":"Fixed in #96","createdAt":"2021-04-05T11:33:34Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/95#issuecomment-813350344","viewerDidAuthor":false}],"createdAt":"2021-04-05T10:25:38Z","labels":[{"id":"MDU6TGFiZWwyMzM5NDMzMTc0","name":"Bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":95,"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"state":"CLOSED","title":"[Bug] Non-retryable exceptions list in RetryOptions does not work as expected","updatedAt":"2021-04-05T11:33:36Z","url":"https://github.com/temporalio/sdk-php/issues/95"}
