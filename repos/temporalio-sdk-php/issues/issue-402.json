{"assignees":[{"id":"MDQ6VXNlcjQxNTI0ODE=","login":"roxblnfk","name":"Aleksei Gagarin","databaseId":0}],"author":{"id":"MDQ6VXNlcjQzNDE1MTc=","is_bot":false,"login":"edglev","name":"Edgaras Levinson"},"body":"### What are you really trying to do?\r\n\r\nPrevent multiple activities with the same name\r\n\r\n### Describe the bug\r\n\r\nRegistering multiples of the same activity does not throw `ERROR_ALREADY_EXISTS`.\r\n\r\n[ArrayRepostiory's add method](https://github.com/temporalio/sdk-php/blob/5e3307ba9ed97ed81e3bbdc12d0d6291b8a22f10/src/Internal/Repository/ArrayRepository.php#L74) checks a non-existing array with `isset($this->prototypes[$name])` and is always false, overwriting entries regardless of `$overwrite` argument specified","closedAt":"2025-06-30T15:23:35Z","comments":[{"id":"IC_kwDOEY5HBM6tP5zu","author":{"login":"rela589n"},"authorAssociation":"NONE","body":"Also stumbled upon this.\n\nActually this `add()` method never takes into account second parameter:\n\n```php\n  /**\n   * Register a new {@see Identifiable} inside the repository.\n   */\n  public function add(Identifiable $entry, bool $overwrite = false): void;\n```\n\nI see that in many places it's passed as `false` explicitly, and in some places it's just omitted. Yet, I've never seen it to be true.\n\nThough, current behavior is as if it always was `true` üòê ","createdAt":"2025-05-24T08:27:41Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/402#issuecomment-2906627310","viewerDidAuthor":false},{"id":"IC_kwDOEY5HBM6vflRW","author":{"login":"rela589n"},"authorAssociation":"NONE","body":"Hi, @wolfy-j ,\n\nThis is quite sever bug, since right now it tolerates naming collisions basically everywhere (including workflow names, activity names, worker task queues, etc.)\n","createdAt":"2025-06-05T13:20:09Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-php/issues/402#issuecomment-2944291926","viewerDidAuthor":false}],"createdAt":"2024-03-04T12:44:50Z","labels":[{"id":"MDU6TGFiZWwyMzM5NDMzMTc0","name":"Bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":402,"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"state":"CLOSED","title":"[Bug] ArrayRepository always overwrites entries when adding","updatedAt":"2025-06-30T15:23:35Z","url":"https://github.com/temporalio/sdk-php/issues/402"}
