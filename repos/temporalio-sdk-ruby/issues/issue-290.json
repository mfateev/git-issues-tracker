{"assignees":[],"author":{"id":"MDQ6VXNlcjQ2NjI5NzQ5","is_bot":false,"login":"1990eam","name":"Elián Agustín Magni"},"body":"### What are you really trying to do?\n\nInvoke child workflows from within a parent workflow via `#execute_child_workflow`\n\n### Describe the bug\n\nChild workflows invoked via `#execute_child_workflow` run and are completed but they don't show as relationships of the parent workflow (A) nor in the dashboard (B). They only seem to show up in the parent workflow execution history (C)\n\nA\n![Image](https://github.com/user-attachments/assets/2ba90afd-5a2e-4ffc-8496-96bcfcf1a79e)\n\nB\n![Image](https://github.com/user-attachments/assets/68acb7ef-e477-47df-b677-aab07e19f905)\n\nC\n![Image](https://github.com/user-attachments/assets/a12214ad-e804-4165-a36d-2fac45941c36)\n\n\n### Minimal Reproduction\n\nInvoke child workflows from within parent context via `#execute_child_workflow`\n\n### Environment/Versions\n\n<!-- Please complete the following information where relevant. -->\n\n- OS and processor: Linux 22.04\n- Temporal Version: Ruby 0.4.0\n- Are you using Docker or Kubernetes or building Temporal from source? Docker\n\n### Additional context\n\nWe do wrap the child invocation in a `Temporalio::Workflow::Future.new {}` block as we want these to run concurrently and are using an `abandon` `parent_close_policy`\n","closedAt":"2025-06-27T13:05:35Z","comments":[{"id":"IC_kwDOHI0NyM6zUTW1","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"You may need to at least wait until the child workflows are _started_ before exiting the workflow. You can use `start_child_workflow` and wait for that result before completing the primary workflow function. The completion of the workflow makes the requests to start child workflows a no-op (same for a request to start activities and other things).","createdAt":"2025-06-26T13:09:50Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-ruby/issues/290#issuecomment-3008443829","viewerDidAuthor":false},{"id":"IC_kwDOHI0NyM6zWYul","author":{"login":"1990eam"},"authorAssociation":"NONE","body":"> You may need to at least wait until the child workflows are _started_ before exiting the workflow. You can use `start_child_workflow` and wait for that result before completing the primary workflow function. \n\nI changed a couple things to try what you are suggesting.\n\nI started using `start_child_workflow` since the docs say that calls to that method `do not complete until the start has been accepted by the server` . It looked like that would be enough, especially since I can't call `started?` on a `Future` to check before completing the parent, but unfortunately nothing changed.\n\nWhat did _work_ (not an actual solution) was putting a `sleep` after invoking the child workflows and before the parent workflow returns, then the child workflows started showing up everywhere.\n\nAre there any workarounds? What's the right way to use the `abandon` parent close policy to not lose ability to track child workflows if the parent completes before child start?\n\n","createdAt":"2025-06-26T16:00:56Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-ruby/issues/290#issuecomment-3008990117","viewerDidAuthor":false},{"id":"IC_kwDOHI0NyM6zYKCM","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"> It looked like that would be enough, especially since I can't call started? on a Future to check before completing the parent, but unfortunately nothing changed.\n\nFuture doesn't have a \"started\", you'd wait until the future completes which represents start completing, e.g. something like this (untested, just typed here in chat, may have typos)\n\n```ruby\nTemporalio::Workflow::Future.all_of(\n  *10.times.map do |i|\n    Temporalio::Workflow::Future.new do\n      Temporalio::Workflow.start_child_workflow(\n        MyChildWorkflow, \"param #{i}\",\n        parent_close_policy: Temporalio::Workflow::ParentClosePolicy::ABANDON\n      )\n    end\n  end\n).wait\n```\n\nNotice how that will wait for all futures to complete before moving on, and futures complete when the workflow has been accepted to start by the server. See https://github.com/temporalio/sdk-ruby?tab=readme-ov-file#workflow-futures.\n","createdAt":"2025-06-26T18:27:34Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HEART","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-ruby/issues/290#issuecomment-3009454220","viewerDidAuthor":false}],"createdAt":"2025-06-25T20:36:50Z","labels":[{"id":"LA_kwDOHI0NyM7vFHIE","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":290,"reactionGroups":[],"state":"CLOSED","title":"[Bug] Child invoked via #execute_child_workflow don't show up in parent relationship or UI","updatedAt":"2025-06-27T14:02:45Z","url":"https://github.com/temporalio/sdk-ruby/issues/290"}
