{"assignees":[],"author":{"id":"MDQ6VXNlcjIwNjM5Ng==","is_bot":false,"login":"cretz","name":"Chad Retz"},"body":"### Describe the solution you'd like\n\nA user calling `Time#iso8601` is getting a trace with:\n\n```\n/usr/local/bundle/ruby/3.3.0/gems/temporalio-0.4.0-aarch64-linux/lib/temporalio/internal/worker/workflow_instance/illegal_call_tracer.rb:66:in `block in initialize'                                                                \n/usr/local/lib/ruby/3.3.0/time.rb:82:in `zone_offset'\n/usr/local/lib/ruby/3.3.0/time.rb:640:in `xmlschema'\n```\n\nThis is because the second parameter at https://github.com/ruby/ruby/blob/5124f9ac7513eb590c37717337c430cb93caa151/lib/time.rb#L82 is asking for current time. Ug. We need to find some way to exclude this.\n\nRight now we only accept a basic hash of illegal calls. We probably need a more advanced abstraction for illegal time skipping that allows a workflow-stateful stack to skip checking further down. Put it behind a very generic \"check illegal\" abstract class so others can have implementations.","closedAt":"2025-06-27T18:42:34Z","comments":[{"id":"IC_kwDOHI0NyM6x6w7M","author":{"login":"igillis-clara"},"authorAssociation":"CONTRIBUTOR","body":"Ideally it could be judicious about `initialize` as well. If it's called with arguments and a timezone, I don't believe there is any nondeterminism issue. This comes up when trying to deserialize `datetime` strings using the default `ActiveModel` deserialization.\n\nhttps://github.com/rails/rails/blob/v7.1.5.1/activemodel/lib/active_model/type/helpers/time_value.rb#L76\n\nhttps://github.com/ruby/ruby/blob/v3_3_8/timev.rb#L409","createdAt":"2025-06-18T16:41:44Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-ruby/issues/272#issuecomment-2984971980","viewerDidAuthor":false},{"id":"IC_kwDOHI0NyM6yXV8F","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"üëç Yes, we need to support `Time#initialize` with deterministic parameters. It's a little wonky with TracePoint to do something that advanced (inspect parameters via binding), but it can be done and we will have tests confirming it.","createdAt":"2025-06-20T18:22:32Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-ruby/issues/272#issuecomment-2992463621","viewerDidAuthor":false}],"createdAt":"2025-05-15T15:48:56Z","labels":[{"id":"LA_kwDOHI0NyM7vFHIK","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":272,"reactionGroups":[],"state":"CLOSED","title":"[Feature Request] Time#iso8601 improperly considered illegal, look into excluding","updatedAt":"2025-06-27T18:42:34Z","url":"https://github.com/temporalio/sdk-ruby/issues/272"}
