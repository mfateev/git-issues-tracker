{"assignees":[{"id":"MDQ6VXNlcjIwNjM5Ng==","login":"cretz","name":"Chad Retz","databaseId":0}],"author":{"id":"MDQ6VXNlcjU1NTIzODE=","is_bot":false,"login":"mastermanu","name":""},"body":"The Problem:\r\nThere have been many instances where customer workers suddenly stop connecting. The error message returned is typically something that is not very actionable (e.g. last connection error: connection closed before server preface received).  After much panic/head-wrangling, the customer eventually discovers that the client cert they are using to connect to the server has expired. They replace the client certificate with a new one, and their connectivity problems disappear.\r\n\r\nThe Solution:\r\nGiven the number of times we have seen this happen among multiple users, the goal is to reduce the user's time to detect why their workers cannot connect. Most users do look at their Worker logs in order to initially ascertain the source of their connection troubles. The proposal is to add a warning-level log during connection attempts if the certificate is indeed expired. If this is too difficult, then at least adding a warning log as part of setting up the TLS Configuration, as that would still have caught a few other cases.\r\n\r\nWhile we could go full-ham and try and validate many other aspects of a certificate (e.g. Signature algorithm, key usage fields, etc), this is a bad idea because:\r\n1) There are so many different variations we have to verify.\r\n2) The server is going to anyways validate these upon connection time.\r\n\r\nThe goal is to provide a targeted log for a common, specific issue that users of the SDK run into. Philosophically, adding any kind of client logging is far from ideal. Practically, this might be worth doing.\r\n","closedAt":null,"comments":[{"id":"IC_kwDOGflYbs5IGJE8","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"I am moving this to SDK features so that all SDKs have to do it.","createdAt":"2022-08-09T15:53:49Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/features/issues/111#issuecomment-1209569596","viewerDidAuthor":false},{"id":"IC_kwDOGflYbs6lHuJb","author":{"login":"Sushisource"},"authorAssociation":"MEMBER","body":"@mastermanu Do you think this is still relevant in today's world? For context, it's a pretty costly thing to do in SDKs, we don't have much (or possibly in some cases, even sufficient) control over the TLS stack to make this work.","createdAt":"2025-04-01T17:57:34Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/features/issues/111#issuecomment-2770264667","viewerDidAuthor":false}],"createdAt":"2022-08-09T15:49:33Z","labels":[{"id":"LA_kwDOGflYbs7XtLc6","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":111,"reactionGroups":[],"state":"OPEN","title":"Emit warning log if a supplied client certificate has already expired","updatedAt":"2025-04-01T17:57:35Z","url":"https://github.com/temporalio/features/issues/111"}
