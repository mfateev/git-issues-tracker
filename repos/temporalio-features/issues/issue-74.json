{"assignees":[],"author":{"id":"MDQ6VXNlcjUzMjEwOA==","is_bot":false,"login":"Spikhalskiy","name":"Dmitry Spikhalsky"},"body":"1. We need to separate two concepts in SDK: data converter and encoder. These are two separate things and should be set explicitly differently. Data Converter is 'objects -> bytes'. Data Encoder is 'bytes -> bytes'.\r\n2. Stacktrace query results and stacktraces of Temporal Failures should always be converter using a standard Temporal Data Converter. There is no reason to apply a custom user data converter for these text values that should be displayable in Temporal UI as easily as possible.\r\n3. By default, Data Encoder is not applied to Stacktrace Query results and stacktraces of Temporal Failures. This is a reasonable default to allow users the easiest direct access to the failure information during investigations. \r\n4. Temporal SDK should provide an opt-in flag to apply Data Encrypter to stacktraces.\r\n5. Everything said above is not applied for additional 'values' payload of Temporal Failures which is a piece of additional information that may be attached by users for propagation. This additional payload is a normal user object and should be processed by a custom user data converter and encrypted (or not) like any other regular Payload like an activity input parameter or result for example).\r\n\r\n_This task will be updated with specific method names_","closedAt":"2023-10-13T22:20:20Z","comments":[{"id":"IC_kwDOGflYbs5G5D9S","author":{"login":"lorensr"},"authorAssociation":"CONTRIBUTOR","body":"In ts/go/python, we use these terms:\r\n\r\n- Payload Converter: `object -> bytes`\r\n- Payload Codec: `bytes -> bytes` (can do encryption, compression, etc)\r\n- Data Converter: tuple of (payloadConverter, single payloadCodec or list of payloadCodecs)\r\n\r\nDocs:\r\n\r\nhttps://docs.temporal.io/concepts/what-is-a-data-converter/#payload-codecs\r\n\r\n\r\n","createdAt":"2022-07-19T17:28:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/features/issues/74#issuecomment-1189363538","viewerDidAuthor":false},{"id":"IC_kwDOGflYbs5G5Vw0","author":{"login":"lorensr"},"authorAssociation":"CONTRIBUTOR","body":"> 4. Temporal SDK should provide an opt-in flag to apply Data Encrypter to stacktraces.\r\n\r\nMaybe: \r\n\r\n```\r\nWorkerOptions.applyCodecsToFailures\r\nWorkerOptions.applyCodecsToStackTraceQueryResults\r\n```\r\n\r\nboth default false.\r\n\r\n> 5. Everything said above is not applied for additional 'values' payload of Temporal Failures\r\n\r\n`details` and `last_heartbeat_details`:\r\n\r\nhttps://github.com/temporalio/api/blob/c8a79e6cb7db277a3a990ee6d6118a77750e9f50/temporal/api/failure/v1/message.proto#L40-L60\r\n","createdAt":"2022-07-19T18:47:10Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/features/issues/74#issuecomment-1189436468","viewerDidAuthor":false},{"id":"IC_kwDOGflYbs5W9Q8e","author":{"login":"Spikhalskiy"},"authorAssociation":"CONTRIBUTOR","body":"Implemented in JavaSDK:\r\n- [x] https://github.com/temporalio/sdk-java/pull/1330 PayloadCodec framework and abstraction\r\n- [x] https://github.com/temporalio/sdk-java/pull/1645 Failure conversion / encryption\r\n- [ ]  https://github.com/temporalio/sdk-java/issues/1586","createdAt":"2023-03-07T21:30:14Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/features/issues/74#issuecomment-1458900766","viewerDidAuthor":false},{"id":"IC_kwDOGflYbs5pCbit","author":{"login":"josh-berry"},"authorAssociation":"NONE","body":"Possibly-dumb question, but how is this related to #66? Seems like (3) and (4) is exactly what #66 is asking for? Not sure about the data converter parts thoughâ€”if I read the docs, I get the impression that these are the same thing, except Dmitry's point (1) seems to indicate they're different.","createdAt":"2023-10-13T21:25:08Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/features/issues/74#issuecomment-1762244781","viewerDidAuthor":false},{"id":"IC_kwDOGflYbs5pCgDC","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"I suspect this is essentially a duplicate of that one","createdAt":"2023-10-13T21:46:39Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/features/issues/74#issuecomment-1762263234","viewerDidAuthor":false},{"id":"IC_kwDOGflYbs5pCl6d","author":{"login":"lorensr"},"authorAssociation":"CONTRIBUTOR","body":"I think dup, also a lot of this may have been implemented since these issues were opened ","createdAt":"2023-10-13T21:53:24Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/features/issues/74#issuecomment-1762287261","viewerDidAuthor":false},{"id":"IC_kwDOGflYbs5pCrp5","author":{"login":"josh-berry"},"authorAssociation":"NONE","body":"Closing as dup of #66.","createdAt":"2023-10-13T22:20:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/features/issues/74#issuecomment-1762310777","viewerDidAuthor":false}],"createdAt":"2022-07-19T15:57:42Z","labels":[{"id":"LA_kwDOGflYbs7XtLc4","name":"duplicate","description":"This issue or pull request already exists","color":"cfd3d7"},{"id":"LA_kwDOGflYbs7XtLc6","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":74,"reactionGroups":[],"state":"CLOSED","title":"Data conversion and encryption for Failures and Stacktrace Query results","updatedAt":"2023-10-13T22:20:26Z","url":"https://github.com/temporalio/features/issues/74"}
