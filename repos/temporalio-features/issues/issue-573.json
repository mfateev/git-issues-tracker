{"assignees":[],"author":{"id":"MDQ6VXNlcjUxNDkzMg==","is_bot":false,"login":"antmendoza","name":"Antonio Mendoza PÃ©rez"},"body":"### Is your feature request related to a problem? Please describe.\r\n<!-- A clear and concise description of what the problem is. Ex. I'm always frustrated when [...] -->\r\n\r\nSome users want to control when workflows are evicted from the cache. For example:\r\n- They may want to evict workflows they know will sleep for days. For non-latency-sensitive use cases, the cost of storing these workflows in the cache is higher than polling and replaying the workflow history when the timer fires. Ideally, they want to prioritize keeping in the cache workflows that they know are actively active and latency-sensitive.\r\n\r\n- They may want to keep in cache workflows that will be queried after the workflow is closed (and evicted from cache). Querying closed workflows comes with extra latency since the workflow history has to be fetched and replayed by the worker before executing the query. Users want to control how long the workflow will be stored in the cache after the workflow is closed to prevent the extra latency that comes with fetch + replay\r\n\r\n\r\n### Describe the solution you'd like\r\n\r\n<!-- A clear and concise description of what you want to happen. SCREENSHOTS OR CODE SAMPLES ARE VERY HELPFUL -->\r\n\r\n\r\n### Additional context\r\n\r\n<!-- Add any other context or screenshots about the feature request here. -->\r\n\r\n### Per-SDK Tickets\r\n\r\n<!-- Add links here once the tickets are created (no need to create them immediately). -->\r\n\r\n- [ ] Go - \r\n- [ ] Java - \r\n- [ ] Core - \r\n- [ ] TypeScript - \r\n- [ ] Python - \r\n- [ ] .NET - \r\n- [ ] Ruby - \r\n- [ ] PHP - \r\n- [ ] Temporal CLI - \r\n","closedAt":null,"comments":[{"id":"IC_kwDOGflYbs6ZqOdr","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"This will need some internal discussions on design, and some of the work may be server side if post-close queries don't use the sticky queue anyways.","createdAt":"2025-01-08T15:38:18Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/features/issues/573#issuecomment-2577983339","viewerDidAuthor":false},{"id":"IC_kwDOGflYbs6ZqYYb","author":{"login":"Quinn-With-Two-Ns"},"authorAssociation":"MEMBER","body":"> They may want to evict workflows they know will sleep for days. \r\n\r\nCurrently SDKs use a LRU strategy for eviction, I think their is room for optimization here. For example we could factor in history size when choosing what workflow to evict. If it is worth optimizing eviction vs just asking users to increase their memory and cache size I am not sure.\r\n\r\n>and some of the work may be server side if post-close queries don't use the sticky queue anyways.\r\n\r\nYes their is some server side work needed to allow query to always use the workflow cache https://github.com/temporalio/temporal/issues/4463. \r\n\r\nI do think it should be opt in since keeping a closed workflow in cache by default on the chance that it may be queried, is not appropriate. ","createdAt":"2025-01-08T15:54:58Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/features/issues/573#issuecomment-2578023963","viewerDidAuthor":false}],"createdAt":"2025-01-08T15:16:48Z","labels":[{"id":"LA_kwDOGflYbs7XtLc6","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":573,"reactionGroups":[],"state":"OPEN","title":"Add fine control for workflow cache eviction","updatedAt":"2025-01-08T15:55:00Z","url":"https://github.com/temporalio/features/issues/573"}
