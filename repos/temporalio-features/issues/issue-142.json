{"assignees":[],"author":{"id":"MDQ6VXNlcjUyMzA0","is_bot":false,"login":"bergundy","name":"Roey Berman"},"body":"See this server PR for more information:\r\n\r\nhttps://github.com/temporalio/temporal/pull/1949/files#diff-b3797d690c398677a5a20c26925f78157dc5da1bf96316215d93ac26ecd7bd2bR59","closedAt":null,"comments":[{"id":"IC_kwDOGflYbs5MF0Ix","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"That's a really old PR. If there isn't a recent use case bringing this up, I don't think we should send this until there is a need.","createdAt":"2022-10-12T18:46:41Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/features/issues/142#issuecomment-1276592689","viewerDidAuthor":false},{"id":"IC_kwDOGflYbs5MGCdW","author":{"login":"dnr"},"authorAssociation":"MEMBER","body":"What does the age of the PR have to do with anything? That just means that we should have done it last year.\r\n\r\nThere is a clear need, as evidenced by that PR, and I can easily imagine more in the future.","createdAt":"2022-10-12T19:39:20Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/features/issues/142#issuecomment-1276651350","viewerDidAuthor":false},{"id":"IC_kwDOGflYbs5MGEd9","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"> What does the age of the PR have to do with anything? That just means that we should have done it last year.\r\n\r\nHow long SDKs have not needed something and how long it has been since anyone has asked for anything that requires such a thing matters. We need to be wary of adding things without real need and the age directly relates to the staleness of such a request.\r\n\r\n> There is a clear need\r\n\r\nThere is a clear want. A clear need would have had necessity force the implementation. If there is a use case that needs this, I support it.","createdAt":"2022-10-12T19:48:22Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/features/issues/142#issuecomment-1276659581","viewerDidAuthor":false},{"id":"IC_kwDOGflYbs5MM0m4","author":{"login":"dnr"},"authorAssociation":"MEMBER","body":"The fact that we've gotten by for a while with an ugly hack and unreliable heuristics to tell when to trigger the hack doesn't invalidate the need for a clean way to communicate this information.\r\n\r\nThe use case this is needed for is asking for the error from a non-final workflow retry, or the result or error from a specific [old] cron run. Without sending this capability, the server won't send the correct close event and you won't get the value you're looking for.\r\n\r\nBut even if that weren't true, we need to be able to evolve software and switch to newer code paths when new capabilities are supported. In this case the hack is relatively cheap but that won't always be the case.","createdAt":"2022-10-14T03:28:14Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/features/issues/142#issuecomment-1278429624","viewerDidAuthor":false},{"id":"IC_kwDOGflYbs5MOpi1","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"The concern is adding overhead on every single client call when you only need this in a specific case. Note, we don't pass server capabilities back to the client on every call. The other concern is that this becomes a stringly typed set of data. Note, we use well-defined protos for server capabilities. Having said that, I understand the client is more stateful than the server so it is hard to maintain state about a specific connection.","createdAt":"2022-10-14T11:56:42Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/features/issues/142#issuecomment-1278908597","viewerDidAuthor":false},{"id":"IC_kwDOGflYbs5MQWKs","author":{"login":"dnr"},"authorAssociation":"MEMBER","body":"If you have a good way to do this using protos, and with less overhead, please suggest it. My assumption was that http2 header compression will reduce the per-call overhead to a few bytes even if the full string needs to be sent once per tcp connection. But I admit I haven't confirmed that.","createdAt":"2022-10-14T18:56:05Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/features/issues/142#issuecomment-1279353516","viewerDidAuthor":false},{"id":"IC_kwDOGflYbs5MQg09","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"> In this case the hack is relatively cheap but that won't always be the case.\r\n\r\nI haven't dug into the issue, but my first impression would be to use the existing request proto params to add params to requests. For example, why not a `bool` of `GetWorkflowExecutionHistoryRequest.next_run_id_following_supported` when this was added? Why add a header on every call when it only applies to one call (or does it apply to many)? And if you're adding a header even on the one call, you might as well use the typed input format we support for parameters instead of the headers.\r\n\r\nI'd personally like to wait until the case where a value cannot be put into the request but instead has to be in the header before we add this.","createdAt":"2022-10-14T19:49:45Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/features/issues/142#issuecomment-1279397181","viewerDidAuthor":false}],"createdAt":"2022-10-11T23:35:28Z","labels":[{"id":"LA_kwDOGflYbs7XtLc6","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":142,"reactionGroups":[],"state":"OPEN","title":"[Feature Request] SDKs should send client capabilities in gRPC metadata","updatedAt":"2024-07-13T01:07:48Z","url":"https://github.com/temporalio/features/issues/142"}
