{"assignees":[],"author":{"id":"MDQ6VXNlcjExOTQyMg==","is_bot":false,"login":"tsurdilo","name":"Tihomir Surdilovic"},"body":"Example:\r\n\r\n     Workflow.await(Duration.ofSeconds(n), () -> condition);\r\n     activities.doSomething(...);\r\n\r\nWorkflow.await / sleep produces different sequence of events if n<=0 and when n>0 (basically if n>0 will have TimerStarted event from command in history, if n<=0 TimerStarted event is not in history)\r\nSimilar for Workflow.sleep\r\n\r\nThis can cause non-deterministic issues during replay, if user calculates n in workflow code (even if they do not use system time, but some initial wf inputs so code itself is deterministic).\r\n\r\nFeature request is for SDKS not to cause non-deterministic failure here and replay the workflow task but to log it and dont fail. \r\nAnother option could be to fail workflow task with like \"duration cannot be 0\" or similar message but first option imo would be preferred if possible\r\n\r\nWorkarounds are currently for the \"n\" calculation to be done inside side effect or local activity/activity so n is not re-calculated on replay each time.\r\n","closedAt":null,"comments":[{"id":"IC_kwDOGflYbs5MjqYG","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"> Workflow.await / sleep produces different sequence of events if n<=0 and when n>0 (basically if n>0 will have TimerStarted event from command in history, if n<=0 TimerStarted event is not in history)\r\n\r\nCan you confirm this is happening in all SDKs or is this server behavior? I would guess some (most?) SDKs don't inspect the value before sending to the server.","createdAt":"2022-10-19T18:32:39Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/features/issues/145#issuecomment-1284417030","viewerDidAuthor":false}],"createdAt":"2022-10-19T18:13:11Z","labels":[{"id":"LA_kwDOGflYbs7XtLc6","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":145,"reactionGroups":[],"state":"OPEN","title":"[Feature Request] Workfow sleep/await with 0 duration","updatedAt":"2024-07-13T01:07:45Z","url":"https://github.com/temporalio/features/issues/145"}
