{"assignees":[],"author":{"id":"MDQ6VXNlcjQ2NjAzODUz","is_bot":false,"login":"dan8f","name":"dani"},"body":"### What are you really trying to do?\n\nSetting a TLS server name override in client connection connect\n\n### Describe the bug\n\nWhen setting a server name override in client connection, the TLS server name is mishandled by `grpc-js` library and ends up overridden with the address provided\n\n### Minimal Reproduction\n\n```\n  import { Connection, Client } from '@temporalio/client';\n\n  const connection = await Connection.connect(\n    {\n      address: '<address>:7233',\n\n      tls: {\n        serverNameOverride: '<override>',\n      },\n\n      apiKey,\n\n      metadata\n    })\n\n```\n\n### Environment/Versions\n\nTS SDK 1.11.7\n\n### Additional context\n\n[grpc-js servername override](https://github.com/grpc/grpc-node/blob/c2b914d4fd085679f7b48fae5356c5e7702b4a34/packages/grpc-js/src/channel-credentials.ts#L257)\n","closedAt":"2025-05-28T17:02:26Z","comments":[{"id":"IC_kwDOEujx186n6A8W","author":{"login":"kazaz-lumida"},"authorAssociation":"NONE","body":"Yes please :) This is blocking us from taking our app to production where we only want to use PrivateLink and not go through the internet","createdAt":"2025-04-20T05:32:16Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"url":"https://github.com/temporalio/sdk-typescript/issues/1681#issuecomment-2817003286","viewerDidAuthor":false},{"id":"IC_kwDOEujx186r5hp1","author":{"login":"kazaz-lumida"},"authorAssociation":"NONE","body":"Can anyone please let us know what is the status here?\nThis is a MAJOR security issue from our side and a core functionality of the SDK.\nTo be honest I'm surprised it was not addressed right away given its importance and what seems to be an easy fix.","createdAt":"2025-05-15T14:17:59Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":3}}],"url":"https://github.com/temporalio/sdk-typescript/issues/1681#issuecomment-2883983989","viewerDidAuthor":false},{"id":"IC_kwDOEujx186r7gJi","author":{"login":"mjameswh"},"authorAssociation":"MEMBER","body":"Very sorry for the delay. I was honestly under the impression that our support team had already provided you a suitable workaround through our Zendesk portal, but this might have been a different conversation. My bad.\n\nThe current workaround is to add this dependency to your own package.json:\n\n```\n\"@grpc/grpc-js\": \"1.12.6\"\n```\n\nThis will get Client connections through Private Link working properly.","createdAt":"2025-05-15T17:01:35Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1681#issuecomment-2884502114","viewerDidAuthor":false},{"id":"IC_kwDOEujx186sAlmH","author":{"login":"kazaz-lumida"},"authorAssociation":"NONE","body":"Thank you @mjameswh , any estimation on getting a real fix?\nFixing the version also means I'm not going to get any new security updates on such critical package which is a security concern on its own","createdAt":"2025-05-16T07:04:21Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1681#issuecomment-2885835143","viewerDidAuthor":false},{"id":"IC_kwDOEujx186sE6ub","author":{"login":"mjameswh"},"authorAssociation":"MEMBER","body":"> any estimation on getting a real fix?\n\nThere are actually two solutions coming up:\n1. https://github.com/grpc/grpc-node/pull/2956;\n2. https://github.com/temporalio/sdk-typescript/pull/1699 (to be released in TS SDK 1.12.0).\n\nAny of these two will resolve the problem you are facing.\n\nI expect both to be available in the next few days.","createdAt":"2025-05-16T14:58:55Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"ROCKET","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-typescript/issues/1681#issuecomment-2886970267","viewerDidAuthor":false},{"id":"IC_kwDOEujx186twXGV","author":{"login":"kazaz-lumida"},"authorAssociation":"NONE","body":"Hi @mjameswh , seems like https://github.com/grpc/grpc-node/releases/tag/%40grpc%2Fgrpc-js%401.13.4 was merged and released ðŸŽ‰ \n\nCan the Temporal team update the package and release a security patch version so this topic will be resolved?","createdAt":"2025-05-28T06:33:42Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1681#issuecomment-2915135893","viewerDidAuthor":false},{"id":"IC_kwDOEujx186t3kh8","author":{"login":"mjameswh"},"authorAssociation":"MEMBER","body":"> seems like https://github.com/grpc/grpc-node/releases/tag/%40grpc%2Fgrpc-js%401.13.4 was merged and released ðŸŽ‰\n\nIndeed. We just confirmed that running Temporal TS SDK 1.11.8 with `@grpc/grpc-js` 1.13.4 works fine and allows connection to Temporal Cloud through Private Link.\n\nAffected users may update that dependency locally by simply doing:\n\n```\nnpm update @grpc/grpc-js\n```\n\n> Can the Temporal team update the package and release a security patch version so this topic will be resolved?\n\nWe won't bump that dependency nor make a new release. That's not necessary, as that dependency is controlled from the user's project `package-lock.json` file anyway. Simply do `npm update @grpc/grpc-js`, which is actually easier than having to update all of your `@temporalio/*` dependencies. And other users may have their own reasons to prefer some older releases of `grpc-js`; there's no sufficient reason we should prevent them from doing so in this case.","createdAt":"2025-05-28T17:02:26Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1681#issuecomment-2917025916","viewerDidAuthor":false}],"createdAt":"2025-04-17T20:01:31Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDA2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":1681,"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"state":"CLOSED","title":"[Bug] TLS server name override not respected","updatedAt":"2025-05-28T17:09:31Z","url":"https://github.com/temporalio/sdk-typescript/issues/1681"}
