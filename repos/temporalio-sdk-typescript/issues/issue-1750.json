{"assignees":[],"author":{"id":"U_kgDOCA0Oxg","is_bot":false,"login":"antlai-temporal","name":"Antonio Lain"},"body":"\n### Describe the bug\n\nUsing sample https://github.com/temporalio/samples-typescript/tree/main/custom-logger unless the worker \nconfigures core logging filter to DEBUG or TRACE, workflow application logging, i.e.,  using `log.info` in workflow code, will not show up in the logs.\n\nThis is confusing because it would be expected if telemetryOptions.logging.filter is set to INFO, a `log.info` in workflow code will be reflected in the logs\n\n### Minimal Reproduction\nChange line https://github.com/temporalio/samples-typescript/blob/main/custom-logger/src/worker.ts#L33 to\n\n`filter: makeTelemetryFilterString({ core: 'INFO' }),`\n\nand the log.info in \nhttps://github.com/temporalio/samples-typescript/blob/main/custom-logger/src/workflows/index.ts#L10\n\ndoes not show up in the logs\n\n### Environment/Versions\n\nLatest TS SDK 1.12.1\n\n","closedAt":"2025-08-27T21:06:21Z","comments":[{"id":"IC_kwDOEujx18655gec","author":{"login":"mjameswh"},"authorAssociation":"MEMBER","body":"Ehh? That's a very surprising situation.\n\n> This is confusing because it would be expected if `telemetryOptions.logging.filter` is set to INFO, a log.info in workflow code will be reflected in the logs\n\nNot only that, but more importantly, the value of `telemetryOptions.logging.filter` is only ever passed to Core (i.e. to control verbosity of log messages emitted by _core_), which is not involved in collecting log messages coming from Workflows (that one is implemented using sinks).\n\nOne thing that comes to my mind… When core's logs are forwarded to lang, log messages get buffered for a few miliseconds through the `NativeLogCollector` class, which ensures proper ordering of messages. The thing is that this class only flushes buffered messages when it receives a log message from Core. It could be that if core is configured at INFO, we get very few messages from Core, and so the buffer rarely gets flushed. But I would still expect the log message to eventually get flushed at some point; in the worst case, that would be on Worker shutdown. Does that matches your observation?","createdAt":"2025-07-25T15:50:03Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-typescript/issues/1750#issuecomment-3118860188","viewerDidAuthor":false},{"id":"IC_kwDOEujx1866A6Lw","author":{"login":"antlai-temporal"},"authorAssociation":"MEMBER","body":"I don't see the messages with graceful worker shutdown. I added a `console.log(\"Worker gracefully shutdown\"` after `await worker.run();` and then use `kill -TERM ...` to trigger worker shutdown. It prints the \"Worker gracefully...\" message but not the info logs from the workflow...\nHowever, it is true that there are no more core messages after the workflow starts (with info), even after shutdown, so it could be that we need to guarantee to always flush the collector during shutdown...\nFrankly, there are very few core log messages with info+, so relying on them for flushing workflow logs is a bad idea...","createdAt":"2025-07-26T00:33:31Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1750#issuecomment-3120800496","viewerDidAuthor":false},{"id":"IC_kwDOEujx1866zs8z","author":{"login":"tatejones"},"authorAssociation":"NONE","body":"Come to think of it, I believe it maybe related to the flush as I would see them during a shutdown phase.","createdAt":"2025-07-29T21:22:07Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1750#issuecomment-3134115635","viewerDidAuthor":false},{"id":"IC_kwDOEujx1867bO9_","author":{"login":"Nielsvanbree"},"authorAssociation":"NONE","body":"> One thing that comes to my mind… When core's logs are forwarded to lang, log messages get buffered for a few miliseconds through the `NativeLogCollector` class, which ensures proper ordering of messages. The thing is that this class only flushes buffered messages when it receives a log message from Core. It could be that if core is configured at INFO, we get very few messages from Core, and so the buffer rarely gets flushed. But I would still expect the log message to eventually get flushed at some point; in the worst case, that would be on Worker shutdown. Does that matches your observation?\n\nThis looks like the core problem for what our team also experiences. After upgrading to Temporal 1.12.x we don't see any of our worker logs until we redeploy the worker: in that moment, all past logs are written in 1 go. Even if we don't deploy for a few days, the logs don't get written until we redeploy.\n\nSetting the filter to DEBUG like @antlai-temporal showed resolved the issue for us, even though we expect it to work with INFO (which it was set to for months without issues).\n","createdAt":"2025-08-01T12:50:38Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1750#issuecomment-3144478591","viewerDidAuthor":false},{"id":"IC_kwDOEujx186-UWZq","author":{"login":"SamuelMS"},"authorAssociation":"NONE","body":"Yep, I can confirm this, or something similar – our activity logs get suppressed when we use `makeTelemetryFilterString` at `INFO`, and `DEBUG`/`TRACE` are too noisy for production use. Removing the option surfaces the missing logs (which were emitted at `INFO`). We were stumped as to why our worker entrypoint was logging just fine but activities were failing until we found this issue.","createdAt":"2025-08-15T23:39:06Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1750#issuecomment-3193005674","viewerDidAuthor":false},{"id":"IC_kwDOEujx186-ipsl","author":{"login":"saniul"},"authorAssociation":"NONE","body":"Same, can confirm this too. We've had to downgrade to `1.11.8` to ensure we can see our workflow logs in production without enabling `DEBUG` logs from the Core.","createdAt":"2025-08-18T13:06:40Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-typescript/issues/1750#issuecomment-3196754725","viewerDidAuthor":false},{"id":"IC_kwDOEujx186_j-_4","author":{"login":"geuben"},"authorAssociation":"NONE","body":"Also seeing this.\n\nMy workflow logs do get emitted when the worker process receives a SIGTERM but that's not acceptable behaviour.","createdAt":"2025-08-22T10:26:43Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-typescript/issues/1750#issuecomment-3213881336","viewerDidAuthor":false},{"id":"IC_kwDOEujx186_nSmy","author":{"login":"SamuelMS"},"authorAssociation":"NONE","body":"@mjameswh Given @geuben's comment above, maybe your guess that something's going awry with log flushing is correct?","createdAt":"2025-08-22T15:17:35Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1750#issuecomment-3214748082","viewerDidAuthor":false},{"id":"IC_kwDOEujx187AfS20","author":{"login":"mjameswh"},"authorAssociation":"MEMBER","body":"Extra note: [it has been pointed out](https://temporalio.slack.com/archives/C01DKSMU94L/p1756221182888799?thread_ts=1754500828.319189&cid=C01DKSMU94L) that this might cause a memory leak, as the LogCollector's buffer may grow to a significant number of log entries (thanks to @geuben for surfacing that aspect).","createdAt":"2025-08-27T19:07:17Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1750#issuecomment-3229429172","viewerDidAuthor":false},{"id":"IC_kwDOEujx187AfgB7","author":{"login":"antlai-temporal"},"authorAssociation":"MEMBER","body":"@mjameswh This could be related to a memory leak reported by one of Temporal's customer (see https://temporalsupport.zendesk.com/agent/tickets/14825). They are using an OTEL logger combined with Winston and seeing\na clear memory leak running locally and in Cloud.","createdAt":"2025-08-27T19:25:41Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-typescript/issues/1750#issuecomment-3229483131","viewerDidAuthor":false}],"createdAt":"2025-07-24T21:19:31Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDA2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":1750,"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":7}}],"state":"CLOSED","title":"[Bug] Workflow logs not propagated unless telemetryOptions.logging.filter is DEBUG or TRACE","updatedAt":"2025-08-27T21:06:21Z","url":"https://github.com/temporalio/sdk-typescript/issues/1750"}
