{"assignees":[],"author":{"id":"MDQ6VXNlcjM3MDgyMDA5","is_bot":false,"login":"josiah-roberts","name":"Josiah \"Rebase\" Roberts"},"body":"### Is your feature request related to a problem? Please describe.\r\n\r\nEverything here also applies to `QueryDefinition`, but I'll use `SignalDefinition` in these examples.\r\n\r\nBecause `SignalDefinition<Args>` does not use `_Args` in the resulting type, and because TypeScript is structurally typed, certain absurdities can arise. For example, the fact that a `SignalDefinition<[string]>` is a `SignalDefinition<[number]>`. The following is legal TS:\r\n\r\n```typescript\r\nfunction sendNumberSignal(s: SignalDefinition<[number]>, n: number) {\r\n  // workflowHandle.signal(s, n)\r\n}\r\n\r\nconst stringSignal = defineSignal<[string]>('some name');\r\nsendNumberSignal(stringSignal, 21);\r\n```\r\n\r\nThis creates some real problems when trying to perform type algebra or do higher-order reasoning about signal and query types for helpers and utility functions.\r\n\r\n### Describe the solution you'd like\r\n\r\nThis issue can be fixed by no longer discarding the `<_Args>` type parameter, and instead using a virtual [type brand](https://medium.com/@KevinBGreene/surviving-the-typescript-ecosystem-branding-and-type-tagging-6cf6e516523d) to preserve the information within the type system.\r\n\r\nThis brand doesn't exist at run-time, and since the symbol is not exported it is not possible for consumers to access the \"virtual\" property.\r\n\r\n`SignalDefinition` becomes:\r\n```typescript\r\ndeclare const argsBrand: unique symbol;\r\nexport interface SignalDefinition<Args extends any[] = []> {\r\n  type: 'signal';\r\n  [argsBrand]: Args;\r\n}\r\n```\r\n\r\nAnd `defineSignal` becomes:\r\n```typescript\r\nexport function defineSignal<Args extends any[] = [], Name extends string = string>(name: Name): SignalDefinition<Args, Name> {\r\n  return {\r\n    type: 'signal',\r\n    name,\r\n  } as SignalDefinition<Args, Name>;\r\n}\r\n```\r\n\r\nHaving made these changes, `SignalDefinition<[string]>` is no longer assignable to `SignalDefinition<[number]>`, and type-level logic over the arg types of symbols becomes possible.\r\n","closedAt":"2023-02-23T05:27:02Z","comments":[],"createdAt":"2023-02-10T23:09:49Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDEz","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":1051,"reactionGroups":[],"state":"CLOSED","title":"[Feature Request] Retain type information for signal/query `_Args`","updatedAt":"2023-02-23T05:27:02Z","url":"https://github.com/temporalio/sdk-typescript/issues/1051"}
