{"assignees":[],"author":{"id":"U_kgDOBuMEIQ","is_bot":false,"login":"rd-akind","name":"Richard Danninger"},"body":"### What are you really trying to do?\n\nCall an activity from a workflow, through `proxyActivities`, and use TypeScript's type inference to determine the activity return type.\n\n### Describe the bug\n\nWhen using TypeScript SDK 1.12.1, calling an activity and storing its return value in a variable always successfully compiles.\n\nIn TypeScript SDK 1.12.2 and above, some instances of code that previously successfully compiled, now emits the error:\n\n```\nerror TS7022: '...' implicitly has type 'any' because it does not have a type annotation and is referenced directly or indirectly in its own initializer.\n```\n\n### Minimal Reproduction\n\nAn example repo with nonsensical code but minimal TypeScript configuration can be found here: https://github.com/akindgroup/temporal-repro-1657\n\nOne of the circumstances where TypeScript is not able to infer the type correctly when upgrading past TypeScript SDK 1.12.2:\n\n```typescript\n// activities.ts\nexport const sampleActivity = async (input: { pointer: number }) => {\n  return { pointer: 7 }\n}\n\n// workflow.ts\nimport { proxyActivities } from \"@temporalio/workflow\";\nimport type * as activities from \"./activities.js\";\n\nconst { sampleActivity } = proxyActivities<typeof activities>({})\n\nexport const workflow = async () => {\n  let pointer: null | number = 0\n\n  do {\n    const result = await sampleActivity({ pointer })\n    pointer = result.pointer\n  } while (pointer !== null)\n}\n```\n\nThis issue might be caused by changes to the typing of the `proxyActivites` function introduced in https://github.com/temporalio/sdk-typescript/pull/1657\n\n```typescript\n// Before PR 1657\nexport type ActivityInterfaceFor<T> = {\n  [K in keyof T]: T[K] extends ActivityFunction ? T[K] : typeof NotAnActivityMethod;\n};\n\n// After PR 1657\nexport type ActivityInterfaceFor<T> = {\n  [K in keyof T]: T[K] extends ActivityFunction ? ActivityFunctionWithOptions<T[K]> : typeof NotAnActivityMethod;\n};\n```\n\n### Environment/Versions\n\n- Temporal Version: SDK version 1.12.2+\n\n### Workaround\n\nThe simplest workaround is to explicitly type the variable storing the return value, e.g:\n\n```typescript\nconst result: { pointer: number } = await sampleActivity({ pointer })\n```\n\nAnother is to rearrange the code, which works well in some cases:\n\n```typescript\nlet { pointer } = await sampleActivity({ pointer: 0 })\n\nwhile (pointer !== null) {\n  const result = await sampleActivity({ pointer })\n  pointer = result.pointer\n}\n```","closedAt":null,"comments":[],"createdAt":"2025-10-08T07:29:37Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDA2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":1796,"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"state":"OPEN","title":"[Bug] Changes in type inference of activity return type in SDK 1.12.2","updatedAt":"2025-10-08T07:29:37Z","url":"https://github.com/temporalio/sdk-typescript/issues/1796"}
