{"assignees":[],"author":{"id":"MDQ6VXNlcjcyNzE3OTA=","is_bot":false,"login":"florianmorath","name":"Florian Morath"},"body":"### What are you really trying to do?\r\n\r\nCreating a Temporal schedule using the calendar-based specifications of times.\r\n\r\n### Describe the bug\r\n\r\nWhen creating a Temporal schedule using the calendar-based specifications of times, there is an issue with the encoding of the input values.\r\nAccording to the documentation the `dayOfMonth` should accept numbers from 1 to 31 but e.g. input value 21 is rejected with the following error message (https://typescript.temporal.io/api/interfaces/client.CalendarSpec#dayofmonth).\r\n\r\n`Error: Invalid CalendarSpec component for field dayOfMonth: '21' of type 'number'`\r\n\r\n### Minimal Reproduction\r\n\r\nUse the code below in the following sample.\r\nhttps://github.com/temporalio/samples-typescript/blob/main/schedules/src/start-schedule.ts\r\n\r\n```typescript\r\n// https://typescript.temporal.io/api/classes/client.ScheduleClient#create\r\nconst schedule = await client.schedule.create({\r\n  action: {\r\n    type: 'startWorkflow',\r\n    workflowType: reminder,\r\n    args: [''],\r\n    taskQueue: 'schedules',\r\n  },\r\n  scheduleId: 'sample-schedule',\r\n  policies: {\r\n    catchupWindow: '1 day',\r\n    overlap: ScheduleOverlapPolicy.ALLOW_ALL,\r\n  },\r\n  spec: {\r\n    calendars: [\r\n      {\r\n        year: 2023,\r\n        month: 'APRIL',\r\n        dayOfMonth: 21, // 21st day of month\r\n        hour: 12,\r\n        minute: 0,\r\n        second: 0,\r\n      },\r\n    ],\r\n  },\r\n});\r\n```\r\n\r\n### Environment/Versions\r\n\r\n- OS and processor: Apple M2\r\n- Temporal Version: `\"@temporalio/client\": \"^1.7.2\"`\r\n\r\n### Additional context\r\n\r\nHere is a diff that we use to fix the issue.\r\n\r\n```diff\r\ndiff --git a/node_modules/@temporalio/client/src/schedule-helpers.ts b/node_modules/@temporalio/client/src/schedule-helpers.ts\r\nindex 14cddbe..6a5d05a 100644\r\n--- a/node_modules/@temporalio/client/src/schedule-helpers.ts\r\n+++ b/node_modules/@temporalio/client/src/schedule-helpers.ts\r\n@@ -66,7 +66,7 @@ const [encodeMinute, decodeMinue] = makeCalendarSpecFieldCoders(\r\n \r\n const [encodeHour, decodeHour] = makeCalendarSpecFieldCoders(\r\n   'hour',\r\n-  (x: number) => (typeof x === 'number' && x >= 0 && x <= 59 ? x : undefined),\r\n+  (x: number) => (typeof x === 'number' && x >= 0 && x <= 23 ? x : undefined),\r\n   (x: number) => x,\r\n   [{ start: 0, end: 0, step: 0 }], // default to 0\r\n   [{ start: 0, end: 23, step: 1 }]\r\n@@ -74,7 +74,7 @@ const [encodeHour, decodeHour] = makeCalendarSpecFieldCoders(\r\n \r\n const [encodeDayOfMonth, decodeDayOfMonth] = makeCalendarSpecFieldCoders(\r\n   'dayOfMonth',\r\n-  (x: number) => (typeof x === 'number' && x >= 0 && x <= 6 ? x : undefined),\r\n+  (x: number) => (typeof x === 'number' && x >= 0 && x <= 31 ? x : undefined),\r\n   (x: number) => x,\r\n   [{ start: 1, end: 31, step: 1 }], // default to *\r\n   [{ start: 1, end: 31, step: 1 }]\r\n\r\n```","closedAt":"2023-05-25T19:36:01Z","comments":[],"createdAt":"2023-04-21T12:29:28Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDA2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":1105,"reactionGroups":[],"state":"CLOSED","title":"[Bug] `CalendarSpec` components not encoded correctly","updatedAt":"2023-05-25T19:36:01Z","url":"https://github.com/temporalio/sdk-typescript/issues/1105"}
