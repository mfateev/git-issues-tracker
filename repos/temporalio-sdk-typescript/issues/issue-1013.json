{"assignees":[{"id":"MDQ6VXNlcjY0MTIxNjk=","login":"mjameswh","name":"James Watkins-Harvey","databaseId":0}],"author":{"id":"MDQ6VXNlcjIwNTA0MDQ5","is_bot":false,"login":"Quinn-With-Two-Ns","name":"Quinn Klassen"},"body":"### What are you really trying to do?\r\n\r\nList schedules with the `ScheduleClient.list()` API\r\n\r\n### Describe the bug\r\n\r\nNo schedules are returned when I can verify there are schedules through `tctl`, the UI and go-sdk.\r\n\r\n### Minimal Reproduction\r\n\r\nSee the `basic` typescript test here https://github.com/temporalio/sdk-features/pull/192\r\n\r\n### Environment/Versions\r\n\r\n\r\n- OS and processor:M1 Mac\r\n- Temporal Version: tried temporalite 1.17 and 1.19\r\n- Are you using Docker or Kubernetes or building Temporal from source?\r\n\r\n### Additional context\r\n\r\n<!-- Add any other context about the problem here. -->\r\n","closedAt":"2023-01-25T21:51:12Z","comments":[{"id":"IC_kwDOEujx185Rvnjv","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"Is there any chance that the spec is falsy in those schedules?\r\n\r\nhttps://github.com/temporalio/sdk-typescript/blob/f16d1dac5176c3a695e3332de0b420bad07bbf5b/packages/client/src/schedule-client.ts#L373","createdAt":"2023-01-04T21:23:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1013#issuecomment-1371437295","viewerDidAuthor":false},{"id":"IC_kwDOEujx185TVCBn","author":{"login":"igorsechyn"},"authorAssociation":"NONE","body":"I am hitting the same issue in our setup. What I noticed is that `workflowService.listSchedules` does not always return the full response. In most cases it just returns an array of schedule ids and thats it. However sometimes i saw responses containing the full information.\r\n\r\nThis is how I create schedules \r\n```\r\nawait temporalClient.schedule.create({\r\n        scheduleId,\r\n        action: {\r\n          taskQueue: Config.TEMPORAL_TASK_QUEUE,\r\n          type: \"startWorkflow\",\r\n          workflowType: workflow,\r\n          args: [anonymousWorkflowContext],\r\n          workflowId: workflow,\r\n        },\r\n        spec: {\r\n          cronExpressions: [cronConfig.schedule],\r\n        },\r\n        policies: {\r\n          overlap: ScheduleOverlapPolicy.SKIP,\r\n        },\r\n      });\r\n```\r\n\r\nSo the spec should not be falsy","createdAt":"2023-01-20T07:44:07Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1013#issuecomment-1398022247","viewerDidAuthor":false},{"id":"IC_kwDOEujx185TYNZK","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"@igorsechyn The schedules list response is eventually consistent, you may have to wait for your schedule to appear in the response.","createdAt":"2023-01-20T19:48:06Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1013#issuecomment-1398855242","viewerDidAuthor":false},{"id":"IC_kwDOEujx185TYR2k","author":{"login":"Quinn-With-Two-Ns"},"authorAssociation":"MEMBER","body":"@bergundy the schedule spec is not falsy.  The issue I saw only happens in the typescript sdk not the go sdk.","createdAt":"2023-01-20T20:06:43Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1013#issuecomment-1398873508","viewerDidAuthor":false},{"id":"IC_kwDOEujx185TYUjp","author":{"login":"mjameswh"},"authorAssociation":"MEMBER","body":">The issue I saw only happens in the typescript sdk not the go sdk.\r\n\r\n@igorsechyn is reporting this issue using raw GRPC calls... The SDK is essentially not involved there. I personally think this is an eventual consistency issue, but then... how come we never observe this using the Go SDK?!?","createdAt":"2023-01-20T20:17:10Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1013#issuecomment-1398884585","viewerDidAuthor":false},{"id":"IC_kwDOEujx185Tb4KG","author":{"login":"igorsechyn"},"authorAssociation":"NONE","body":"> The schedules list response is eventually consistent, you may have to wait for your schedule to appear in the response.\r\n\r\nI dont think this is the case. Our use case:\r\n- on app startup we check, if there are any cron jobs we need to run, if there are we create temporal schedule objects. \r\n- if we remove a cron from our codebase, we also want to delete corresponding schedule in temporal, so on each startup we fetch the list of schedules\r\n\r\nI have been testing it locally and although schedules were running for some time now, on app restart we only get a list with schedule's id, i.e. when using `workspaceService`. So it's not that we do not see any schedules, we see them, but the response only contains an id. This is what i see in response from `workspaceService`\r\n\r\n```\r\n[{\r\n  \"scheduleId\": \"my-schedule-id\"\r\n}]\r\n```\r\n\r\nI think thats the reason, why the schedule client returns an empty array, cause the workflowService does not return any spec. \r\n\r\nMore details:\r\n- sdk version: 1.5.2\r\n- temporal version: 1.18.3\r\n\r\n","createdAt":"2023-01-23T05:13:14Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1013#issuecomment-1399816838","viewerDidAuthor":false},{"id":"IC_kwDOEujx185TcT4i","author":{"login":"igorsechyn"},"authorAssociation":"NONE","body":"Just tested again, and after a schedule running for multiple hours querying the list on our app restart, temporal still returns just schedule ids.","createdAt":"2023-01-23T07:52:58Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1013#issuecomment-1399930402","viewerDidAuthor":false},{"id":"IC_kwDOEujx185TnA_F","author":{"login":"mjameswh"},"authorAssociation":"MEMBER","body":"@igorsechyn Which \"deployment type\" of Temporal server are you using exactly (ie. Docker, temporalite, temporal-cli, etc) and which persistence backends?","createdAt":"2023-01-24T21:49:49Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1013#issuecomment-1402736581","viewerDidAuthor":false},{"id":"IC_kwDOEujx185To0TJ","author":{"login":"igorsechyn"},"authorAssociation":"NONE","body":"> @igorsechyn Which \"deployment type\" of Temporal server are you using exactly (ie. Docker, temporalite, temporal-cli, etc) and which persistence backends?\r\n\r\nWe are running temporal on kubernetes using docker images. We currently use postgres as a persistence backend.","createdAt":"2023-01-25T07:36:50Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1013#issuecomment-1403208905","viewerDidAuthor":false}],"createdAt":"2023-01-04T18:31:16Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDA2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":1013,"reactionGroups":[],"state":"CLOSED","title":"[Bug] ScheduleClient.list() fails to return any schedules","updatedAt":"2023-01-25T21:51:12Z","url":"https://github.com/temporalio/sdk-typescript/issues/1013"}
