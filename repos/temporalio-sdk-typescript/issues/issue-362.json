{"assignees":[{"id":"MDQ6VXNlcjUyMzA0","login":"bergundy","name":"Roey Berman","databaseId":0}],"author":{"id":"MDQ6VXNlcjUyMzA0","is_bot":false,"login":"bergundy","name":"Roey Berman"},"body":"We should support patches at the top level of user code as shown here:\r\n```ts\r\nlet runActivity = false;\r\nif (patched('p1')) {\r\n  runActivity = true;\r\n}\r\n\r\nexport async function myWorkflow() {\r\n  if (runActivity) {\r\n    await myActivity();\r\n  }\r\n}\r\n```","closedAt":"2021-11-10T22:14:40Z","comments":[{"id":"IC_kwDOEujx1845euzM","author":{"login":"Sushisource"},"authorAssociation":"MEMBER","body":"@bergundy Keep in mind this will only find patches in the 1st/2nd workflow task\r\n\r\nWhich I suppose is fine since during non-replay they should be recorded in 1st WFT","createdAt":"2021-11-09T17:12:17Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/362#issuecomment-964357324","viewerDidAuthor":false},{"id":"IC_kwDOEujx1845e0nJ","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"yup @Sushisource ","createdAt":"2021-11-09T17:39:25Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/362#issuecomment-964381129","viewerDidAuthor":false},{"id":"IC_kwDOEujx1845kFcL","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"We decided to disallow this because patches at top level apply to all workflows and the experience is too confusing.","createdAt":"2021-11-10T21:30:03Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/362#issuecomment-965760779","viewerDidAuthor":false}],"createdAt":"2021-11-09T17:08:48Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDA2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":{"number":2,"title":"beta","description":"","dueOn":null},"number":362,"reactionGroups":[],"state":"CLOSED","title":"[Bug] Patches should be applied to workflow before workflow code is required","updatedAt":"2021-11-10T22:14:40Z","url":"https://github.com/temporalio/sdk-typescript/issues/362"}
