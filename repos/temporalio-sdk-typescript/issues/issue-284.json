{"assignees":[],"author":{"id":"MDQ6VXNlcjI1MTI4OA==","is_bot":false,"login":"lorensr","name":"Loren ☺️"},"body":"### Describe the solution you'd like\r\n\r\nCurrently `shutdown` returns `void`:\r\n\r\nhttps://nodejs.temporal.io/api/classes/worker.Worker#shutdown\r\n\r\nI think it would be nice if it returns a `Promise<void>` that resolves when the Worker finishes shutting down.\r\n\r\n### Additional context\r\n\r\nIt would change this:\r\n\r\n```js\r\n  let runPromise = null;\r\n  let worker = null;\r\n\r\n  before(async function() {\r\n    worker = ...  \r\n    runPromise = worker.run();\r\n  });\r\n\r\n  after(async function() {\r\n    worker.shutdown();\r\n    await runPromise;\r\n  });\r\n```\r\n\r\nto:\r\n\r\n```js\r\n  let worker = null;\r\n\r\n  before(async function() {\r\n    worker = ...\r\n    worker.run();\r\n  });\r\n\r\n  after(async function() {\r\n    await worker.shutdown();\r\n  });\r\n```\r\n\r\n\r\n","closedAt":"2021-10-12T15:31:16Z","comments":[{"id":"IC_kwDOEujx18433vZS","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"Maybe shutdown can return the run promise.\r\nI wouldn't remove the run promise because in actual production code you never shutdown the worker, it shuts itself down if it gets a signal.\r\nThen the new version for testing would be:\r\n```ts\r\n  let worker = null;\r\n\r\n  before(async function() {\r\n    worker = ...\r\n    worker.run().catch(() => undefined); // ignore errors here and catch them in `after`\r\n  });\r\n\r\n  after(async function() {\r\n    await worker.shutdown();\r\n  });\r\n```","createdAt":"2021-10-07T00:55:29Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/284#issuecomment-937358930","viewerDidAuthor":false},{"id":"IC_kwDOEujx18433vfk","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"To clarify catching is for avoiding unhandled rejection.","createdAt":"2021-10-07T00:56:25Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/284#issuecomment-937359332","viewerDidAuthor":false},{"id":"IC_kwDOEujx18433vmi","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"I'm not convinced this is desired though.\r\nShutdown ATM is a synchronous operation that only requests shutdown, making it return the run promise is a bit confusing especially because the stack trace would be weird.","createdAt":"2021-10-07T00:57:41Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/284#issuecomment-937359778","viewerDidAuthor":false},{"id":"IC_kwDOEujx1844GGmk","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"As discussed in slack I'm closing this issue.","createdAt":"2021-10-12T15:31:16Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/284#issuecomment-941124004","viewerDidAuthor":false}],"createdAt":"2021-10-07T00:32:12Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDEz","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":284,"reactionGroups":[],"state":"CLOSED","title":"[Feature Request] Return Promise from Worker.shutdown()","updatedAt":"2021-10-12T15:31:16Z","url":"https://github.com/temporalio/sdk-typescript/issues/284"}
