{"assignees":[],"author":{"id":"MDQ6VXNlcjI1MTI4OA==","is_bot":false,"login":"lorensr","name":"Loren ☺️"},"body":"`npm install temporalio` doesn't work with package managers that do [strict dependency resolution](https://github.com/temporalio/sdk-typescript/issues/421#issuecomment-1067196052) (don't support transitive deps) like pnpm and yarn3.\r\n\r\nWe could either:\r\n- keep `temporalio`, and warn at the top of the README and on install to not use it if you're using such a package manager\r\n- change our setup instructions and samples `package.json`s to install the direct packages:\r\n\r\n  ```\r\n  npm install @temporalio/{client,worker,workflow,activity,common}\r\n  ```\r\n\r\nI think the latter is simpler / will result in less confusion.","closedAt":"2022-07-15T04:08:32Z","comments":[{"id":"IC_kwDOEujx185FxEel","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"No need to install common directly","createdAt":"2022-06-29T21:04:00Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/727#issuecomment-1170491301","viewerDidAuthor":false},{"id":"IC_kwDOEujx185GOeyv","author":{"login":"lorensr"},"authorAssociation":"CONTRIBUTOR","body":"Update: we'll do both, including `npm deprecate temporalio \"message\"`: \r\n\r\nhttps://docs.npmjs.com/cli/v8/commands/npm-deprecate\r\n\r\nHow's this deprecation message?\r\n\r\n```\r\nInstead of installing `temporalio`, we recommend directly installing our packages: npm remove temporalio; npm install @temporalio/client @temporalio/worker @temporalio/workflow @temporalio/activity\r\n```\r\n\r\nWill show up in the \"Author message\" field:\r\n\r\n<img width=\"670\" alt=\"image\" src=\"https://user-images.githubusercontent.com/251288/177867313-df27cde2-2e0c-42e2-8bf1-e983eab2f2fc.png\">\r\n","createdAt":"2022-07-07T20:40:22Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/727#issuecomment-1178201263","viewerDidAuthor":false},{"id":"IC_kwDOEujx185GP_-b","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"SGTM","createdAt":"2022-07-08T06:19:09Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/727#issuecomment-1178599323","viewerDidAuthor":false},{"id":"IC_kwDOEujx185GRT50","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"Question - how do other projects do \"umbrella\" packages like this? Might it make more sense to just have a simple index file for the `temporalio` that imports all of those packages instead? I figure reading \"No need to install common directly\" that transitive dependencies _are_ actually included if referenced?","createdAt":"2022-07-08T12:39:39Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/727#issuecomment-1178943092","viewerDidAuthor":false},{"id":"IC_kwDOEujx185GR1VC","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"We can’t export everything from the umbrella package as is because of workflow sandbox limitations.\r\nWe can work around it but I still want to support using the individual packages and would rather be consistent in our docs and samples.","createdAt":"2022-07-08T14:54:24Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/727#issuecomment-1179080002","viewerDidAuthor":false},{"id":"IC_kwDOEujx185GSEn8","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"> We can’t export everything from the umbrella package as is because of workflow sandbox limitations.\r\n\r\nI am confused, if I only import things from `@temporalio/workflow` in the sandbox, how does that affect what's referenced from `@temporalio`? But understanding this issue now, it doesn't really apply (I was confused what was meant by transitive here, I thought the problem was we never referenced those other packages in code).\r\n\r\nMy other questions still stand. Restated:\r\n\r\n1. How do other projects do \"umbrella\" packages like this?\r\n2. Why \"No need to install common directly\"? If I use anything out of `@temporalio/common`, won't pnpm or yarn fail if I use the setup instructions that we're now using? If so, why are we ok with telling a user \"you must install specific package if you use it with pnpm/yarn\" for \"common\" but not the others?\r\n\r\nIt seems like the limitations of pnpm and yarn would apply to those installing w/ those package managers while those using npm can still use umbrella packages. I'm curious what other projects do here.","createdAt":"2022-07-08T15:55:46Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/727#issuecomment-1179142652","viewerDidAuthor":false},{"id":"IC_kwDOEujx185GSTI1","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"I'll explain what I meant.\r\n\r\nIf we encourage using the umbrella (meta) package, we'll have code in samples and such that looks like:\r\n```ts\r\nimport * as wf from '@temporalio/workflow'\r\n// and\r\nimport * as wf from 'temporalio/workflow'\r\n```\r\n\r\nI'd like to avoid this confusion and have a single \"blessed\" way to import our packages.\r\nI'd also like users only wanting to use the client not to have to install the worker's native dependencies, this will especially become important when we write a browser client.\r\n\r\nThe problem with transitive dependencies is that package managers like pnpm prevent using a dependency without explicitly installing it (e.g specifying in package.json), this is due to the way they organize the packages and work around node's default module resolution.\r\n\r\n> How do other projects do \"umbrella\" packages like this?\r\n\r\nFrom what I've seen, you always install the packages you use.\r\n\r\n> Why \"No need to install common directly\"? If I use anything out of @temporalio/common, won't pnpm or yarn fail if I use the setup instructions that we're now using? If so, why are we ok with telling a user \"you must install specific package if you use it with pnpm/yarn\" for \"common\" but not the others?\r\n\r\nIf you use anything from common with pnpm and yarn, you'll fail (at runtime), this is an expected by users of these package managers. We re-export most of the relevant common utilities from the other packages so you rarely need to install common directly.\r\n\r\n> It seems like the limitations of pnpm and yarn would apply to those installing w/ those package managers while those using npm can still use umbrella packages. I'm curious what other projects do here.\r\n\r\nThat's a valid point, we don't **have** to deprecate the meta package, I may be uneducated here but it seems like the node ecosystem is going towards the more strict package layout scheme and I'd rather steer users in the right direction. When pnpm and yarn3 users see `npm install temporalio` in our getting started guides they'll try the same with their package manager and fail.\r\n","createdAt":"2022-07-08T17:09:46Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/727#issuecomment-1179202101","viewerDidAuthor":false},{"id":"IC_kwDOEujx185GSTou","author":{"login":"lorensr"},"authorAssociation":"CONTRIBUTOR","body":"1. Apollo Client used to have a long list of packages to install. Now they re-export everything from the meta package:\r\n\r\n<img width=\"323\" alt=\"image\" src=\"https://user-images.githubusercontent.com/251288/178038461-7c457b15-5538-4bb3-8051-c5571976afba.png\">\r\n\r\n2. Most samples don't import from `@temporalio/common`, since most things are re-exported from the relevant client/activity/workflow package. I'll add to docs that use common (I think just custom data converters) to `npm install @temporalio/common`.","createdAt":"2022-07-08T17:12:12Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/727#issuecomment-1179204142","viewerDidAuthor":false},{"id":"IC_kwDOEujx185GSYov","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"Thanks! That things are re-exported and the common package isn't directly referenced now makes sense. As for a \"meta\" package, I can understand not wanting that. All of my concerns/questions are handled.","createdAt":"2022-07-08T17:39:47Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/727#issuecomment-1179224623","viewerDidAuthor":false}],"createdAt":"2022-06-27T18:56:25Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDA2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":{"number":6,"title":"1.0","description":"","dueOn":null},"number":727,"reactionGroups":[],"state":"CLOSED","title":"[Bug] Deprecate `temporalio` meta package","updatedAt":"2022-07-15T04:08:32Z","url":"https://github.com/temporalio/sdk-typescript/issues/727"}
