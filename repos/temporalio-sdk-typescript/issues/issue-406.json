{"assignees":[],"author":{"id":"MDQ6VXNlcjMzMzUxODE=","is_bot":false,"login":"JoshuaKGoldberg","name":"Josh Goldberg ✨"},"body":"### Describe the bug\r\n\r\n<!-- A clear and concise description of what the bug is. -->\r\n\r\n### To Reproduce\r\n\r\nRun `node` on a file with these contents:\r\n\r\n```\r\nimport { sleep } from \"@temporalio/workflow\";\r\n\r\nawait sleep(\"100 ms\");\r\n```\r\n\r\n### Expected behavior\r\n\r\nAn error message something like:\r\n\r\n```\r\nWorkflow commands may only be run from within a workflow.\r\n```\r\n\r\n### Screenshots/Terminal output\r\n\r\n```\r\n/mnt/c/Code/temporal-slack-adventure-bot-2/node_modules/@temporalio/workflow/lib/cancellation-scope.js:117\r\n        return exports.storage.getStore() ?? exports.ROOT_SCOPE;\r\n                               ^\r\n\r\nTypeError: exports.storage.getStore is not a function\r\n    at Function.current (/mnt/c/Code/temporal-slack-adventure-bot-2/node_modules/@temporalio/workflow/lib/cancellation-scope.js:117:32)\r\n    at /mnt/c/Code/temporal-slack-adventure-bot-2/node_modules/@temporalio/workflow/lib/workflow.js:28:62\r\n    at new Promise (<anonymous>)\r\n    at timerNextHandler (/mnt/c/Code/temporal-slack-adventure-bot-2/node_modules/@temporalio/workflow/lib/workflow.js:27:12)\r\n    at sleep (/mnt/c/Code/temporal-slack-adventure-bot-2/node_modules/@temporalio/workflow/lib/workflow.js:70:12)\r\n    at file:///mnt/c/Code/temporal-slack-adventure-bot-2/src/repro.mjs:3:7\r\n    at ModuleJob.run (node:internal/modules/esm/module_job:185:25)\r\n    at async Promise.all (index 0)\r\n    at async ESMLoader.import (node:internal/modules/esm/loader:281:24)\r\n    at async loadESM (node:internal/process/esm_loader:88:5)\r\n```\r\n\r\n### Versions\r\n\r\n<!-- Please complete the following information where relevant. -->\r\n\r\n- OS: [e.g. Mac, Windows, Linux]: WSL 2.0 Ubuntu\r\n- Temporal Version 0.16.x of the TypeScript SDK\r\n- Are you using Docker or Kubernetes or building Temporal from source?: Docker\r\n\r\n","closedAt":"2022-11-23T22:17:01Z","comments":[{"id":"IC_kwDOEujx1846e2JK","author":{"login":"lorensr"},"authorAssociation":"CONTRIBUTOR","body":"> Workflow commands may only be run from within a workflow.\r\n\r\nI like it—sounds like a helpful message to see for all `@temporal/workflow` exports used outside of an isolate. Maybe:\r\n\r\nError: This function is meant to be used inside Workflow code. Workflow code should only be run by the Worker (and is provided to the Worker via either the `workflowsPath` or `workflowBundle` option).\r\n","createdAt":"2021-11-28T22:31:59Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-typescript/issues/406#issuecomment-981164618","viewerDidAuthor":false},{"id":"IC_kwDOEujx185PBOKz","author":{"login":"mjameswh"},"authorAssociation":"MEMBER","body":"Closing in favor of #553.","createdAt":"2022-11-23T22:17:01Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/406#issuecomment-1325720243","viewerDidAuthor":false}],"createdAt":"2021-11-28T10:36:54Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDA2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":406,"reactionGroups":[],"state":"CLOSED","title":"[Bug] Poor error message running sleep() in a Node script","updatedAt":"2022-11-23T22:17:01Z","url":"https://github.com/temporalio/sdk-typescript/issues/406"}
