{"assignees":[],"author":{"id":"MDQ6VXNlcjEwMjI2NzEz","is_bot":false,"login":"getarun","name":"Dome"},"body":"## Expected Behavior\r\n\r\nTemporal should execute as shown in the minimal examples (tested hello-world).\r\n## Actual Behavior\r\n\r\nMinimal examples run fine `ts-node src/client.ts`.\r\nCode run in meteor with meteor run `src/client.ts` fails with error while executing `new Connection.connect()`\r\n\r\n## Steps to Reproduce the Problem\r\n\r\n  1. Set up meteor project with meteor 2.7.3\r\n  2. Copy copy from example to server side (/server) and import it in /server/index.ts\r\n  3. Run project with meteor run.\r\n  4. When new Connection.connect() is called the error is thrown.\r\n~~~\r\n  W20221014-19:37:06.005(2)? (STDERR) TypeError: Cannot read property 'Symbol(kResourceStore)' of undefined\r\nW20221014-19:37:06.005(2)? (STDERR)     at AsyncLocalStorage._propagate (async_hooks.js:288:34)\r\nW20221014-19:37:06.005(2)? (STDERR)     at AsyncHook.init (async_hooks.js:255:22)\r\nW20221014-19:37:06.005(2)? (STDERR)     at emitInitNative (internal/async_hooks.js:203:43)\r\nW20221014-19:37:06.006(2)? (STDERR)     at emitInitScript (internal/async_hooks.js:493:3)\r\nW20221014-19:37:06.006(2)? (STDERR)     at promiseInitHook (internal/async_hooks.js:323:3)\r\nW20221014-19:37:06.006(2)? (STDERR)     at new Promise (<anonymous>)\r\nW20221014-19:37:06.006(2)? (STDERR)     at FiberPool.run (/home/xxx/.meteor/packages/promise/.0.12.0.wdpd7b.4qul++os+web.browser+web.browser.legacy+web.cordova/npm/node_modules/meteor-promise/fiber_pool.js:94:19)\r\nW20221014-19:37:06.006(2)? (STDERR)     at result (/home/xxx/.meteor/packages/promise/.0.12.0.wdpd7b.4qul++os+web.browser+web.browser.legacy+web.cordova/npm/node_modules/meteor-promise/promise_server.js:157:29)\r\nW20221014-19:37:06.006(2)? (STDERR)     at processTicksAndRejections (internal/process/task_queues.js:95:5)\r\n~~~\r\n\r\n## Specifications\r\n\r\n  - Version: Meteor 2.7.3, node 14.19.3\r\n  - Platform: linux, x64\r\n  - SDK: Typescript\r\n  - npm package: @temporalio/client\r\n  - function that crashes: Connection.connect();\r\n\r\n## Thoughts\r\n- Since there seem to be a meteor problem with newer versions (something I can't grasp in detail) and these kind of errors\r\n  - (https://github.com/meteor/meteor/issues/11539)\r\n  - (https://github.com/meteor/meteor/discussions/11505)\r\n\r\n## Question\r\n- How can I run temporal typescript sdk in a meteor 2.7.3 environment?\r\n- Is there a way to maybe run it without AsyncLocalStorage (what seems to be the issue here)\r\n\r\nThank you for your time :)\r\n","closedAt":"2023-01-24T01:56:15Z","comments":[{"id":"IC_kwDOEujx185MQc6q","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"Oh i see meteor is using fibers, that might conflict with AsyncLocalStorage.\r\nWe could look into degrading the client capabilities when AsyncLocalStorage cannot be accessed.","createdAt":"2022-10-14T19:31:15Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/921#issuecomment-1279381162","viewerDidAuthor":false},{"id":"IC_kwDOEujx185MRrKp","author":{"login":"getarun"},"authorAssociation":"NONE","body":"Yeah, is there a way to achieve this right now?´Maybe me patching it? Not\nsure where to look and what to replace it with :/\n\nAm Fr., 14. Okt. 2022 um 21:31 Uhr schrieb Roey Berman <\n***@***.***>:\n\n> Oh i see meteor is using fibers, that might conflict with\n> AsyncLocalStorage.\n> We could look into degrading the client capabilities when\n> AsyncLocalStorage cannot be accessed.\n>\n> —\n> Reply to this email directly, view it on GitHub\n> <https://github.com/temporalio/sdk-typescript/issues/921#issuecomment-1279381162>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/ACOAYGLJGCJLC6O2VJ5QEI3WDGYI5ANCNFSM6AAAAAARFP6R2Y>\n> .\n> You are receiving this because you authored the thread.Message ID:\n> ***@***.***>\n>\n","createdAt":"2022-10-15T09:09:41Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/921#issuecomment-1279701673","viewerDidAuthor":false},{"id":"IC_kwDOEujx185MR9Ec","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"Probably this line:\r\nhttps://github.com/temporalio/sdk-typescript/blob/bfb0065fe1c562fa3ca5725e254bd5c0a1ca6d16/packages/client/src/connection.ts#L334","createdAt":"2022-10-15T16:11:12Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/921#issuecomment-1279775004","viewerDidAuthor":false},{"id":"IC_kwDOEujx185MSJB1","author":{"login":"getarun"},"authorAssociation":"NONE","body":"thank you, will have a look :)\n\nAm Sa., 15. Okt. 2022 um 18:11 Uhr schrieb Roey Berman <\n***@***.***>:\n\n> Probably this line:\n>\n> https://github.com/temporalio/sdk-typescript/blob/bfb0065fe1c562fa3ca5725e254bd5c0a1ca6d16/packages/client/src/connection.ts#L334\n>\n> —\n> Reply to this email directly, view it on GitHub\n> <https://github.com/temporalio/sdk-typescript/issues/921#issuecomment-1279775004>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/ACOAYGKS7VX5QNA4WJNBV6TWDLJSXANCNFSM6AAAAAARFP6R2Y>\n> .\n> You are receiving this because you authored the thread.Message ID:\n> ***@***.***>\n>\n","createdAt":"2022-10-15T20:06:29Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/921#issuecomment-1279823989","viewerDidAuthor":false},{"id":"IC_kwDOEujx185SiHtN","author":{"login":"mjameswh"},"authorAssociation":"MEMBER","body":"@getarun Can we close this ticket?","createdAt":"2023-01-16T23:45:24Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/921#issuecomment-1384676173","viewerDidAuthor":false},{"id":"IC_kwDOEujx185TQSuG","author":{"login":"getarun"},"authorAssociation":"NONE","body":"Yes\n\nAm Di., 17. Jan. 2023 um 00:45 Uhr schrieb James Watkins-Harvey <\n***@***.***>:\n\n> @getarun <https://github.com/getarun> Can we close this ticket?\n>\n> —\n> Reply to this email directly, view it on GitHub\n> <https://github.com/temporalio/sdk-typescript/issues/921#issuecomment-1384676173>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/ACOAYGJROUP5GHLSPQ4RDLDWSXMR7ANCNFSM6AAAAAARFP6R2Y>\n> .\n> You are receiving this because you were mentioned.Message ID:\n> ***@***.***>\n>\n","createdAt":"2023-01-19T10:51:54Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/921#issuecomment-1396779910","viewerDidAuthor":false}],"createdAt":"2022-10-14T18:14:44Z","labels":[],"milestone":null,"number":921,"reactionGroups":[],"state":"CLOSED","title":"[Advice needed] Run temporal in meteor 2.7.3 / node 14.19.3","updatedAt":"2023-01-24T01:56:15Z","url":"https://github.com/temporalio/sdk-typescript/issues/921"}
