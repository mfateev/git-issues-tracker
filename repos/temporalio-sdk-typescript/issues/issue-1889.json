{"assignees":[],"author":{"id":"MDQ6VXNlcjgwMDc5ODg=","is_bot":false,"login":"maxi1555","name":""},"body":"### What are you really trying to do?\n\nTrying to use the TEMPORAL AI-SDK for tool calls.\n\n### Describe the bug\n\nI made the simplest \"agent\" with two tools( MCP ), and I had plenty of issues using the \"TEMPORAL AI-SDK\", later I made the **same** \"agent\" directly with the \"Vercel AI-SDK\" and it worked as expected.\n\nComparing the \"result.steps\" returned by the function \"generateText\" I've noticed that the tools send in the request by the agent that used the \"TEMPORAL AI-SDK\" has not any description and even the definition for the input parameters for the tool list-services is incorrect:\n\nVercel AI-SDK:\n`{\n    \"steps\": [\n        {\n            \"content\": [\n                {\n                    \"dynamic\": true,\n                    \"input\": {\n                    },\n                    \"toolCallId\": \"863b6663-948f-4c44-a8b4-f125c6d2c2a8\",\n                    \"toolName\": \"list-regions\",\n                    \"type\": \"tool-call\"\n                },\n                {\n                    \"dynamic\": true,\n                    \"input\": {\n                    },\n                    \"output\": {\n                        \"content\": [\n                            {\n                                \"text\": \"[{\\\"id\\\":\\\"us-east-1\\\",\\\"name\\\":\\\"US East (N. Virginia)\\\",\\\"description\\\":\\\"US East (N. Virginia) Region\\\"},{\\\"id\\\":\\\"eu-west-1\\\",\\\"name\\\":\\\"Europe (Ireland)\\\",\\\"description\\\":\\\"Europe (Ireland) Region\\\"},{\\\"id\\\":\\\"us-west-2\\\",\\\"name\\\":\\\"US West (Oregon)\\\",\\\"description\\\":\\\"US West (Oregon) Region\\\"}]\",\n                                \"type\": \"text\"\n                            }\n                        ],\n                        \"isError\": false\n                    },\n                    \"toolCallId\": \"863b6663-948f-4c44-a8b4-f125c6d2c2a8\",\n                    \"toolName\": \"list-regions\",\n                    \"type\": \"tool-result\"\n                }\n            ],\n            \"providerMetadata\": {\n                \"ollama\": {\n                    \"created_at\": \"2026-01-15T14:06:46.871Z\",\n                    \"eval_duration\": 1188321090,\n                    \"load_duration\": 19071749241,\n                    \"model\": \"qwen2.5:3b\",\n                    \"reliable_tool_calling\": false,\n                    \"total_duration\": 32311968813\n                }\n            },\n            \"request\": {\n                \"body\": {\n                    \"messages\": [\n                        {\n                            \"content\": \"You are an agent that execute mcp tools. If you need mandatory parameters to execute a tool, ask for them to the user. You must not guess input parameters. You must not guess parameters names, double check the parameters names.\",\n                            \"role\": \"system\"\n                        },\n                        {\n                            \"content\": \"show me the regions\",\n                            \"role\": \"user\"\n                        }\n                    ],\n                    \"model\": \"qwen2.5:3b\",\n                    \"options\": {\n                    },\n                    \"tools\": [\n                        {\n                            \"function\": {\n                                \"description\": \"Tool that returns a list of regions of the platform. The response field \\\"id\\\" is the \\\"regionId\\\" used in the other tools\",\n                                \"name\": \"list-regions\",\n                                \"parameters\": {\n                                    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n                                    \"additionalProperties\": false,\n                                    \"properties\": {\n                                    },\n                                    \"type\": \"object\"\n                                }\n                            },\n                            \"type\": \"function\"\n                        },\n                        {\n                            \"function\": {\n                                \"description\": \"Tool that returns a list of services available in a region\",\n                                \"name\": \"list-services\",\n                                \"parameters\": {\n                                    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n                                    \"additionalProperties\": false,\n                                    \"properties\": {\n                                        \"regionId\": {\n                                            \"description\": \"The regionId of the region to list services.\",\n                                            \"type\": \"string\"\n                                        }\n                                    },\n                                    \"required\": [\n                                        \"regionId\"\n                                    ],\n                                    \"type\": \"object\"\n                                }\n                            },\n                            \"type\": \"function\"\n                        }\n                    ]\n                }\n            },\n            \"response\": {\n                \"id\": \"aitxt-R8raiK4IGi4Qikp00KEKqmbJ\",\n                \"messages\": [\n                    {\n                        \"content\": [\n                            {\n                                \"input\": {\n                                },\n                                \"toolCallId\": \"863b6663-948f-4c44-a8b4-f125c6d2c2a8\",\n                                \"toolName\": \"list-regions\",\n                                \"type\": \"tool-call\"\n                            }\n                        ],\n                        \"role\": \"assistant\"\n                    },\n                    {\n                        \"content\": [\n                            {\n                                \"output\": {\n                                    \"type\": \"json\",\n                                    \"value\": {\n                                        \"content\": [\n                                            {\n                                                \"text\": \"[{\\\"id\\\":\\\"us-east-1\\\",\\\"name\\\":\\\"US East (N. Virginia)\\\",\\\"description\\\":\\\"US East (N. Virginia) Region\\\"},{\\\"id\\\":\\\"eu-west-1\\\",\\\"name\\\":\\\"Europe (Ireland)\\\",\\\"description\\\":\\\"Europe (Ireland) Region\\\"},{\\\"id\\\":\\\"us-west-2\\\",\\\"name\\\":\\\"US West (Oregon)\\\",\\\"description\\\":\\\"US West (Oregon) Region\\\"}]\",\n                                                \"type\": \"text\"\n                                            }\n                                        ],\n                                        \"isError\": false\n                                    }\n                                },\n                                \"toolCallId\": \"863b6663-948f-4c44-a8b4-f125c6d2c2a8\",\n                                \"toolName\": \"list-regions\",\n                                \"type\": \"tool-result\"\n                            }\n                        ],\n                        \"role\": \"tool\"\n                    }\n                ],\n                \"modelId\": \"qwen2.5:3b\",\n                \"timestamp\": \"2026-01-15T14:06:46.878Z\"\n            },\n            \"usage\": {\n                \"inputTokenDetails\": {\n                    \"noCacheTokens\": 263\n                },\n                \"inputTokens\": 263,\n                \"outputTokenDetails\": {\n                    \"textTokens\": 17\n                },\n                \"outputTokens\": 17,\n                \"totalTokens\": 280\n            },\n            \"warnings\": [\n            ]\n        },\n        {\n            \"content\": [\n                {\n                    \"text\": \"The available regions in the platform are:\\n\\n- US East (N. Virginia)\\n  - Description: US East (N. Virginia) Region\\n- Europe (Ireland)\\n  - Description: Europe (Ireland) Region\\n- US West (Oregon)\\n  - Description: US West (Oregon) Region\",\n                    \"type\": \"text\"\n                }\n            ],\n            \"providerMetadata\": {\n                \"ollama\": {\n                    \"created_at\": \"2026-01-15T14:06:56.945Z\",\n                    \"eval_duration\": 4941716997,\n                    \"load_duration\": 152669348,\n                    \"model\": \"qwen2.5:3b\",\n                    \"reliable_tool_calling\": false,\n                    \"total_duration\": 10028656753\n                }\n            },\n            \"request\": {\n                \"body\": {\n                    \"messages\": [\n                        {\n                            \"content\": \"You are an agent that execute mcp tools. If you need mandatory parameters to execute a tool, ask for them to the user. You must not guess input parameters. You must not guess parameters names, double check the parameters names.\",\n                            \"role\": \"system\"\n                        },\n                        {\n                            \"content\": \"show me the regions\",\n                            \"role\": \"user\"\n                        },\n                        {\n                            \"content\": \"\",\n                            \"role\": \"assistant\",\n                            \"tool_calls\": [\n                                {\n                                    \"function\": {\n                                        \"arguments\": {\n                                        },\n                                        \"name\": \"list-regions\"\n                                    },\n                                    \"id\": \"863b6663-948f-4c44-a8b4-f125c6d2c2a8\",\n                                    \"type\": \"function\"\n                                }\n                            ]\n                        },\n                        {\n                            \"content\": \"{\\\"content\\\":[{\\\"type\\\":\\\"text\\\",\\\"text\\\":\\\"[{\\\\\\\"id\\\\\\\":\\\\\\\"us-east-1\\\\\\\",\\\\\\\"name\\\\\\\":\\\\\\\"US East (N. Virginia)\\\\\\\",\\\\\\\"description\\\\\\\":\\\\\\\"US East (N. Virginia) Region\\\\\\\"},{\\\\\\\"id\\\\\\\":\\\\\\\"eu-west-1\\\\\\\",\\\\\\\"name\\\\\\\":\\\\\\\"Europe (Ireland)\\\\\\\",\\\\\\\"description\\\\\\\":\\\\\\\"Europe (Ireland) Region\\\\\\\"},{\\\\\\\"id\\\\\\\":\\\\\\\"us-west-2\\\\\\\",\\\\\\\"name\\\\\\\":\\\\\\\"US West (Oregon)\\\\\\\",\\\\\\\"description\\\\\\\":\\\\\\\"US West (Oregon) Region\\\\\\\"}]\\\"}],\\\"isError\\\":false}\",\n                            \"role\": \"tool\",\n                            \"tool_name\": \"list-regions\"\n                        }\n                    ],\n                    \"model\": \"qwen2.5:3b\",\n                    \"options\": {\n                    },\n                    \"tools\": [\n                        {\n                            \"function\": {\n                                \"description\": \"Tool that returns a list of regions of the platform. The response field \\\"id\\\" is the \\\"regionId\\\" used in the other tools\",\n                                \"name\": \"list-regions\",\n                                \"parameters\": {\n                                    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n                                    \"additionalProperties\": false,\n                                    \"properties\": {\n                                    },\n                                    \"type\": \"object\"\n                                }\n                            },\n                            \"type\": \"function\"\n                        },\n                        {\n                            \"function\": {\n                                \"description\": \"Tool that returns a list of services available in a region\",\n                                \"name\": \"list-services\",\n                                \"parameters\": {\n                                    \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n                                    \"additionalProperties\": false,\n                                    \"properties\": {\n                                        \"regionId\": {\n                                            \"description\": \"The regionId of the region to list services.\",\n                                            \"type\": \"string\"\n                                        }\n                                    },\n                                    \"required\": [\n                                        \"regionId\"\n                                    ],\n                                    \"type\": \"object\"\n                                }\n                            },\n                            \"type\": \"function\"\n                        }\n                    ]\n                }\n            },\n            \"response\": {\n                \"id\": \"aitxt-U2ofiy1hauhnPV1FyNcrZGnS\",\n                \"messages\": [\n                    {\n                        \"content\": [\n                            {\n                                \"input\": {\n                                },\n                                \"toolCallId\": \"863b6663-948f-4c44-a8b4-f125c6d2c2a8\",\n                                \"toolName\": \"list-regions\",\n                                \"type\": \"tool-call\"\n                            }\n                        ],\n                        \"role\": \"assistant\"\n                    },\n                    {\n                        \"content\": [\n                            {\n                                \"output\": {\n                                    \"type\": \"json\",\n                                    \"value\": {\n                                        \"content\": [\n                                            {\n                                                \"text\": \"[{\\\"id\\\":\\\"us-east-1\\\",\\\"name\\\":\\\"US East (N. Virginia)\\\",\\\"description\\\":\\\"US East (N. Virginia) Region\\\"},{\\\"id\\\":\\\"eu-west-1\\\",\\\"name\\\":\\\"Europe (Ireland)\\\",\\\"description\\\":\\\"Europe (Ireland) Region\\\"},{\\\"id\\\":\\\"us-west-2\\\",\\\"name\\\":\\\"US West (Oregon)\\\",\\\"description\\\":\\\"US West (Oregon) Region\\\"}]\",\n                                                \"type\": \"text\"\n                                            }\n                                        ],\n                                        \"isError\": false\n                                    }\n                                },\n                                \"toolCallId\": \"863b6663-948f-4c44-a8b4-f125c6d2c2a8\",\n                                \"toolName\": \"list-regions\",\n                                \"type\": \"tool-result\"\n                            }\n                        ],\n                        \"role\": \"tool\"\n                    },\n                    {\n                        \"content\": [\n                            {\n                                \"text\": \"The available regions in the platform are:\\n\\n- US East (N. Virginia)\\n  - Description: US East (N. Virginia) Region\\n- Europe (Ireland)\\n  - Description: Europe (Ireland) Region\\n- US West (Oregon)\\n  - Description: US West (Oregon) Region\",\n                                \"type\": \"text\"\n                            }\n                        ],\n                        \"role\": \"assistant\"\n                    }\n                ],\n                \"modelId\": \"qwen2.5:3b\",\n                \"timestamp\": \"2026-01-15T14:06:56.945Z\"\n            },\n            \"usage\": {\n                \"inputTokenDetails\": {\n                    \"noCacheTokens\": 399\n                },\n                \"inputTokens\": 399,\n                \"outputTokenDetails\": {\n                    \"textTokens\": 63\n                },\n                \"outputTokens\": 63,\n                \"totalTokens\": 462\n            },\n            \"warnings\": [\n            ]\n        }\n    ],\n    \"totalUsage\": {\n        \"inputTokenDetails\": {\n            \"noCacheTokens\": 662\n        },\n        \"inputTokens\": 662,\n        \"outputTokenDetails\": {\n            \"textTokens\": 80\n        },\n        \"outputTokens\": 80,\n        \"totalTokens\": 742\n    }\n}`\n\nTEMPORAL AI-SDK:\n`{\n    \"steps\": [\n        {\n            \"content\": [\n                {\n                    \"dynamic\": true,\n                    \"input\": {\n                    },\n                    \"toolCallId\": \"d18df5bf-feec-4e68-b224-a2bd254369b2\",\n                    \"toolName\": \"list-regions\",\n                    \"type\": \"tool-call\"\n                },\n                {\n                    \"dynamic\": true,\n                    \"input\": {\n                    },\n                    \"output\": {\n                        \"content\": [\n                            {\n                                \"text\": \"[{\\\"id\\\":\\\"us-east-1\\\",\\\"name\\\":\\\"US East (N. Virginia)\\\",\\\"description\\\":\\\"US East (N. Virginia) Region\\\"},{\\\"id\\\":\\\"eu-west-1\\\",\\\"name\\\":\\\"Europe (Ireland)\\\",\\\"description\\\":\\\"Europe (Ireland) Region\\\"},{\\\"id\\\":\\\"us-west-2\\\",\\\"name\\\":\\\"US West (Oregon)\\\",\\\"description\\\":\\\"US West (Oregon) Region\\\"}]\",\n                                \"type\": \"text\"\n                            }\n                        ],\n                        \"isError\": false\n                    },\n                    \"toolCallId\": \"d18df5bf-feec-4e68-b224-a2bd254369b2\",\n                    \"toolName\": \"list-regions\",\n                    \"type\": \"tool-result\"\n                }\n            ],\n            \"providerMetadata\": {\n                \"ollama\": {\n                    \"created_at\": \"2026-01-15T14:10:29.445Z\",\n                    \"eval_duration\": 1096000388,\n                    \"load_duration\": 85288184,\n                    \"model\": \"qwen2.5:3b\",\n                    \"reliable_tool_calling\": false,\n                    \"total_duration\": 1334480843\n                }\n            },\n            \"request\": {\n                \"body\": {\n                    \"messages\": [\n                        {\n                            \"content\": \"You are an agent that execute mcp tools. If you need mandatory parameters to execute a tool, ask for them to the user. You must not guess input parameters. You must not guess parameters names, double check the parameters names.\",\n                            \"role\": \"system\"\n                        },\n                        {\n                            \"content\": \"show me the regions\",\n                            \"role\": \"user\"\n                        }\n                    ],\n                    \"model\": \"qwen2.5:3b\",\n                    \"options\": {\n                    },\n                    \"tools\": [\n                        {\n                            \"function\": {\n                                \"name\": \"list-regions\",\n                                \"parameters\": {\n                                    \"additionalProperties\": false,\n                                    \"properties\": {\n                                    },\n                                    \"type\": \"object\"\n                                }\n                            },\n                            \"type\": \"function\"\n                        },\n                        {\n                            \"function\": {\n                                \"name\": \"list-services\",\n                                \"parameters\": {\n                                    \"additionalProperties\": false,\n                                    \"properties\": {\n                                    },\n                                    \"type\": \"object\"\n                                }\n                            },\n                            \"type\": \"function\"\n                        }\n                    ]\n                }\n            },\n            \"response\": {\n                \"id\": \"aitxt-IddJF5drggD75uN33vwW8dTS\",\n                \"messages\": [\n                    {\n                        \"content\": [\n                            {\n                                \"input\": {\n                                },\n                                \"toolCallId\": \"d18df5bf-feec-4e68-b224-a2bd254369b2\",\n                                \"toolName\": \"list-regions\",\n                                \"type\": \"tool-call\"\n                            }\n                        ],\n                        \"role\": \"assistant\"\n                    },\n                    {\n                        \"content\": [\n                            {\n                                \"output\": {\n                                    \"type\": \"json\",\n                                    \"value\": {\n                                        \"content\": [\n                                            {\n                                                \"text\": \"[{\\\"id\\\":\\\"us-east-1\\\",\\\"name\\\":\\\"US East (N. Virginia)\\\",\\\"description\\\":\\\"US East (N. Virginia) Region\\\"},{\\\"id\\\":\\\"eu-west-1\\\",\\\"name\\\":\\\"Europe (Ireland)\\\",\\\"description\\\":\\\"Europe (Ireland) Region\\\"},{\\\"id\\\":\\\"us-west-2\\\",\\\"name\\\":\\\"US West (Oregon)\\\",\\\"description\\\":\\\"US West (Oregon) Region\\\"}]\",\n                                                \"type\": \"text\"\n                                            }\n                                        ],\n                                        \"isError\": false\n                                    }\n                                },\n                                \"toolCallId\": \"d18df5bf-feec-4e68-b224-a2bd254369b2\",\n                                \"toolName\": \"list-regions\",\n                                \"type\": \"tool-result\"\n                            }\n                        ],\n                        \"role\": \"tool\"\n                    }\n                ],\n                \"modelId\": \"qwen2.5:3b\",\n                \"timestamp\": \"2026-01-15T14:10:29.449Z\"\n            },\n            \"usage\": {\n                \"inputTokenDetails\": {\n                    \"noCacheTokens\": 194\n                },\n                \"inputTokens\": 194,\n                \"outputTokenDetails\": {\n                    \"textTokens\": 17\n                },\n                \"outputTokens\": 17,\n                \"totalTokens\": 211\n            },\n            \"warnings\": [\n            ]\n        },\n        {\n            \"content\": [\n                {\n                    \"text\": \"Here are the available regions:\\n\\n1. **US East (N. Virginia)** - id: us-east-1, Description: US East (N. Virginia) Region\\n2. **Europe (Ireland)** - id: eu-west-1, Description: Europe (Ireland) Region\\n3. **US West (Oregon)** - id: us-west-2, Description: US West (Oregon) Region\\n\\nWould you like to see the services available in a specific region?\",\n                    \"type\": \"text\"\n                }\n            ],\n            \"providerMetadata\": {\n                \"ollama\": {\n                    \"created_at\": \"2026-01-15T14:10:41.104Z\",\n                    \"eval_duration\": 6878827970,\n                    \"load_duration\": 99512518,\n                    \"model\": \"qwen2.5:3b\",\n                    \"reliable_tool_calling\": false,\n                    \"total_duration\": 11430659920\n                }\n            },\n            \"request\": {\n                \"body\": {\n                    \"messages\": [\n                        {\n                            \"content\": \"You are an agent that execute mcp tools. If you need mandatory parameters to execute a tool, ask for them to the user. You must not guess input parameters. You must not guess parameters names, double check the parameters names.\",\n                            \"role\": \"system\"\n                        },\n                        {\n                            \"content\": \"show me the regions\",\n                            \"role\": \"user\"\n                        },\n                        {\n                            \"content\": \"\",\n                            \"role\": \"assistant\",\n                            \"tool_calls\": [\n                                {\n                                    \"function\": {\n                                        \"arguments\": {\n                                        },\n                                        \"name\": \"list-regions\"\n                                    },\n                                    \"id\": \"d18df5bf-feec-4e68-b224-a2bd254369b2\",\n                                    \"type\": \"function\"\n                                }\n                            ]\n                        },\n                        {\n                            \"content\": \"{\\\"content\\\":[{\\\"type\\\":\\\"text\\\",\\\"text\\\":\\\"[{\\\\\\\"id\\\\\\\":\\\\\\\"us-east-1\\\\\\\",\\\\\\\"name\\\\\\\":\\\\\\\"US East (N. Virginia)\\\\\\\",\\\\\\\"description\\\\\\\":\\\\\\\"US East (N. Virginia) Region\\\\\\\"},{\\\\\\\"id\\\\\\\":\\\\\\\"eu-west-1\\\\\\\",\\\\\\\"name\\\\\\\":\\\\\\\"Europe (Ireland)\\\\\\\",\\\\\\\"description\\\\\\\":\\\\\\\"Europe (Ireland) Region\\\\\\\"},{\\\\\\\"id\\\\\\\":\\\\\\\"us-west-2\\\\\\\",\\\\\\\"name\\\\\\\":\\\\\\\"US West (Oregon)\\\\\\\",\\\\\\\"description\\\\\\\":\\\\\\\"US West (Oregon) Region\\\\\\\"}]\\\"}],\\\"isError\\\":false}\",\n                            \"role\": \"tool\",\n                            \"tool_name\": \"list-regions\"\n                        }\n                    ],\n                    \"model\": \"qwen2.5:3b\",\n                    \"options\": {\n                    },\n                    \"tools\": [\n                        {\n                            \"function\": {\n                                \"name\": \"list-regions\",\n                                \"parameters\": {\n                                    \"additionalProperties\": false,\n                                    \"properties\": {\n                                    },\n                                    \"type\": \"object\"\n                                }\n                            },\n                            \"type\": \"function\"\n                        },\n                        {\n                            \"function\": {\n                                \"name\": \"list-services\",\n                                \"parameters\": {\n                                    \"additionalProperties\": false,\n                                    \"properties\": {\n                                    },\n                                    \"type\": \"object\"\n                                }\n                            },\n                            \"type\": \"function\"\n                        }\n                    ]\n                }\n            },\n            \"response\": {\n                \"id\": \"aitxt-v3ny7ZlxqQ0oD1W8eLZnp4zx\",\n                \"messages\": [\n                    {\n                        \"content\": [\n                            {\n                                \"input\": {\n                                },\n                                \"toolCallId\": \"d18df5bf-feec-4e68-b224-a2bd254369b2\",\n                                \"toolName\": \"list-regions\",\n                                \"type\": \"tool-call\"\n                            }\n                        ],\n                        \"role\": \"assistant\"\n                    },\n                    {\n                        \"content\": [\n                            {\n                                \"output\": {\n                                    \"type\": \"json\",\n                                    \"value\": {\n                                        \"content\": [\n                                            {\n                                                \"text\": \"[{\\\"id\\\":\\\"us-east-1\\\",\\\"name\\\":\\\"US East (N. Virginia)\\\",\\\"description\\\":\\\"US East (N. Virginia) Region\\\"},{\\\"id\\\":\\\"eu-west-1\\\",\\\"name\\\":\\\"Europe (Ireland)\\\",\\\"description\\\":\\\"Europe (Ireland) Region\\\"},{\\\"id\\\":\\\"us-west-2\\\",\\\"name\\\":\\\"US West (Oregon)\\\",\\\"description\\\":\\\"US West (Oregon) Region\\\"}]\",\n                                                \"type\": \"text\"\n                                            }\n                                        ],\n                                        \"isError\": false\n                                    }\n                                },\n                                \"toolCallId\": \"d18df5bf-feec-4e68-b224-a2bd254369b2\",\n                                \"toolName\": \"list-regions\",\n                                \"type\": \"tool-result\"\n                            }\n                        ],\n                        \"role\": \"tool\"\n                    },\n                    {\n                        \"content\": [\n                            {\n                                \"text\": \"Here are the available regions:\\n\\n1. **US East (N. Virginia)** - id: us-east-1, Description: US East (N. Virginia) Region\\n2. **Europe (Ireland)** - id: eu-west-1, Description: Europe (Ireland) Region\\n3. **US West (Oregon)** - id: us-west-2, Description: US West (Oregon) Region\\n\\nWould you like to see the services available in a specific region?\",\n                                \"type\": \"text\"\n                            }\n                        ],\n                        \"role\": \"assistant\"\n                    }\n                ],\n                \"modelId\": \"qwen2.5:3b\",\n                \"timestamp\": \"2026-01-15T14:10:41.105Z\"\n            },\n            \"usage\": {\n                \"inputTokenDetails\": {\n                    \"noCacheTokens\": 330\n                },\n                \"inputTokens\": 330,\n                \"outputTokenDetails\": {\n                    \"textTokens\": 99\n                },\n                \"outputTokens\": 99,\n                \"totalTokens\": 429\n            },\n            \"warnings\": [\n            ]\n        }\n    ],\n    \"totalUsage\": {\n        \"inputTokenDetails\": {\n            \"noCacheTokens\": 524\n        },\n        \"inputTokens\": 524,\n        \"outputTokenDetails\": {\n            \"textTokens\": 116\n        },\n        \"outputTokens\": 116,\n        \"totalTokens\": 640\n    }\n}`\n\nAs you can imagine the LLMs relies on text / description removing them makes them dummy :( and you can imagine what is happening if the tools receive wrong input parameters :O specially the MCPs...","closedAt":"2026-01-22T17:54:56Z","comments":[{"id":"IC_kwDOEujx187f4gOW","author":{"login":"tconley1428"},"authorAssociation":"MEMBER","body":"I'm not able to reproduce the same issue, but it did cause me to find what I think is a distinct issue with MCP tools. https://github.com/temporalio/sdk-typescript/pull/1890. We'll publish a release with that and another fix soon. If you still see this issue, can you give a bit more detail on how you're getting the MCP tools? I see the descriptions and parameters filled in in my testing.","createdAt":"2026-01-15T17:49:16Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1889#issuecomment-3756131222","viewerDidAuthor":false},{"id":"IC_kwDOEujx187f8mz_","author":{"login":"maxi1555"},"authorAssociation":"NONE","body":"Hi,\nI've implemented the changes of 1890, but not luck.\n\nAbout how I'm getting the tools I can say quite following the docs:\n\n---worker begin---\n...\nconst activities = require(\"../activities\");\nconst { AiSdkPlugin } = require(\"@temporalio/ai-sdk\");\nconst { createOllama } = require(\"ai-sdk-ollama\");\nconst { experimental_createMCPClient } = require(\"@ai-sdk/mcp\");\nconst {\n  StreamableHTTPClientTransport,\n} = require(\"@modelcontextprotocol/sdk/client/streamableHttp.js\");\n...\n  const modelProvider = createOllama({\n    baseURL: \"http://localhost:11434\",\n  });\n...\n  const mcpClientFactories = {\n    testServer: () =>\n      experimental_createMCPClient({\n        transport: new StreamableHTTPClientTransport(\n          new URL(\"http://localhost:12001/mcp\")\n        ),\n      }),\n  };\n...\n    const workerForAi = await Worker.create({\n      plugins: [\n        new AiSdkPlugin({\n          modelProvider: modelProvider,\n          mcpClientFactories,\n        }),\n      ],\n      connection,\n      workflowsPath: require.resolve(\"../workflows\"),\n      activities,\n      taskQueue: \"ai\",\n    });\n---worker end---\n\n\n---workflow begin---\n...\nconst { TemporalMCPClient, temporalProvider } = require(\"@temporalio/ai-sdk\");\nconst { generateText, stepCountIs } = require(\"ai\");\n...\n  const mcpClient = new TemporalMCPClient({ name: \"testServer\" });\n  let tools = await mcpClient.tools();\n...\n    const result = await generateText({\n      model: temporalProvider.languageModel(\"qwen2.5:3b\"), \n      messages: conversation_history.messages,\n      tools: tools,\n      system: `You are an agent that execute mcp tools. If you need mandatory parameters to execute a tool, ask for them to the user. You must not guess input parameters. You must not guess parameters names, double check the parameters names.`,\n      stopWhen: stepCountIs(20),\n    });\n...\n---workflo end---\n\nFrom the temporal UI I can see that in the task \"testServer-listTools\" the output of the step \"ActivityTaskCompleted\" is correct ( event id 7 ):\n\n[{\"list-regions\":{\"description\":\"Tool that returns a list of regions of the platform. The response field \\\"id\\\" is the \\\"regionId\\\" used in the other tools\",\"inputSchema\":{\"jsonSchema\":{\"type\":\"object\",\"properties\":{},\"$schema\":\"http://json-schema.org/draft-07/schema#\",\"additionalProperties\":false}}},\"list-services\":{\"description\":\"Tool that returns a list of services available in a region\",\"inputSchema\":{\"jsonSchema\":{\"type\":\"object\",\"properties\":{\"regionId\":{\"type\":\"string\",\"description\":\"The regionId of the region to list services.\"}},\"$schema\":\"http://json-schema.org/draft-07/schema#\",\"required\":[\"regionId\"],\"additionalProperties\":false}}}}]\n\nBut it is getting interesting during the next events:\n\nEvent 11: User provide input\nEvent 15 - invokeModel - ActivityTaskScheduled ( input ): The description of the parameters of the tools is ok, but the descriptions of the tools is missing, the parameters of the tools looks ok\nEvent 17 - invokeModel - ActivityTaskCompleted( result ): The description of the parameters of the tools is missing, description of the tools is missing, the parameters of the tool \"list-services\" is wrong\nEvent 21 - testServer-callTool: all good ( it is calling the tool without any parameters)\nEvent 27 - invokeModel - ActivityTaskScheduled ( input ): Here the LLM is trying to format the final response, but the tool definitions are like the \"Event 15 - ActivityTaskScheduled\"\nEvent 29 - invokeModel - ActivityTaskCompleted( result ): The tool definitions are like the \"Event 17 - invokeModel - ActivityTaskCompleted\"\n\nAnother thing that I noticed is that the UI is showing data for the results like \"\"finishReason\": \"stop\"\", but the TEMPORAL AI-SDK is always returning undifined for result.finishReason, a very important piece of information is missing there\n\nYou can find the events trace attached:\n\n[86cbe417-5137-43ab-8d24-3a28e4c173a2_events.json](https://github.com/user-attachments/files/24655295/86cbe417-5137-43ab-8d24-3a28e4c173a2_events.json).\n\nIf you need you can find my MCP definition:\n\n[mcp.js](https://github.com/user-attachments/files/24655328/mcp.js)\n\n[package.json](https://github.com/user-attachments/files/24655330/package.json)\n\nIf you need you can find below my Vercel AI-SDK client:\n\n[Vercel-AI-SDK-Client.js](https://github.com/user-attachments/files/24655804/Vercel-AI-SDK-Client.js)\n\n[package.json](https://github.com/user-attachments/files/24655820/package.json)\n\nOne image says more than 1000 words:\n\n<img width=\"5120\" height=\"966\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/cdccf073-0dae-4a29-84c5-c0c3b008ee71\" />\n","createdAt":"2026-01-15T22:30:52Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1889#issuecomment-3757206783","viewerDidAuthor":false},{"id":"IC_kwDOEujx187hUaxw","author":{"login":"tconley1428"},"authorAssociation":"MEMBER","body":"> Event 15 - invokeModel - ActivityTaskScheduled ( input ): The description of the parameters of the tools is ok, but the descriptions of the tools is missing, the parameters of the tools looks ok\n\nI believe I located this issue, the description was being dropped.\n\n> Event 17 - invokeModel - ActivityTaskCompleted( result ): The description of the parameters of the tools is missing, description of the tools is missing, the parameters of the tool \"list-services\" is wrong\n\nFrom your event history:\n```\n\"inputSchema\": {\n                        \"jsonSchema\": {\n                          \"type\": \"object\",\n                          \"properties\": {\n                            \"regionId\": {\n                              \"type\": \"string\",\n                              \"description\": \"The regionId of the region to list services.\"\n                            }\n                          },\n                          \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n                          \"required\": [\n                            \"regionId\"\n                          ],\n                          \"additionalProperties\": false\n                        }\n                      }\n```\nYou still have a nested `jsonSchema` inside `inputSchema` which means that #1890 was not applied successfully. That's making ollama fail to parse the tool.\n","createdAt":"2026-01-21T18:05:57Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1889#issuecomment-3780226160","viewerDidAuthor":false},{"id":"IC_kwDOEujx187hZipa","author":{"login":"maxi1555"},"authorAssociation":"NONE","body":"> > Event 15 - invokeModel - ActivityTaskScheduled ( input ): The description of the parameters of the tools is ok, but the descriptions of the tools is missing, the parameters of the tools looks ok\n> \n> I believe I located this issue, the description was being dropped.\n> \n> > Event 17 - invokeModel - ActivityTaskCompleted( result ): The description of the parameters of the tools is missing, description of the tools is missing, the parameters of the tool \"list-services\" is wrong\n> \n> From your event history:\n> ```\n> \"inputSchema\": {\n>                         \"jsonSchema\": {\n>                           \"type\": \"object\",\n>                           \"properties\": {\n>                             \"regionId\": {\n>                               \"type\": \"string\",\n>                               \"description\": \"The regionId of the region to list services.\"\n>                             }\n>                           },\n>                           \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n>                           \"required\": [\n>                             \"regionId\"\n>                           ],\n>                           \"additionalProperties\": false\n>                         }\n>                       }\n> ```\n> You still have a nested `jsonSchema` inside `inputSchema` which means that #1890 was not applied successfully. That's making ollama fail to parse the tool.\n> \n\nPlease let me know when a new version is published so I can test it","createdAt":"2026-01-21T23:15:38Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1889#issuecomment-3781569114","viewerDidAuthor":false}],"createdAt":"2026-01-15T14:17:38Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDA2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":1889,"reactionGroups":[],"state":"CLOSED","title":"[Bug] AI-SDK - Missing descriptions of tools, fields and wrong input parameter definitions","updatedAt":"2026-01-22T17:54:56Z","url":"https://github.com/temporalio/sdk-typescript/issues/1889"}
