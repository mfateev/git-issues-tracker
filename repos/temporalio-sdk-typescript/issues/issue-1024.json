{"assignees":[],"author":{"id":"MDQ6VXNlcjExMDA2MjQz","is_bot":false,"login":"MrMaximus","name":"Max"},"body":"### Describe the bug\r\n\r\nI'm trying to execute workflow tests using @temporalio/testing with jest in docker.  Creating a TestWorkflowEnvironment with `TestWorkflowEnvironment.create()` fails with the below error\r\n\r\n```bash\r\n  â— Console\r\n    console.error\r\n      2023-01-11T13:27:32.036Z [ERROR] Failed to kill test server child process {\r\n        error: Error: kill ESRCH\r\n            at process.kill (node:internal/process/per_thread:220:13)\r\n            at kill (/builds/my-service/node_modules/@temporalio/testing/src/child-process.ts:33:11)\r\n            at Function.create (/builds/my-service/node_modules/@temporalio/testing/src/index.ts:226:19)\r\n            at processTicksAndRejections (node:internal/process/task_queues:96:5)\r\n            at /builds/my-service/src/worker/workflows/my-workflow.test.ts:28:13 {\r\n          errno: -3,\r\n          code: 'ESRCH',\r\n          syscall: 'kill'\r\n        }\r\n      }\r\n      26 |\r\n      27 | beforeAll(async () => {\r\n    > 28 |   testEnv = await TestWorkflowEnvironment.create();\r\n         |             ^\r\n      29 | });\r\n      30 |\r\n      at DefaultLogger.defaultLogFunction [as logFunction] (node_modules/@temporalio/worker/src/logger.ts:41:13)\r\n      at DefaultLogger.log (node_modules/@temporalio/worker/src/logger.ts:67:12)\r\n      at DefaultLogger.error (node_modules/@temporalio/worker/src/logger.ts:93:10)\r\n      at Function.create (node_modules/@temporalio/testing/src/index.ts:228:16)\r\n      at src/worker/workflows/my-workflow.test.ts:28:13\r\n```\r\n\r\nThe error is because its trying to kill a child process that didn't start. The child process being referenced is from spawning the `test-server`.\r\n\r\nI tried to start the `test-server` myself and the error is\r\n```bash\r\n./test-server: /lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.32' not found (required by ./test-server)\r\n./test-server: /lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.34' not found (required by ./test-server)\r\n```\r\n\r\nThere is a npm install script in the `@temporalio/testing@v1.1.0` library which pulls the latest release of the test server from `https://api.github.com/repos/temporalio/sdk-java/releases/latest`, and a new release was published two days ago. I expect this new release is causing the bug\r\n\r\n### Minimal Reproduction\r\n\r\nTemporal testing library: `@temporalio/testing@v1.1.0`\r\nDocker image: `node:16-slim`\r\n\r\n```javascript\r\nimport { TestWorkflowEnvironment } from '@temporalio/testing';\r\n\r\nlet testEnv;\r\n\r\nbeforeAll(async () => {\r\n  testEnv = await TestWorkflowEnvironment.create();\r\n});\r\n\r\nafterAll(async () => {\r\n  await testEnv.teardown();\r\n});\r\n\r\ndescribe('Test workflow', () => {\r\n  test('test', async () => {\r\n    expect(testEnv).toBeInstanceOf(TestWorkflowEnvironment);\r\n  });\r\n});\r\n\r\n```\r\n\r\n### Additional context\r\nWorks on macOS\r\n\r\n### EDIT\r\n\r\nThis setup did work previously so I believe the issue stems from the fact there have been a new test-server release and it is not pinned in the testing lib","closedAt":"2023-01-12T17:35:17Z","comments":[{"id":"IC_kwDOEujx185STNaD","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"Looks like you're using an old version of the SDK, this shouldn't happen since 1.3.0: https://github.com/temporalio/sdk-typescript/blob/main/CHANGELOG.md#130---2022-09-20.\r\n\r\nI'm closing this issue.\r\nIf you encounter it after upgrading, please reopen.","createdAt":"2023-01-12T17:35:17Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1024#issuecomment-1380767363","viewerDidAuthor":false}],"createdAt":"2023-01-12T10:25:54Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDA2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":1024,"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"state":"CLOSED","title":"[Bug] cannot spawn test-server","updatedAt":"2023-01-12T17:35:18Z","url":"https://github.com/temporalio/sdk-typescript/issues/1024"}
