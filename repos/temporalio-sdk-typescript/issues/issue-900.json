{"assignees":[],"author":{"id":"MDQ6VXNlcjI5MDczOTc=","is_bot":false,"login":"colinking","name":"Colin"},"body":"### What are you really trying to do?\r\n\r\nInstalling version `1.3.0` of `temporalio/worker` should install `1.3.0` of `temporalio/common` rather than the latest minor version. Ideally each Temporal SDK pins their Temporal dependencies.\r\n\r\n### Describe the bug\r\n\r\nAttempting to install an older version of the Temporal SDK will pull in the latest minor version of the underlying packages, e.g. `@temporalio/common`. This causes issues since there have been breaking changes in minor releases. For example, `1.4.0` unexported `errorMessage` so version `1.3.0` of `temporalio/worker` errors when trying to import it:\r\n\r\n```\r\nerror: TypeError: (0 , common_1.errorMessage) is not a function\r\n       at /airplane/.airplane/node_modules/@temporalio/worker/lib/tracing.js:70:102\r\n       at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\r\n       at async /airplane/.airplane/node_modules/@temporalio/worker/lib/worker.js:554:24\r\n }\r\n```\r\n\r\n### Minimal Reproduction\r\n\r\nCreate a `package.json` that depends on `1.3.0` like so:\r\n\r\n```\r\n{\r\n  \"dependencies\": {\r\n    \"@temporalio/worker\": \"1.3.0\",\r\n    \"@temporalio/workflow\": \"1.3.0\"\r\n  }\r\n}\r\n```\r\n\r\nRun `npm install`. Inspect `package-lock.json` and notice it installs a mixture of `1.3.0` and `1.4.0` versions of the various Temporal SDK packages:\r\n\r\n```\r\n▶ cat package-lock.json | grep -A5 temporal\r\n    \"@temporalio/workflow\": {\r\n      \"version\": \"1.3.0\",\r\n      \"resolved\": \"https://registry.npmjs.org/@temporalio/workflow/-/workflow-1.3.0.tgz\",\r\n      \"integrity\": \"sha512-iK6LkQLF5vN9R+eONZK+LGR+x5ZgFTc+mKigqNzNZFwLsAm4WM8MmBvh5uKCsIXdfN2F4tnxB/I6svUN6OZBdA==\",\r\n      \"requires\": {\r\n        \"@temporalio/common\": \"^1.3.0\",\r\n        \"@temporalio/internal-workflow-common\": \"^1.3.0\",\r\n        \"@temporalio/proto\": \"^1.3.0\"\r\n      }\r\n    },\r\n\r\n...\r\n\r\n\r\n    \"@temporalio/common\": {\r\n      \"version\": \"1.4.0\",\r\n      \"resolved\": \"https://registry.npmjs.org/@temporalio/common/-/common-1.4.0.tgz\",\r\n      \"integrity\": \"sha512-94TGVWh4iUQt86iojN/tc02Au4m+3WKXK4YVjYKxD33KTL0J7VYW1cZq3ELdicUNhVP35ioAr88K6Vs1KNPyLA==\",\r\n      \"requires\": {\r\n        \"@opentelemetry/api\": \"^1.0.3\",\r\n        \"@temporalio/proto\": \"^1.4.0\",\r\n        \"long\": \"^5.2.0\",\r\n        \"ms\": \"^2.1.3\",\r\n        \"proto3-json-serializer\": \"^1.0.3\",\r\n        \"protobufjs\": \"^7.0.0\"\r\n      }\r\n```\r\n\r\nSince `@temporalio/workflow` depends on `\"@temporalio/common\": \"^1.3.0\"` instead of `\"@temporalio/common\": \"1.3.0\"`, it installs the latest minor version.\r\n\r\n### Environment/Versions\r\n\r\n<!-- Please complete the following information where relevant. -->\r\n\r\n- OS and processor: M1 Mac\r\n- Temporal Version: 1.3.0\r\n- Are you using Docker or Kubernetes or building Temporal from source? N/A\r\n\r\n```\r\n▶ npm version\r\n  npm: '8.15.0',\r\n  node: '18.7.0',\r\n```\r\n\r\n### Additional context\r\n\r\nN/A\r\n","closedAt":"2022-10-11T04:58:17Z","comments":[{"id":"IC_kwDOEujx185LoQa5","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"Thanks for reporting this. We will address this in following releases.","createdAt":"2022-10-05T19:11:50Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/900#issuecomment-1268844217","viewerDidAuthor":false},{"id":"IC_kwDOEujx185LoRE2","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"We will also publish a 1.3.1 patch ","createdAt":"2022-10-05T19:13:24Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/900#issuecomment-1268846902","viewerDidAuthor":false},{"id":"IC_kwDOEujx185LoRZB","author":{"login":"colinking"},"authorAssociation":"NONE","body":"Fantastic. Thanks for the quick response, @bergundy.","createdAt":"2022-10-05T19:14:33Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/900#issuecomment-1268848193","viewerDidAuthor":false},{"id":"IC_kwDOEujx185L8Q9D","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"Fixed in 1.3.1 and 1.4.1","createdAt":"2022-10-11T04:58:17Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/900#issuecomment-1274089283","viewerDidAuthor":false},{"id":"IC_kwDOEujx185MBX8M","author":{"login":"colinking"},"authorAssociation":"NONE","body":"@bergundy this issue appears fixed in `1.3.1`, but not `1.4.1` nor `1.4.2`.\r\n\r\n## 1.3.1\r\n\r\nUses `~` and only accepts patch version updates (lgtm):\r\n\r\n<img width=\"960\" alt=\"CleanShot 2022-10-11 at 20 21 39\" src=\"https://user-images.githubusercontent.com/2907397/195221487-58935290-144f-4054-b111-871b4c435347.png\">\r\n\r\nThis lockfile was generated from this `package.json`:\r\n\r\n```json\r\n{\r\n  \"dependencies\": {\r\n    \"@temporalio/worker\": \"1.3.1\",\r\n    \"@temporalio/workflow\": \"1.3.1\"\r\n  }\r\n}\r\n```\r\n\r\n\r\n## 1.4.2\r\n\r\nUses `^` and will accept minor version updates (broken):\r\n\r\n<img width=\"921\" alt=\"CleanShot 2022-10-11 at 20 18 00\" src=\"https://user-images.githubusercontent.com/2907397/195221275-4cf7529d-c729-448c-9b9c-a158baa9dcc6.png\">\r\n\r\nThis lockfile was generated from this `package.json`:\r\n\r\n```json\r\n{\r\n  \"dependencies\": {\r\n    \"@temporalio/worker\": \"1.4.2\",\r\n    \"@temporalio/workflow\": \"1.4.2\"\r\n  }\r\n}\r\n```","createdAt":"2022-10-12T00:22:29Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/900#issuecomment-1275428620","viewerDidAuthor":false},{"id":"IC_kwDOEujx185MBawI","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"I know, we've updated the contributing guide explaining how to ping to minor.\r\nThanks for reporting.","createdAt":"2022-10-12T00:42:41Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/900#issuecomment-1275440136","viewerDidAuthor":false}],"createdAt":"2022-10-05T19:08:37Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDA2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":900,"reactionGroups":[],"state":"CLOSED","title":"[Bug] TypeError: (0 , common_1.errorMessage) is not a function","updatedAt":"2022-10-12T00:42:41Z","url":"https://github.com/temporalio/sdk-typescript/issues/900"}
