{"assignees":[],"author":{"id":"MDQ6VXNlcjEzODk1MDU3","is_bot":false,"login":"shawnjones253","name":"Shawn Jones"},"body":"### What are you really trying to do?\r\n\r\nRun a temporal activity within a jest test.\r\n\r\n### Describe the bug\r\n\r\nJest can't exit after instantiating MockActivityEnvironment, even if I don't actually use the MockActivityEnvironment to run an activity.\r\n\r\n### Minimal Reproduction\r\n\r\n```\r\ntest('some test', async () => {\r\n  const env = new MockActivityEnvironment()\r\n  // whether or not you use env.run() doesn't seem to matter...\r\n}\r\n```\r\n\r\n```\r\nJest has detected the following 1 open handle potentially keeping Jest from exiting:\r\n\r\n  â—  neon threadsafe function\r\n\r\n      261 |\r\n      262 |   test('some test', async () => {\r\n    > 263 |     const env = new MockActivityEnvironment()\r\n          |                 ^\r\n\r\n at ../../node_modules/@temporalio/core-bridge/index.js:16:14\r\n      at Function.create (../../node_modules/@temporalio/worker/src/runtime.ts:208:31)\r\n      at Function.instance (../../node_modules/@temporalio/worker/src/runtime.ts:196:17)\r\n      at new MockActivityEnvironment (../../node_modules/@temporalio/testing/src/index.ts:413:15)\r\n```\r\n### Environment/Versions\r\n\r\n<!-- Please complete the following information where relevant. -->\r\n\r\n- OS and processor: M1 Mac\r\n- Temporal Version: 1.8.1\r\n- Are you using Docker or Kubernetes or building Temporal from source? No\r\n\r\n### Additional context\r\n\r\n\r\n","closedAt":"2023-10-12T20:33:54Z","comments":[{"id":"IC_kwDOEujx185o7HtG","author":{"login":"mjameswh"},"authorAssociation":"MEMBER","body":"Duplicate of #928 ","createdAt":"2023-10-12T20:33:54Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1259#issuecomment-1760328518","viewerDidAuthor":false}],"createdAt":"2023-10-12T03:15:14Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDA2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":1259,"reactionGroups":[],"state":"CLOSED","title":"[Bug] MockActivityEnvironment holds open handle prevents jest from exiting","updatedAt":"2023-10-12T20:33:55Z","url":"https://github.com/temporalio/sdk-typescript/issues/1259"}
