{"assignees":[],"author":{"id":"MDQ6VXNlcjMwMDEzNTE5","is_bot":false,"login":"bert-bae","name":"Elbert (Sangyoup) Bae"},"body":"### What are you really trying to do?\r\n\r\nPackage update for latest on @temporalio/worker has an issue with a sub-dependency update for @opentelemetry/api. The version restriction listed for temporalio/worker is for opentelemetry/api to be ^1.3.0. We previously had 1.6.0 which does not have this issue, but updating our packages to have the latest 1.9.0 causes this problem.\r\n\r\n### Describe the bug\r\n\r\nCannot run when `@temporalio/worker` uses `@opentelemetry/api` version `1.9.0` with the following error encountered:\r\n\r\n```sh\r\nError: Package subpath './build/src/trace/NoopTracer' is not defined by \"exports\" in /opt/atlassian/pipelines/agent/build/node_modules/.pnpm/@temporalio+worker@1.8.6/node_modules/@opentelemetry/api/package.json\r\n ❯ Object.<anonymous> ../../node_modules/.pnpm/@temporalio+worker@1.8.6/node_modules/@temporalio/worker/src/tracing.ts:2:1\r\n\r\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯\r\nSerialized Error: { code: 'ERR_PACKAGE_PATH_NOT_EXPORTED' }\r\n```\r\n\r\nLocking @opentelemetry/api version between 1.3.0 to 1.6.0 is a workaround.\r\n\r\n### Minimal Reproduction\r\n\r\nInstalling `@temporalio/worker` which currently has a minimum version marked for `@opentelemetry/api^1.3.0` downloads the latest of version 1.9.0 which breaks the import. It appears since temporalio/worker package is doing a deep import directly from the build directory, it is not an issue that opentelemetry will fix.\r\n\r\n### Environment/Versions\r\n\r\nNode Version 18.17.1\r\nMacOS Sonoma\r\n\r\n### Additional context\r\n\r\n[Opentelemetry's github issue related to this problem](https://github.com/open-telemetry/opentelemetry-js/issues/4518)\r\n","closedAt":"2024-09-09T13:43:52Z","comments":[{"id":"IC_kwDOEujx186LXbwO","author":{"login":"mjameswh"},"authorAssociation":"MEMBER","body":"The import on `NoopTracer` was removed in #1269. Please update all @temporalio to >1.9.0.","createdAt":"2024-09-09T13:47:08Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1502#issuecomment-2338176014","viewerDidAuthor":false}],"createdAt":"2024-08-21T21:36:22Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDA2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":1502,"reactionGroups":[],"state":"CLOSED","title":"[Bug] @temporalio/worker with subdependency @opentelemetry/api version higher than 1.6.0 breaks","updatedAt":"2024-09-09T13:47:09Z","url":"https://github.com/temporalio/sdk-typescript/issues/1502"}
