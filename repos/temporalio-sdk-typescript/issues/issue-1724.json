{"assignees":[],"author":{"id":"MDQ6VXNlcjc3MjM4MTk5","is_bot":false,"login":"liho00","name":"LiHo"},"body":" TypeError: Failed to initialize workflow of type 'sayHello': no such function is exported by the workflow bundle\n\n\n\n```\n[12:22:05 AM] Starting compilation in watch mode...\n\n[12:22:07 AM] Found 0 errors. Watching for file changes.\n\n[Nest] 56464  - 06/11/2025, 12:22:07 AM     LOG [NestFactory] Starting Nest application...\n[Nest] 56464  - 06/11/2025, 12:22:07 AM     LOG [TemporalClientModule] Connecting to Temporal server at localhost:7233\n[Nest] 56464  - 06/11/2025, 12:22:07 AM     LOG [InstanceLoader] TemporalWorkerModule dependencies initialized +10ms\n[Nest] 56464  - 06/11/2025, 12:22:07 AM     LOG [TemporalClientModule] Connected to Temporal server, using namespace \"default\"\n[Nest] 56464  - 06/11/2025, 12:22:07 AM     LOG [InstanceLoader] TemporalClientModule dependencies initialized +1ms\n[Nest] 56464  - 06/11/2025, 12:22:07 AM     LOG [InstanceLoader] TemporalModule dependencies initialized +0ms\n[Nest] 56464  - 06/11/2025, 12:22:07 AM     LOG [InstanceLoader] AppModule dependencies initialized +0ms\nStarting Temporal worker...\n[Nest] 56464  - 06/11/2025, 12:22:07 AM     LOG [RoutesResolver] HelloWorkflowController {/}: +2ms\n[Nest] 56464  - 06/11/2025, 12:22:07 AM     LOG [RoutesResolver] AppController {/}: +1ms\n[Nest] 56464  - 06/11/2025, 12:22:07 AM     LOG [RouterExplorer] Mapped {/hello/:name, GET} route +1ms\n[Nest] 56464  - 06/11/2025, 12:22:07 AM     LOG [TemporalClient] Enhanced Temporal service initialized\n[Nest] 56464  - 06/11/2025, 12:22:07 AM     LOG [TemporalClient] Discovered: 0 controllers, 0 workflows, 0 scheduled\n[Nest] 56464  - 06/11/2025, 12:22:07 AM     LOG [TemporalClient] Schedules: 0 total, 0 active\n[Nest] 56464  - 06/11/2025, 12:22:07 AM     LOG [TemporalClient] Worker: not initialized, 0 activities registered\n[Nest] 56464  - 06/11/2025, 12:22:07 AM   DEBUG [WorkflowDiscovery] Discovered workflow controller: HelloWorkflowController\n[Nest] 56464  - 06/11/2025, 12:22:07 AM     LOG [WorkflowDiscovery] Discovered 1 controllers with 1 workflow methods\n[Nest] 56464  - 06/11/2025, 12:22:07 AM     LOG [WorkflowDiscovery] Found 0 scheduled workflows, 0 signals, 0 queries\n[Nest] 56464  - 06/11/2025, 12:22:07 AM   DEBUG [WorkflowDiscovery] Controller: HelloWorkflowController (taskQueue: hello-world)\n[Nest] 56464  - 06/11/2025, 12:22:07 AM   DEBUG [WorkflowDiscovery]   - Workflow: sayHello (sayHello)\n[Nest] 56464  - 06/11/2025, 12:22:07 AM     LOG [TemporalClientService] Temporal client initialized successfully\n[Nest] 56464  - 06/11/2025, 12:22:07 AM     LOG [TemporalScheduleService] Temporal schedule client initialized\n[Nest] 56464  - 06/11/2025, 12:22:07 AM     LOG [TemporalWorker] Initializing Temporal worker...\n[Nest] 56464  - 06/11/2025, 12:22:07 AM   DEBUG [TemporalWorker] Using workflows from filesystem path (recommended for development)\n[Nest] 56464  - 06/11/2025, 12:22:07 AM     LOG [TemporalWorker] Found 2 activity providers\n[Nest] 56464  - 06/11/2025, 12:22:07 AM   DEBUG [TemporalWorker] Processing activity class: GreetingActivities\n[Nest] 56464  - 06/11/2025, 12:22:07 AM   DEBUG [ActivityExecution] Found activity method: GreetingActivities.formatGreeting -> formatGreeting\n[Nest] 56464  - 06/11/2025, 12:22:07 AM   DEBUG [ActivityExecution] Found activity method: GreetingActivities.logGreeting -> logGreeting\n[Nest] 56464  - 06/11/2025, 12:22:07 AM   DEBUG [TemporalWorker] Registered activity: GreetingActivities.formatGreeting\n[Nest] 56464  - 06/11/2025, 12:22:07 AM   DEBUG [TemporalWorker] Registered activity: GreetingActivities.logGreeting\n[Nest] 56464  - 06/11/2025, 12:22:07 AM   DEBUG [TemporalWorker] Processing activity class: GreetingActivities\n[Nest] 56464  - 06/11/2025, 12:22:07 AM   DEBUG [TemporalWorker] Registered activity: GreetingActivities.formatGreeting\n[Nest] 56464  - 06/11/2025, 12:22:07 AM   DEBUG [TemporalWorker] Registered activity: GreetingActivities.logGreeting\n[Nest] 56464  - 06/11/2025, 12:22:07 AM     LOG [TemporalWorker] Registered 2 activity methods in total\n[Nest] 56464  - 06/11/2025, 12:22:07 AM   DEBUG [TemporalWorker] Connecting to Temporal server at localhost:7233\n[Nest] 56464  - 06/11/2025, 12:22:07 AM   DEBUG [TemporalWorker] Temporal connection established\n2025-06-10T16:22:07.984Z [INFO] Creating worker {\n  sdkComponent: 'worker',\n  taskQueue: 'hello-world',\n  options: {\n    namespace: 'default',\n    identity: '56464@Lis-MacBook-Pro.local',\n    useVersioning: false,\n    buildId: undefined,\n    shutdownGraceTime: 0,\n    enableNonLocalActivities: true,\n    maxConcurrentWorkflowTaskPolls: 5,\n    maxConcurrentActivityTaskPolls: 10,\n    stickyQueueScheduleToStartTimeout: '10s',\n    maxHeartbeatThrottleInterval: '60s',\n    defaultHeartbeatThrottleInterval: '30s',\n    isolateExecutionTimeout: '5s',\n    workflowThreadPoolSize: 2,\n    maxCachedWorkflows: 914,\n    showStackTraceSources: false,\n    debugMode: false,\n    interceptors: { activity: [], workflowModules: [] },\n    nonStickyToStickyPollRatio: 0.2,\n    sinks: { __temporal_logger: [Object] },\n    connection: NativeConnection {\n      nativeClient: [External: 138226a70],\n      referenceHolders: Set(0) {}\n    },\n    taskQueue: 'hello-world',\n    activities: Map(2) {\n      'formatGreeting' => [Function: bound formatGreeting] AsyncFunction,\n      'logGreeting' => [Function: bound logGreeting] AsyncFunction\n    },\n    workflowsPath: '/Users/liho/Desktop/taocan/taocan-workflow/dist/workflows',\n    reuseV8Context: false,\n    tuner: {\n      workflowTaskSlotSupplier: [Object],\n      activityTaskSlotSupplier: [Object],\n      localActivityTaskSlotSupplier: [Object]\n    },\n    shutdownGraceTimeMs: 0,\n    shutdownForceTimeMs: undefined,\n    stickyQueueScheduleToStartTimeoutMs: 10000,\n    isolateExecutionTimeoutMs: 5000,\n    maxHeartbeatThrottleIntervalMs: 60000,\n    defaultHeartbeatThrottleIntervalMs: 30000,\n    loadedDataConverter: {\n      payloadConverter: [DefaultPayloadConverter],\n      failureConverter: [DefaultFailureConverter],\n      payloadCodecs: []\n    }\n  }\n}\n2025-06-10T16:22:08.421Z [INFO] asset workflow-bundle-98eb4e810cf2eec45dcd.js 921 KiB [emitted] [immutable] (name: main)\nmodules by path ./node_modules/@temporalio/ 229 KiB\n  modules by path ./node_modules/@temporalio/common/ 98.7 KiB 24 modules\n  modules by path ./node_modules/@temporalio/workflow/ 130 KiB\n    ./node_modules/@temporalio/workflow/lib/worker-interface.js 8.38 KiB [built] [code generated]\n    ./node_modules/@temporalio/workflow/lib/global-overrides.js 4.09 KiB [built] [code generated]\n    ./node_modules/@temporalio/workflow/lib/cancellation-scope.js 9.92 KiB [built] [code generated]\n    + 13 modules\nmodules by path ./dist/ 444 bytes\n  ./dist/workflows-autogenerated-entrypoint.cjs 443 bytes [built] [code generated]\n  ./dist/workflows/index.js 1 bytes [built] [code generated]\n__temporal_custom_payload_converter (ignored) 15 bytes [built] [code generated]\n__temporal_custom_failure_converter (ignored) 15 bytes [built] [code generated]\n./node_modules/long/umd/index.js 49.8 KiB [built] [code generated]\nwebpack 5.99.6 compiled successfully in 267 ms { sdkComponent: 'worker', taskQueue: 'hello-world' }\n2025-06-10T16:22:08.422Z [INFO] Workflow bundle created { sdkComponent: 'worker', taskQueue: 'hello-world', size: '0.90MB' }\n[Nest] 56464  - 06/11/2025, 12:22:08 AM     LOG [TemporalWorker] Worker created for queue: hello-world in namespace: default\n[Nest] 56464  - 06/11/2025, 12:22:08 AM     LOG [TemporalWorker] Worker configuration summary:\n[Nest] 56464  - 06/11/2025, 12:22:08 AM     LOG [TemporalWorker] {\n  \"taskQueue\": \"hello-world\",\n  \"namespace\": \"default\",\n  \"workflowSource\": \"filesystem\",\n  \"activitiesCount\": 2,\n  \"autoStart\": true,\n  \"environment\": \"development\"\n}\n[Nest] 56464  - 06/11/2025, 12:22:08 AM     LOG [TemporalWorker] Temporal worker initialization completed\n[Nest] 56464  - 06/11/2025, 12:22:08 AM     LOG [ScheduleManager] No scheduled workflows found\n[Nest] 56464  - 06/11/2025, 12:22:08 AM     LOG [TemporalWorker] Starting worker for task queue: hello-world\n2025-06-10T16:22:08.509Z [INFO] Worker state changed { sdkComponent: 'worker', taskQueue: 'hello-world', state: 'RUNNING' }\n2025-06-10T16:23:11.558Z [ERROR] Failed to process Worklow Activation {\n  sdkComponent: 'worker',\n  taskQueue: 'hello-world',\n  runId: '01975a93-9917-7c97-810e-4950029c94b9',\n  error: /Users/liho/Desktop/taocan/taocan-workflow/workflow-bundle-98eb4e810cf2eec45dcd.js:4485\n          throw new TypeError(`Failed to initialize workflow of type '${activator.info.workflowType}': ${details}`);\n          ^\n  \n  TypeError: Failed to initialize workflow of type 'sayHello': no such function is exported by the workflow bundle\n      at Object.initRuntime (/Users/liho/Desktop/taocan/taocan-workflow/node_modules/@temporalio/workflow/src/worker-interface.ts:87:10)\n      at evalmachine.<anonymous>:1:18\n      at Script.runInContext (node:vm:149:12)\n      at Object.runInContext (node:vm:301:6)\n      at Proxy.<anonymous> (/Users/liho/Desktop/taocan/taocan-workflow/node_modules/@temporalio/worker/lib/workflow/vm.js:41:46)\n      at VMWorkflowCreator.createWorkflow (/Users/liho/Desktop/taocan/taocan-workflow/node_modules/@temporalio/worker/lib/workflow/vm.js:48:24)\n      at async handleRequest (/Users/liho/Desktop/taocan/taocan-workflow/node_modules/@temporalio/worker/lib/workflow/workflow-worker-thread.js:42:13)\n      at async MessagePort.<anonymous> (/Users/liho/Desktop/taocan/taocan-workflow/node_modules/@temporalio/worker/lib/workflow/workflow-worker-thread.js:92:32),\n  workflowExists: false\n}\n\n```","closedAt":"2025-06-11T08:03:39Z","comments":[{"id":"IC_kwDOEujx186wf78u","author":{"login":"mjameswh"},"authorAssociation":"MEMBER","body":"That error could indicate any of a multitude of problems. Can you please provide more details on how you got there? Any code you can share?\n\nAlso, I see this is a Nest application. We do not officially provide or support any Temporal+Nest integration module. You may find it useful to review documentation or samples from the integration library you are using.","createdAt":"2025-06-11T03:51:51Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1724#issuecomment-2961162030","viewerDidAuthor":false},{"id":"IC_kwDOEujx186wgAaK","author":{"login":"liho00"},"authorAssociation":"NONE","body":"> That error could indicate any of a multitude of problems. Can you please provide more details on how you got there? Any code you can share?\n> \n> Also, I see this is a Nest application. We do not officially provide or support any Temporal+Nest integration module. You may find it useful to review documentation or samples from the integration library you are using.\n\nreproduce repo: https://github.com/liho00/nestjs-temporal\n@mjameswh \n\n\nhttps://github.com/harsh-simform/nestjs-temporal-core\n@harsh-simform","createdAt":"2025-06-11T04:08:08Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1724#issuecomment-2961180298","viewerDidAuthor":false},{"id":"IC_kwDOEujx186whxCu","author":{"login":"mjameswh"},"authorAssociation":"MEMBER","body":"I see. Yeah, that issue really is specific to the Temporal+Nest integration library that you are using. Given my own very limited knowledge of Nest JS, there's very little I can do to help you on this.\n\nI however want to point out that your frustration regarding that library probably result from a misalignment between what you are looking for and what that library really is doing.\n\nBridging Nest dependency injection and Temporal's Workflow sandbox, is a complex and difficult thing. It is simply not possible to load the `@nestjs/common` or `@nestjs/core` packages inside the Workflow sandbox, as they themselves depend on various non-deterministic-safe modules, so a library doing this would not only need to dynamically generate an entrypoint file for all the workflows definitions, but would also need some form of compile time transformation mechanism to replace Nest's decorators in the generated Workflow bundle.\n\nLooking specifically at this project, I don't see any such thing. The recently introduced \"Automatic discovery of workflow controllers\" feature is about collecting metadata on Workflows, signals, queries, etc. Those metadata can be used for example to automatically add the appropriate task queue name when starting a workflow using the exposed `TemporalService`, which is some kind of NestJS-style Temporal _Client_. But Workflow metadata don't affect the Worker's Workflow bundle.\n\nYou are therefore left with the responsibility of generating the corresponding Workflow bundle, or for exporting some kind of `workflows.ts` file, and that bundle can't contain reference to  `@nestjs/common` or `@nestjs/core`, nor can it reference the `nestjs-temporal-core` package as it itself imports `@nestjs/common` and `@nestjs/core`.","createdAt":"2025-06-11T08:03:39Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1724#issuecomment-2961641646","viewerDidAuthor":false},{"id":"IC_kwDOEujx186wqBOg","author":{"login":"frct1"},"authorAssociation":"NONE","body":"@mjameswh \nHello there!\nStarted to looking for ways to bring Temporal.io into projects and stuck on a nestjs-temporal-core lib. It has a nice readme though devs really didn't found the way to bundle workflows via decorated class (as nestjs completely rely on through some sort of discovery logic to bind classes/method to actual package).\nBut, the [v2.0.8](https://github.com/harsh-simform/nestjs-temporal-core/tree/v2.0.8) works enough except some nits like it uses the current recommended way on exporting workflows to allow bundler pick them up.\nWhat could be workarounds on this case? Nest provides solid way building apps and node.js at this time doesn't have any efficient job queue integrating many languages except temporal.io.\n\nI got some questions on this behalf (to be edited probably): \n> Can we use any another way on exporting workflows to the temporal worker? \n\nNote: I see that at this moment it is required to provide workflowsPath or workflowsBundle.","createdAt":"2025-06-11T18:36:07Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1724#issuecomment-2963805088","viewerDidAuthor":false},{"id":"IC_kwDOEujx187ERurv","author":{"login":"clintonb"},"authorAssociation":"NONE","body":"We just encountered this issue with the latest version of nestjs-temporal and both Temporal 1.12.0 and 1.13.0. The problem does _not_ exist with Temporal 1.11.3.","createdAt":"2025-09-15T16:23:59Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1724#issuecomment-3292981999","viewerDidAuthor":false},{"id":"IC_kwDOEujx187ESfmv","author":{"login":"clintonb"},"authorAssociation":"NONE","body":"I think this may be a Webpack issue. I can see that my workflows are bundled and exported; however, the call to `importWorkflows()` in `@temporalio/workflow/src/worker-interface.ts` does not return all of the exported workflows. I get about 30 of 35 functions. I'm combining multiple workflow files into a single file by exporting (see the example below). If I remove one of the files, my all other functions _are_ returned by `importWorkflows()`.\n\n```ts\n// NOTE: We do not generally like barrel files. We make an exception here\n// because our current Temporal helper code assumes each Temporal module has\n// a single workflow file.\n\nexport * from '../export-to-email/export-to-email.workflow';\nexport * from '../sftp-file-transfer/sftp-transfer.workflow';\nexport * from './eplum/eplum.workflow';\nexport * from './payments/payments.workflow';\nexport * from './workflows/backfill/pos-backfill.workflow';\nexport * from './workflows/ditto.workflow';\nexport * from './workflows/inventory.workflow';\nexport * from './workflows/pos-transaction-report.workflow';\n// No functions exported beyond this point are returned by `importWorkflows`.\n// If I comment out `pos-transaction-report.workflow`, all functions below\n// ARE exported. There is nothing \"special\" about pos-transaction-report.workflow.\n\nexport * from './workflows/shopper.workflow';\nexport * from './workflows/stuck-invoices.workflow';\nexport * from './workflows/wic.workflow';\n\n```","createdAt":"2025-09-15T17:20:16Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1724#issuecomment-3293182383","viewerDidAuthor":false},{"id":"IC_kwDOEujx187ESjWd","author":{"login":"clintonb"},"authorAssociation":"NONE","body":"Hmm...I'm pretty sure my issues are due to some interplay between Bluebird and Webpack. Removing Bluebird `map()` calls from workflow functions result in all functions being exported.","createdAt":"2025-09-15T17:24:16Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1724#issuecomment-3293197725","viewerDidAuthor":false},{"id":"IC_kwDOEujx187ESoxJ","author":{"login":"clintonb"},"authorAssociation":"NONE","body":"Confirmed. Replacing Bluebird with [p-map](https://www.npmjs.com/package/p-map) resolves this issue for me. No changes need to be made to nestjs-temporal.","createdAt":"2025-09-15T17:31:17Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1724#issuecomment-3293219913","viewerDidAuthor":false}],"createdAt":"2025-06-10T18:52:14Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDA2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":1724,"reactionGroups":[],"state":"CLOSED","title":"[Bug] TypeError: Failed to initialize workflow of type 'sayHello': no such function is exported by the workflow bundle","updatedAt":"2025-09-15T17:31:17Z","url":"https://github.com/temporalio/sdk-typescript/issues/1724"}
