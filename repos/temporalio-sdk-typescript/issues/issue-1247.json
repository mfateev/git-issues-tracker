{"assignees":[],"author":{"id":"MDQ6VXNlcjY0MTIxNjk=","is_bot":false,"login":"mjameswh","name":"James Watkins-Harvey"},"body":"### Describe the bug\r\n\r\nThe objects returned by the `wf.workflowInfo()` and `act.Context.current()` functions can be mutated at will by user code. Though there might be arguably legitimate use cases for adding _custom_ properties into these objects, it appears undesirable, and even dangerous to allow mutating the value of existing properties.\r\n\r\nThe consequence of such mutations varies. As an extreme case, workflow code can actually flip the value of `wf.workflowInfo().unsafe.isReplaying`, which results in the `wf.patched()` API function to misbehave.\r\n\r\n### Minimal Reproduction\r\n\r\n```\r\nexport async function asyncActivityWorkflow(): Promise<string> {\r\n  workflowInfo().attempt = 100;\r\n  (workflowInfo() as any).something = 'something';\r\n  \r\n  workflowInfo().unsafe.isReplaying = true;\r\n  if (patched('test')) {\r\n    console.log(`This should be printed at least once`);\r\n  }\r\n\r\n  const answer = await completeSomethingAsync();\r\n\r\n  console.log(`workflowInfo().attempt: ${workflowInfo().attempt}`);\r\n  console.log(`workflowInfo().something: ${(workflowInfo() as any).something}`);\r\n\r\n  return `The Peon says: ${answer}`;\r\n}\r\n```\r\n\r\nproduce the following output:\r\n\r\n```\r\n[asyncActivityWorkflow(activities-examples)] workflowInfo().attempt: 100\r\n[asyncActivityWorkflow(activities-examples)] workflowInfo().something: something\r\n```","closedAt":"2023-10-17T22:01:04Z","comments":[],"createdAt":"2023-09-14T08:48:49Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDA2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":1247,"reactionGroups":[],"state":"CLOSED","title":"[Bug] Properties of `WorkflowInfo` and `Activity.Context` should not be mutable by user code","updatedAt":"2023-10-17T22:01:04Z","url":"https://github.com/temporalio/sdk-typescript/issues/1247"}
