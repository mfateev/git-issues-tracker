{"assignees":[],"author":{"id":"MDQ6VXNlcjI0ODgxNzY4","is_bot":false,"login":"ThePinger","name":"Omar Emad"},"body":"### What are you really trying to do?\r\n\r\nWell I'm trying to create a new workflow with the same `workflowId` of a Completed one. \r\n\r\n### Describe the bug\r\n\r\nI keep on receiving `WorkflowNotFoundError: workflow execution already completed` despite specifying the `workflowIdReusePolicy` as `ALLOW_DUPLICATE`\r\n\r\nHere's the code: \r\n\r\n```ts\r\nexport async function runWorkflow(\r\n  id: string,\r\n  startDate: Date\r\n) {\r\n  try {\r\n    const handle = await client.start(workflowExample, {\r\n      args: [id, startDate],\r\n      taskQueue: 'examples',\r\n      workflowId: `workflow-${id}`,\r\n      workflowIdReusePolicy:\r\n        WorkflowIdReusePolicy.WORKFLOW_ID_REUSE_POLICY_ALLOW_DUPLICATE,\r\n    })\r\n    console.log(`Started workflow ${handle.workflowId}`)\r\n  } catch (e: any) {\r\n    console.error(e)\r\n  }\r\n}\r\n```\r\n\r\nand here's the error:\r\n\r\n```shell\r\nWorkflowNotFoundError: workflow execution already completed\r\n    at WorkflowClient.rethrowGrpcError (/PATH_TO_NODE_MODULES/node_modules/@temporalio/client/src/workflow-client.ts:521:15)\r\n    at WorkflowClient._signalWorkflowHandler (/PATH_TO_NODE_MODULES/node_modules/@temporalio/client/src/workflow-client.ts:584:12)\r\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)\r\n    at Object.signal (/PATH_TO_NODE_MODULES/node_modules/@temporalio/client/src/workflow-client.ts:811:9) {\r\n  workflowId: 'workflow-cl3gea8x40340ukooxl1jyrkl',\r\n  runId: undefined\r\n}\r\n```\r\n\r\n### Minimal Reproduction\r\n\r\nTried using the hello-world template with the same id and it surprisingly worked so not sure what's the problem here\r\n\r\n- TypeScript: https://github.com/temporalio/samples-typescript/tree/main/hello-world\r\n\r\n\r\n### Environment/Versions\r\n\r\n- OS and processor: Intel macOS Monterey 12.1\r\n- Temporal Version: 1.16.2 \r\n- Temporal TypeScript SDK Version: 0.22.0\r\n- Using Docker to run Temporal\r\n\r\n","closedAt":"2022-05-21T23:18:15Z","comments":[{"id":"IC_kwDOEujx185DlBTQ","author":{"login":"lorensr"},"authorAssociation":"CONTRIBUTOR","body":"I was also unable to reproduce:\r\n\r\nhttps://github.com/temporalio/samples-typescript/blob/repro-allow-duplicate/hello-world/src/client.ts#L22-L23\r\n\r\nFrom `at Object.signal` in the trace, it looks like the error is actually coming from calling `handle.signal()`?","createdAt":"2022-05-21T22:37:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/661#issuecomment-1133778128","viewerDidAuthor":false},{"id":"IC_kwDOEujx185DlB5B","author":{"login":"ThePinger"},"authorAssociation":"NONE","body":"Hey @lorensr thanks for the fast reply. My bad really sorry for this issue as u said it was a result from `handle.signal()` but for some reason I thought that was not the issue. Again thanks for your help.","createdAt":"2022-05-21T23:02:53Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/661#issuecomment-1133780545","viewerDidAuthor":false},{"id":"IC_kwDOEujx185DlCRp","author":{"login":"lorensr"},"authorAssociation":"CONTRIBUTOR","body":"No problem, welcome! ☺️","createdAt":"2022-05-21T23:18:15Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HEART","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-typescript/issues/661#issuecomment-1133782121","viewerDidAuthor":false}],"createdAt":"2022-05-21T22:15:33Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDA2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":661,"reactionGroups":[],"state":"CLOSED","title":"[Bug] Cannot create a new workflow with same workflowId of a completed one","updatedAt":"2022-05-21T23:18:16Z","url":"https://github.com/temporalio/sdk-typescript/issues/661"}
