{"assignees":[],"author":{"id":"MDQ6VXNlcjI4Njc5","is_bot":false,"login":"joebowbeer","name":"Joe Bowbeer"},"body":"### Is your feature request related to a problem? Please describe.\r\n\r\nIdeally one should be able to implement any workflow in any language supported by Temporal. This is important when migrating to a new language, e.g., from PHP to Typescript. However, there are currently some incompatibilities regarding workflow and workflow method naming.\r\n\r\nFor example, I wanted to provide a Typescript implementation of the game rules in a [polyglot snake example](https://github.com/joebowbeer/temporal-polyglot-snake), but ran into some issues that required changes in the workflow's client.\r\n\r\n* The PHP workflow is named BoardRules.new whereas the Node SDK currently assigns the workflow names from their filenames.\r\n* The game code expects a workflow method named `exec` whereas the Node SDK requires a method named `main`.\r\n\r\nSee https://github.com/tsurdilo/temporal-polyglot-snake/blob/main/game/src/main/java/io/temporal/snakegame/GameRulesWorkflowInterface.java#L10-L11\r\n\r\nAs I result, I needed to modify the game code to work with the new Typescript workflow implementation.\r\n\r\n### Describe the solution you'd like\r\n\r\nPlease eliminate incompatibilities, or at the least document them and recommend strategies to avoid them.","closedAt":"2021-09-12T10:03:18Z","comments":[{"id":"IC_kwDOEujx1842lz11","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"I don't think we want to support renaming `main` (now called `execute`), I don't see much value in it, I feel like it's simpler to just have this as a convention.\r\nIn #225 we change workflow registration to be export based instead of file based, you can use any export compatible name for your workflow.","createdAt":"2021-09-09T08:36:28Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/228#issuecomment-915881333","viewerDidAuthor":false},{"id":"IC_kwDOEujx1842mEcD","author":{"login":"joebowbeer"},"authorAssociation":"CONTRIBUTOR","body":"Regarding the `execute` entrypoint:\r\n\r\nSearching for PHP WorkflowMethod annotations, I see a lot of different entrypoint names being used, and I do think they make the code more expressive:\r\n\r\nrun, handle, handler, exec, execute, greet, greetPeriodically, composeGreeting, createGreeting, bookTrip, transfer, compensate, and so on and so on.\r\n\r\nIn some of the Java examples the entrypoint name is not only part of the named interface but is also referenced in the code: WorkflowInterface::exec.\r\n\r\nI think it would be a rude surprise for someone hoping to migrate to TypeScript to realize that they have to change a lot of legacy workflow interfaces.\r\n\r\nMy documentation suggestion is meant to avoid this surprise.\r\n\r\nAlso, I think it would be wise to consider how this might be supported in a future enhancement. In TypeScript this seems to me like a job for Decorators.","createdAt":"2021-09-09T10:09:17Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/228#issuecomment-915949315","viewerDidAuthor":false},{"id":"IC_kwDOEujx1842msy_","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"I thought about using decorators with typescript but ruled it out because we want JS to be fully supported in the SDK so we can't use any exclusive TS features.\r\nI can't think of an ergonomic way to support custom method names and I'm not convinced it adds much in terms of readability.\r\nI think this is one of those cases where we should go with the language constraints.\r\nNote that the go SDK doesn't even have an `execute` method and the prototype rust SDK doesn't either.\r\nAlso note that there's no real meaning to this method other perhaps for improved readability.\r\nYou can still define a Workflow interface in Java (or PHP) with a custom method name and use that to call a Workflow in node.","createdAt":"2021-09-09T13:48:18Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/228#issuecomment-916114623","viewerDidAuthor":false},{"id":"IC_kwDOEujx1842sG6U","author":{"login":"joebowbeer"},"authorAssociation":"CONTRIBUTOR","body":"Thanks for the explanation.\r\n\r\nAt the generic SDK level, that is, not specific to the Node SDK, I think it would be helpful to provide a compatibility matrix showing what can call what, within certain naming restrictions. That would clarify how to code for maximum cross-language compatibility.\r\n\r\nRelated: #232 ","createdAt":"2021-09-12T01:54:52Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/228#issuecomment-917532308","viewerDidAuthor":false},{"id":"IC_kwDOEujx1842sYhi","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"I agree, we should document how to call workflows and activities in other languages, ideally we'd have the full matrix.\r\nAs mentioned above using `execute` vs. custom method name is purely superficial, there are no compatibility issues.\r\n\r\nI can have the following workflow interface in Java:\r\n```java\r\n@WorkflowInterface\r\npublic interface GreetingWorkflow {\r\n    @WorkflowMethod\r\n    void greet(String name);\r\n}\r\n```\r\n\r\nAnd call it from node via:\r\n```ts\r\ntype GreetingWorkflow = (name: string) => {\r\n  execute(): Promise<void>;\r\n}\r\n\r\nconst wf = client.stub<GreetingWorkflow>('greeting', { taskQueue: 'example' });\r\nawait wf.execute('joe'); // calls `createGreeting` in Java\r\n```\r\n\r\nOr this node Workflow (using the type above):\r\n```ts\r\nexport function greetingWorkflow(name: string) {\r\n  return {\r\n    async execute() {\r\n      // ...\r\n    }\r\n  };\r\n}\r\n```\r\n\r\nAnd call it from Java:\r\n\r\n```java\r\nGreetingWorkflow workflow = client.newWorkflowStub(GreetingWorkflow.class, workflowOptions);\r\nworkflow.greet(\"joe\") // calls `execute` in node\r\n```","createdAt":"2021-09-12T10:03:18Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/228#issuecomment-917604450","viewerDidAuthor":false}],"createdAt":"2021-09-07T21:02:54Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDEz","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":228,"reactionGroups":[],"state":"CLOSED","title":"[Feature Request] Flexible workflow and main method naming","updatedAt":"2021-09-12T10:03:18Z","url":"https://github.com/temporalio/sdk-typescript/issues/228"}
