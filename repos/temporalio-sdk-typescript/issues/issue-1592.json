{"assignees":[],"author":{"id":"MDQ6VXNlcjY0MTIxNjk=","is_bot":false,"login":"mjameswh","name":"James Watkins-Harvey"},"body":"### Describe the bug\r\n\r\nWhen the `reuseV8Context` option is enabled, the logic that swaps global variables in and out for a specific Workflow Execution only look at \"regular\" properties on `globalThis`, but ignores `symbol` properties. Symbol properties may therefore leak from one Workflow Execution to another.\r\n\r\nIn a [recent investigation](https://github.com/izakfilmalter/temporal-effect-oom), this was identified as the cause of a memory leak when using [Effect](https://github.com/Effect-TS/effect) in Workflow Code, as Effect was storing its own \"global store\" as a symbol property on `globalThis`. Though this specific case has just been [fixed on Effect's side](https://github.com/Effect-TS/effect/pull/4196), we recognize that there was nothing wrong in them using global symbol properties this way, and that other libraries are likely to do so. We must therefore ensure that Temporal SDK is able to properly handle global symbol properties.\r\n\r\nHuge thanks to @izakfilmalter for his work in preparing a repro project for this issue, capturing heap dumps, and coordinating efforts between Effect's and Temporal's teams, as well as to @mikearnaldi from [Effect](https://github.com/Effect-TS/effect) for his precious collaboration in investigating this through.","closedAt":"2025-01-24T00:39:36Z","comments":[],"createdAt":"2024-12-27T19:28:42Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDA2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":1592,"reactionGroups":[{"content":"HEART","users":{"totalCount":1}}],"state":"CLOSED","title":"[Bug] Reusable VM allows context leak due to global symbol properties","updatedAt":"2025-01-24T00:39:36Z","url":"https://github.com/temporalio/sdk-typescript/issues/1592"}
