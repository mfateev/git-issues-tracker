{"assignees":[],"author":{"id":"MDQ6VXNlcjExMDM5NjM=","is_bot":false,"login":"johnrjj","name":"John Johnson"},"body":"### What are you really trying to do?\r\n\r\nBuild started failing after updating latest 1.1.0. Also repro'd in Render environment:\r\n\r\n`Error: /lib/x86_64-linux-gnu/libm.so.6: version `GLIBC_2.29' not found (required by /opt/render/project/src/node_modules/.pnpm/@temporalio+core-bridge@1.10.0/node_modules/@temporalio/core-bridge/releases/x86_64-unknown-linux-gnu/index.node)`\r\n\r\n<!-- \r\nTell us at a high level what you're doing, to avoid XY problem (https://en.wikipedia.org/wiki/XY_problem) \r\n-->\r\n\r\n### Describe the bug\r\n\r\nUpdate @temporalio packages to v^1.10.0. Build in remote CI, build fails.\r\n\r\nBun had a similar issue it appears -- https://github.com/oven-sh/bun/issues/255\r\n\r\n<!-- A clear and concise description of what the bug is. -->\r\n\r\n<!-- If applicable, add screenshots or code blocks to help explain your problem. You can also use [Loom](http://loom.com/) to do short, free video bug reports. -->\r\n\r\n### Minimal Reproduction\r\n\r\n<!-- \r\nModify our hello world templates to demonstrate:\r\n\r\n- TypeScript: https://github.com/temporalio/samples-typescript/tree/main/hello-world\r\n- Go: https://github.com/temporalio/money-transfer-project-template-go\r\n- Java: https://github.com/temporalio/money-transfer-project-template-java\r\n- PHP: https://github.com/temporalio/samples-php#samples\r\n-->\r\n\r\n### Environment/Versions\r\n\r\n<!-- Please complete the following information where relevant. -->\r\n\r\n- OS and processor: [e.g. M1 Mac, x86 Windows, Linux]\r\n- Temporal Version: [e.g. 1.14.0?] and/or SDK version\r\n- Are you using Docker or Kubernetes or building Temporal from source?\r\n\r\n### Additional context\r\n\r\n<!-- Add any other context about the problem here. -->\r\n","closedAt":"2024-05-27T14:02:23Z","comments":[{"id":"IC_kwDOEujx185-zOb4","author":{"login":"johnrjj"},"authorAssociation":"NONE","body":"Will try to create a repro over weekend -- just wanted to post issue here for visibility in case others encounter same problem. In the meantime I downgraded back to 1.9.0 without any issue.","createdAt":"2024-05-23T14:58:45Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1427#issuecomment-2127357688","viewerDidAuthor":false},{"id":"IC_kwDOEujx185-1o7T","author":{"login":"mjameswh"},"authorAssociation":"MEMBER","body":"@johnrjj What's the [version of Node.js](https://docs.render.com/node-version) in your Render environment?\r\n\r\nAs mentioned in [v1.10.0's release notes](https://github.com/temporalio/sdk-typescript/releases/tag/v1.10.0), Node 14.x is no longer supported. Also note that Node 16 will no longer be supported starting with v1.11.\r\n\r\nSee this annoucement from our [v1.9.0 release notes](https://github.com/temporalio/sdk-typescript/releases/tag/v1.9.0):\r\n\r\n> Support for Node.js 14 and Node.js 16 will soon be dropped. Node.js 14 officially reached end-of-life on April 30th, 2023, and Node.js 16 reached end-of-life on September 11th, 2023 (see [Node.js release schedule](https://nodejs.org/en/about/previous-releases#release-schedule)).\r\n>\r\n> This has since then caused a rippling effect, as more and more libraries in the NPM ecosystem are progressively dropping support for both of those older targets. Given that challenges to maintaining compatibility with these outdated Node.js releases will only continue to grow, it is evident that we will soon need to follow suit in discontinuing support for Node.js 14 and 16 in the Temporal TypeScript SDK.\r\n>\r\n> For those reasons:\r\n>\r\n>    TS SDK v1.9 will be the last minor release to support Node.js 14.\r\n>    TS SDK v1.10 could possibly be the last minor release to support Node.js 16. Note that this also implies that GLIBC 2.27 will no longer be supported from that point on, since Node.js 18+ won’t compile on GLIBC older than 2.28.\r\n>\r\n> We strongly encourage everyone to take immediate action in updating their deployments to supported versions of Node.js to ensure continued compatibility and receive the latest features and security updates.","createdAt":"2024-05-23T20:46:11Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1427#issuecomment-2127990483","viewerDidAuthor":false},{"id":"IC_kwDOEujx185-1uWK","author":{"login":"johnrjj"},"authorAssociation":"NONE","body":"Using latest/default (>=18). Will try for a repro. Will also try debugging a bit more deeply.\r\n\r\n```\r\nINFO==> Requesting node version >=18\r\nINFO==> Using Node version 22.2.0 via /opt/render/project/src/package.json\r\nINFO@repo/temporal:build: > @repo/temporal@0.1.0 build:workflow /opt/render/project/src/apps/temporal\r\nINFO@repo/temporal:build: > ts-node src/scripts/build-workflow-bundle.ts\r\nINFO@repo/temporal:build: \r\nERROR@repo/temporal:build: Error: /lib/x86_64-linux-gnu/libm.so.6: version `GLIBC_2.29' not found (required by /opt/render/project/src/node_modules/.pnpm/@temporalio+core-bridge@1.10.0/node_modules/@temporalio/core-bridge/releases/x86_64-unknown-linux-gnu/index.node)\r\nINFO@repo/temporal:build:     at Object.Module._extensions..node (node:internal/modules/cjs/loader:1544:18)\r\nINFO@repo/temporal:build:     at Module.load (node:internal/modules/cjs/loader:1249:32)\r\nINFO@repo/temporal:build:     at Function.Module._load (node:internal/modules/cjs/loader:1065:12)\r\nINFO@repo/temporal:build:     at Module.require (node:internal/modules/cjs/loader:1271:19)\r\nINFO@repo/temporal:build:     at require (node:internal/modules/helpers:123:16)\r\nINFO@repo/temporal:build:     at Object.<anonymous> (/opt/render/project/src/node_modules/.pnpm/@temporalio+core-bridge@1.10.0/node_modules/@temporalio/core-bridge/index.js:26:20)\r\nINFO@repo/temporal:build:     at Module._compile (node:internal/modules/cjs/loader:1434:14)\r\nINFO@repo/temporal:build:     at Module._extensions..js (node:internal/modules/cjs/loader:1518:10)\r\nINFO@repo/temporal:build:     at Object.require.extensions.<computed> [as .js] (/opt/render/project/src/node_modules/.pnpm/ts-node@10.9.2_@swc+core@1.5.7_@swc+helpers@0.5.11__@types+node@16.11.43_typescript@5.4.5/node_modules/ts-node/src/index.ts:1608:43)\r\nINFO@repo/temporal:build:     at Module.load (node:internal/modules/cjs/loader:1249:32) {\r\nINFO@repo/temporal:build:   code: 'ERR_DLOPEN_FAILED'\r\nINFO@repo/temporal:build: }\r\nINFO@repo/temporal:build:  ELIFECYCLE  Command failed with exit code 1.\r\nINFO@repo/temporal:build:  ELIFECYCLE  Command failed with exit code 1.\r\nERROR@repo/temporal:build: ERROR: command finished with error: command (/opt/render/project/src/apps/temporal) /usr/bin/pnpm run build exited (1)\r\nINFO@repo/temporal#build: command (/opt/render/project/src/apps/temporal) /usr/bin/pnpm run build exited (1)\r\nINFO\r\n```\r\n\r\nRight now the only obvious change in config was upgrading the temporal packages. (and reverting back made it work again immediately)","createdAt":"2024-05-23T21:01:40Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1427#issuecomment-2128012682","viewerDidAuthor":false},{"id":"IC_kwDOEujx185-2BH-","author":{"login":"mjameswh"},"authorAssociation":"MEMBER","body":"I see. That means Render is using glibc 2.28 based image for their containers. Node 18 requires at least glibc 2.28, but 1.10.0 requires glibc 2.29 (or 2.35 on linux-arm64).\r\n\r\nWe're already working on a solution to [build TS SDK 1.10 on an older glibc](https://github.com/temporalio/sdk-typescript/pull/1428). Unfortunately, some recent/upcoming changes in GitHub Actions are making this harder than it should be, but I have good hope that making it work on glibc 2.28 is possible.\r\n","createdAt":"2024-05-23T22:01:14Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1427#issuecomment-2128089598","viewerDidAuthor":false},{"id":"IC_kwDOEujx185_K2qq","author":{"login":"mjameswh"},"authorAssociation":"MEMBER","body":"Fixed by #1428. See [v1.10.1](https://github.com/temporalio/sdk-typescript/releases/tag/v1.10.1).","createdAt":"2024-05-27T14:02:23Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1427#issuecomment-2133551786","viewerDidAuthor":false}],"createdAt":"2024-05-23T01:53:46Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDA2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":1427,"reactionGroups":[],"state":"CLOSED","title":"[Bug] Latest update to v1.10.0 makes build fail","updatedAt":"2024-05-27T14:02:23Z","url":"https://github.com/temporalio/sdk-typescript/issues/1427"}
