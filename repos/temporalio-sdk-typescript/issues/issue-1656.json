{"assignees":[],"author":{"id":"U_kgDOC-WjkQ","is_bot":false,"login":"jean-pruliere","name":"Jean Pruliere"},"body":"### What are you really trying to do?\n\nI have created an abstract class `Workflow`, all my workflow classes extend it and each one has a method containing the actual workflow definition. The workflow bundle is created by instantiating each class then rebinding the method it contains (=the actual workflow function) to its instance.\n```typescript\n// workflows/example.workflow.ts\nexport ExampleWorkflow extends Workflow {\n  public async example(input: { name: string }) {\n    // workflow definition goes here\n  }\n}\n\n// workflows/index.ts\nimport { ExampleWorkflow } from \"./example.workflow.ts\";\n\nconst exampleClass = new ExampleWorkflow();\nexport example = exampleClass.example.bind(exampleClass);\n```\nI'd like to use these exported workflow functions with a WorkflowClient to start new executions.\n```typescript\nthis.workflowClient.start(\n  example,\n  {\n    args: [{ name }],\n    taskQueue,\n    workflowId: randomUUID(),\n  },\n),\n```\n\n### Describe the bug\n\nBecause the function is bound, its `name` property became `bound example`, so the workflow type ends up also being `bound example`. But because the workers get a bundle with the name of each exported function (i.e. `example`), they cannot execute a `bound example` workflow.\n\n### Minimal Reproduction\n\nHere is an [example of this behavior](https://github.com/jean-pruliere/samples-typescript/blob/demo/bound-workflows/hello-world/src/workflows.ts).\n\nThe mocha tests fail and the worker logs the following error:\n```\n2025-03-20T16:38:13.045Z [ERROR] Failed to process Worklow Activation {\n  sdkComponent: 'worker',\n  taskQueue: 'test',\n  runId: '0195b46b-6928-74b7-87aa-301e9c2cfe1d',\n  error: /Users/jean.pruliere/code/perso/samples-typescript/hello-world/workflow-bundle-7deb71318020c96355f1.js:4654\n          throw new TypeError(`Failed to initialize workflow of type '${activator.info.workflowType}': ${details}`);\n          ^\n  \n  TypeError: Failed to initialize workflow of type 'bound example': no such function is exported by the workflow bundle\n      at Object.initRuntime (/Users/jean.pruliere/code/perso/samples-typescript/hello-world/node_modules/@temporalio/workflow/src/worker-interface.ts:87:10)\n      at evalmachine.<anonymous>:1:18\n      at Script.runInContext (node:vm:149:12)\n      at Object.runInContext (node:vm:301:6)\n      at Proxy.<anonymous> (/Users/jean.pruliere/code/perso/samples-typescript/hello-world/node_modules/@temporalio/worker/lib/workflow/reusable-vm.js:104:50)\n      at ReusableVMWorkflowCreator.createWorkflow (/Users/jean.pruliere/code/perso/samples-typescript/hello-world/node_modules/@temporalio/worker/lib/workflow/reusable-vm.js:131:24)\n      at handleRequest (/Users/jean.pruliere/code/perso/samples-typescript/hello-world/node_modules/@temporalio/worker/lib/workflow/workflow-worker-thread.js:42:35)\n      at MessagePort.<anonymous> (/Users/jean.pruliere/code/perso/samples-typescript/hello-world/node_modules/@temporalio/worker/lib/workflow/workflow-worker-thread.js:92:38)\n      at [nodejs.internal.kHybridDispatch] (node:internal/event_target:816:20)\n      at MessagePort.<anonymous> (node:internal/per_context/messageport:23:28),\n  workflowExists: false\n}\n```\n\n### Environment/Versions\n\n- OS and processor: M2 Mac\n- Temporal Version: sdk 1.11.7, server 1.27.1\n- I'm using Docker and our production use Kubernetes\n","closedAt":null,"comments":[{"id":"IC_kwDOEujx186jYqhj","author":{"login":"jean-pruliere"},"authorAssociation":"NONE","body":"I forgot to mention it but I can work on a fix, I have already identified [which function](https://github.com/temporalio/sdk-typescript/blob/main/packages/common/src/workflow-options.ts#L240) should be modified.\n\nLet me know, cheers","createdAt":"2025-03-20T17:12:58Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1656#issuecomment-2741151843","viewerDidAuthor":false}],"createdAt":"2025-03-20T17:10:26Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDA2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":1656,"reactionGroups":[],"state":"OPEN","title":"[Bug] Workflow type is incorrectly deduced when using `bind` on workflow function","updatedAt":"2025-03-20T17:13:00Z","url":"https://github.com/temporalio/sdk-typescript/issues/1656"}
