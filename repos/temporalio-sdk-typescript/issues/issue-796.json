{"assignees":[{"id":"MDQ6VXNlcjI1MTI4OA==","login":"lorensr","name":"Loren ☺️","databaseId":0}],"author":{"id":"MDQ6VXNlcjE0OTgyMjc=","is_bot":false,"login":"albertyfwu","name":"Albert"},"body":"### What are you really trying to do?\r\n\r\nI'm trying to write a query that will return the time left on a timer.\r\n\r\n### Describe the bug\r\n\r\nIf a query depends on `Date.now()`, it will calculate `Date.now()` once and not update it it again on successive queries.\r\n\r\nFor example:\r\n```\r\nsetHandler(timeLeftMsQuery, () => timer.getDeadline() - Date.now());\r\n```\r\n\r\nIf I query this, I keep getting the same number back even though I would expect to keep getting smaller numbers.\r\n\r\n### Minimal Reproduction\r\n\r\n```\r\nasync function wf() {\r\n  setHandler(timeLeftMsQuery, () => Date.now());\r\n  await sleep('5 hours');\r\n}\r\n\r\nconst timeLeftMsQuery = defineQuery<number>('timeLeftMs');\r\n```\r\n\r\n### Environment/Versions\r\n\r\n<!-- Please complete the following information where relevant. -->\r\n\r\n- OS and processor: [e.g. M1 Mac, x86 Windows, Linux]\r\n- Temporal Version: [e.g. 1.14.0?] and/or SDK version\r\n- Are you using Docker or Kubernetes or building Temporal from source?\r\n\r\n### Additional context\r\n\r\n<!-- Add any other context about the problem here. -->\r\n","closedAt":"2022-09-28T04:15:11Z","comments":[{"id":"IC_kwDOEujx185HiqIS","author":{"login":"albertyfwu"},"authorAssociation":"NONE","body":"I believe I discussed this with @bergundy a while back on Slack, but I could not relocate the issue on github.","createdAt":"2022-07-30T18:08:16Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/796#issuecomment-1200267794","viewerDidAuthor":false},{"id":"IC_kwDOEujx185HixaS","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"https://github.com/temporalio/sdk-features/issues/31#issuecomment-1138616879\r\n\r\nThis is trivial to add.\r\nI’ll make sure we include in the next release ","createdAt":"2022-07-30T21:32:17Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/796#issuecomment-1200297618","viewerDidAuthor":false}],"createdAt":"2022-07-30T18:07:41Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDEz","name":"enhancement","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":796,"reactionGroups":[],"state":"CLOSED","title":"Add WorkflowInfo.unsafe.now()","updatedAt":"2022-09-28T04:15:11Z","url":"https://github.com/temporalio/sdk-typescript/issues/796"}
