{"assignees":[],"author":{"id":"U_kgDODQhmQw","is_bot":false,"login":"jbrody-nexxa","name":""},"body":"### What are you really trying to do?\n\nCall a Workflow with Worker Versioning and PINNED behavior using the TypeScript SDK client\n\n### Describe the bug\n\nStarting in Temporal Server version 1.28.0, the validation logic for versioning overrides in the API expects either of the following structures for pinned behavior:\n\n```\n{\n  pinned: {\n    version: 'pinned-version', // v0.32\n    behavior: temporal.api.workflow.v1.VersioningOverride.PinnedOverrideBehavior.PINNED_OVERRIDE_BEHAVIOR_PINNED, // v0.32  \n  },\n}\n```\nor:\n```\n{\n  behavior: temporal.api.enums.v1.VersioningBehavior.VERSIONING_BEHAVIOR_PINNED, // v0.31\n  pinnedVersion: 'pinned-version', // v0.31\n}\n```\n\nSince TS SDK version 1.12, the client is sending versioning overrides in the following format:\n```\n{\n  pinned: {\n      version: 'pinned-version', // v0.32\n  },\n  behavior: temporal.api.enums.v1.VersioningBehavior.VERSIONING_BEHAVIOR_PINNED, // v0.31\n  pinnedVersion: 'pinned-version', // v0.31\n}\n```\n\nThis fails validation, as the server prefers validation of the v0.32 structure over the deprecated v0.31 structure. The error message from the server is: `ServiceError: must specify pinned override behavior if override is pinned.`\n\nSee server validation code in https://github.com/temporalio/temporal/blob/fcd84c4be64104ca8b9b670f50539a027e77aa78/common/worker_versioning/worker_versioning.go#L483\n\n### Minimal Reproduction\n\n1. Start a Workflow Worker with the following workerDeploymentOptions:\n`{   useWorkerVersioning: true,   defaultVersioningBehavior: 'AUTO_UPGRADE',   version: {   deploymentName: deploymentName,   buildId: buildId, }`\n2. Call `WorkflowClient.start()` from the TypeScript SDK with the following versioningOverride:\n`{   pinnedTo: { deploymentName: deploymentName, buildId: buildId,   }, }`\n3. Workflow does not start, and client produces the error: `ServiceError: must specify pinned override behavior if override is pinned.`\n\n### Environment/Versions\n\n- OS and processor: Mac, Linux\n- Temporal Version: TS SDK version 1.12.1; works on server 1.27.1, fails on sever 1.28.0 and 1.29.0\n- Are you using Docker or Kubernetes or building Temporal from source? Using Kubernetes and brew on Mac\n\n### Additional context\n\nSee the discussion thread with Carly on the issue in the server repo: https://github.com/temporalio/temporal/issues/8114\n","closedAt":"2025-07-31T16:38:07Z","comments":[],"createdAt":"2025-07-30T23:46:00Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDA2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":1753,"reactionGroups":[],"state":"CLOSED","title":"[Bug] Calling a Workflow with Worker Versioning and PINNED behavior in versionOverrides fails in Temporal Server >=1.28.0","updatedAt":"2025-07-31T16:38:07Z","url":"https://github.com/temporalio/sdk-typescript/issues/1753"}
