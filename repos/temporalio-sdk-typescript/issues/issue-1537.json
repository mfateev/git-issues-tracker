{"assignees":[],"author":{"id":"MDQ6VXNlcjY0MTIxNjk=","is_bot":false,"login":"mjameswh","name":"James Watkins-Harvey"},"body":"### Describe what you are trying to do\r\n\r\n(From a user) We are trying to get good logs to do alerts on following usecases:\r\n- When a workflow task fails for more than 3 times (possibly becasue of implementation issue)\r\n- Workflow fails (because of ApplicationFailure or ActivityFailure etc)\r\n\r\n### Describe the bug\r\n\r\n- On Workflow Task failure, the lifecycle logger prints out a message indicating that `Workflow failed`; that's exactly the same error message as on actual `Workflow Failure`, making it impossible to differentiate these cases.\r\n\r\n- Similarly, one may see `Workflow started` printed multiple time for a same Workflow Execution, i.e. every single time that the a Worker needs to rebuild (aka “replay”) the runtime state of that Workflow Execution from the very beginning.\r\n\r\n### Additional context\r\n\r\n- The thing is that this lifecycle handler is logging things from the perspective of \"the Cached Workflow Instance” (i.e. the specific instance of that workflow execution in the cache of that specific Workflow Worker), rather than from the perspective of the actual Workflow Execution’s lifecycle.\r\n\r\n- We need to think of a more precise way of formulating those messages. For various reasons, no mention of “Workflow” or “Workflow Task” (starting, failing, completing…) would be 100% reliable at that precise place. For example, Workflow code may attempt to “Complete Workflow”, but the completion command times out or get rejected by the server because of new incoming events, and so what appears to be “Workflow completed” actually ends up being a Workflow Task Failure or Timeout.\r\n\r\n- Community Slack conversation: https://temporalio.slack.com/archives/C01DKSMU94L/p1727436127246899","closedAt":null,"comments":[{"id":"IC_kwDOEujx186Oe-lV","author":{"login":"ilijaNL"},"authorAssociation":"NONE","body":"Since temporal sdk has metric counters, why wouldnt it be possible to do logging in the same place when the counter increases?","createdAt":"2024-10-03T04:20:21Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1537#issuecomment-2390485333","viewerDidAuthor":false},{"id":"IC_kwDOEujx186SiULy","author":{"login":"mjameswh"},"authorAssociation":"MEMBER","body":"> Since temporal sdk has metric counters, why wouldnt it be possible to do logging in the same place when the counter increases?\r\n\r\nIt's unfortunately not that simple. Metrics bookkeeping is handled by Core SDK, whereas logging is handled on the TypeScript side.","createdAt":"2024-11-06T00:32:02Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1537#issuecomment-2458469106","viewerDidAuthor":false}],"createdAt":"2024-09-27T15:43:58Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDA2","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"LA_kwDOEujx188AAAABwJfM3Q","name":"visibility","description":"","color":"616998"}],"milestone":null,"number":1537,"reactionGroups":[],"state":"OPEN","title":"[Bug] Workflow lifecycle logging is misleading","updatedAt":"2024-11-06T00:32:04Z","url":"https://github.com/temporalio/sdk-typescript/issues/1537"}
