{"assignees":[],"author":{"id":"MDQ6VXNlcjI2MTQzODcz","is_bot":false,"login":"tareksalem","name":"tarek salem"},"body":"### What are you really trying to do?\r\nThis is not an actual bug\r\n\r\nI am using a simple activity like this:\r\n\r\n```typescript\r\nexport async function greet(name: string): Promise<string> {\r\n  return Promise.reject('www')\r\n}\r\n```\r\n\r\nand this is the workflow\r\n\r\n```typescript\r\n\r\n/** A workflow that simply calls an activity */\r\nexport async function example(name: string): Promise<string> {\r\n  try {\r\n    console.log(\"============= entered try\")\r\n    return await greet(name);\r\n  } catch (err) {\r\n    console.log('============= entered the failure catch');\r\n    throw ApplicationFailure.nonRetryable(\"====================== failed to get name\");\r\n  }\r\n}\r\n```\r\nI want to throw the application failure from the workflow itself if the activity failed, not from the activity function\r\n\r\n### Describe the bug\r\nIn normal javascript code, when I return a rejection from a promise function and call that function in a try-catch block, its expected to catch the error and do whatever logic should be done inside that catch block, but this is not the case with temporal SDK, if I return a rejection from the promise and call it inside try-catch block inside the workflow it doesn't call the catch block and it causes the workflow to be retried which is not the wanted behavior.\r\n\r\n\r\n#### Why do I want to do that?\r\nfor me activities are functions and I want  to make them pure functions for testability and extendability, so I don't want the activities function to know anything about the temporal application failure and not take the decision regarding to which error should be thrown\r\nI think the workflow itself should have that logic so I want to put the activities that might return a failure to put them inside a try catch block inside the workflow and in the catch block decide which type of failure should be thrown\r\n\r\nIs something like this doable?\r\n\r\nAlso, I didn't find something in the documentation explaining this, is there a resource that explains this in detail?\r\n\r\nThanks.","closedAt":"2023-05-30T15:16:17Z","comments":[{"id":"IC_kwDOEujx185df02E","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"Activities are retired indefinitely by default unless they throw an error that's specified in the non retryable types in the retry policy or they throw a non retryable application failure.\r\nThis is typically what you want because activities interact with unreliable systems and Temporal ensures they run to completion.\r\nRetrying from the workflow is far more expensive in terms of compute and storage operations so we generally do not recommend that approach.\r\n\r\nThis page covers what you need to know about activities conceptually: https://docs.temporal.io/activities\r\n\r\n","createdAt":"2023-05-30T15:16:17Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1127#issuecomment-1568624004","viewerDidAuthor":false},{"id":"IC_kwDOEujx185dnevp","author":{"login":"tareksalem"},"authorAssociation":"NONE","body":"@bergundy why throwing errors from the workflow is more expensive?\r\n\r\nwhat If I want to make the decision of retrying or not from outside the activity?","createdAt":"2023-05-31T17:29:39Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1127#issuecomment-1570630633","viewerDidAuthor":false},{"id":"IC_kwDOEujx185dqCRT","author":{"login":"lorensr"},"authorAssociation":"CONTRIBUTOR","body":"If you need to decide whether to retry from the workflow, you can throw a\nnon-retryable error from the Activity:\n\n`throw ApplicationFailure.create({ message: 'foo', nonRetryable: true })`\n\nMore info:\n\nhttps://docs.temporal.io/kb/failures\n\nOn Wed, May 31, 2023 at 1:29 PM tarek salem ***@***.***>\nwrote:\n\n> @bergundy <https://github.com/bergundy> why throwing errors from the\n> workflow is more expensive?\n>\n> what If I want to make the decision of retrying or not from outside the\n> activity?\n>\n> —\n> Reply to this email directly, view it on GitHub\n> <https://github.com/temporalio/sdk-typescript/issues/1127#issuecomment-1570630633>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AAB5LGEW72GVBB43DAZ5QVTXI55Y5ANCNFSM6AAAAAAYT5NWJI>\n> .\n> You are receiving this because you are subscribed to this thread.Message\n> ID: ***@***.***>\n>\n","createdAt":"2023-06-01T03:59:10Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/1127#issuecomment-1571300435","viewerDidAuthor":false}],"createdAt":"2023-05-30T12:14:48Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDA2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":1127,"reactionGroups":[],"state":"CLOSED","title":"Temporal SDK Changes how javascript is being executed","updatedAt":"2023-06-01T03:59:11Z","url":"https://github.com/temporalio/sdk-typescript/issues/1127"}
