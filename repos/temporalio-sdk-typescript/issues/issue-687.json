{"assignees":[],"author":{"id":"MDQ6VXNlcjYyODQzMQ==","is_bot":false,"login":"davidtheclark","name":"David Clark"},"body":"### What are you really trying to do?\r\n\r\nUpdate from 0.21 to 0.23.\r\n\r\n### Describe the bug\r\n\r\nI get error \"Cannot find module '@temporalio/common/lib/converter/wrapped-payload-converter'\".\r\n\r\n```\r\n> @watershed/temporal-worker@0.1.0 build-webpack-bundle /.../workspaces/temporal-worker\r\n> node ../../build/workspaces/temporal-worker/build-webpack-bundle.js\r\nnode:internal/modules/cjs/loader:936\r\n  throw err;\r\n  ^\r\nError: Cannot find module '@temporalio/common/lib/converter/wrapped-payload-converter'\r\nRequire stack:\r\n- /.../node_modules/.pnpm/@temporalio+workflow@0.23.0/node_modules/@temporalio/workflow/lib/internals.js\r\n- /.../node_modules/.pnpm/@temporalio+workflow@0.23.0/node_modules/@temporalio/workflow/lib/workflow.js\r\n- /.../node_modules/.pnpm/@temporalio+workflow@0.23.0/node_modules/@temporalio/workflow/lib/index.js\r\n- /.../node_modules/.pnpm/@temporalio+worker@0.23.2/node_modules/@temporalio/worker/lib/worker.js\r\n- /.../node_modules/.pnpm/@temporalio+worker@0.23.2/node_modules/@temporalio/worker/lib/index.js\r\n- /.../build/workspaces/temporal-worker/build-webpack-bundle.js\r\n    at Function.Module._resolveFilename (node:internal/modules/cjs/loader:933:15)\r\n    at Function.Module._resolveFilename (/.../node_modules/.pnpm/module-alias@2.2.2/node_modules/module-alias/index.js:49:29)\r\n    at Function.Module._load (node:internal/modules/cjs/loader:778:27)\r\n    at Module.require (node:internal/modules/cjs/loader:1005:19)\r\n    at require (node:internal/modules/cjs/helpers:102:18)\r\n    at Object.<anonymous> (/.../node_modules/.pnpm/@temporalio+workflow@0.23.0/node_modules/@temporalio/workflow/lib/internals.js:17:37)\r\n    at Module._compile (node:internal/modules/cjs/loader:1105:14)\r\n    at Object.Module._extensions..js (node:internal/modules/cjs/loader:1159:10)\r\n    at Module.load (node:internal/modules/cjs/loader:981:32)\r\n    at Function.Module._load (node:internal/modules/cjs/loader:822:12) {\r\n  code: 'MODULE_NOT_FOUND',\r\n  requireStack: [\r\nundefined\r\n    '/.../node_modules/.pnpm/@temporalio+workflow@0.23.0/node_modules/@temporalio/workflow/lib/internals.js',\r\n    '/.../node_modules/.pnpm/@temporalio+workflow@0.23.0/node_modules/@temporalio/workflow/lib/workflow.js',\r\n    '/.../node_modules/.pnpm/@temporalio+workflow@0.23.0/node_modules/@temporalio/workflow/lib/index.js',\r\n    '/.../node_modules/.pnpm/@temporalio+worker@0.23.2/node_modules/@temporalio/worker/lib/worker.js',\r\n    '/.../node_modules/.pnpm/@temporalio+worker@0.23.2/node_modules/@temporalio/worker/lib/index.js',\r\n/.../workspaces/temporal-worker:\r\n ERR_PNPM_RECURSIVE_RUN_FIRST_FAIL  @watershed/temporal-worker@0.1.0 build-webpack-bundle: `node ../../build/workspaces/temporal-worker/build-webpack-bundle.js`\r\nExit status 1\r\n    '/.../build/workspaces/temporal-worker/build-webpack-bundle.js'\r\n  ]\r\n}\r\n```\r\n\r\nIt looks to me like [`@temporalio/workflow/lib/internals` depends on `@temporalio/common`](https://github.com/temporalio/sdk-typescript/blob/31eb76a8849ef046b2978bc77b78248eb1ae32d6/packages/workflow/src/internals.ts), but [`@temporalio/common` is not defined as a dependency in `workflow/package.json`.](https://github.com/temporalio/sdk-typescript/blob/31eb76a8849ef046b2978bc77b78248eb1ae32d6/packages/workflow/package.json)\r\n\r\n### Environment/Versions\r\n\r\n<!-- Please complete the following information where relevant. -->\r\n\r\n- OS and processor: Mac\r\n- Temporal Version: 0.21 -> 0.23\r\n- Are you using Docker or Kubernetes or building Temporal from source? Docker\r\n\r\nI'm using pnpm to manage Node dependencies.\r\n","closedAt":"2022-06-09T20:05:23Z","comments":[{"id":"IC_kwDOEujx185EbTS1","author":{"login":"lorensr"},"authorAssociation":"CONTRIBUTOR","body":"Thanks for reporting! That particular import isn't used anymore on latest `main`, but we do have other imports to /common from /workflow, so I opened #688 to fix.","createdAt":"2022-06-06T22:46:26Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/687#issuecomment-1148007605","viewerDidAuthor":false}],"createdAt":"2022-06-06T21:50:37Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDA2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":687,"reactionGroups":[],"state":"CLOSED","title":"[Bug] Installing v0.23 I get error \"Cannot find module '@temporalio/common/lib/converter/wrapped-payload-converter'\"","updatedAt":"2022-06-09T20:05:23Z","url":"https://github.com/temporalio/sdk-typescript/issues/687"}
