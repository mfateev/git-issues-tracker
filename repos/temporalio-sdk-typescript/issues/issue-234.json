{"assignees":[{"id":"MDQ6VXNlcjUyMzA0","login":"bergundy","name":"Roey Berman","databaseId":0}],"author":{"id":"MDQ6VXNlcjUyMzA0","is_bot":false,"login":"bergundy","name":"Roey Berman"},"body":"Some sample failures:\r\n\r\n- https://buildkite.com/temporal/node-sdk/builds/94#f4020ec8-7b30-46e8-94b9-071acb1f7c7f\r\n- https://buildkite.com/temporal/node-sdk/builds/93#088f173f-0a7f-48a6-bbcb-f0181570d504","closedAt":"2021-10-13T14:20:12Z","comments":[{"id":"IC_kwDOEujx1843LCdX","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"@Sushisource I think this overlaps with what you're working on, let's sync.","createdAt":"2021-09-23T09:20:02Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/234#issuecomment-925640535","viewerDidAuthor":false},{"id":"IC_kwDOEujx1843Y18c","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"@Sushisource I think once you merge retry interceptors we'll only have to deal with context deadline exceeded when polling on workflow result.\r\nI can handle that tomorrow.","createdAt":"2021-09-28T14:03:46Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/234#issuecomment-929259292","viewerDidAuthor":false},{"id":"IC_kwDOEujx1843cPFS","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"DEADLINE EXCEEDED happens in GH actions as well.\r\nAfter further investigation, it seems like it's always a query that hits the deadline.\r\n\r\nAFAICT, retrying the query \"eliminates\" the issue and tests pass but I suspect that there's a bug in the query implementation causing timeouts.\r\nThe server logs show the query timeout:\r\n```\r\ntemporal                | {\"level\":\"info\",\"ts\":\"2021-09-29T12:39:28.133Z\",\"msg\":\"query directly through matching on sticky timed out, attempting to query on non-sticky\",\"service\":\"history\",\"shard-id\":1,\"address\":\"172.20.0.4:7234\",\"shard-item\":\"0xc0004bce00\",\"component\":\"history-engine\",\"wf-namespace\":\"default\",\"wf-id\":\"72f29e60-7fe3-4586-bd68-15550a411bab\",\"wf-run-id\":\"0b00ddf4-5e5c-4b89-8d2c-ed61c509aa3d\",\"wf-query-type\":\"isBlocked\",\"wf-task-queue-name\":\"\",\"wf-next-event-id\":10,\"logging-call-at\":\"historyEngine.go:921\"}\r\n```","createdAt":"2021-09-29T12:55:58Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/234#issuecomment-930148690","viewerDidAuthor":false},{"id":"IC_kwDOEujx1843cS-p","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"Apart from finding and fixing the root cause I suggest that we rethrow errors from the service in `WorkflowClient` because grpc errors are thrown asynchronously with a meaningless stack trace.","createdAt":"2021-09-29T13:15:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/234#issuecomment-930164649","viewerDidAuthor":false},{"id":"IC_kwDOEujx1843cwFf","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"Retrying the query sometimes results in the test timing out so it's not a valid workaround.","createdAt":"2021-09-29T15:25:51Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/234#issuecomment-930283871","viewerDidAuthor":false},{"id":"IC_kwDOEujx184357mx","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"Looks like there's general instability on buildkite: https://buildkite.com/temporal/node-sdk/builds/277","createdAt":"2021-10-07T16:02:54Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/234#issuecomment-937933233","viewerDidAuthor":false},{"id":"IC_kwDOEujx1844Kzg7","author":{"login":"bergundy"},"authorAssociation":"MEMBER","body":"Tuning down the number of cached workflows seems to have stabilzed buildkite builds.\r\nThe occasional DEADLINE EXCEEDED on query requests is a server issue which was fixed here: https://github.com/temporalio/temporal/pull/2033\r\n","createdAt":"2021-10-13T14:20:12Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-typescript/issues/234#issuecomment-942356539","viewerDidAuthor":false}],"createdAt":"2021-09-12T12:38:39Z","labels":[{"id":"MDU6TGFiZWwyNTQ1Mzg0MDA2","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":{"number":2,"title":"beta","description":"","dueOn":null},"number":234,"reactionGroups":[],"state":"CLOSED","title":"[Bug] Load tests fail due to timeouts on buildkite","updatedAt":"2021-10-13T14:20:12Z","url":"https://github.com/temporalio/sdk-typescript/issues/234"}
