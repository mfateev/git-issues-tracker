{"assignees":[],"author":{"id":"MDQ6VXNlcjI2Njk5Mjc=","is_bot":false,"login":"rstm-sf","name":"Rustam"},"body":"**Summary**\r\n\r\nWhen I try to build a solution, I get errors NU1903\r\n\r\n**Details**\r\n\r\n```bash\r\n> dotnet build\r\n    .\\sdk-dotnet\\tests\\Temporalio.Tests\\Temporalio.Tests.csproj : error NU1903: Warning As Error: Package 'System.Net.Http' 4.3.0 has a known high severity vulnerability, https://github.com/advisories/GHSA-7jgj-8wvc-jh57\r\n    .\\sdk-dotnet\\src\\Temporalio.Extensions.Hosting\\Temporalio.Extensions.Hosting.csproj : error NU1903: Warning As Error: Package 'System.Text.Json' 7.0.0 has a known high severity vulnerability, https://github.com/advisories/GHSA-hh2w-p6rv-4g7w\r\n    .\\sdk-dotnet\\tests\\Temporalio.Tests\\Temporalio.Tests.csproj : error NU1903: Warning As Error: Package 'System.Text.Json' 8.0.0 has a known high severity vulnerability, https://github.com/advisories/GHSA-hh2w-p6rv-4g7w\r\n    .\\sdk-dotnet\\tests\\Temporalio.Tests\\Temporalio.Tests.csproj : error NU1903: Warning As Error: Package 'System.Text.RegularExpressions' 4.3.0 has a known high severity vulnerability, https://github.com/advisories/GHSA-cmhx-cq75-c4mj\r\n```\r\n\r\nRestore failed with 4 error(s) in 0.7s","closedAt":"2024-10-31T16:51:18Z","comments":[{"id":"IC_kwDOInL6Hs6MPoZH","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"Hrmm, these issues do not occur in our CI build when we do a `dotnet build`. I wonder if our `dotnet` version is off. For instance, https://github.com/temporalio/sdk-dotnet/actions/runs/10812517816 is not reporting this. Can you provide the steps to replicate this build error? Is there a global setting you have that we do not in CI?\r\n\r\nRegardless, we can definitely update the test dependencies. For the `Temporalio.Extensions.Hosting` dependency I'm a bit more hesitant to require the next major version (though of course we suggest all _users_ of the library use the latest), but we may be able to upgrade that too.","createdAt":"2024-09-16T13:22:26Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-dotnet/issues/347#issuecomment-2352907847","viewerDidAuthor":false},{"id":"IC_kwDOInL6Hs6MP3Rz","author":{"login":"rstm-sf"},"authorAssociation":"NONE","body":"Seems to be because [the .NET 6 SDK is being used](\r\nhttps://github.com/temporalio/sdk-dotnet/blob/5141c2cb1330cdce1ab88f1bffd246012d5e1aa7/.github/workflows/ci.yml#L47) and it may not have up-to-date package checking for known vulnerabilities.\r\n\r\n\r\nI have SDKs from 6 to 9 and when I build, I used global.json to specify that I should use SDK 8. Now I tried to specify 6 SDK and there were no errors either\r\n```bash\r\ndotnet build\r\nMSBuild version 17.3.4+a400405ba for .NET\r\n  Determining projects to restore...\r\n  Restored .\\sdk-dotnet\\src\\Temporalio.Extensions.OpenTelemetry\\Temporalio.Extensions.OpenTelemetry.csproj (in 193 ms).\r\n  Restored .\\sdk-dotnet\\src\\Temporalio.Extensions.DiagnosticSource\\Temporalio.Extensions.DiagnosticSource.csproj (in 193 ms).\r\n  Restored .\\sdk-dotnet\\src\\Temporalio.Extensions.Hosting\\Temporalio.Extensions.Hosting.csproj (in 213 ms).\r\n  Restored .\\sdk-dotnet\\src\\Temporalio\\Temporalio.csproj (in 193 ms).\r\n  Restored .\\sdk-dotnet\\tests\\Temporalio.Tests\\Temporalio.Tests.csproj (in 232 ms).\r\n  Temporalio -> .\\sdk-dotnet\\src\\Temporalio\\bin\\Debug\\netcoreapp3.1\\Temporalio.dll\r\n  Temporalio -> .\\sdk-dotnet\\src\\Temporalio\\bin\\Debug\\netstandard2.0\\Temporalio.dll\r\n  Temporalio -> .\\sdk-dotnet\\src\\Temporalio\\bin\\Debug\\net462\\Temporalio.dll\r\n  Temporalio.Extensions.DiagnosticSource -> .\\sdk-dotnet\\src\\Temporalio.Extensions.DiagnosticSource\\bin\\Debug\\netstandard2.0\\Temporalio.Extensions.DiagnosticSource.dll\r\n  Temporalio.Extensions.OpenTelemetry -> .\\sdk-dotnet\\src\\Temporalio.Extensions.OpenTelemetry\\bin\\Debug\\netstandard2.0\\Temporalio.Extensions.OpenTelemetry.dll\r\n  Temporalio.Extensions.Hosting -> .\\sdk-dotnet\\src\\Temporalio.Extensions.Hosting\\bin\\Debug\\netstandard2.0\\Temporalio.Extensions.Hosting.dll\r\n  Temporalio.Extensions.Hosting -> .\\sdk-dotnet\\src\\Temporalio.Extensions.Hosting\\bin\\Debug\\net462\\Temporalio.Extensions.Hosting.dll\r\n  Temporalio.Extensions.DiagnosticSource -> .\\sdk-dotnet\\src\\Temporalio.Extensions.DiagnosticSource\\bin\\Debug\\net462\\Temporalio.Extensions.DiagnosticSource.dll\r\n  Temporalio.Extensions.OpenTelemetry -> .\\sdk-dotnet\\src\\Temporalio.Extensions.OpenTelemetry\\bin\\Debug\\net462\\Temporalio.Extensions.OpenTelemetry.dll\r\n  Temporalio.Extensions.Hosting -> .\\sdk-dotnet\\src\\Temporalio.Extensions.Hosting\\bin\\Debug\\net6.0\\Temporalio.Extensions.Hosting.dll\r\n  Temporalio.Tests -> .\\sdk-dotnet\\tests\\Temporalio.Tests\\bin\\Debug\\net6.0\\Temporalio.Tests.dll\r\n```\r\n\r\n```json\r\n{\r\n  \"sdk\": {\r\n    \"version\": \"6.0.0\",\r\n    \"rollForward\": \"latestFeature\",\r\n    \"allowPrerelease\": false\r\n  }\r\n}\r\n```\r\n","createdAt":"2024-09-16T13:44:58Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-dotnet/issues/347#issuecomment-2352968819","viewerDidAuthor":false},{"id":"IC_kwDOInL6Hs6MR6_s","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"Thanks! We will look into setting up a build with .NET 8 and look into updating minimum dependencies in a way that doesn't harm past users.\r\n\r\nThis should just affect builds of the SDK not usage of the SDK so we likely won't release an emergency patch release for this, but we should get to this soon. You can either alter the dependency versions explicitly or disable this warning in the meantime.","createdAt":"2024-09-16T17:30:19Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-dotnet/issues/347#issuecomment-2353508332","viewerDidAuthor":false},{"id":"IC_kwDOInL6Hs6PEfwU","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"@rstm-sf - I used .NET 8 in a part of our CI at https://github.com/temporalio/sdk-dotnet/pull/356 and did not see any errors restoring/building (see run at https://github.com/temporalio/sdk-dotnet/actions/runs/11239495901/job/31246675940?pr=356, it is windows specific).\r\n\r\nIt does seem like per https://learn.microsoft.com/en-us/dotnet/core/compatibility/sdk/8.0/dotnet-restore-audit that this should fail if it had bad dependencies. I wonder if a fresh build is pulling in fixed versions of those dependencies? Or is there some other setting governing this? We have `TreatWarningsAsErrors` as `true`. I wonder if related to `net6.0` target framework. I want to make sure we replicate the failure in CI so I know I have fixed it and I know we won't see it again.","createdAt":"2024-10-08T16:23:59Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-dotnet/issues/347#issuecomment-2400320532","viewerDidAuthor":false},{"id":"IC_kwDOInL6Hs6Qh_Zl","author":{"login":"rstm-sf"},"authorAssociation":"NONE","body":"@cretz hello, sorry for delay, I reproduced it :) https://github.com/rstm-sf/sdk-dotnet/actions/runs/11425577349/job/31787420591?pr=1\r\n\r\n```bash\r\nRun dotnet build\r\n  Determining projects to restore...\r\n/home/runner/work/sdk-dotnet/sdk-dotnet/src/Temporalio/Temporalio.csproj : error NU1903: Warning As Error: Package 'System.Text.Json' 8.0.4 has a known high severity vulnerability, https://github.com/advisories/GHSA-8g4q-xg66-9fp4 [/home/runner/work/sdk-dotnet/sdk-dotnet/Temporalio.sln]\r\n  Restored /home/runner/work/sdk-dotnet/sdk-dotnet/src/Temporalio.Extensions.OpenTelemetry/Temporalio.Extensions.OpenTelemetry.csproj (in 3.07 sec).\r\n  Restored /home/runner/work/sdk-dotnet/sdk-dotnet/src/Temporalio.Extensions.Hosting/Temporalio.Extensions.Hosting.csproj (in 3.09 sec).\r\n  Failed to restore /home/runner/work/sdk-dotnet/sdk-dotnet/src/Temporalio/Temporalio.csproj (in 3.07 sec).\r\n  Restored /home/runner/work/sdk-dotnet/sdk-dotnet/src/Temporalio.Extensions.DiagnosticSource/Temporalio.Extensions.DiagnosticSource.csproj (in 4 ms).\r\n  Restored /home/runner/work/sdk-dotnet/sdk-dotnet/tests/Temporalio.Tests/Temporalio.Tests.csproj (in 6.95 sec).\r\n\r\nBuild FAILED.\r\n\r\n/home/runner/work/sdk-dotnet/sdk-dotnet/src/Temporalio/Temporalio.csproj : error NU1903: Warning As Error: Package 'System.Text.Json' 8.0.4 has a known high severity vulnerability, https://github.com/advisories/GHSA-8g4q-xg66-9fp4 [/home/runner/work/sdk-dotnet/sdk-dotnet/Temporalio.sln]\r\n    0 Warning(s)\r\n    1 Error(s)\r\n\r\nTime Elapsed 00:00:10.98\r\nError: Process completed with exit code 1.\r\n```","createdAt":"2024-10-20T10:34:59Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-dotnet/issues/347#issuecomment-2424829541","viewerDidAuthor":false},{"id":"IC_kwDOInL6Hs6QjAce","author":{"login":"rstm-sf"},"authorAssociation":"NONE","body":"Maybe using\r\n```xml\r\n<WarningsNotAsErrors>NU1903</WarningsNotAsErrors>\r\n```\r\nhttps://learn.microsoft.com/en-us/dotnet/csharp/language-reference/compiler-options/errors-warnings#warningsaserrors-and-warningsnotaserrors","createdAt":"2024-10-20T16:15:09Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-dotnet/issues/347#issuecomment-2425095966","viewerDidAuthor":false},{"id":"IC_kwDOInL6Hs6Qox7G","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"Thanks! I wonder what was different about our PRs. I wonder if my use of `8` instead of `8.x` is the issue? Regardless, yes we should at least update `System.Text.Json` dependency because we're already on `8`, but I do want to make sure our CI is catching these going forward (we are also getting a security alert on this dependency internally with dependabot). I will try again to make the CI fail (I do want to keep a 6.x build around in CI too).","createdAt":"2024-10-21T12:59:52Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-dotnet/issues/347#issuecomment-2426609350","viewerDidAuthor":false},{"id":"IC_kwDOInL6Hs6RUcjv","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"That was it, it's that I used `8` instead of `8.x`. Fixing this now...","createdAt":"2024-10-25T14:59:27Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-dotnet/issues/347#issuecomment-2438056175","viewerDidAuthor":false}],"createdAt":"2024-09-15T06:32:39Z","labels":[],"milestone":null,"number":347,"reactionGroups":[],"state":"CLOSED","title":"NU1903 error when run dotnet build ","updatedAt":"2024-10-31T16:51:18Z","url":"https://github.com/temporalio/sdk-dotnet/issues/347"}
