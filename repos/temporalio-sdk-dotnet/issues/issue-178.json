{"assignees":[],"author":{"id":"MDQ6VXNlcjUxNzY4Mw==","is_bot":false,"login":"Sushisource","name":"Spencer Judge"},"body":"### What are you really trying to do?\r\n\r\n<!-- \r\nTell us at a high level what you're doing, to avoid XY problem (https://en.wikipedia.org/wiki/XY_problem) \r\n-->\r\n\r\n### Describe the bug\r\n\r\nIf a child workflow is cancelled before it's scheduled, this (can) surface as a `ChildWorkflowFailureException` when it should instead be a `CanceledFailureException` as with other cancellations.\r\n\r\nThere is some code [here](https://github.com/temporalio/sdk-dotnet/blob/71757a66e152e49ddff2955dc464f8111cd10b07/src/Temporalio/Worker/WorkflowInstance.cs#L1782) that attempts to do the right thing, but this code may not always get to run before things have been handed off to Core (as is the case here). Probably we don't even need to have that code, Core will do the right thing and the failure it returns for the child just needs to be interpreted properly.\r\n\r\n### Minimal Reproduction\r\n\r\nReproduced during fuzz testing, but just cancelling children immediately or near-immedately ought to do it.\r\n\r\n### Environment/Versions\r\n\r\n<!-- Please complete the following information where relevant. -->\r\n\r\n- OS and processor: [e.g. M1 Mac, x86 Windows, Linux]\r\n- Temporal Version: [e.g. 1.14.0?] and/or SDK version\r\n- Are you using Docker or Kubernetes or building Temporal from source?\r\n\r\n### Additional context\r\n\r\n<!-- Add any other context about the problem here. -->\r\n","closedAt":"2024-02-12T21:13:55Z","comments":[{"id":"IC_kwDOInL6Hs5xq0Yy","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"After discussion, throwing cancellation exceptions eagerly if a call is made with an already-cancelled token is the .NET way and we do it in timers as well. So we need to just document that calling with an already-cancelled token may have a different exception than if it's cancelled before started (or after started). And that users should use `TemporalException.IsCanceledException` helper to know whether an exception is a cancelled exception.","createdAt":"2024-01-23T22:50:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-dotnet/issues/178#issuecomment-1907050034","viewerDidAuthor":false}],"createdAt":"2024-01-18T18:07:39Z","labels":[{"id":"LA_kwDOInL6Hs8AAAABJH7zkA","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":178,"reactionGroups":[],"state":"CLOSED","title":"[Bug] Child Workflow Cancellation before scheduled surfaces as incorrect error","updatedAt":"2024-02-12T21:13:55Z","url":"https://github.com/temporalio/sdk-dotnet/issues/178"}
