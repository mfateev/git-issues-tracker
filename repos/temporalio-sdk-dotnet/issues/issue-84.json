{"assignees":[],"author":{"id":"MDQ6VXNlcjgwNjA5MDg2","is_bot":false,"login":"tgrieger-sf","name":"Trevor Grieger"},"body":"### What are you really trying to do?\r\n\r\nValidating my understanding of how Temporal handles resuming child workflows.\r\n\r\n### Describe the bug\r\n\r\nWhen running a simple workflow that spans child workflows, if a child workflow is in progress and I kill the application, restarting the application does not resume the workflows like I would expect.\r\n\r\nIf I, instead, kill the application while a child workflow is NOT running and then resume it, the parent workflow resumes no problem.\r\n\r\nI've linked essentially what I'm doing, just boiled down to exactly what is needed to reproduce. What I don't know is if this expected no matter what, an issue with the dotnet sdk, or something else. Any help is much appreciated.\r\n\r\n### Minimal Reproduction\r\n\r\nMinimal reproduction with instructions here: https://github.com/tgrieger-sf/TemporalChildWorkflowBug\r\n\r\n### Environment/Versions\r\n\r\n<!-- Please complete the following information where relevant. -->\r\n\r\n- OS and processor: x64 Windows 10\r\n- Temporal Version: server 1.20.1\r\n- Are you using Docker or Kubernetes or building Temporal from source? Running it from `temporal start dev`\r\n\r\n### Additional context\r\n\r\n<!-- Add any other context about the problem here. -->\r\n\r\nN/A\r\n","closedAt":"2023-06-07T20:01:17Z","comments":[{"id":"IC_kwDOInL6Hs5eQkQd","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"I suspect your problem is that you have crashed an activity without the server knowing. For all but the most immediate activities, you should set a `HeartbeatTimeout` and heartbeat regularly as a keep alive to let the server know the activity hasn't crashed. See https://github.com/temporalio/sdk-dotnet#activity-heartbeating-and-cancellation. You should also set a `StartToCloseTimeout` with the max amount of time you expect an activity attempt to take before it should retry.\r\n\r\nThe child workflows resume, but they have nothing to resume because they are waiting on the activity. But since you are not heartbeating your activity or setting a reasonable timeout, the server thinks the activity is still running.\r\n\r\n(can continue to discuss here, or can also discuss in forum at https://community.temporal.io/ or `#dotnet-sdk` in Slack)","createdAt":"2023-06-07T19:37:01Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-dotnet/issues/84#issuecomment-1581401117","viewerDidAuthor":false},{"id":"IC_kwDOInL6Hs5eQrGH","author":{"login":"tgrieger-sf"},"authorAssociation":"NONE","body":"I'll close the issue, updated the `ScheduleToCloseTimeout` to `StartToCloseTimeout` and set it at a more reasonable 1 second and that did it. Thanks!","createdAt":"2023-06-07T20:01:17Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/temporalio/sdk-dotnet/issues/84#issuecomment-1581429127","viewerDidAuthor":false},{"id":"IC_kwDOInL6Hs5eRS1R","author":{"login":"cretz"},"authorAssociation":"MEMBER","body":"Note that 1 second may not be very reasonable actually for schedule to close. That means it has to be picked up, processed including all retries, and completed within a second. May work for a test, but your normal workflow may need a bit more leniency.","createdAt":"2023-06-07T22:22:53Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/temporalio/sdk-dotnet/issues/84#issuecomment-1581591889","viewerDidAuthor":false}],"createdAt":"2023-06-07T19:09:29Z","labels":[{"id":"LA_kwDOInL6Hs8AAAABJH7zrA","name":"question","description":"Further information is requested","color":"d876e3"}],"milestone":null,"number":84,"reactionGroups":[],"state":"CLOSED","title":"[Bug] If a child workflow is in progress when the service goes down, no workflows are resumed","updatedAt":"2023-06-07T22:22:53Z","url":"https://github.com/temporalio/sdk-dotnet/issues/84"}
